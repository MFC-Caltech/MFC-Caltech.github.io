<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Post_process: m_derived_variables.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Post_process
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__derived__variables_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_derived_variables.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__derived__variables_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html">   39</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__derived__variables.html">m_derived_variables</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>         !&lt; definitions of the derived types</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>     !&lt; global parameters for the code</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>             !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__derived__variables.html#a15a6d70e2bd1c9b7001c753ca1f2ee27">s_initialize_derived_variables_module</a>, &amp;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#acf313542c783139e0798f2097d1f68fc">s_compute_finite_difference_coefficients</a>, &amp;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#a7fadac6924cf61654373f9f334106001">s_derive_unadvected_volume_fraction</a>, &amp;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#aab235aa45c622ecf7f387cbf7994387d">s_derive_specific_heat_ratio</a>, &amp;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#a02166198be4da04f6b6ce69fd432910d">s_derive_liquid_stiffness</a>, &amp;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#a51eb66162227584de46a25cac55b5b6b">s_derive_sound_speed</a>, &amp;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#ac85e77b0312f21389eb166960446f6ec">s_derive_flux_limiter</a>, &amp;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#aa038ec37a8a0c8fe8d7185b9ef6d54a9">s_derive_vorticity_component</a>, &amp;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#af816bc88ed55a050bfe8f2ab94d89cba">s_derive_numerical_schlieren_function</a>, &amp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#a2c43e6d73417e237731fdad2eea07b22">s_derive_curvature</a>, &amp;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                       <a class="code" href="namespacem__derived__variables.html#a735665bf598281689158d9d6e075f3d4">s_finalize_derived_variables_module</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    </div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">   65</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">   75</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">   76</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">   77</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a2a27e1fa08c6751186a38d562b826955">   80</a></span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PRIVATE</span> :: <a class="code" href="namespacem__derived__variables.html#a2a27e1fa08c6751186a38d562b826955">flg</a></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a15a6d70e2bd1c9b7001c753ca1f2ee27">s_initialize_derived_variables_module</a>() <span class="comment">! ----------------------</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a15a6d70e2bd1c9b7001c753ca1f2ee27">   98</a></span>&#160;            </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="comment">! Allocating the gradient magnitude of the density variable provided</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="comment">! that numerical Schlieren function is outputted during post-process</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">schlieren_wrt</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>( -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg : <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end, &amp;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                    -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg : <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end, &amp;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                    -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg : <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end ))</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            </div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="comment">! Allocating the variables which will store the coefficients of the</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="comment">! centered family of finite-difference schemes. Note that sufficient</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="comment">! space is allocated so that the coefficients up to any chosen order</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="comment">! of accuracy may be bookkept. However, if higher than fourth-order</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="comment">! accuracy coefficients are wanted, the formulae required to compute</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="comment">! these coefficients will have to be implemented in the subroutine</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">! s_compute_finite_difference_coefficients.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="comment">! Allocating centered finite-difference coefficients in x-direction</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(2) .OR. <a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(3) .OR. <a class="code" href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">schlieren_wrt</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>(    -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a> : <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>      , &amp;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                    -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg : <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end ) )</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="comment">! Allocating centered finite-difference coefficients in y-direction</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">IF</span>(               <a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(1) .OR. <a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(3)              &amp;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                           .OR.                           &amp;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                               (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">schlieren_wrt</a>)                ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>(    -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a> : <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>      , &amp;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                    -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg : <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end ) )</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="comment">! Allocating centered finite-difference coefficients in z-direction</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">IF</span>(               <a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(1) .OR. <a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(2)              &amp;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                           .OR.                           &amp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                               (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">schlieren_wrt</a>)                ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(    -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a> : <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>      , &amp;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                    -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg : <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end ) )</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment">! Annotating the dimensionality of the dataset undergoing the post-</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="comment">! process. A flag value of 1 indicates that the dataset is 3D, while</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="comment">! a flag value of 0 indicates that it is not.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <a class="code" href="namespacem__derived__variables.html#a2a27e1fa08c6751186a38d562b826955">flg</a> = 1</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <a class="code" href="namespacem__derived__variables.html#a2a27e1fa08c6751186a38d562b826955">flg</a> = 0</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a15a6d70e2bd1c9b7001c753ca1f2ee27">s_initialize_derived_variables_module</a> <span class="comment">! --------------------</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#acf313542c783139e0798f2097d1f68fc">s_compute_finite_difference_coefficients</a>(    q, offset_s,   &amp;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                             s_cc, fd_coeff_s  )</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#acf313542c783139e0798f2097d1f68fc">  166</a></span>&#160;           </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: q</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: offset_s</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordtype">DIMENSION(-buff_size:q+buff_size)</span>, &amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: s_cc</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordtype">DIMENSION(-fd_number:fd_number, -offset_s%beg:q+offset_s%end)</span>, &amp;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: fd_coeff_s</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">! Computing the 1st order finite-difference coefficients</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a8892cc67c7d04be4d8e6d02a86e209bc">fd_order</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keywordflow">DO</span> i = -offset_s%beg, q+offset_s%end</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    fd_coeff_s(-1,i) =  0d0</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    fd_coeff_s( 0,i) = -1d0 / (s_cc(i+1) - s_cc(i))</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    fd_coeff_s( 1,i) = -fd_coeff_s(0,i)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="comment">! Computing the 2nd order finite-difference coefficients</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a8892cc67c7d04be4d8e6d02a86e209bc">fd_order</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">DO</span> i = -offset_s%beg, q+offset_s%end</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    fd_coeff_s(-1,i) = -1d0 / (s_cc(i+1) - s_cc(i-1))</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    fd_coeff_s( 0,i) =  0d0</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    fd_coeff_s( 1,i) = -fd_coeff_s(-1,i)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">! Computing the 4th order finite-difference coefficients</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">DO</span> i = -offset_s%beg, q+offset_s%end</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    fd_coeff_s(-2,i) =  1d0 / ( s_cc(i-2) - 8d0*s_cc(i-1) &amp;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                              - s_cc(i+2) + 8d0*s_cc(i+1) )</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    fd_coeff_s(-1,i) = -8d0*fd_coeff_s(-2,i)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    fd_coeff_s( 0,i) =  0d0</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    fd_coeff_s( 1,i) = -fd_coeff_s(-1,i)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    fd_coeff_s( 2,i) = -fd_coeff_s(-2,i)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                </div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            </div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#acf313542c783139e0798f2097d1f68fc">s_compute_finite_difference_coefficients</a> <span class="comment">! --------------</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a7fadac6924cf61654373f9f334106001">s_derive_unadvected_volume_fraction</a>(q_cons_vf, q_sf) <span class="comment">! ------</span></div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a7fadac6924cf61654373f9f334106001">  223</a></span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordtype">DIMENSION( -offset_x%beg : m+offset_x%end  , &amp;
                       -offset_y%beg : n+offset_y%end  , &amp;
                       -offset_z%beg : p+offset_z%end )</span>, &amp;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">! Computing unadvected volume fraction from conservative variables</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        </div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        q_sf(j,k,l) = 1d0</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                            q_sf(j,k,l) = q_sf(j,k,l) - q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                        </div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a7fadac6924cf61654373f9f334106001">s_derive_unadvected_volume_fraction</a> <span class="comment">! -------------------</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#aab235aa45c622ecf7f387cbf7994387d">s_derive_specific_heat_ratio</a>(gamma_sf, q_sf) <span class="comment">! --------------</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#aab235aa45c622ecf7f387cbf7994387d">  265</a></span>&#160;            <span class="keywordtype">DIMENSION( -buff_size     :  m+buff_size       , &amp;
                       -buff_size     :  n+buff_size       , &amp;
                       -buff_size*flg : (p+buff_size)*flg )</span>, &amp;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: gamma_sf</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordtype">DIMENSION( -offset_x%beg : m+offset_x%end  , &amp;
                       -offset_y%beg : n+offset_y%end  , &amp;
                       -offset_z%beg : p+offset_z%end )</span>, &amp;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            </div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="comment">! Computing specific heat ratio from specific heat ratio function</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="keywordflow">DO</span> i = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                        q_sf(i,j,k) = 1d0 + 1d0 / gamma_sf(i,j,k)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#aab235aa45c622ecf7f387cbf7994387d">s_derive_specific_heat_ratio</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a02166198be4da04f6b6ce69fd432910d">s_derive_liquid_stiffness</a>(gamma_sf, pi_inf_sf, q_sf) <span class="comment">! ------</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordtype">DIMENSION( -buff_size     :  m+buff_size       , &amp;
                       -buff_size     :  n+buff_size       , &amp;
                       -buff_size*flg : (p+buff_size)*flg )</span>, &amp;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: gamma_sf, pi_inf_sf</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a02166198be4da04f6b6ce69fd432910d">  305</a></span>&#160;            <span class="keywordtype">DIMENSION( -offset_x%beg : m+offset_x%end  , &amp;
                       -offset_y%beg : n+offset_y%end  , &amp;
                       -offset_z%beg : p+offset_z%end )</span>, &amp;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            </div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">! Calculating the values of the liquid stiffness from those of the</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">! specific heat ratio function and the liquid stiffness function</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    <span class="keywordflow">DO</span> i = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        q_sf(i,j,k) = pi_inf_sf(i,j,k) / (gamma_sf(i,j,k) + 1d0)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            </div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            </div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a02166198be4da04f6b6ce69fd432910d">s_derive_liquid_stiffness</a> <span class="comment">! -----------------------------</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a51eb66162227584de46a25cac55b5b6b">s_derive_sound_speed</a>( q_prim_vf, rho_sf, gamma_sf, &amp; ! ------</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                pi_inf_sf, q_sf       )</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            </div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordtype">DIMENSION( -buff_size     :  m+buff_size       , &amp;
                       -buff_size     :  n+buff_size       , &amp;
                       -buff_size*flg : (p+buff_size)*flg )</span>, &amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: rho_sf, gamma_sf, pi_inf_sf</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a51eb66162227584de46a25cac55b5b6b">  349</a></span>&#160;            <span class="keywordtype">DIMENSION( -offset_x%beg : m+offset_x%end  , &amp;
                       -offset_y%beg : n+offset_y%end  , &amp;
                       -offset_z%beg : p+offset_z%end )</span>, &amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="comment">! Fluid bulk modulus for alternate sound speed</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: blkmod1, blkmod2</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="comment">! Computing speed of sound values from those of pressure, density,</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">! specific heat ratio function and the liquid stiffness function</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    <span class="keywordflow">DO</span> i = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        <span class="comment">! Compute mixture sound speed</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            q_sf(i,j,k) = (((gamma_sf(i,j,k) + 1d0) * &amp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k) + &amp;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                pi_inf_sf(i,j,k)) / (gamma_sf(i,j,k) * &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                rho_sf(i,j,k)))</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                            blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1d0)*q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k) + &amp;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                            blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma + 1d0)*q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k) + &amp;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                            q_sf(i,j,k) = (1d0/(rho_sf(i,j,k)*(q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(i,j,k)/blkmod1 + &amp;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                    (1d0-q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(i,j,k))/blkmod2)))</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. q_sf(i,j,k) &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                            q_sf(i,j,k) = 1d-16</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                            q_sf(i,j,k) = sqrt(q_sf(i,j,k))</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a51eb66162227584de46a25cac55b5b6b">s_derive_sound_speed</a> <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        </div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#ac85e77b0312f21389eb166960446f6ec">s_derive_flux_limiter</a>(i, q_prim_vf, q_sf) <span class="comment">! -----------------</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION (    -offset_x%beg : m+offset_x%end , &amp;
                                            -offset_y%beg : n+offset_y%end , &amp;
                                            -offset_z%beg : p+offset_z%end)</span>, &amp;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: top, bottom, slope</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#ac85e77b0312f21389eb166960446f6ec">  417</a></span>&#160;                        <span class="keywordflow">IF</span> (i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            <span class="keywordflow">IF</span> (q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                top =   q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( j ,k,l) - &amp; </div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j-1,k,l)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                bottom= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( j ,k,l)</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                top =   q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+2,k,l) - &amp; </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+1,k,l)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                bottom= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( j ,k,l)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        <span class="keywordflow">ELSEIF</span> (i == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                            <span class="keywordflow">IF</span> (q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                top =   q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j, k ,l) - &amp; </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k-1,l)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                bottom= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k+1,l) - &amp;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j, k ,l)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                top =   q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k+2,l) - &amp; </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k+1,l)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                bottom= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k+1,l) - &amp;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j, k ,l)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                            <span class="keywordflow">IF</span> (q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                top =   q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k, l ) - &amp; </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l-1)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                bottom= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l+1) - &amp;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k, l )</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                top =   q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l+2) - &amp; </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l+1)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                bottom= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l+1) - &amp;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k, l )</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        <span class="keywordflow">IF</span> (abs(top) &lt; 1d-8) top = 0d0</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        <span class="keywordflow">IF</span> (abs(bottom) &lt; 1d-8) bottom = 0d0</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                </div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        <span class="keywordflow">IF</span> (top == bottom) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                            slope = 1d0</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="comment">!       ELSEIF((top == 0d0 .AND. bottom /= 0d0) &amp;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <span class="comment">!               .OR.            &amp;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="comment">!           (bottom == 0d0 .AND. top /= 0d0)) THEN</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="comment">!           slope = 0d0</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                            slope = (top*bottom)/(bottom**2d0+1d-16)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        <span class="comment">! Flux limiter function</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 1) <span class="keywordflow">THEN</span> <span class="comment">! MINMOD (MM)</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                            q_sf(j,k,l) = max(0d0,min(1d0,slope))</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 2) <span class="keywordflow">THEN</span> <span class="comment">! MUSCL (MC)</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                            q_sf(j,k,l) = max(0d0,min(2d0*slope,5d-1*(1d0+slope),2d0))</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 3) <span class="keywordflow">THEN</span> <span class="comment">! OSPRE (OP)</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                            q_sf(j,k,l) = (15d-1*(slope**2d0+slope))/(slope**2d0+slope+1d0)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 4) <span class="keywordflow">THEN</span> <span class="comment">! SUPERBEE (SB)</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                            q_sf(j,k,l) = max(0d0,min(1d0,2d0*slope),min(slope,2d0))</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 5) <span class="keywordflow">THEN</span> <span class="comment">! SWEBY (SW) (beta = 1.5)</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                            q_sf(j,k,l) = max(0d0,min(15d-1*slope,1d0),min(slope,15d-1))</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 6) <span class="keywordflow">THEN</span> <span class="comment">! VAN ALBADA (VA)</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                            q_sf(j,k,l) = (slope**2d0+slope)/(slope**2d0+1d0)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 7) <span class="keywordflow">THEN</span> <span class="comment">! VAN LEER (VL)</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                            q_sf(j,k,l) = (abs(slope) + slope)/(1d0 + abs(slope))</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#ac85e77b0312f21389eb166960446f6ec">s_derive_flux_limiter</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a2c43e6d73417e237731fdad2eea07b22">s_derive_curvature</a>(i, q_prim_vf, q_sf) <span class="comment">! --------------------</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    </div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION (-offset_x%beg : m+offset_x%end , &amp;
                                        -offset_y%beg : n+offset_y%end , &amp;
                                        -offset_z%beg : p+offset_z%end)</span>, &amp;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: alpha_unadv_sf</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: A</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: sol, b, AA</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: norm</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: xloc, yloc, zloc</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordtype">INTEGER</span> :: ndim</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l, jj, kk, ll, i1, i2</div><div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a2c43e6d73417e237731fdad2eea07b22">  513</a></span>&#160;            <span class="keywordtype">INTEGER</span> :: stencil_j_min, stencil_j_max</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordtype">INTEGER</span> :: stencil_k_min, stencil_k_max</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordtype">INTEGER</span> :: stencil_l_min, stencil_l_max</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: iz1</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span> <span class="comment">! 3D simulation</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keyword">ALLOCATE</span>(a(10,10))</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keyword">ALLOCATE</span>(sol(10)); <span class="keyword">ALLOCATE</span>(b(10)); <span class="keyword">ALLOCATE</span>(aa(10))</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">ELSE</span> <span class="comment">! 2D simulation</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keyword">ALLOCATE</span>(a(6,6))</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keyword">ALLOCATE</span>(sol(6)); <span class="keyword">ALLOCATE</span>(b(6)); <span class="keyword">ALLOCATE</span>(aa(6))</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">IF</span> ((i == <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keyword">ALLOCATE</span>(alpha_unadv_sf(-<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg : <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end , &amp;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                        -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg : <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end , &amp;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                        -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg : <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end))</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__derived__variables.html#a7fadac6924cf61654373f9f334106001">s_derive_unadvected_volume_fraction</a>(q_prim_vf, alpha_unadv_sf)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                iz1%beg = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg; iz1%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                iz1%beg = -1; iz1%end = 1</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="comment">! Parabolic fitting</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            ndim = <span class="keyword">SIZE</span>(sol,1)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">DO</span> l = iz1%beg+1, iz1%end-1</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end-1</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end-1</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        a(:,:) = 0d0</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        b(:) = 0d0</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        sol(:) = 0d0</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        aa(:) = 0d0</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                        stencil_j_min = j-1; stencil_j_max = j+1</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        stencil_k_min = k-1; stencil_k_max = k+1</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                            stencil_l_min = l-1; stencil_l_max = l+1</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                            stencil_l_min = 0; stencil_l_max = 0</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        <span class="keywordflow">DO</span> ll = stencil_l_min, stencil_l_max</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            <span class="keywordflow">DO</span> kk = stencil_k_min, stencil_k_max</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                <span class="keywordflow">DO</span> jj = stencil_j_min, stencil_j_max</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                    <span class="comment">! Ignore corner points in 3D stencil</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                    <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0).AND.(abs(jj-j)==1).AND.(abs(kk-k)==1).AND.(abs(ll-l)==1)) cycle</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                    <span class="comment">! Find distance between cell centers</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                    xloc = <a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(jj) - <a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(j)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                    yloc = <a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(kk) - <a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                        zloc = <a class="code" href="namespacem__global__parameters.html#a2c4b9e99b981dc55cccf0b153159404e">z_cc</a>(ll) - <a class="code" href="namespacem__global__parameters.html#a2c4b9e99b981dc55cccf0b153159404e">z_cc</a>(l)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                    <span class="comment">! Compute operator</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                    aa(1) = 1d0</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                    aa(2) = xloc</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                    aa(3) = yloc</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                    aa(4) = 5d-1*xloc**2d0</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                    aa(5) = 5d-1*yloc**2d0</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                    aa(6) = xloc*yloc</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                        aa(7) = zloc</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                        aa(8) = 5d-1*zloc**2d0</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                        aa(9) = yloc*zloc</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                        aa(10) = zloc*xloc</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                    <span class="keywordflow">DO</span> i1 = 1, ndim</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                        <span class="keywordflow">DO</span> i2 = 1, ndim</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                            a(i1,i2) = a(i1,i2) + aa(i1)*aa(i2)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                    <span class="comment">! Form RHS vector</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                    <span class="keywordflow">DO</span> i1 = 1, ndim</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                        <span class="keywordflow">IF</span> ((i == <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                            b(i1) = b(i1) + alpha_unadv_sf(jj,kk,ll)*aa(i1)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                            b(i1) = b(i1) + q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(jj,kk,ll)*aa(i1)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__derived__variables.html#a2604318b4c2822441b485a32c755e5b6">s_solve_linear_system</a>(a,b,sol,ndim)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                            norm = sqrt(sol(2)**2d0 + sol(3)**2d0 + sol(7)**2d0)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                            norm = sqrt(sol(2)**2d0 + sol(3)**2d0)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                            q_sf(j,k,l) = -(sol(2)**2d0*sol(5) - 2d0*sol(2)*sol(3)*sol(6) + sol(2)**2d0*sol(8) + &amp;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                            sol(3)**2d0*sol(8) - 2d0*sol(3)*sol(7)*sol(9) + sol(3)**2d0*sol(4) + &amp;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                            sol(7)**2d0*sol(4) - 2d0*sol(7)*sol(2)*sol(10)+ sol(7)**2d0*sol(5)) / &amp;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                            max(norm,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)**3d0</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                            q_sf(j,k,l) = -(sol(2)**2d0*sol(5) - 2d0*sol(2)*sol(3)*sol(6) + sol(3)**2d0*sol(4)) / &amp;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                max(norm,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)**3d0</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keyword">DEALLOCATE</span>(a,sol,b,aa)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">IF</span> ((i == <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keyword">DEALLOCATE</span>(alpha_unadv_sf)</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a2c43e6d73417e237731fdad2eea07b22">s_derive_curvature</a> <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    </div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a2604318b4c2822441b485a32c755e5b6">s_solve_linear_system</a>(A,b,sol,ndim)</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: ndim</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(ndim,ndim)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: A</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(ndim)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: b</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: sol</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(ndim)</span> :: ipiv</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordtype">INTEGER</span> :: nrhs, lda, ldb, info</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordtype">EXTERNAL</span> dgesv</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="comment">! Solve linear system using Intel MKL (Hooke)</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">!               nrhs = 1</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">!               lda = ndim</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">!               ldb = ndim</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">!    </span></div><div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#a2604318b4c2822441b485a32c755e5b6">  658</a></span>&#160;<span class="comment">!               CALL DGESV(ndim, nrhs, A, lda, ipiv, b, ldb, info)</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">!    </span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">!               DO i = 1, ndim</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">!                   sol(i) = b(i)</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">!               END DO</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">!    </span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">!               IF (info /= 0) THEN</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">!                   PRINT &#39;(A)&#39;, &#39;Trouble solving linear system&#39;</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">!                   CALL s_mpi_abort()</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">!               END IF</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="comment">! Solve linear system using own linear solver (Thomson/Darter/Comet/Stampede)</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="comment">! Forward elimination</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keywordflow">DO</span> i = 1, ndim</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    <span class="comment">! Pivoting</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    j = i-1+maxloc(abs(a(i:ndim,i)),1)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    sol = a(i,:)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    a(i,:) = a(j,:)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    a(j,:) = sol</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    sol(1) = b(i)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    b(i) = b(j)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    b(j) = sol(1)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    <span class="comment">! Elimination</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    b(i) = b(i) / a(i,i)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    a(i,:) = a(i,:) / a(i,i)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    <span class="keywordflow">DO</span> k = i+1, ndim</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        b(k) = b(k) - a(k,i)*b(i)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        a(k,:) = a(k,:) - a(k,i)*a(i,:)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="comment">! Backward substitution</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">DO</span> i = ndim, 1, -1</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    sol(i) = b(i)</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="keywordflow">DO</span> k = i+1, ndim</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        sol(i) = sol(i) - a(i,k)*sol(k)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a2604318b4c2822441b485a32c755e5b6">s_solve_linear_system</a> <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#aa038ec37a8a0c8fe8d7185b9ef6d54a9">s_derive_vorticity_component</a>(i, q_prim_vf, q_sf) <span class="comment">! ----------</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordtype">DIMENSION( -offset_x%beg : m+offset_x%end  , &amp;
                       -offset_y%beg : n+offset_y%end  , &amp;
                       -offset_z%beg : p+offset_z%end )</span>, &amp;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l,r</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            </div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="comment">! Computing the vorticity component in the x-coordinate direction</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="namespacem__derived__variables.html#aa038ec37a8a0c8fe8d7185b9ef6d54a9">  728</a></span>&#160;                    <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                            </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                            q_sf(j,k,l) = 0d0</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                            </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                            <span class="keywordflow">DO</span> r = -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>, <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                    q_sf(j,k,l) =                            &amp;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                        q_sf(j,k,l) + 1d0/<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)          * &amp;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                        (    <a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>(r,k) * <a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(r+k)   * &amp;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                        q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end )%sf(j,r+k,l) &amp;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                           - <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(r,l) *               &amp;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                        q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,r+l))</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                    q_sf(j,k,l) =                                  &amp;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                          q_sf(j,k,l) + <a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>(r,k) *          &amp;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                          q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end )%sf( j ,r+k, l ) &amp;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                                                      - <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(r,l) *          &amp;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                          q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf( j , k ,r+l)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                            </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="comment">! Computing the vorticity component in the y-coordinate direction</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">ELSEIF</span>(i == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                        <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                            </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                            q_sf(j,k,l) = 0d0</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                            </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                            <span class="keywordflow">DO</span> r = -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>, <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                    q_sf(j,k,l) =                                  &amp;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                          q_sf(j,k,l) + <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(r,l)/<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k) *  &amp;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                          q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg )%sf( j , k ,r+l) &amp;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                                      - <a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>(r,j) *          &amp;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                          q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end )%sf(r+j, k , l )</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                    q_sf(j,k,l) =                                  &amp;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                          q_sf(j,k,l) + <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(r,l) *          &amp;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                          q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg )%sf( j , k ,r+l) &amp;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                                                      - <a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>(r,j) *          &amp;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                          q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end )%sf(r+j, k , l )</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                            </div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                </div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">! Computing the vorticity component in the z-coordinate direction</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                            </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                            q_sf(j,k,l) = 0d0</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                            </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                            <span class="keywordflow">DO</span> r = -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>, <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                q_sf(j,k,l) = &amp;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                      q_sf(j,k,l) + <a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>(r,j) *          &amp;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                      q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(r+j, k , l ) &amp;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                                  - <a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>(r,k) *          &amp;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                      q_prim_vf( <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg )%sf( j ,r+k, l )</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                            </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#aa038ec37a8a0c8fe8d7185b9ef6d54a9">s_derive_vorticity_component</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        </div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#af816bc88ed55a050bfe8f2ab94d89cba">s_derive_numerical_schlieren_function</a>(q_cons_vf,rho_sf, q_sf)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordtype">DIMENSION( -buff_size     :  m+buff_size       , &amp;
                       -buff_size     :  n+buff_size       , &amp;
                       -buff_size*flg : (p+buff_size)*flg )</span>, &amp;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: rho_sf</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordtype">DIMENSION( -offset_x%beg : m+offset_x%end  , &amp;
                       -offset_y%beg : n+offset_y%end  , &amp;
                       -offset_z%beg : p+offset_z%end )</span>, &amp;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_sf</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: drho_dx, drho_dy, drho_dz</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: gm_rho_max</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: alpha_unadv</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            </div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            </div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="comment">! Computing Gradient Magnitude of Density ==========================</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="comment">! Contributions from the x- and y-coordinate directions</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                        </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        drho_dx = 0d0</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        drho_dy = 0d0</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                        </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                        <span class="keywordflow">DO</span> i = -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>, <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            drho_dx = drho_dx + <a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>(i,j)*rho_sf(i+j,k,l)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                            drho_dy = drho_dy + <a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>(i,k)*rho_sf(j,i+k,l)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                        </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        <a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>(j,k,l) = drho_dx*drho_dx + drho_dy*drho_dy</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="comment">! Contribution from the z-coordinate direction</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                    <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                            </div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                            drho_dz = 0d0</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                            </div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                            <span class="keywordflow">DO</span> i = -<a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a>, <a class="code" href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">fd_number</a></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                    drho_dz = drho_dz + <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(i,l)/<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k) * &amp;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                                        rho_sf(j,k,i+l)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                    drho_dz = drho_dz + <a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>(i,l) * &amp;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                                        rho_sf(j,k,i+l)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                            </div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                            <a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>(j,k,l) = <a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>(j,k,l) &amp;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                             + drho_dz*drho_dz</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                            </div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">! Up until now, only the dot product of the gradient of the density</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="comment">! field has been calculated and stored in the gradient magnitude of</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="comment">! density variable. So now we proceed to take the square-root as to</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="comment">! complete the desired calculation.</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a> = sqrt(<a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            </div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="comment">! Determining the local maximum of the gradient magnitude of density</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="comment">! and bookkeeping the result, along with rank of the local processor</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            gm_rho_max = (/ maxval(<a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>), <span class="keywordtype">REAL(proc_rank, KIND(0d0))</span> /)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            </div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="comment">! Comparing the local maximum gradient magnitude of the density on</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="comment">! this processor to the those computed on the remaining processors.</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="comment">! This allows for the global maximum to be computed and the rank of</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="comment">! the processor on which it has occured to be recorded.</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> &gt; 1) <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#adaa028bb99f844487de8d6e4507e7734">s_mpi_reduce_maxloc</a>(gm_rho_max)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            </div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="comment">! Computing Numerical Schlieren Function ===========================</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="comment">! The form of the numerical Schlieren function depends on the choice</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            <span class="comment">! of the multicomponent flow model. For the gamma/pi_inf model, the</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="comment">! exponential of the negative, normalized, gradient magnitude of the</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="comment">! density is computed. For the volume fraction model, the amplitude</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="comment">! of the exponential&#39;s inside is also modulated with respect to the</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="comment">! identity of the fluid in which the function is evaluated. For more</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="comment">! information, refer to Marquina and Mulet (2003).</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            </div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>                    <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                q_sf = -<a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>/gm_rho_max(1)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keywordflow">ELSE</span>                                        <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                        <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                            </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                            q_sf(j,k,l) = 0d0</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                            </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                q_sf(j,k,l) =                              &amp;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                        q_sf(j,k,l) - <a class="code" href="namespacem__global__parameters.html#ada8a4a23b5804dfa9843b25ddd1cd8c1">schlieren_alpha</a>(i) * &amp;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                        q_cons_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)     * &amp;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                        <a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>(j,k,l) / gm_rho_max(1)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                            </div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                alpha_unadv = 1d0</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                </div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>-1</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                    alpha_unadv = alpha_unadv                  &amp;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                                - q_cons_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                q_sf(j,k,l) = q_sf(j,k,l)                    &amp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                            - <a class="code" href="namespacem__global__parameters.html#ada8a4a23b5804dfa9843b25ddd1cd8c1">schlieren_alpha</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)  * &amp;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                              alpha_unadv*<a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>(j,k,l) / &amp;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                              gm_rho_max(1)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                </div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                            </div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            </div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="comment">! Up until now, only the inside of the exponential of the numerical</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="comment">! Schlieren function has been evaluated and stored. Then, to finish</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <span class="comment">! the computation, the exponential of the inside quantity is taken.</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            q_sf = exp(q_sf)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#af816bc88ed55a050bfe8f2ab94d89cba">s_derive_numerical_schlieren_function</a> <span class="comment">! -----------------</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        </div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        </div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        </div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a735665bf598281689158d9d6e075f3d4">s_finalize_derived_variables_module</a>() <span class="comment">! -------------------</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            </div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <span class="comment">! Deallocating the variable containing the gradient magnitude of the</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="comment">! density field provided that the numerical Schlieren function was</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="comment">! was outputted during the post-process</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">schlieren_wrt</a>) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">gm_rho_sf</a>)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            </div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            </div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="comment">! Deallocating the variables that might have been used to bookkeep</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="comment">! the finite-difference coefficients in the x-, y- and z-directions</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keywordflow">IF</span>(<span class="keyword">ALLOCATED</span>(<a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>)) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">fd_coeff_x</a>)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">IF</span>(<span class="keyword">ALLOCATED</span>(<a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>)) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">fd_coeff_y</a>)</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keywordflow">IF</span>(<span class="keyword">ALLOCATED</span>(<a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>)) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">fd_coeff_z</a>)</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            </div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__derived__variables.html#a735665bf598281689158d9d6e075f3d4">s_finalize_derived_variables_module</a> <span class="comment">! -----------------</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        </div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        </div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        </div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        </div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__derived__variables.html">m_derived_variables</a></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<div class="ttc" id="namespacem__global__parameters_html_a8892cc67c7d04be4d8e6d02a86e209bc"><div class="ttname"><a href="namespacem__global__parameters.html#a8892cc67c7d04be4d8e6d02a86e209bc">m_global_parameters::fd_order</a></div><div class="ttdeci">integer fd_order</div><div class="ttdoc">The order of the finite-difference (fd) approximations of the first-order derivatives that need to be...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a576bd60474fdaccd3ee42edaaabddefa"><div class="ttname"><a href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">m_global_parameters::offset_y</a></div><div class="ttdeci">type(bounds_info) offset_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae8e6c40b6ec73cb126b0cce7496e0057"><div class="ttname"><a href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00135">m_global_parameters.f90:135</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_aab235aa45c622ecf7f387cbf7994387d"><div class="ttname"><a href="namespacem__derived__variables.html#aab235aa45c622ecf7f387cbf7994387d">m_derived_variables::s_derive_specific_heat_ratio</a></div><div class="ttdeci">subroutine, public s_derive_specific_heat_ratio(gamma_sf, q_sf)</div><div class="ttdoc">This subroutine receives as input the specific heat ratio function, gamma_sf, and derives from it the...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00265">m_derived_variables.f90:265</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00169">m_global_parameters.f90:169</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a3cafc9204d5773653e119ce3a3b98722"><div class="ttname"><a href="namespacem__derived__variables.html#a3cafc9204d5773653e119ce3a3b98722">m_derived_variables::fd_coeff_z</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, public fd_coeff_z</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00077">m_derived_variables.f90:77</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad7e05d3d526e5dfa14a74ffda890e63d"><div class="ttname"><a href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">m_global_parameters::y_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable y_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00094">m_global_parameters.f90:94</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">This module contains all of the parameters characterizing the computational domain, simulation algorithm, stiffened equation of state and finally, the formatted database file(s) structure. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00037">m_global_parameters.f90:37</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00051">m_derived_types.f90:51</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ada8a4a23b5804dfa9843b25ddd1cd8c1"><div class="ttname"><a href="namespacem__global__parameters.html#ada8a4a23b5804dfa9843b25ddd1cd8c1">m_global_parameters::schlieren_alpha</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids_max) schlieren_alpha</div><div class="ttdoc">Amplitude coefficients of the numerical Schlieren function that are used to adjust the intensity of n...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00231">m_global_parameters.f90:231</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a735665bf598281689158d9d6e075f3d4"><div class="ttname"><a href="namespacem__derived__variables.html#a735665bf598281689158d9d6e075f3d4">m_derived_variables::s_finalize_derived_variables_module</a></div><div class="ttdeci">subroutine, public s_finalize_derived_variables_module()</div><div class="ttdoc">Deallocation procedures for the module. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l01003">m_derived_variables.f90:1003</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adefe3b78bf286d73a56aef49880dfb0d"><div class="ttname"><a href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00132">m_global_parameters.f90:132</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a102e235b77ff78573a043c5c9b9bb0d8"><div class="ttname"><a href="namespacem__derived__variables.html#a102e235b77ff78573a043c5c9b9bb0d8">m_derived_variables::gm_rho_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable gm_rho_sf</div><div class="ttdoc">Gradient magnitude (gm) of the density for each cell of the computational sub-domain. This variable is employed in the calculation of the numerical Schlieren function. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00065">m_derived_variables.f90:65</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_aa038ec37a8a0c8fe8d7185b9ef6d54a9"><div class="ttname"><a href="namespacem__derived__variables.html#aa038ec37a8a0c8fe8d7185b9ef6d54a9">m_derived_variables::s_derive_vorticity_component</a></div><div class="ttdeci">subroutine, public s_derive_vorticity_component(i, q_prim_vf, q_sf)</div><div class="ttdoc">This subroutine receives as inputs the indicator of the component of the vorticity that should be out...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00728">m_derived_variables.f90:728</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_ab273055cd131e3ce73c1f468b78af7b7"><div class="ttname"><a href="namespacem__derived__variables.html#ab273055cd131e3ce73c1f468b78af7b7">m_derived_variables::fd_coeff_y</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, public fd_coeff_y</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00076">m_derived_variables.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acd86b6cea52b83b147f680d9d6da342c"><div class="ttname"><a href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">m_global_parameters::schlieren_wrt</a></div><div class="ttdeci">logical schlieren_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00221">m_global_parameters.f90:221</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aacf46ffa4ec2f27743a20fb3016f2c82"><div class="ttname"><a href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">m_global_parameters::offset_z</a></div><div class="ttdeci">type(bounds_info) offset_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00070">m_global_parameters.f90:70</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_ac85e77b0312f21389eb166960446f6ec"><div class="ttname"><a href="namespacem__derived__variables.html#ac85e77b0312f21389eb166960446f6ec">m_derived_variables::s_derive_flux_limiter</a></div><div class="ttdeci">subroutine, public s_derive_flux_limiter(i, q_prim_vf, q_sf)</div><div class="ttdoc">This subroutine derives the flux_limiter at cell boundary i+1/2. This is an approximation because the...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00417">m_derived_variables.f90:417</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html"><div class="ttname"><a href="namespacem__derived__variables.html">m_derived_variables</a></div><div class="ttdoc">This module features subroutines that allow for the derivation of numerous flow variables from the co...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00039">m_derived_variables.f90:39</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a2c43e6d73417e237731fdad2eea07b22"><div class="ttname"><a href="namespacem__derived__variables.html#a2c43e6d73417e237731fdad2eea07b22">m_derived_variables::s_derive_curvature</a></div><div class="ttdeci">subroutine, public s_derive_curvature(i, q_prim_vf, q_sf)</div><div class="ttdoc">Computes the local curvatures. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00513">m_derived_variables.f90:513</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of different fluids present in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaf315f1df492ccc9daaeee046f185bb5"><div class="ttname"><a href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">m_global_parameters::x_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00094">m_global_parameters.f90:94</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_acf313542c783139e0798f2097d1f68fc"><div class="ttname"><a href="namespacem__derived__variables.html#acf313542c783139e0798f2097d1f68fc">m_derived_variables::s_compute_finite_difference_coefficients</a></div><div class="ttdeci">subroutine, public s_compute_finite_difference_coefficients(q, offset_s, s_cc, fd_coeff_s)</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00166">m_derived_variables.f90:166</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad138d35528cf27ff42dba00d13c269be"><div class="ttname"><a href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaf0ab8b40d717a67662251516870b1a6"><div class="ttname"><a href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">m_global_parameters::omega_wrt</a></div><div class="ttdeci">logical, dimension(3) omega_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00220">m_global_parameters.f90:220</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_af816bc88ed55a050bfe8f2ab94d89cba"><div class="ttname"><a href="namespacem__derived__variables.html#af816bc88ed55a050bfe8f2ab94d89cba">m_derived_variables::s_derive_numerical_schlieren_function</a></div><div class="ttdeci">subroutine, public s_derive_numerical_schlieren_function(q_cons_vf, rho_sf, q_sf)</div><div class="ttdoc">This subroutine gets as inputs the conservative variables and density. From those inputs...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00840">m_derived_variables.f90:840</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0f2d413d9739928f8e1a98f0a5783ab9"><div class="ttname"><a href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">m_global_parameters::grid_geometry</a></div><div class="ttdeci">integer grid_geometry</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a15a6d70e2bd1c9b7001c753ca1f2ee27"><div class="ttname"><a href="namespacem__derived__variables.html#a15a6d70e2bd1c9b7001c753ca1f2ee27">m_derived_variables::s_initialize_derived_variables_module</a></div><div class="ttdeci">subroutine, public s_initialize_derived_variables_module()</div><div class="ttdoc">Computation of parameters, allocation procedures, and/or any other tasks needed to properly setup the...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00098">m_derived_variables.f90:98</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a19b6ba65c32dfc21f4762eceb25f29"><div class="ttname"><a href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">m_global_parameters::alt_soundspeed</a></div><div class="ttdeci">logical alt_soundspeed</div><div class="ttdoc">Alternate sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00127">m_global_parameters.f90:127</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a2a27e1fa08c6751186a38d562b826955"><div class="ttname"><a href="namespacem__derived__variables.html#a2a27e1fa08c6751186a38d562b826955">m_derived_variables::flg</a></div><div class="ttdeci">integer, private flg</div><div class="ttdoc">Flagging (flg) variable used to annotate the dimensionality of the dataset that is undergoing the pos...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00080">m_derived_variables.f90:80</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00134">m_global_parameters.f90:134</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aafb65952c33f1c363d1040bde29734ea"><div class="ttname"><a href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">m_global_parameters::num_procs</a></div><div class="ttdeci">integer num_procs</div><div class="ttdoc">Number of processors. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00052">m_global_parameters.f90:52</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a7fadac6924cf61654373f9f334106001"><div class="ttname"><a href="namespacem__derived__variables.html#a7fadac6924cf61654373f9f334106001">m_derived_variables::s_derive_unadvected_volume_fraction</a></div><div class="ttdeci">subroutine, public s_derive_unadvected_volume_fraction(q_cons_vf, q_sf)</div><div class="ttdoc">This subroutine is used together with the volume fraction model and when called upon, it computes the values of the unadvected volume fraction from the inputted conservative variables, q_cons_vf. The calculated values are stored in the derived flow quantity storage variable, q_sf. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00223">m_derived_variables.f90:223</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00069">m_global_parameters.f90:69</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a60d7ab72fdab2b005144a5a45aa572de"><div class="ttname"><a href="namespacem__global__parameters.html#a60d7ab72fdab2b005144a5a45aa572de">m_global_parameters::fd_number</a></div><div class="ttdeci">integer fd_number</div><div class="ttdoc">The finite-difference number is given by MAX(1, fd_order/2). Essentially, it is a measure of the half...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00242">m_global_parameters.f90:242</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a4f61d6bef7f53e49a0f5e4a3f9577912"><div class="ttname"><a href="namespacem__derived__variables.html#a4f61d6bef7f53e49a0f5e4a3f9577912">m_derived_variables::fd_coeff_x</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, public fd_coeff_x</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00075">m_derived_variables.f90:75</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a51eb66162227584de46a25cac55b5b6b"><div class="ttname"><a href="namespacem__derived__variables.html#a51eb66162227584de46a25cac55b5b6b">m_derived_variables::s_derive_sound_speed</a></div><div class="ttdeci">subroutine, public s_derive_sound_speed(q_prim_vf, rho_sf, gamma_sf, pi_inf_sf, q_sf)</div><div class="ttdoc">This subroutine admits as inputs the primitive variables, the density, the specific heat ratio functi...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00349">m_derived_variables.f90:349</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acbb163a79ff0011a4327c3fb65a04c14"><div class="ttname"><a href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">m_global_parameters::flux_lim</a></div><div class="ttdeci">integer flux_lim</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00207">m_global_parameters.f90:207</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_adaa028bb99f844487de8d6e4507e7734"><div class="ttname"><a href="namespacem__mpi__proxy.html#adaa028bb99f844487de8d6e4507e7734">m_mpi_proxy::s_mpi_reduce_maxloc</a></div><div class="ttdeci">subroutine s_mpi_reduce_maxloc(var_loc)</div><div class="ttdoc">The following subroutine takes the first element of the 2-element inputted variable and determines it...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01631">m_mpi_proxy.f90:1631</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2c4b9e99b981dc55cccf0b153159404e"><div class="ttname"><a href="namespacem__global__parameters.html#a2c4b9e99b981dc55cccf0b153159404e">m_global_parameters::z_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable z_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00094">m_global_parameters.f90:94</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a2604318b4c2822441b485a32c755e5b6"><div class="ttname"><a href="namespacem__derived__variables.html#a2604318b4c2822441b485a32c755e5b6">m_derived_variables::s_solve_linear_system</a></div><div class="ttdeci">subroutine s_solve_linear_system(A, b, sol, ndim)</div><div class="ttdoc">Computes the solution to the linear system Ax=b w/ sol = x. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00658">m_derived_variables.f90:658</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00122">m_global_parameters.f90:122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5f209d71bd815d863485787639d9684a"><div class="ttname"><a href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">m_global_parameters::offset_x</a></div><div class="ttdeci">type(bounds_info) offset_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type attaching information about the beginning and the end bounds as attributes (beg - beginn...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00063">m_derived_types.f90:63</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">This module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aec97838cc58623019b07ae47da7f4c1c"><div class="ttname"><a href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">m_global_parameters::sgm_eps</a></div><div class="ttdeci">real(kind(0d0)), parameter sgm_eps</div><div class="ttdoc">Segmentation tolerance. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00058">m_global_parameters.f90:58</a></div></div>
<div class="ttc" id="namespacem__derived__variables_html_a02166198be4da04f6b6ce69fd432910d"><div class="ttname"><a href="namespacem__derived__variables.html#a02166198be4da04f6b6ce69fd432910d">m_derived_variables::s_derive_liquid_stiffness</a></div><div class="ttdeci">subroutine, public s_derive_liquid_stiffness(gamma_sf, pi_inf_sf, q_sf)</div><div class="ttdoc">This subroutine admits as inputs the specific heat ratio function and the liquid stiffness function...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__variables_8f90_source.html#l00305">m_derived_variables.f90:305</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3981c7e6886ba3cde245ce4dcc6ca664"><div class="ttname"><a href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">m_global_parameters::mixture_err</a></div><div class="ttdeci">logical mixture_err</div><div class="ttdoc">Mixture error limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f39c77f8ac4f88bc51904794a36f3985.html">post_process_code</a></li><li class="navelem"><a class="el" href="m__derived__variables_8f90.html">m_derived_variables.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
