<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Simulation: m_variables_conversion.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Simulation
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__variables__conversion_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_variables_conversion.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__variables__conversion_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html">   47</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>        !&lt; definitions of the derived types</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>    !&lt; definitions of the global parameters</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>            !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__variables__conversion.html#ac006af9a5403b2fdad7f81ce0a67ecec">s_initialize_variables_conversion_module</a>          , &amp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>                    , &amp;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a>            , &amp;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a>    , &amp;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a>            , &amp;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">s_convert_conservative_to_primitive_variables</a>     , &amp;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#af05a8e081300b76aa2a685d598cb5b92">s_convert_conservative_to_characteristic_variables</a>, &amp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#abede800c9696158470575d8758460360">s_convert_conservative_to_flux_variables</a>          , &amp;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a1dbfde20c4af4e0ad0989f4629889809">s_convert_primitive_to_conservative_variables</a>     , &amp;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a7f62727a697f6be7f205bbc65156d508">s_convert_primitive_to_characteristic_variables</a>   , &amp;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">s_convert_primitive_to_flux_variables</a>             , &amp;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#ac02f08709876d8ef71c8f8db47a4efa3">s_convert_primitive_to_flux_variables_bubbles</a>     , &amp;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a40712fcf8ac2c0e87d0393bbe1a0b800">s_convert_characteristic_to_conservative_variables</a>, &amp;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a49df2e65b245cbc006e27663d69e4399">s_convert_characteristic_to_primitive_variables</a>   , &amp;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">s_compute_lsq_gradient_curvature</a>                  , &amp;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                       <a class="code" href="namespacem__variables__conversion.html#a6a3f90e69ef4dea304495d0f7c068de2">s_finalize_variables_conversion_module</a></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    abstract <span class="keyword">INTERFACE</span> <span class="comment">! =======================================================</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        </div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables.html">   95</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables.html">s_convert_abstract_to_mixture_variables</a>( qK_vf, rho_K,      &amp;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                                            gamma_K, pi_inf_K, &amp;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                            Re_K, We_K, i,j,k  )</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables.html#a8bc488ab9d36a5b761fbe1dc5da4a1ce">   98</a></span>&#160;            </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordtype">IMPORT </span>:: <a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: qK_vf</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho_K, gamma_K, pi_inf_K</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>, <span class="keywordtype">INTENT(OUT)</span> :: Re_K</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION( num_fluids, &amp;
                                        num_fluids  )</span>, <span class="keywordtype">INTENT(OUT)</span> :: We_K</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            </div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables.html">s_convert_abstract_to_mixture_variables</a></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__variables__conversion_1_1s__compute__abstract__average__state.html">s_compute_abstract_average_state</a>(i,j,k)</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="interfacem__variables__conversion_1_1s__compute__abstract__average__state.html">  121</a></span>&#160;            </div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="interfacem__variables__conversion_1_1s__compute__abstract__average__state.html#a95df8743965c65a01070f21d3bb7acee">  122</a></span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__variables__conversion_1_1s__compute__abstract__average__state.html">s_compute_abstract_average_state</a></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">    END INTERFACE </span><span class="comment">! ============================================================</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::    rho_L,    rho_R</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a05df52959cedafb938a98a6afd93274c">  132</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::    <a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a>,    <a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">  133</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::   <a class="code" href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">pres_l</a>,   <a class="code" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">pres_r</a></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">  134</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::      <a class="code" href="namespacem__variables__conversion.html#a7cd906bb65027a37f6e53ed835f74cfc">e_l</a>,      <a class="code" href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">e_r</a></div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">  135</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::      <a class="code" href="namespacem__variables__conversion.html#a7f9d10004d2efcf06092c8e83afd90a9">h_l</a>,      <a class="code" href="namespacem__variables__conversion.html#a00d96d7b614a5c0ce7dbe96d556b0342">h_r</a></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a00d96d7b614a5c0ce7dbe96d556b0342">  136</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::     <a class="code" href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">mf_l</a>,     <a class="code" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">mf_r</a></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">  137</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::  <a class="code" href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">gamma_l</a>,  <a class="code" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">gamma_r</a></div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">  138</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__variables__conversion.html#a6f2d4a77c301f98562a27a23b2983691">pi_inf_l</a>, <a class="code" href="namespacem__variables__conversion.html#ab9f7728bd98c31174efdeaf389d724c5">pi_inf_r</a></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ab9f7728bd98c31174efdeaf389d724c5">  139</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>,              <span class="keywordtype">DIMENSION(2)</span>   ::     <a class="code" href="namespacem__variables__conversion.html#a3b45952794b8a8edb8ec8bc3612edbe3">re_l</a>,     <a class="code" href="namespacem__variables__conversion.html#aea8ad83f5633509287326ea1a428cb89">re_r</a></div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#aea8ad83f5633509287326ea1a428cb89">  140</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> ::     <a class="code" href="namespacem__variables__conversion.html#a87022a7b6fc9b57912e4fca2d38bd0e2">we_l</a>,     <a class="code" href="namespacem__variables__conversion.html#a0b984f6015e127568f82af37a3135ceb">we_r</a></div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a0b984f6015e127568f82af37a3135ceb">  141</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::   <a class="code" href="namespacem__variables__conversion.html#a77bc35ccbac3dbf5e5a01e4e0219d301">alpha_l</a>,   <a class="code" href="namespacem__variables__conversion.html#a5f8751544d985f9e8dba160437f72b12">alpha_r</a></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>   , <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a></div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">  147</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>   , <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>     :: <a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a></div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">  148</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: <a class="code" href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">h_avg</a></div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">  149</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>     :: <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a></div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">  150</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: <a class="code" href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">gamma_avg</a></div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">  151</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>   , <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">  152</a></span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: <a class="code" href="namespacem__variables__conversion.html#ac41b66d567256cb60746f95010a6ea65">alpha_avg</a></div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ac41b66d567256cb60746f95010a6ea65">  154</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: <a class="code" href="namespacem__variables__conversion.html#a45f7e4963c2a7c792bad6a90bbe43c36">pres_avg</a></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables.html">s_convert_abstract_to_mixture_variables</a>), &amp;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">  158</a></span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; null() </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__variables__conversion_1_1s__compute__abstract__average__state.html">s_compute_abstract_average_state</a>), &amp;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">  163</a></span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">s_compute_average_state</a> =&gt; null() </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    </div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;             </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a>( qK_vf, rho_K,      &amp;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                           gamma_K, pi_inf_K, &amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                           Re_K, We_K, i,j,k  )</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">  188</a></span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: qK_vf</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho_K, gamma_K, pi_inf_K</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>, <span class="keywordtype">INTENT(OUT)</span> :: Re_K</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION( num_fluids, &amp;
                                        num_fluids  )</span>, <span class="keywordtype">INTENT(OUT)</span> :: We_K</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">! Performing the transfer of the density, the specific heat ratio</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment">! function as well as the liquid stiffness function, respectively</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            rho_k    = qk_vf(1)%sf(i,j,k)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            gamma_k  = qk_vf(<a class="code" href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">gamma_idx</a>)%sf(i,j,k)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            pi_inf_k = qk_vf(<a class="code" href="namespacem__global__parameters.html#a7db1a23566279bdbc7da68850c596c69">pi_inf_idx</a>)%sf(i,j,k)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;       </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a> ( qK_vf, rho_K,      &amp;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                                           gamma_K, pi_inf_K, &amp;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                           Re_K, We_K, i,j,k  )</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: qK_vf</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">  226</a></span>&#160;            </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho_K, gamma_K, pi_inf_K</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>, <span class="keywordtype">INTENT(OUT)</span> :: Re_K</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION( num_fluids, &amp;
                                        num_fluids  )</span>, <span class="keywordtype">INTENT(OUT)</span> :: We_K</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> :: alpha_rho_K, alpha_K</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            </div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordtype">INTEGER</span> :: l</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">! Constraining the partial densities and the volume fractions within</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">! their physical bounds to make sure that any mixture variables that</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">! are derived from them result within the limits that are set by the</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="comment">! fluids physical parameters that make up the mixture</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">! alpha_rho_K(1) = qK_vf(i)%sf(i,j,k)</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="comment">! alpha_K(1)     = qK_vf(E_idx+i)%sf(i,j,k)</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">! Performing the transfer of the density, the specific heat ratio</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">! function as well as the liquid stiffness function, respectively       </span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                rho_k    = qk_vf(1)%sf(i,j,k)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                gamma_k  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma <span class="comment">!qK_vf(gamma_idx)%sf(i,j,k)</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                pi_inf_k = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf <span class="comment">!qK_vf(pi_inf_idx)%sf(i,j,k)</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                rho_k = 0d0; gamma_k = 0d0; pi_inf_k = 0d0</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 2)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                        rho_k    = rho_k    + qk_vf(l)%sf(i,j,k) </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        gamma_k  = gamma_k  + qk_vf(l+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(l)%gamma</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        pi_inf_k = pi_inf_k + qk_vf(l+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(l)%pi_inf</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    rho_k    = qk_vf(1)%sf(i,j,k)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    gamma_k  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    pi_inf_k = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>-1 <span class="comment">!leave out bubble part of mixture</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        rho_k    = rho_k    + qk_vf(l)%sf(i,j,k) </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                        gamma_k  = gamma_k  + qk_vf(l+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(l)%gamma</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                        pi_inf_k = pi_inf_k + qk_vf(l+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(i,j,k)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(l)%pi_inf</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    <span class="comment">!rho_K    = qK_vf(1)%sf(i,j,k)</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    <span class="comment">!gamma_K  = fluid_pp(1)%gamma</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="comment">!pi_inf_K = fluid_pp(1)%pi_inf</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    rho_k    = qk_vf(1)%sf(i,j,k)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    gamma_k  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    pi_inf_k = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        </div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a>( qK_vf, rho_K,      &amp;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                                           gamma_K, pi_inf_K, &amp;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                           Re_K, We_K, k,l,r  )</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: qK_vf</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">  306</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho_K, gamma_K, pi_inf_K</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>, <span class="keywordtype">INTENT(OUT)</span> :: Re_K</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            </div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="comment">! Weber numbers</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION( num_fluids, &amp;
                                        num_fluids  )</span>, <span class="keywordtype">INTENT(OUT)</span> :: We_K</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> :: alpha_rho_K, alpha_K</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: k,l,r</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">! Constraining the partial densities and the volume fractions within</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">! their physical bounds to make sure that any mixture variables that</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="comment">! are derived from them result within the limits that are set by the</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="comment">! fluids physical parameters that make up the mixture</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                alpha_rho_k(i) = qk_vf(i)%sf(k,l,r)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                alpha_k(i)     = qk_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(k,l,r)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;               </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    alpha_rho_k(i) = max(0d0,alpha_rho_k(i))</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    alpha_k(i)     = min(max(0d0,alpha_k(i)),1d0)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;               </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                alpha_k = alpha_k/max(sum(alpha_k),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;               </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordflow">            END IF</span>            </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="comment">! Calculating the density, the specific heat ratio function and the</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="comment">! liquid stiffness function, respectively, from the species analogs</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            rho_k = 0d0; gamma_k = 0d0; pi_inf_k = 0d0</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                rho_k    = rho_k    + alpha_rho_k(i)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                gamma_k  = gamma_k  + alpha_k(i)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                pi_inf_k = pi_inf_k + alpha_k(i)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            </div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">! Computing the shear and bulk Reynolds numbers from species analogs</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;               </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                re_k(i) = <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i) &gt; 0) re_k(i) = 0d0</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;               </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    re_k(i) = alpha_k(<a class="code" href="namespacem__global__parameters.html#a33b4272ac0c75aff15851f9dfa6a9d14">re_idx</a>(i,j))/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a33b4272ac0c75aff15851f9dfa6a9d14">re_idx</a>(i,j))%Re(i) &amp;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                              + re_k(i)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;               </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                re_k(i) = 1d0/max(re_k(i),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">! Computing the Weber numbers from species analogs</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                we_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) = ( alpha_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) + &amp;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                                  alpha_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) ) &amp;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                             / (                  alpha_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                 <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%We(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) + &amp;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                  alpha_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                 <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%We(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) + &amp;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                               <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>   )</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                we_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) = <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        </div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a4cf9b21c0dfd924ac807585579240486">s_compute_roe_average_state</a>(j,k,l) <span class="comment">! ------------------------</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            </div><div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a4cf9b21c0dfd924ac807585579240486">  397</a></span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j,k,l) = sqrt(rho_l*rho_r)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            </div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a> = (sqrt(rho_l)*<a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a> + sqrt(rho_r)*<a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>) / &amp;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                      (sqrt(rho_l) + sqrt(rho_r))</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">h_avg</a> = (sqrt(rho_l)*<a class="code" href="namespacem__variables__conversion.html#a7f9d10004d2efcf06092c8e83afd90a9">h_l</a> + sqrt(rho_r)*<a class="code" href="namespacem__variables__conversion.html#a00d96d7b614a5c0ce7dbe96d556b0342">h_r</a>) / &amp;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    (sqrt(rho_l) + sqrt(rho_r))</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(i)%sf(j,k,l) = ( sqrt(rho_l)*<a class="code" href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">mf_l</a>(i)   &amp;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                         + sqrt(rho_r)*<a class="code" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">mf_r</a>(i) ) &amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                       / ( sqrt(rho_l) &amp;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                         + sqrt(rho_r) )</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            </div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">gamma_avg</a> = (sqrt(rho_l)*<a class="code" href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">gamma_l</a> + sqrt(rho_r)*<a class="code" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">gamma_r</a>) / &amp;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        (sqrt(rho_l) + sqrt(rho_r))</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j,k,l) = sqrt((<a class="code" href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a>**2d0))/<a class="code" href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">gamma_avg</a>)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a4cf9b21c0dfd924ac807585579240486">s_compute_roe_average_state</a> <span class="comment">! ---------------------------</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        </div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a825db8aee0af3c120a7ca1f8de814490">s_compute_arithmetic_average_state</a>(j,k,l) <span class="comment">! -----------------</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;         </div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            </div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a825db8aee0af3c120a7ca1f8de814490">  433</a></span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j,k,l) = 5d-1*(rho_l + rho_r)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a> = 5d-1*(<a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a> + <a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            </div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(i)%sf(j,k,l) = 5d-1*(<a class="code" href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">mf_l</a>(i) + <a class="code" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">mf_r</a>(i))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">h_avg</a> = 5d-1*(<a class="code" href="namespacem__variables__conversion.html#a7f9d10004d2efcf06092c8e83afd90a9">h_l</a> + <a class="code" href="namespacem__variables__conversion.html#a00d96d7b614a5c0ce7dbe96d556b0342">h_r</a>)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">gamma_avg</a> = 5d-1*(<a class="code" href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">gamma_l</a> + <a class="code" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">gamma_r</a>)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#ac41b66d567256cb60746f95010a6ea65">alpha_avg</a> = 5d-1*(<a class="code" href="namespacem__variables__conversion.html#a77bc35ccbac3dbf5e5a01e4e0219d301">alpha_l</a> + <a class="code" href="namespacem__variables__conversion.html#a5f8751544d985f9e8dba160437f72b12">alpha_r</a>)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a45f7e4963c2a7c792bad6a90bbe43c36">pres_avg</a> = 5d-1*(<a class="code" href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">pres_l</a> + <a class="code" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">pres_r</a>)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j,k,l) = sqrt((<a class="code" href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a>**2d0))/<a class="code" href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">gamma_avg</a>)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="comment">! For Tait EOS</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j,k,l) = sqrt(                         &amp;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                            (1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma+1d0) *       &amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                            (<a class="code" href="namespacem__variables__conversion.html#a45f7e4963c2a7c792bad6a90bbe43c36">pres_avg</a> + <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf) /   &amp;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                            (<a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j,k,l)*(1d0-<a class="code" href="namespacem__variables__conversion.html#ac41b66d567256cb60746f95010a6ea65">alpha_avg</a>))   &amp;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                            )</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            </div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a825db8aee0af3c120a7ca1f8de814490">s_compute_arithmetic_average_state</a> <span class="comment">! --------------------</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        </div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ac006af9a5403b2fdad7f81ce0a67ecec">s_initialize_variables_conversion_module</a>() <span class="comment">! ----------------</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="comment">! Associating the procedural pointer to the appropriate subroutine</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="comment">! that will be utilized in the conversion to the mixture variables</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! gamma/pi_inf model</span></div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ac006af9a5403b2fdad7f81ce0a67ecec">  469</a></span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span>           <span class="comment">! Volume fraction for bubbles</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment">! Allocating velocities, mass fractions and Weber numbers as well</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="comment">! as associating the procedural pointer to the correct subroutine</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="comment">! utilized in the computation of the average state</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab62b8c589dcddff0e6295f4956012c7a">char_decomp</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keyword">ALLOCATE</span>(  <a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>),      <a class="code" href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">mf_l</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end))</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <span class="keyword">ALLOCATE</span>(  <a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>),      <a class="code" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">mf_r</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end))</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>), <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end))</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a87022a7b6fc9b57912e4fca2d38bd0e2">we_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a0b984f6015e127568f82af37a3135ceb">we_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a1a3314b39e21e17d7e72a9837db2ab42">avg_state</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    <a class="code" href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">s_compute_average_state</a> =&gt; <a class="code" href="namespacem__variables__conversion.html#a4cf9b21c0dfd924ac807585579240486">s_compute_roe_average_state</a></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <a class="code" href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">s_compute_average_state</a> =&gt; <a class="code" href="namespacem__variables__conversion.html#a825db8aee0af3c120a7ca1f8de814490">s_compute_arithmetic_average_state</a></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            </div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ac006af9a5403b2fdad7f81ce0a67ecec">s_initialize_variables_conversion_module</a> <span class="comment">! --------------</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">s_convert_conservative_to_primitive_variables</a>(  qK_cons_vf, &amp;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                                                   qK_prim_vf, &amp;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                                                 gm_alphaK_vf, &amp;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                                                     ix,iy,iz  )</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qK_cons_vf</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">  521</a></span>&#160;            </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qK_prim_vf</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            </div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: gm_alphaK_vf</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="comment">! Density, dynamic pressure, surface energy, specific heat ratio</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">! function, liquid stiffness function, shear and volume Reynolds</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="comment">! numbers and the Weber numbers</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::      rho_K</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: dyn_pres_K</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::     E_We_K</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::    gamma_K</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::   pi_inf_K</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::       nbub</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>                     ::       Re_K</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,num_fluids)</span> ::       We_K</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(nb)</span> :: nRtmp</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;       </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">! Calculating the velocity and pressure from the momentum and energy</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    </div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        dyn_pres_k = 0d0; e_we_k = 0d0</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                     </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( qk_cons_vf, rho_k, &amp;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                                 gamma_k, pi_inf_k, &amp;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                                 re_k, we_k, j,k,l  )</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            <span class="comment">!no mixture variables if single bubble mixture</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            <span class="comment">!compute velocity</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                <span class="comment">! u = \rho_k u / \rho_k &lt;--- Mixture densities</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                qk_prim_vf(i)%sf(j,k,l) = qk_cons_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                       / max(rho_k,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                dyn_pres_k = dyn_pres_k + 5d-1*qk_cons_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                                          *qk_prim_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="comment">!model_eqns == 4. </span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                <span class="comment">!u = \rho u / \rho</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                <span class="comment">!don&#39;t need mixture density here since it&#39;s the same</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                qk_prim_vf(i)%sf(j,k,l) = qk_cons_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                       / qk_cons_vf(1)%sf(j,k,l)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. (<a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a> .OR. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                             <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                e_we_k = e_we_k &amp;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                       + qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(j,k,l) * &amp;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                             gm_alphak_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                                   we_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))   &amp;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                       + qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                             gm_alphak_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(j,k,l) / &amp;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                                   we_k(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordflow">                             END DO</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        <span class="comment">! compute pressure</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                            <span class="comment">! p = ( E - 0.5 rho u u - pi_inf_k )/gamma_k</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                            qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                ( qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) &amp;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                                - dyn_pres_k &amp;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                                - pi_inf_k &amp;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                                - e_we_k ) / gamma_k</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> == 1) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                            <span class="comment">! p_l = ( E/(1-alf) - 0.5 rho u u/(1-alf) - pi_inf_k )/gamma_k</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                            qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                ( (qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) &amp;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                - dyn_pres_k) / (1.d0 - qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)) &amp;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                                - pi_inf_k &amp;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                                - e_we_k ) / gamma_k</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                            <span class="comment">! p = ( E/(1-alf) - 0.5 rho u u/(1-alf) - pi_inf_k )/gamma_k</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                            qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                ( (qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) &amp;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                                - dyn_pres_k) / (1.d0 - qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)) &amp;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                                - pi_inf_k &amp;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                                - e_we_k ) / gamma_k</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                            <span class="comment">! Tait EOS</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            <span class="comment">! p_l = (pl0 + pi_infty)(rho/(rho_l0(1-alf)))^gamma - pi_infty  </span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) =                       &amp; </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                   (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf) *                  &amp;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                   ((                                            &amp; </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                   qk_cons_vf(1)%sf(j,k,l)/                     &amp;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                   (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.d0-qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+1)%sf(j,k,l)))   &amp; </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                   ) ** (1.d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1.d0)) - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        <span class="comment">! \phi = (n\phi)/n  (n = nbub)</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                            <span class="comment">! n = sqrt( 4pi/(3 alpha) * (nR)**3 )</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                            <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                nrtmp(i) = qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l)</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                <span class="comment">!IF (nRtmp(i) &lt; 0.d0) nRtmp(i) = 1.d-12 !stop &#39;nR &lt; 0&#39;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( qk_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l), nrtmp, nbub)                            </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                           </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                            <span class="keywordflow">IF</span> ( nbub &lt; 0.d0) stop <span class="stringliteral">&#39;nbub is negative&#39;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                qk_prim_vf(i)%sf(j,k,l) = qk_cons_vf(i)%sf(j,k,l)/nbub</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        </div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">s_convert_conservative_to_primitive_variables</a> <span class="comment">! ---------</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#af05a8e081300b76aa2a685d598cb5b92">s_convert_conservative_to_characteristic_variables</a>( &amp; ! -----</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                   q_rs_wsK, norm_dir, is1,is2,is3, dj )</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>),                &amp;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordtype">DIMENSION(-weno_polyn:weno_polyn)</span>, &amp;</div><div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#af05a8e081300b76aa2a685d598cb5b92">  664</a></span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_rs_wsK</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: is1,is2,is3</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dj</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            </div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="comment">! Initializing projection matrices for characteristic decomposition</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">IF</span>(dj == -1) <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a3ca1b002fc78b7faad2f8638e4a42f9a">s_initialize_characteristic_decomposition</a>( &amp;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                               q_rs_wsk, &amp;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                                               norm_dir, &amp;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                                            is1,is2,is3  )</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">! Projecting conservative variables onto the characteristic fields</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">DO</span> i = -<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>, <a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordflow">DO</span> l = is3%beg, is3%end</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <span class="keywordflow">DO</span> k = is2%beg, is2%end</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        <span class="keywordflow">DO</span> j = is1%beg, is1%end</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                        </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Conversion from conservative to &#39;</span> // &amp;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                             <span class="stringliteral">&#39;characteristic variables not &#39;</span>    // &amp;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                             <span class="stringliteral">&#39;implemented. Exiting ...&#39;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#af05a8e081300b76aa2a685d598cb5b92">s_convert_conservative_to_characteristic_variables</a> <span class="comment">! ----</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#abede800c9696158470575d8758460360">s_convert_conservative_to_flux_variables</a>( qK_cons_vf, &amp; ! ---</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                                                  FK_vf, &amp;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                                              FK_src_vf, &amp;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                                               ix,iy,iz  )</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: qK_cons_vf</div><div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#abede800c9696158470575d8758460360">  720</a></span>&#160;            </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: FK_vf, FK_src_vf</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="comment">! Calculating the flux variables from the conservative ones, without</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="comment">! accounting for the contribution of either viscosity or capillarity</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                     </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                            print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Conversion from conservative to &#39;</span> // &amp;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                         <span class="stringliteral">&#39;flux variables not implemented. &#39;</span> // &amp;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                         <span class="stringliteral">&#39;Exiting ...&#39;</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                     </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            </div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#abede800c9696158470575d8758460360">s_convert_conservative_to_flux_variables</a> <span class="comment">! --------------</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        </div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a1dbfde20c4af4e0ad0989f4629889809">s_convert_primitive_to_conservative_variables</a>(  qK_prim_vf, &amp;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                                                   qK_cons_vf, &amp;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                                                 gm_alphaK_vf, &amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                                                     ix,iy,iz  )</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: qK_prim_vf</div><div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a1dbfde20c4af4e0ad0989f4629889809">  769</a></span>&#160;            </div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qK_cons_vf</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            </div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: gm_alphaK_vf</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            </div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">! Calculating the momentum and energy from the velocity and pressure</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                     </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                            print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Conversion from primitive to &#39;</span> // &amp;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                         <span class="stringliteral">&#39;conservative variables not &#39;</span>   // &amp;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                         <span class="stringliteral">&#39;implemented. Exiting ...&#39;</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                     </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a1dbfde20c4af4e0ad0989f4629889809">s_convert_primitive_to_conservative_variables</a> <span class="comment">! ---------</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a7f62727a697f6be7f205bbc65156d508">s_convert_primitive_to_characteristic_variables</a>( &amp; ! --------</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                q_rs_wsK, norm_dir, is1,is2,is3, dj )</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>),                &amp;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keywordtype">DIMENSION(-weno_polyn:weno_polyn)</span>, &amp;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_rs_wsK</div><div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a7f62727a697f6be7f205bbc65156d508">  818</a></span>&#160;            </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: is1,is2,is3</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            </div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dj</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(cont_idx%end)</span> :: alpha_rho</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span>     :: vel</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                          :: pres</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">! Initializing projection matrices for characteristic decomposition</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">IF</span>(dj == -1) <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a3ca1b002fc78b7faad2f8638e4a42f9a">s_initialize_characteristic_decomposition</a>( &amp;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                                               q_rs_wsk, &amp;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                                               norm_dir, &amp;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                                                            is1,is2,is3  )</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            </div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="comment">! I think it does this in place. take in primitive vars, set alpha rho, v, p, etc.</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="comment">! then compute the characteristic variables</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="comment">!I think the speed of sound computation needs to be modified for Tait EOS here</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="comment">! Projecting the primitive variables onto the characteristic fields</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">DO</span> r = -<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>, <a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                <span class="keywordflow">DO</span> l = is3%beg, is3%end</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    <span class="keywordflow">DO</span> k = is2%beg, is2%end</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        <span class="keywordflow">DO</span> j = is1%beg, is1%end</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        </div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                alpha_rho(i) = q_rs_wsk(r)%vf(i)%sf(j,k,l)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                vel(i)= q_rs_wsk(r)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        </div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                            pres = q_rs_wsk(r)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                        </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                q_rs_wsk(r)%vf(i)%sf(j,k,l) = alpha_rho(i) &amp;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                        - pres * <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(i)%sf(j+dj,k,l) &amp;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                               /        <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j+dj,k,l) &amp;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                               /        <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j+dj,k,l)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                        </div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                q_rs_wsk(r)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                                           vel(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) &amp;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                             - pres *  <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) &amp;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                                    / <a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j+dj,k,l) &amp;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                                    /   <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j+dj,k,l)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                            q_rs_wsk(r)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = vel(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                                + pres / <a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j+dj,k,l) &amp;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                                       /   <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j+dj,k,l)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                        </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            </div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a7f62727a697f6be7f205bbc65156d508">s_convert_primitive_to_characteristic_variables</a> <span class="comment">! -------</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        </div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">s_convert_primitive_to_flux_variables</a>( qK_prim_vf, &amp; ! ------</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                                               FK_vf, &amp;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                                           FK_src_vf, &amp;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                                            ix,iy,iz  )</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;           </div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: qK_prim_vf</div><div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">  903</a></span>&#160;            </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: FK_vf, FK_src_vf</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            </div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="comment">! Partial densities, density, velocity, pressure, energy, advection</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="comment">! variables, the specific heat ratio and liquid stiffness functions,</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="comment">! the shear and volume Reynolds numbers and the Weber numbers</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(cont_idx%end)</span>          :: alpha_rho_K</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::       rho_K</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span>              ::       vel_K</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::      pres_K</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::         E_K</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(adv_idx%end-E_idx)</span>     ::       adv_K</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::     gamma_K</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::    pi_inf_K</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>                     ::        Re_K</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,num_fluids)</span> ::        We_K</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            </div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="comment">! Computing the flux variables from the primitive variables, without</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="comment">! accounting for the contribution of either viscosity or capillarity</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                     </div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                            alpha_rho_k(i) = qk_prim_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                     </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                            vel_k(i) = qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                     </div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        pres_k = qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                     </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( qk_prim_vf, rho_k, &amp;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                                             gamma_k, pi_inf_k, &amp;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                                             re_k, we_k, j,k,l  )</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                        <span class="comment">! Computing the energy from the pressure</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        e_k = gamma_k*pres_k + pi_inf_k &amp;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                 + 5d-1*rho_k*sum(vel_k**2d0)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                   </div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                            adv_k(i) = qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j,k,l)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                     </div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        <span class="comment">! mass flux, this should be \alpha_i \rho_i u_i </span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                            fk_vf(i)%sf(j,k,l) = alpha_rho_k(i)*vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                     </div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                            fk_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                               rho_k*vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                                    *vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) &amp;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                          + pres_k*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        <span class="comment">! energy flux, u(E+p)</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                        fk_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(e_k + pres_k)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                     </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                        <span class="comment">! have been using == 2 </span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                                fk_vf(i)%sf(j,k,l) = 0d0</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                fk_src_vf(i)%sf(j,k,l) = adv_k(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        </div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                fk_vf(i)%sf(j,k,l) = vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*adv_k(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                            fk_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l) = vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">s_convert_primitive_to_flux_variables</a> <span class="comment">! -----------------</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        </div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ac02f08709876d8ef71c8f8db47a4efa3">s_convert_primitive_to_flux_variables_bubbles</a>( qK_prim_vf, &amp; ! ------</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                                                qk_cons_vf, &amp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                                                FK_vf, &amp;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                                                FK_src_vf, &amp;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                                                ix,iy,iz  )</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            </div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: qK_prim_vf, qK_cons_vf</div><div class="line"><a name="l01011"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ac02f08709876d8ef71c8f8db47a4efa3"> 1011</a></span>&#160;            </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: FK_vf, FK_src_vf</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            </div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="comment">! Partial densities, density, velocity, pressure, energy, advection</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="comment">! variables, the specific heat ratio and liquid stiffness functions,</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="comment">! the shear and volume Reynolds numbers and the Weber numbers</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(cont_idx%end)</span>          :: alpha_rho_K</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::       rho_K</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span>              ::       vel_K</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::      pres_K</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::         E_K</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(adv_idx%end-E_idx)</span>     ::       adv_K</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::     gamma_K</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::    pi_inf_K</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>                     ::        Re_K</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,num_fluids)</span> ::        We_K</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/1,2,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/1d0,0d0,0d0/)</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="comment">! Computing the flux variables from the primitive variables, without</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="comment">! accounting for the contribution of either viscosity or capillarity</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                     </div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                            alpha_rho_k(i) = qk_prim_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                     </div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                            vel_k(i) = qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                     </div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        pres_k = qk_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                     </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( qk_prim_vf, rho_k, &amp;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                                                             gamma_k, pi_inf_k, &amp;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                                             re_k, we_k, j,k,l  )</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        </div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        <span class="comment">! mass flux, \rho u</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                            fk_vf(i)%sf(j,k,l) = alpha_rho_k(i)*vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                     </div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        <span class="comment">! momentum flux, \rho u u + p I</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                            fk_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                               rho_k*vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                                    *vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) &amp;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                          + pres_k*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                    </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                        <span class="comment">! energy flux, 0</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        fk_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = 0. </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                        <span class="comment">! vol. frac, nR, and nRdot fluxes, u{\alpha, nR, nRdot}</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                            fk_vf(i)%sf(j,k,l) = vel_k(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*qk_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;           </div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="comment">!stop</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            </div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ac02f08709876d8ef71c8f8db47a4efa3">s_convert_primitive_to_flux_variables_bubbles</a> <span class="comment">! -----------------        </span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;       </div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a40712fcf8ac2c0e87d0393bbe1a0b800">s_convert_characteristic_to_conservative_variables</a>( &amp; ! -----</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                             qK_rs_vf, is1,is2,is3, dj )</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            </div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: qK_rs_vf</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: is1,is2,is3</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dj</div><div class="line"><a name="l01099"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a40712fcf8ac2c0e87d0393bbe1a0b800"> 1099</a></span>&#160;            </div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            </div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="comment">! Projecting characteristic variables onto the conservative fields</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <span class="keywordflow">DO</span> l = is3%beg, is3%end</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <span class="keywordflow">DO</span> k = is2%beg, is2%end</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                    <span class="keywordflow">DO</span> j = is1%beg, is1%end</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                     </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                            print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Conversion from characteristic to &#39;</span> // &amp;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                         <span class="stringliteral">&#39;conservative variables not &#39;</span>        // &amp;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                         <span class="stringliteral">&#39;implemented. Exiting ...&#39;</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                     </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            </div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            </div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="comment">! Finalizing projection matrices for characteristic decomposition</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordflow">IF</span>(dj == 0) <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a81e6ad74f0a2bd1b27a7873dbd797a60">s_finalize_characteristic_decomposition</a>()</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            </div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            </div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a40712fcf8ac2c0e87d0393bbe1a0b800">s_convert_characteristic_to_conservative_variables</a> <span class="comment">! ----</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        </div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        </div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a49df2e65b245cbc006e27663d69e4399">s_convert_characteristic_to_primitive_variables</a>( &amp; ! --------</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                          qK_rs_vf, is1,is2,is3, dj )</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            </div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: qK_rs_vf</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: is1,is2,is3</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dj</div><div class="line"><a name="l01140"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a49df2e65b245cbc006e27663d69e4399"> 1140</a></span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(E_idx)</span> :: w_K</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            </div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            </div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="comment">! Projecting characteristic variables onto the primitive fields</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">DO</span> l = is3%beg, is3%end</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                <span class="keywordflow">DO</span> k = is2%beg, is2%end</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    <span class="keywordflow">DO</span> j = is1%beg, is1%end</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    </div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                            w_k(i) = qk_rs_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                    </div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                            qk_rs_vf(i)%sf(j,k,l) = w_k(i) + <a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j+dj,k,l) * &amp;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                                        <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(i)%sf(j+dj,k,l) / &amp;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                                               <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j+dj,k,l) * &amp;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                                          5d-1*( w_k(   <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>   )   &amp;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                                             - w_k(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg) )</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                    </div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                            qk_rs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                                ( w_k(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)     &amp;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                                + w_k(     <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>    ) *   &amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                                  <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) ) / &amp;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                          ( 1d0 + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) )</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    </div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                        qk_rs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = 5d-1*<a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>(j+dj,k,l) * &amp;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                                           <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>(j+dj,k,l) * &amp;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                                           ( w_k(   <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>   )   &amp;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                                           - w_k(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg) )</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            </div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <span class="comment">! Finalizing projection matrices for characteristic decomposition</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordflow">IF</span>(dj == 0) <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a81e6ad74f0a2bd1b27a7873dbd797a60">s_finalize_characteristic_decomposition</a>()</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            </div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a49df2e65b245cbc006e27663d69e4399">s_convert_characteristic_to_primitive_variables</a> <span class="comment">! -------</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a3ca1b002fc78b7faad2f8638e4a42f9a">s_initialize_characteristic_decomposition</a>( &amp; ! --------------</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                              q_rs_wsK, norm_dir, is1,is2,is3 )</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>),                &amp;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="keywordtype">DIMENSION(-weno_polyn:weno_polyn)</span>, &amp;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_rs_wsK</div><div class="line"><a name="l01203"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a3ca1b002fc78b7faad2f8638e4a42f9a"> 1203</a></span>&#160;            </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            </div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: is1,is2,is3</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            </div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            <span class="comment">! Configuring the coordinate direction indexes and flags</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/1,2,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/1d0,0d0,0d0/)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/2,1,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/0d0,1d0,0d0/)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/3,1,2/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/0d0,0d0,1d0/)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            </div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            </div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="comment">! Allocating the average density, speed of sound and mass fractions</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>( is1%beg-1 : is1%end, &amp;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                 is2%beg   : is2%end, &amp;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                 is3%beg   : is3%end ))</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            <span class="keyword">ALLOCATE</span>(  <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>( is1%beg-1 : is1%end, &amp;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                 is2%beg   : is2%end, &amp;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                 is3%beg   : is3%end ))</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            </div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(i)%sf( is1%beg-1 : is1%end, &amp;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                          is2%beg   : is2%end, &amp;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                          is3%beg   : is3%end ))</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            </div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <span class="comment">! Performing evaluation of projection matrices at cell-boundaries</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordflow">DO</span> r = -1,0</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                <span class="keywordflow">DO</span> l = is3%beg, is3%end</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                    <span class="keywordflow">DO</span> k = is2%beg, is2%end</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                        <span class="keywordflow">DO</span> j = is1%beg, is1%beg + (r+1)*(is1%end - is1%beg)</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_rs_wsk( r )%vf, &amp;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                                                   rho_l, <a class="code" href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">gamma_l</a>, &amp;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                                                   <a class="code" href="namespacem__variables__conversion.html#a6f2d4a77c301f98562a27a23b2983691">pi_inf_l</a>, <a class="code" href="namespacem__variables__conversion.html#a3b45952794b8a8edb8ec8bc3612edbe3">re_l</a>, &amp;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                                                      <a class="code" href="namespacem__variables__conversion.html#a87022a7b6fc9b57912e4fca2d38bd0e2">we_l</a>, j,k,l  )</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_rs_wsk(r+1)%vf, &amp;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                                                                   rho_r, <a class="code" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">gamma_r</a>, &amp;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                                                   <a class="code" href="namespacem__variables__conversion.html#ab9f7728bd98c31174efdeaf389d724c5">pi_inf_r</a>, <a class="code" href="namespacem__variables__conversion.html#aea8ad83f5633509287326ea1a428cb89">re_r</a>, &amp;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                                                      <a class="code" href="namespacem__variables__conversion.html#a0b984f6015e127568f82af37a3135ceb">we_r</a>, j,k,l  )</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                            </div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a>(i) = q_rs_wsk( r )%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>(i) = q_rs_wsk(r+1)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                            <span class="comment">! alpha_L/R for mixture SOS computation</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#a77bc35ccbac3dbf5e5a01e4e0219d301">alpha_l</a> = q_rs_wsk(r)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+1)%sf(j,k,l)</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#a5f8751544d985f9e8dba160437f72b12">alpha_r</a> = q_rs_wsk(r+1)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+1)%sf(j,k,l)</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                               </div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a7cd906bb65027a37f6e53ed835f74cfc">e_l</a> = q_rs_wsk( r )%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">e_r</a> = q_rs_wsk(r+1)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                               </div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">pres_l</a> = - ( 5d-1*rho_l*sum(<a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a>**2d0) &amp;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                           + <a class="code" href="namespacem__variables__conversion.html#a6f2d4a77c301f98562a27a23b2983691">pi_inf_l</a> - <a class="code" href="namespacem__variables__conversion.html#a7cd906bb65027a37f6e53ed835f74cfc">e_l</a> ) / <a class="code" href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">gamma_l</a></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">pres_r</a> = - ( 5d-1*rho_r*sum(<a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>**2d0) &amp;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                                           + <a class="code" href="namespacem__variables__conversion.html#ab9f7728bd98c31174efdeaf389d724c5">pi_inf_r</a> - <a class="code" href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">e_r</a> ) / <a class="code" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">gamma_r</a></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                               </div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                               </div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">pres_l</a> = q_rs_wsk( r )%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">pres_r</a> = q_rs_wsk(r+1)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                               </div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a7cd906bb65027a37f6e53ed835f74cfc">e_l</a> = <a class="code" href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">gamma_l</a>*<a class="code" href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">pres_l</a> + <a class="code" href="namespacem__variables__conversion.html#a6f2d4a77c301f98562a27a23b2983691">pi_inf_l</a> &amp;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                    + 5d-1*rho_l*sum(<a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a>**2d0)</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">e_r</a> = <a class="code" href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">gamma_r</a>*<a class="code" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">pres_r</a> + <a class="code" href="namespacem__variables__conversion.html#ab9f7728bd98c31174efdeaf389d724c5">pi_inf_r</a> &amp;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                    + 5d-1*rho_r*sum(<a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>**2d0)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                               </div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                        </div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#a7f9d10004d2efcf06092c8e83afd90a9">h_l</a> = (<a class="code" href="namespacem__variables__conversion.html#a7cd906bb65027a37f6e53ed835f74cfc">e_l</a> + <a class="code" href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">pres_l</a>)/rho_l</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#a00d96d7b614a5c0ce7dbe96d556b0342">h_r</a> = (<a class="code" href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">e_r</a> + <a class="code" href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">pres_r</a>)/rho_r</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">mf_l</a>(i) = q_rs_wsk( r )%vf(i)%sf(j,k,l)/rho_l</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                <a class="code" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">mf_r</a>(i) = q_rs_wsk(r+1)%vf(i)%sf(j,k,l)/rho_r</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                        </div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">s_compute_average_state</a>(j+r,k,l)</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                        </div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            </div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            </div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a3ca1b002fc78b7faad2f8638e4a42f9a">s_initialize_characteristic_decomposition</a> <span class="comment">! -------------</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        </div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        </div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a81e6ad74f0a2bd1b27a7873dbd797a60">s_finalize_characteristic_decomposition</a>() <span class="comment">! -----------------</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            </div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            </div><div class="line"><a name="l01309"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a81e6ad74f0a2bd1b27a7873dbd797a60"> 1309</a></span>&#160;            <span class="comment">! Deallocating the average density, sound speed and mass fractions</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">rho_avg_sf</a>, <a class="code" href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">c_avg_sf</a>)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            </div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>(i)%sf)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            </div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            </div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a81e6ad74f0a2bd1b27a7873dbd797a60">s_finalize_characteristic_decomposition</a> <span class="comment">! ---------------</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        </div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        </div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        </div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        </div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        </div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">s_compute_lsq_gradient_curvature</a>(v_vf,grad_x_vf,grad_y_vf,grad_z_vf,norm_vf,kappa_vf)</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span>      :: v_vf</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span>   :: grad_x_vf, grad_y_vf, grad_z_vf</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(num_fluids)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: norm_vf</div><div class="line"><a name="l01328"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063"> 1328</a></span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(num_fluids)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: kappa_vf</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: A</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: sol, b, AA</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: xloc, yloc, zloc</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordtype">INTEGER</span> :: ndim</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k, ii, jj, kk, i1, i2, l</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="keywordtype">INTEGER</span> :: stencil_i_min, stencil_i_max</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <span class="keywordtype">INTEGER</span> :: stencil_j_min, stencil_j_max</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="keywordtype">INTEGER</span> :: stencil_k_min, stencil_k_max</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: ix,iy,iz</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: norm, kappa</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span> <span class="comment">! 3D simulation</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                <span class="keyword">ALLOCATE</span>(a(10,10))</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                <span class="keyword">ALLOCATE</span>(sol(10)); <span class="keyword">ALLOCATE</span>(b(10)); <span class="keyword">ALLOCATE</span>(aa(10))</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="keywordflow">ELSE</span> <span class="comment">! 2D simulation</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                <span class="keyword">ALLOCATE</span>(a(6,6))</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                <span class="keyword">ALLOCATE</span>(sol(6)); <span class="keyword">ALLOCATE</span>(b(6)); <span class="keyword">ALLOCATE</span>(aa(6))</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <span class="comment">! Parabolic fitting</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            ndim = <span class="keyword">SIZE</span>(sol,1)</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            ix%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iy%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            ix%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iy%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                iz%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iz%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                iz%beg = -1; iz%end = 1</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                <span class="keywordflow">DO</span> k = iz%beg+1, iz%end-1</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    <span class="keywordflow">DO</span> j = iy%beg+1, iy%end-1</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                        <span class="keywordflow">DO</span> i = ix%beg+1, ix%end-1</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                            a(:,:) = 0d0</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                            b(:) = 0d0</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                            sol(:) = 0d0</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                            aa(:) = 0d0</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    </div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                            stencil_i_min = i-1; stencil_i_max = i+1</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                            stencil_j_min = j-1; stencil_j_max = j+1</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                stencil_k_min = k-1; stencil_k_max = k+1</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                            <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                stencil_k_min = 0; stencil_k_max = 0</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    </div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                            <span class="keywordflow">DO</span> kk = stencil_k_min, stencil_k_max</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                <span class="keywordflow">DO</span> jj = stencil_j_min, stencil_j_max</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                    <span class="keywordflow">DO</span> ii = stencil_i_min, stencil_i_max</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    </div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                        <span class="comment">! Ignore corner points in 3D stencil</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                        <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0).AND.(abs(ii-i)==1).AND.(abs(jj-j)==1).AND.(abs(kk-k)==1)) cycle</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    </div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                        <span class="comment">! Find distance between cell centers</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                        xloc = <a class="code" href="namespacem__global__parameters.html#aea5b911d65b330f65e97052e9e8c0383">x_cc</a>(ii) - <a class="code" href="namespacem__global__parameters.html#aea5b911d65b330f65e97052e9e8c0383">x_cc</a>(i)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                        yloc = <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(jj) - <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(j)</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) zloc = <a class="code" href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">z_cc</a>(kk) - <a class="code" href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">z_cc</a>(k)</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    </div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                                        <span class="comment">! Compute operator</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                        aa(1) = 1d0</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                                        aa(2) = xloc</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                        aa(3) = yloc</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                        aa(4) = 5d-1*xloc**2d0</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                        aa(5) = 5d-1*yloc**2d0</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                        aa(6) = xloc*yloc</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                            aa(7) = zloc</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                            aa(8) = 5d-1*zloc**2d0</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                            aa(9) = yloc*zloc</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                            aa(10) = zloc*xloc</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    </div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                        <span class="keywordflow">DO</span> i1 = 1, ndim</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                            <span class="keywordflow">DO</span> i2 = 1, ndim</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                                a(i1,i2) = a(i1,i2) + aa(i1)*aa(i2)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="keywordflow">                                            END DO</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    </div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                        <span class="comment">! Form RHS vector</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                        <span class="keywordflow">DO</span> i1 = 1, ndim</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                            b(i1) = b(i1) + v_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf(ii,jj,kk)*aa(i1)</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    </div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#afd3e70122b6f083342f644fdf5b18694">s_solve_linear_system</a>(a,b,sol,ndim)</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    </div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                norm = sqrt(sol(2)**2d0 + sol(3)**2d0 + sol(7)**2d0)</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                                norm = sqrt(sol(2)**2d0 + sol(3)**2d0)</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                            </div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            grad_x_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf(i,j,k) = sol(2)</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                            grad_y_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf(i,j,k) = sol(3)</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                                grad_z_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf(i,j,k) = sol(7)</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                           </div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                kappa = -(sol(2)**2d0*sol(5) - 2d0*sol(2)*sol(3)*sol(6) + sol(2)**2d0*sol(8) + &amp;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                                          sol(3)**2d0*sol(8) - 2d0*sol(3)*sol(7)*sol(9) + sol(3)**2d0*sol(4) + &amp;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                                          sol(7)**2d0*sol(4) - 2d0*sol(7)*sol(2)*sol(10)+ sol(7)**2d0*sol(5)) &amp;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                                          /max(norm,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)**3d0</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                                kappa = -(sol(2)**2d0*sol(5) - 2d0*sol(2)*sol(3)*sol(6) + sol(3)**2d0*sol(4)) &amp;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                                    /max(norm,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)**3d0</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                            norm_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf(i,j,k) = norm</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                            kappa_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf(i,j,k) = kappa</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            </div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <span class="keyword">DEALLOCATE</span>(a,sol,b,aa)</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">s_compute_lsq_gradient_curvature</a></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#afd3e70122b6f083342f644fdf5b18694">s_solve_linear_system</a>(A,b,sol,ndim)</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: ndim</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(ndim,ndim)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: A</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(ndim)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: b</div><div class="line"><a name="l01459"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#afd3e70122b6f083342f644fdf5b18694"> 1459</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: sol</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">!            INTEGER, DIMENSION(ndim) :: ipiv</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">!            INTEGER :: nrhs, lda, ldb, info</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">!            EXTERNAL DGESV</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            <span class="comment">! Solve linear system using Intel MKL (Hooke)</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">!            nrhs = 1</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">!            lda = ndim</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">!            ldb = ndim</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">! </span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment">!            CALL DGESV(ndim, nrhs, A, lda, ipiv, b, ldb, info)</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">! </span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">!            DO i = 1, ndim</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">!                sol(i) = b(i)</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">!            END DO</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">! </span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">!            IF (info /= 0) THEN</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">!                PRINT &#39;(A)&#39;, &#39;Trouble solving linear system&#39;</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">!                CALL s_mpi_abort()</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">!            END IF</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="comment">! Solve linear system using own linear solver (Thomson/Darter/Comet/Stampede)</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <span class="comment">! Forward elimination</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <span class="keywordflow">DO</span> i = 1, ndim</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                <span class="comment">! Pivoting</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                j = i-1+maxloc(abs(a(i:ndim,i)),1)</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                sol = a(i,:)</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                a(i,:) = a(j,:)</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                a(j,:) = sol</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                sol(1) = b(i)</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                b(i) = b(j)</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                b(j) = sol(1)</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                <span class="comment">! Elimination</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                b(i) = b(i) / a(i,i)</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                a(i,:) = a(i,:) / a(i,i)</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                <span class="keywordflow">DO</span> k = i+1, ndim</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                    b(k) = b(k) - a(k,i)*b(i)</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                    a(k,:) = a(k,:) - a(k,i)*a(i,:)</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="comment">! Backward substitution</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            <span class="keywordflow">DO</span> i = ndim, 1, -1</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                sol(i) = b(i)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                <span class="keywordflow">DO</span> k = i+1, ndim</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    sol(i) = sol(i) - a(i,k)*sol(k)</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#afd3e70122b6f083342f644fdf5b18694">s_solve_linear_system</a>    </div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        </div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a6a3f90e69ef4dea304495d0f7c068de2">s_finalize_variables_conversion_module</a>() <span class="comment">! ------------------</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="comment">! Disassociating the pointer to the procedure that was utilized to</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="comment">! to convert mixture or species variables to the mixture variables</span></div><div class="line"><a name="l01520"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a6a3f90e69ef4dea304495d0f7c068de2"> 1520</a></span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; null()</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            </div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="comment">! Deallocating the velocities, the mass fractions, and the Weber</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="comment">! numbers as well as disassociating the pointer to the procedure</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="comment">! which was used in the calculation of the average state</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab62b8c589dcddff0e6295f4956012c7a">char_decomp</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                </div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">vel_l</a>  , <a class="code" href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">mf_l</a>     )</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">vel_r</a>  , <a class="code" href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">mf_r</a>     )</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">vel_avg</a>, <a class="code" href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">mf_avg_vf</a>)</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                </div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__variables__conversion.html#a87022a7b6fc9b57912e4fca2d38bd0e2">we_l</a>, <a class="code" href="namespacem__variables__conversion.html#a0b984f6015e127568f82af37a3135ceb">we_r</a>)</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                </div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">s_compute_average_state</a> =&gt; null()</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                </div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            </div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            </div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a6a3f90e69ef4dea304495d0f7c068de2">s_finalize_variables_conversion_module</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        </div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        </div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<div class="ttc" id="namespacem__global__parameters_html_a5c017ac8b7bf0d36b4b3b88efe5ffc5f"><div class="ttname"><a href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">m_global_parameters::dir_idx</a></div><div class="ttdeci">integer, dimension(3) dir_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00226">m_global_parameters.f90:226</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_afd3e70122b6f083342f644fdf5b18694"><div class="ttname"><a href="namespacem__variables__conversion.html#afd3e70122b6f083342f644fdf5b18694">m_variables_conversion::s_solve_linear_system</a></div><div class="ttdeci">subroutine s_solve_linear_system(A, b, sol, ndim)</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01459">m_variables_conversion.f90:1459</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a4cf9b21c0dfd924ac807585579240486"><div class="ttname"><a href="namespacem__variables__conversion.html#a4cf9b21c0dfd924ac807585579240486">m_variables_conversion::s_compute_roe_average_state</a></div><div class="ttdeci">subroutine s_compute_roe_average_state(j, k, l)</div><div class="ttdoc">The goal of this subroutine is to calculate the Roe average density, velocity, enthalpy, mass fractions, specific heat ratio function and the speed of sound, at the cell-boundaries, from the left and the right cell-average variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00397">m_variables_conversion.f90:397</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa254277cf111be2267a61b7884279844"><div class="ttname"><a href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">m_global_parameters::weno_vars</a></div><div class="ttdeci">integer weno_vars</div><div class="ttdoc">WENO-reconstructed state variables type. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00124">m_global_parameters.f90:124</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6b9c81f07f8444654924e3075e4edaf8"><div class="ttname"><a href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">m_global_parameters::riemann_solver</a></div><div class="ttdeci">integer riemann_solver</div><div class="ttdoc">Riemann solver algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a1dbfde20c4af4e0ad0989f4629889809"><div class="ttname"><a href="namespacem__variables__conversion.html#a1dbfde20c4af4e0ad0989f4629889809">m_variables_conversion::s_convert_primitive_to_conservative_variables</a></div><div class="ttdeci">subroutine, public s_convert_primitive_to_conservative_variables(qK_prim_vf, qK_cons_vf, gm_alphaK_vf, ix, iy, iz)</div><div class="ttdoc">The following procedure handles the conversion between the primitive variables and the conservative v...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00769">m_variables_conversion.f90:769</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a679b4b915633d222074a89abcbfe35dc"><div class="ttname"><a href="namespacem__variables__conversion.html#a679b4b915633d222074a89abcbfe35dc">m_variables_conversion::e_r</a></div><div class="ttdeci">real(kind(0d0)) e_r</div><div class="ttdoc">left/right states total energy </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00135">m_variables_conversion.f90:135</a></div></div>
<div class="ttc" id="structm__derived__types_1_1vector__field_html"><div class="ttname"><a href="structm__derived__types_1_1vector__field.html">m_derived_types::vector_field</a></div><div class="ttdoc">Derived type annexing a vector field (VF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00058">m_derived_types.f90:58</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a634c394073f72172798e63327fc4da9f"><div class="ttname"><a href="namespacem__variables__conversion.html#a634c394073f72172798e63327fc4da9f">m_variables_conversion::rho_avg_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable rho_avg_sf</div><div class="ttdoc">averaged (Roe/arithmetic) density </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00147">m_variables_conversion.f90:147</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae8e6c40b6ec73cb126b0cce7496e0057"><div class="ttname"><a href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00189">m_global_parameters.f90:189</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2f790d774fdcc87779b89a71ae3f2674"><div class="ttname"><a href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_abstract_to_mixture_variables), pointer, public s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00158">m_variables_conversion.f90:158</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1a3314b39e21e17d7e72a9837db2ab42"><div class="ttname"><a href="namespacem__global__parameters.html#a1a3314b39e21e17d7e72a9837db2ab42">m_global_parameters::avg_state</a></div><div class="ttdeci">integer avg_state</div><div class="ttdoc">Average state evaluation method. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00135">m_global_parameters.f90:135</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00247">m_global_parameters.f90:247</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7db1a23566279bdbc7da68850c596c69"><div class="ttname"><a href="namespacem__global__parameters.html#a7db1a23566279bdbc7da68850c596c69">m_global_parameters::pi_inf_idx</a></div><div class="ttdeci">integer pi_inf_idx</div><div class="ttdoc">Index of liquid stiffness func. eqn. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00194">m_global_parameters.f90:194</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ac006af9a5403b2fdad7f81ce0a67ecec"><div class="ttname"><a href="namespacem__variables__conversion.html#ac006af9a5403b2fdad7f81ce0a67ecec">m_variables_conversion::s_initialize_variables_conversion_module</a></div><div class="ttdeci">subroutine, public s_initialize_variables_conversion_module()</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00469">m_variables_conversion.f90:469</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">The module contains all of the parameters describing the program logistics, the computational domain ...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00040">m_global_parameters.f90:40</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00048">m_derived_types.f90:48</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaa584e01b4153d246d84eef286482632"><div class="ttname"><a href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">m_global_parameters::y_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target y_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdoc">Number of eq. bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00282">m_global_parameters.f90:282</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00277">m_global_parameters.f90:277</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adefe3b78bf286d73a56aef49880dfb0d"><div class="ttname"><a href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00186">m_global_parameters.f90:186</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a9ef76270f02246abad03ce449673de84"><div class="ttname"><a href="namespacem__variables__conversion.html#a9ef76270f02246abad03ce449673de84">m_variables_conversion::vel_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00133">m_variables_conversion.f90:133</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a36ee8d46fb5ce8b870cabc66ec1d62ba"><div class="ttname"><a href="namespacem__variables__conversion.html#a36ee8d46fb5ce8b870cabc66ec1d62ba">m_variables_conversion::pres_r</a></div><div class="ttdeci">real(kind(0d0)) pres_r</div><div class="ttdoc">left/right states pressure </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00134">m_variables_conversion.f90:134</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a00d96d7b614a5c0ce7dbe96d556b0342"><div class="ttname"><a href="namespacem__variables__conversion.html#a00d96d7b614a5c0ce7dbe96d556b0342">m_variables_conversion::h_r</a></div><div class="ttdeci">real(kind(0d0)) h_r</div><div class="ttdoc">left/right states enthalpy </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00136">m_variables_conversion.f90:136</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_aea8ad83f5633509287326ea1a428cb89"><div class="ttname"><a href="namespacem__variables__conversion.html#aea8ad83f5633509287326ea1a428cb89">m_variables_conversion::re_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re_r</div><div class="ttdoc">left/right states Reynolds number </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00140">m_variables_conversion.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99557d578d538a853b5fd9e445ad6303"><div class="ttname"><a href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">m_global_parameters::we_riemann_flux</a></div><div class="ttdeci">logical we_riemann_flux</div><div class="ttdoc">Account for capillary effects in the Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a40a27c491716f10b38a268a8e93c5a5f"><div class="ttname"><a href="namespacem__variables__conversion.html#a40a27c491716f10b38a268a8e93c5a5f">m_variables_conversion::gamma_l</a></div><div class="ttdeci">real(kind(0d0)) gamma_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00138">m_variables_conversion.f90:138</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a77bc35ccbac3dbf5e5a01e4e0219d301"><div class="ttname"><a href="namespacem__variables__conversion.html#a77bc35ccbac3dbf5e5a01e4e0219d301">m_variables_conversion::alpha_l</a></div><div class="ttdeci">real(kind(0d0)) alpha_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00142">m_variables_conversion.f90:142</a></div></div>
<div class="ttc" id="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables_html"><div class="ttname"><a href="interfacem__variables__conversion_1_1s__convert__abstract__to__mixture__variables.html">m_variables_conversion::s_convert_abstract_to_mixture_variables</a></div><div class="ttdoc">The abstract interface to the procedures that are utilized to convert the mixture and the species var...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00095">m_variables_conversion.f90:95</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0d20192b0175dc677ba88b14bf0d5104"><div class="ttname"><a href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">m_global_parameters::we_idx</a></div><div class="ttdeci">integer, dimension(:,:), allocatable we_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00210">m_global_parameters.f90:210</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a40712fcf8ac2c0e87d0393bbe1a0b800"><div class="ttname"><a href="namespacem__variables__conversion.html#a40712fcf8ac2c0e87d0393bbe1a0b800">m_variables_conversion::s_convert_characteristic_to_conservative_variables</a></div><div class="ttdeci">subroutine, public s_convert_characteristic_to_conservative_variables(qK_rs_vf, is1, is2, is3, dj)</div><div class="ttdoc">This subroutine takes care of the conversion between the the conservative variables and the character...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01099">m_variables_conversion.f90:1099</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99ba7e33a1870ac89386d376e0d20526"><div class="ttname"><a href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">m_global_parameters::dflt_real</a></div><div class="ttdeci">real(kind(0d0)), parameter dflt_real</div><div class="ttdoc">Default real value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ac6e02dc63185c34a062b7e8107748479"><div class="ttname"><a href="namespacem__variables__conversion.html#ac6e02dc63185c34a062b7e8107748479">m_variables_conversion::h_avg</a></div><div class="ttdeci">real(kind(0d0)) h_avg</div><div class="ttdoc">averaged (Roe/arithmetic) enthalpy </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00149">m_variables_conversion.f90:149</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a351be005cfac23e82310e91393f5d535"><div class="ttname"><a href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">m_global_parameters::weno_polyn</a></div><div class="ttdeci">integer weno_polyn</div><div class="ttdoc">Degree of the WENO polynomials (polyn) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6e342ae3eb66f89e0eeb94e11aa42d92"><div class="ttname"><a href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">m_global_parameters::buff_size</a></div><div class="ttdeci">integer buff_size</div><div class="ttdoc">The number of cells that are necessary to be able to store enough boundary conditions data to march t...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9fef803dde37fd067fd4b2215df851b9"><div class="ttname"><a href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">m_global_parameters::z_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target z_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a46be9183c95b82af0d7552cd16f487f1"><div class="ttname"><a href="namespacem__variables__conversion.html#a46be9183c95b82af0d7552cd16f487f1">m_variables_conversion::pres_l</a></div><div class="ttdeci">real(kind(0d0)) pres_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00134">m_variables_conversion.f90:134</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of fluids in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_af05a8e081300b76aa2a685d598cb5b92"><div class="ttname"><a href="namespacem__variables__conversion.html#af05a8e081300b76aa2a685d598cb5b92">m_variables_conversion::s_convert_conservative_to_characteristic_variables</a></div><div class="ttdeci">subroutine, public s_convert_conservative_to_characteristic_variables(q_rs_wsK, norm_dir, is1, is2, is3, dj)</div><div class="ttdoc">This procedure takes care of the conversion between the conservative variables and the characteristic...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00664">m_variables_conversion.f90:664</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a49df2e65b245cbc006e27663d69e4399"><div class="ttname"><a href="namespacem__variables__conversion.html#a49df2e65b245cbc006e27663d69e4399">m_variables_conversion::s_convert_characteristic_to_primitive_variables</a></div><div class="ttdeci">subroutine, public s_convert_characteristic_to_primitive_variables(qK_rs_vf, is1, is2, is3, dj)</div><div class="ttdoc">This subroutine takes care of the conversion between the the characteristic variables and the primiti...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01140">m_variables_conversion.f90:1140</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a4b22f555477e0d617f5cf53fd4e2fa38"><div class="ttname"><a href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">m_variables_conversion::s_convert_conservative_to_primitive_variables</a></div><div class="ttdeci">subroutine, public s_convert_conservative_to_primitive_variables(qK_cons_vf, qK_prim_vf, gm_alphaK_vf, ix, iy, iz)</div><div class="ttdoc">The following procedure handles the conversion between the conservative variables and the primitive v...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00521">m_variables_conversion.f90:521</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a613c09e8438e535e8c13f15282493793"><div class="ttname"><a href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">m_variables_conversion::s_convert_mixture_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_mixture_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00188">m_variables_conversion.f90:188</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a6a3f90e69ef4dea304495d0f7c068de2"><div class="ttname"><a href="namespacem__variables__conversion.html#a6a3f90e69ef4dea304495d0f7c068de2">m_variables_conversion::s_finalize_variables_conversion_module</a></div><div class="ttdeci">subroutine, public s_finalize_variables_conversion_module()</div><div class="ttdoc">Module deallocation and/or disassociation procedures. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01520">m_variables_conversion.f90:1520</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acfd358e345eac06daf89ca40651ba2c8"><div class="ttname"><a href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">m_global_parameters::we_rhs_flux</a></div><div class="ttdeci">logical we_rhs_flux</div><div class="ttdoc">Account for capillary effects using the conservative formulation in RHS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00149">m_global_parameters.f90:149</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ae846c6fc6552d5bfe98e1e6ad69d1097"><div class="ttname"><a href="namespacem__variables__conversion.html#ae846c6fc6552d5bfe98e1e6ad69d1097">m_variables_conversion::mf_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable mf_r</div><div class="ttdoc">left/right states mass fraction </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00137">m_variables_conversion.f90:137</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0a67704d4c227871a155d6c26590f685"><div class="ttname"><a href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">m_global_parameters::re_size</a></div><div class="ttdeci">integer, dimension(2) re_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00201">m_global_parameters.f90:201</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in system of eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00185">m_global_parameters.f90:185</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a7f62727a697f6be7f205bbc65156d508"><div class="ttname"><a href="namespacem__variables__conversion.html#a7f62727a697f6be7f205bbc65156d508">m_variables_conversion::s_convert_primitive_to_characteristic_variables</a></div><div class="ttdeci">subroutine, public s_convert_primitive_to_characteristic_variables(q_rs_wsK, norm_dir, is1, is2, is3, dj)</div><div class="ttdoc">This subroutine takes care of the conversion between the the primitive variables and the characterist...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00818">m_variables_conversion.f90:818</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Mixture physical parameters (MPP) limits. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00122">m_global_parameters.f90:122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af329319354912b90787e0dff7cdc8a37"><div class="ttname"><a href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">m_global_parameters::we_size</a></div><div class="ttdeci">integer we_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00209">m_global_parameters.f90:209</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a3b45952794b8a8edb8ec8bc3612edbe3"><div class="ttname"><a href="namespacem__variables__conversion.html#a3b45952794b8a8edb8ec8bc3612edbe3">m_variables_conversion::re_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00140">m_variables_conversion.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad138d35528cf27ff42dba00d13c269be"><div class="ttname"><a href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00187">m_global_parameters.f90:187</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ac41b66d567256cb60746f95010a6ea65"><div class="ttname"><a href="namespacem__variables__conversion.html#ac41b66d567256cb60746f95010a6ea65">m_variables_conversion::alpha_avg</a></div><div class="ttdeci">real(kind(0d0)) alpha_avg</div><div class="ttdoc">averaging for bubbly mixture speed of sound </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00154">m_variables_conversion.f90:154</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00191">m_global_parameters.f90:191</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4ecdedaf3db880f8d71dbefc816322f8"><div class="ttname"><a href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">m_global_parameters::gamma_idx</a></div><div class="ttdeci">integer gamma_idx</div><div class="ttdoc">Index of specific heat ratio func. eqn. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a45f7e4963c2a7c792bad6a90bbe43c36"><div class="ttname"><a href="namespacem__variables__conversion.html#a45f7e4963c2a7c792bad6a90bbe43c36">m_variables_conversion::pres_avg</a></div><div class="ttdeci">real(kind(0d0)) pres_avg</div><div class="ttdoc">averaging for bubble mixture speed of sound </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00155">m_variables_conversion.f90:155</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a7e09e021d90fc326b8869c854321b9f2"><div class="ttname"><a href="namespacem__variables__conversion.html#a7e09e021d90fc326b8869c854321b9f2">m_variables_conversion::vel_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_r</div><div class="ttdoc">left/right states velocity </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00133">m_variables_conversion.f90:133</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a30e6fe4c4ff6a8cfefa1bf882dc2e90e"><div class="ttname"><a href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">m_global_parameters::crv_size</a></div><div class="ttdeci">integer crv_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00217">m_global_parameters.f90:217</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_abe0d038aac3b3f0166c1a0c93c497e33"><div class="ttname"><a href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">m_variables_conversion::s_convert_species_to_mixture_variables_bubbles</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables_bubbles(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. Specifially designed for when subgrid bubbles must be included. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00226">m_variables_conversion.f90:226</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ac02f08709876d8ef71c8f8db47a4efa3"><div class="ttname"><a href="namespacem__variables__conversion.html#ac02f08709876d8ef71c8f8db47a4efa3">m_variables_conversion::s_convert_primitive_to_flux_variables_bubbles</a></div><div class="ttdeci">subroutine, public s_convert_primitive_to_flux_variables_bubbles(qK_prim_vf, qk_cons_vf, FK_vf, FK_src_vf, ix, iy, iz)</div><div class="ttdoc">The following subroutine handles the conversion between the primitive variables and the Eulerian flux...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01011">m_variables_conversion.f90:1011</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_abede800c9696158470575d8758460360"><div class="ttname"><a href="namespacem__variables__conversion.html#abede800c9696158470575d8758460360">m_variables_conversion::s_convert_conservative_to_flux_variables</a></div><div class="ttdeci">subroutine, public s_convert_conservative_to_flux_variables(qK_cons_vf, FK_vf, FK_src_vf, ix, iy, iz)</div><div class="ttdoc">The following subroutine handles the conversion between the conservative variables and the Euler flux...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00720">m_variables_conversion.f90:720</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00277">m_global_parameters.f90:277</a></div></div>
<div class="ttc" id="interfacem__variables__conversion_1_1s__compute__abstract__average__state_html"><div class="ttname"><a href="interfacem__variables__conversion_1_1s__compute__abstract__average__state.html">m_variables_conversion::s_compute_abstract_average_state</a></div><div class="ttdoc">The abstract interface to the procedures that are used to compute the Roe and the arithmetic average ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00121">m_variables_conversion.f90:121</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a6f2d4a77c301f98562a27a23b2983691"><div class="ttname"><a href="namespacem__variables__conversion.html#a6f2d4a77c301f98562a27a23b2983691">m_variables_conversion::pi_inf_l</a></div><div class="ttdeci">real(kind(0d0)) pi_inf_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00139">m_variables_conversion.f90:139</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ab9f7728bd98c31174efdeaf389d724c5"><div class="ttname"><a href="namespacem__variables__conversion.html#ab9f7728bd98c31174efdeaf389d724c5">m_variables_conversion::pi_inf_r</a></div><div class="ttdeci">real(kind(0d0)) pi_inf_r</div><div class="ttdoc">left/right states liquid stiffness </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00139">m_variables_conversion.f90:139</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7b7945c133bf17eb1f25468a6d1a6925"><div class="ttname"><a href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">m_global_parameters::crv_idx</a></div><div class="ttdeci">integer, dimension(:), allocatable crv_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00218">m_global_parameters.f90:218</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a825db8aee0af3c120a7ca1f8de814490"><div class="ttname"><a href="namespacem__variables__conversion.html#a825db8aee0af3c120a7ca1f8de814490">m_variables_conversion::s_compute_arithmetic_average_state</a></div><div class="ttdeci">subroutine s_compute_arithmetic_average_state(j, k, l)</div><div class="ttdoc">The goal of this subroutine is to compute the arithmetic average density, velocity, enthalpy, mass fractions, the specific heat ratio function and the sound speed, at the cell-boundaries, from the left and right cell-averages. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00433">m_variables_conversion.f90:433</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a08058afcc5db00000abcceb8e3968eee"><div class="ttname"><a href="namespacem__variables__conversion.html#a08058afcc5db00000abcceb8e3968eee">m_variables_conversion::gamma_r</a></div><div class="ttdeci">real(kind(0d0)) gamma_r</div><div class="ttdoc">left/right states specific heat ratio </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00138">m_variables_conversion.f90:138</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a9ca8440ed6e591b63ef1466c6b46ce5d"><div class="ttname"><a href="namespacem__variables__conversion.html#a9ca8440ed6e591b63ef1466c6b46ce5d">m_variables_conversion::mf_avg_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable mf_avg_vf</div><div class="ttdoc">averaged (Roe/arithmetic) mass fraction </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00150">m_variables_conversion.f90:150</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9dc07be63393049ae70d9dceeff403e9"><div class="ttname"><a href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">m_global_parameters::dir_flg</a></div><div class="ttdeci">real(kind(0d0)), dimension(3) dir_flg</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00227">m_global_parameters.f90:227</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0f5485ff839ecbf46ff48d6dc74c0d90"><div class="ttname"><a href="namespacem__variables__conversion.html#a0f5485ff839ecbf46ff48d6dc74c0d90">m_variables_conversion::mf_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable mf_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00137">m_variables_conversion.f90:137</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a81e6ad74f0a2bd1b27a7873dbd797a60"><div class="ttname"><a href="namespacem__variables__conversion.html#a81e6ad74f0a2bd1b27a7873dbd797a60">m_variables_conversion::s_finalize_characteristic_decomposition</a></div><div class="ttdeci">subroutine s_finalize_characteristic_decomposition()</div><div class="ttdoc">Deallocation and/or disassociation procedures that are necessary to finalize the characteristic decom...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01309">m_variables_conversion.f90:1309</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0670171466cd1ce584495face34cc4de"><div class="ttname"><a href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, k, l, r)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00306">m_variables_conversion.f90:306</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a5f8751544d985f9e8dba160437f72b12"><div class="ttname"><a href="namespacem__variables__conversion.html#a5f8751544d985f9e8dba160437f72b12">m_variables_conversion::alpha_r</a></div><div class="ttdeci">real(kind(0d0)) alpha_r</div><div class="ttdoc">left/right states void fraction </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00142">m_variables_conversion.f90:142</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a33b4272ac0c75aff15851f9dfa6a9d14"><div class="ttname"><a href="namespacem__global__parameters.html#a33b4272ac0c75aff15851f9dfa6a9d14">m_global_parameters::re_idx</a></div><div class="ttdeci">integer, dimension(:,:), allocatable re_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00202">m_global_parameters.f90:202</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0b984f6015e127568f82af37a3135ceb"><div class="ttname"><a href="namespacem__variables__conversion.html#a0b984f6015e127568f82af37a3135ceb">m_variables_conversion::we_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable we_r</div><div class="ttdoc">left/right states Weber number </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00141">m_variables_conversion.f90:141</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aea5b911d65b330f65e97052e9e8c0383"><div class="ttname"><a href="namespacem__global__parameters.html#aea5b911d65b330f65e97052e9e8c0383">m_global_parameters::x_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target x_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a3f563ef8c3ca1b8af63de2eb093f8fd6"><div class="ttname"><a href="namespacem__variables__conversion.html#a3f563ef8c3ca1b8af63de2eb093f8fd6">m_variables_conversion::gamma_avg</a></div><div class="ttdeci">real(kind(0d0)) gamma_avg</div><div class="ttdoc">averaged (Roe/arithmetic) specific heat ratio </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00151">m_variables_conversion.f90:151</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a04ac565bad2b22dc045a5eeb4f516e2e"><div class="ttname"><a href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">m_mpi_proxy::s_mpi_abort</a></div><div class="ttdeci">subroutine s_mpi_abort()</div><div class="ttdoc">The subroutine terminates the MPI execution environment. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00104">m_mpi_proxy.f90:104</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a93f1bb8b4aee426f508a6ceef721a35c"><div class="ttname"><a href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">m_variables_conversion::s_convert_primitive_to_flux_variables</a></div><div class="ttdeci">subroutine, public s_convert_primitive_to_flux_variables(qK_prim_vf, FK_vf, FK_src_vf, ix, iy, iz)</div><div class="ttdoc">The following subroutine handles the conversion between the primitive variables and the Eulerian flux...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00903">m_variables_conversion.f90:903</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aac1a5a73b1eae759c913983b38047167"><div class="ttname"><a href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">m_global_parameters::s_comp_n_from_cons</a></div><div class="ttdeci">subroutine s_comp_n_from_cons(vftmp, nRtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the conservative variables . </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l01051">m_global_parameters.f90:1051</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a953abb55b23caddc730076fa837a8063"><div class="ttname"><a href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">m_variables_conversion::s_compute_lsq_gradient_curvature</a></div><div class="ttdeci">subroutine, public s_compute_lsq_gradient_curvature(v_vf, grad_x_vf, grad_y_vf, grad_z_vf, norm_vf, kappa_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01328">m_variables_conversion.f90:1328</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a3ca1b002fc78b7faad2f8638e4a42f9a"><div class="ttname"><a href="namespacem__variables__conversion.html#a3ca1b002fc78b7faad2f8638e4a42f9a">m_variables_conversion::s_initialize_characteristic_decomposition</a></div><div class="ttdeci">subroutine s_initialize_characteristic_decomposition(q_rs_wsK, norm_dir, is1, is2, is3)</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01203">m_variables_conversion.f90:1203</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a7c36a0df12279321428e742ac7a71001"><div class="ttname"><a href="namespacem__variables__conversion.html#a7c36a0df12279321428e742ac7a71001">m_variables_conversion::c_avg_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable c_avg_sf</div><div class="ttdoc">averaged (Roe/arithmetic) speed of sound </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00152">m_variables_conversion.f90:152</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a8a9fd6029912bd540f67f414592f52f6"><div class="ttname"><a href="namespacem__variables__conversion.html#a8a9fd6029912bd540f67f414592f52f6">m_variables_conversion::vel_avg</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_avg</div><div class="ttdoc">averaged (Roe/arithmetic) velocity </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00148">m_variables_conversion.f90:148</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a7f9d10004d2efcf06092c8e83afd90a9"><div class="ttname"><a href="namespacem__variables__conversion.html#a7f9d10004d2efcf06092c8e83afd90a9">m_variables_conversion::h_l</a></div><div class="ttdeci">real(kind(0d0)) h_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00136">m_variables_conversion.f90:136</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module features a database of subroutines that allow for the conversion of state variables from ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00047">m_variables_conversion.f90:47</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type annexing beginning and ending bounds information. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00064">m_derived_types.f90:64</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a87022a7b6fc9b57912e4fca2d38bd0e2"><div class="ttname"><a href="namespacem__variables__conversion.html#a87022a7b6fc9b57912e4fca2d38bd0e2">m_variables_conversion::we_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable we_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00141">m_variables_conversion.f90:141</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab62b8c589dcddff0e6295f4956012c7a"><div class="ttname"><a href="namespacem__global__parameters.html#ab62b8c589dcddff0e6295f4956012c7a">m_global_parameters::char_decomp</a></div><div class="ttdeci">logical char_decomp</div><div class="ttdoc">Characteristic decomposition. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00128">m_global_parameters.f90:128</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a383c6ff025d4ea09ddd4e2356042d86b"><div class="ttname"><a href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">m_global_parameters::proc_rank</a></div><div class="ttdeci">integer proc_rank</div><div class="ttdoc">Rank of the local processor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00072">m_global_parameters.f90:72</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">The module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aec97838cc58623019b07ae47da7f4c1c"><div class="ttname"><a href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">m_global_parameters::sgm_eps</a></div><div class="ttdeci">real(kind(0d0)), parameter sgm_eps</div><div class="ttdoc">Segmentation tolerance. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00061">m_global_parameters.f90:61</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2071f3e7e4336e3e87f259e72ccdb8b1"><div class="ttname"><a href="namespacem__variables__conversion.html#a2071f3e7e4336e3e87f259e72ccdb8b1">m_variables_conversion::s_compute_average_state</a></div><div class="ttdeci">procedure(s_compute_abstract_average_state), pointer s_compute_average_state</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00163">m_variables_conversion.f90:163</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a7cd906bb65027a37f6e53ed835f74cfc"><div class="ttname"><a href="namespacem__variables__conversion.html#a7cd906bb65027a37f6e53ed835f74cfc">m_variables_conversion::e_l</a></div><div class="ttdeci">real(kind(0d0)) e_l</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00135">m_variables_conversion.f90:135</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdoc">Bubbles on/off. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00290">m_global_parameters.f90:290</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cff1091173cf1fe67371edd427ba236f.html">simulation_code</a></li><li class="navelem"><a class="el" href="m__variables__conversion_8f90.html">m_variables_conversion.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
