<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="icon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Simulation: m_bubbles.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Simulation
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__bubbles_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_bubbles.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__bubbles_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html">   35</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__bubbles.html">m_bubbles</a></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>        !&lt; definitions of the derived types</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>    !&lt; definitions of the global parameters</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>            !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a> !&lt; state variables type conversion procedures</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">   51</a></span>&#160;    <span class="keywordtype">REAL(KIND(0.D0))</span> :: <a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a1ffd14079710afb89dad86916cbb91fc">   52</a></span>&#160;    <span class="keywordtype">REAL(KIND(0.D0))</span> :: <a class="code" href="namespacem__bubbles.html#a1ffd14079710afb89dad86916cbb91fc">k_mw</a></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#adeca2bd43645a6f7bcd59c88151eb3bc">   53</a></span>&#160;    <span class="keywordtype">REAL(KIND(0.D0))</span> :: <a class="code" href="namespacem__bubbles.html#adeca2bd43645a6f7bcd59c88151eb3bc">rho_mw</a></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">s_compute_bubble_source</a>(idir, q_prim_vf, q_cons_vf, mydivu, &amp;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                        bub_adv_src, bub_r_src, bub_v_src, bub_p_src, bub_m_src) </div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">   70</a></span>&#160;            </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf, q_cons_vf</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">INTENT(IN)</span> :: mydivu</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: idir</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(     0:m,0:n,0:p)</span>, <span class="keywordtype">INTENT(INOUT)</span> ::  bub_adv_src</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(1:nb,0:m,0:n,0:p)</span>, <span class="keywordtype">INTENT(INOUT)</span> ::  bub_r_src, &amp;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                                            bub_v_src, &amp;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                                                            bub_p_src, &amp;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                                                            bub_m_src</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(0:m,0:n,0:p)</span> :: nbub</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> ::  tmp1, tmp2, tmp3, tmp4, &amp;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                c_gas, c2_liquid, &amp;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                Cpbw, Cpinf,Cpinf_dot, &amp;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                myH, myHdot, rddot, alf_gas</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>   :: pb, mv, vflux, pldot, pbdot</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: n_tait, B_tait, gamma_gas</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(nb)</span>  :: Rtmp, Vtmp </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>   :: myR, myV, alf, myP, myRho, R2Vav </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: Re</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION( num_fluids, &amp;
                                        num_fluids  )</span> :: We</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;           </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l,q,s</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordtype">INTEGER</span> :: ndirs</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            </div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            ndirs = 1; <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) ndirs = 2; <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) ndirs = 3</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordflow">IF</span> (idir == ndirs) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                bub_adv_src = 0.d0; bub_r_src = 0.d0; bub_v_src = 0.d0</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                    bub_p_src = 0.d0; bub_m_src = 0.d0</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <span class="comment">! advection source</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keywordflow">DO</span> j = 0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <span class="keywordflow">DO</span> k = 0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>; <span class="keywordflow">DO</span> l = 0,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    <span class="comment">! = 3 \alpha \bar{R^2 V} / \bar{R^3} = 4 pi nbub \bar{R^2 V}</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordflow">DO</span> q = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        rtmp(q) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(q))%sf(j,k,l)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        vtmp(q) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(q))%sf(j,k,l)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    <span class="comment">! Computes n_bub number bubble density</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">s_comp_n_from_prim</a>( q_prim_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l), &amp;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                        rtmp, nbub(j,k,l) )</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                      </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>( (rtmp**2.d0)*vtmp, r2vav )</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    bub_adv_src(j,k,l)  = 4.d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>*nbub(j,k,l)*r2vav</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">                END </span>DO; END DO; END do</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="comment">! bubble radius and radial velocity source</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="keywordflow">DO</span> q=1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>; <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a> = 0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a> = 0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>; <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a> = 0,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    bub_r_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(q))%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, myrho, n_tait, b_tait, <a class="code" href="m__rhs_8f90.html#a6c337b82dc4c47f2d3cc57408aa1fc9f">re</a>, <a class="code" href="m__rhs_8f90.html#a19a438a95f2945b7c9e492f2ee983263">we</a>, <a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>, <a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>, <a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a> )</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    n_tait = 1.d0/n_tait + 1.d0 <span class="comment">!make this the usual little &#39;gamma&#39;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        gamma_gas  = 1.d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>+1)%gamma + 1.d0</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        gamma_gas  = 1.d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%gamma + 1.d0</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    myrho= q_prim_vf(1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    myp  = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    alf  = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    myr  = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(q))%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    myv  = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(q))%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        pb = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(q))%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        mv = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(q))%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__bubbles.html#a784afc585b20a8450d23867931c0b5fc">s_bwproperty</a>( pb, q )</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        vflux = <a class="code" href="namespacem__bubbles.html#ac487d49429a9af0456e14bedbadd0ef0">f_vflux</a>( myr, myv, mv, q )</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        pbdot = <a class="code" href="namespacem__bubbles.html#a8d0c865e6ff2c884cb6b4147d7b58491">f_bpres_dot</a>( vflux, myr, myv, pb, mv, q )</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                        bub_p_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = nbub(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)*pbdot</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        bub_m_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = nbub(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)*vflux*4.d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>*(myr**2.d0)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        pb = 0d0; mv = 0d0; vflux = 0d0; pbdot = 0d0</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                   <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aef0de5da0e41de495e9fe67accd62d77">bubble_model</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        <span class="comment">! Gilmore bubbles</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                        cpinf       = myp - <a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                        cpbw        = <a class="code" href="namespacem__bubbles.html#acfe552b68c999e11b895e5cfca6a8786">f_cpbw</a>( <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(q), myr, myv, gamma_gas, pb )</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                        myh         = <a class="code" href="namespacem__bubbles.html#a8f3891f06e63f4c4ee3d749f68bfabd8">f_h</a>( cpbw, cpinf, n_tait, b_tait )</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        c_gas       = <a class="code" href="namespacem__bubbles.html#a5c730e118a27d95c21388bcc2189cc76">f_cgas</a>( cpinf, n_tait, b_tait, myh )</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        cpinf_dot   = <a class="code" href="namespacem__bubbles.html#aa55a0894ed331f2e462b83b8df1d265b">f_cpinfdot</a>( myrho, myp, alf, n_tait, b_tait, bub_adv_src(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>), mydivu%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) )</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                        myhdot      = <a class="code" href="namespacem__bubbles.html#aa7656a8db7cafecfff27383756eacce7">f_hdot</a>( cpbw, cpinf, cpinf_dot, n_tait, b_tait, gamma_gas, myr, myv, <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(q), pbdot )</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        rddot       = <a class="code" href="namespacem__bubbles.html#a1795309127be53d799a3374ba984498c">f_rddot</a>( cpbw, myr, myv, myh, myhdot, c_gas, n_tait, b_tait )</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aef0de5da0e41de495e9fe67accd62d77">bubble_model</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        <span class="comment">! Keller-Miksis bubbles</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        cpinf       = myp</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        cpbw        = <a class="code" href="namespacem__bubbles.html#a3af121d17dd214c10e2ea5881e124e28">f_cpbw_km</a>( <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(q), myr, myv, gamma_gas, pb )</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        c_gas = dsqrt( n_tait*(cpbw+b_tait) / myrho)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        rddot       = <a class="code" href="namespacem__bubbles.html#a0d72f8fddc9e7423b723b71bd792463e">f_rddot_km</a>( pbdot, gamma_gas, cpinf, cpbw, myrho, myr, myv, <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(q), c_gas )</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    bub_v_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = nbub(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) * rddot</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="keywordflow">IF</span> (alf &lt; 1.d-10) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        bub_adv_src(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 0d0</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        bub_r_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 0d0</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                        bub_v_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 0d0</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                           bub_p_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 0d0</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                           bub_m_src(q,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 0d0</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keyword">                END </span>DO; END DO; END DO; END do</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">s_compute_bubble_source</a></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#acfe552b68c999e11b895e5cfca6a8786">f_cpbw</a>( fR0, fR, fV, fgamma_gas, fpb )</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#acfe552b68c999e11b895e5cfca6a8786">  201</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fR0, fR, fV, fgamma_gas, fpb</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_cpbw</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordflow">IF</span> (polytropic) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                f_cpbw = (ca + 2.d0/web/fr0)*((fr0/fr)**(3.d0*fgamma_gas)) - ca - 4.d0*re_inv*fv/fr - 2.d0/(fr*web)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                f_cpbw = fpb - 1.d0 - 4.d0*re_inv*fv/fr - 2.d0/(fr*web)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#acfe552b68c999e11b895e5cfca6a8786">f_cpbw</a></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#a8f3891f06e63f4c4ee3d749f68bfabd8">f_h</a>( fCpbw, fCpinf, fntait, fBtait )</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a8f3891f06e63f4c4ee3d749f68bfabd8">  221</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fCpbw, fCpinf, fntait, fBtait</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: tmp1,tmp2,tmp3</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_H</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            tmp1 = ( fntait-1.d0 )/fntait</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            tmp2 = (  fcpbw/(1.d0+fbtait)+1.d0 )**tmp1</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            tmp3 = ( fcpinf/(1.d0+fbtait)+1.d0 )**tmp1</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            f_h = ( tmp2 - tmp3 )*fntait*( 1.d0+fbtait )/( fntait-1.d0 )</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#a8f3891f06e63f4c4ee3d749f68bfabd8">f_h</a></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#a5c730e118a27d95c21388bcc2189cc76">f_cgas</a>( fCpinf, fntait, fBtait, fH )</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a5c730e118a27d95c21388bcc2189cc76">  242</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fCpinf, fntait, fBtait, fH</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: tmp </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_cgas </div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">! get sound speed for Gilmore equations &quot;C&quot; -&gt; c_gas</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            tmp = ( fcpinf/(1.d0+fbtait)+1.d0 )**( (fntait-1.d0)/fntait )</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            tmp = fntait*( 1.d0+fbtait )*tmp</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            f_cgas= dsqrt( tmp+(fntait-1.d0)*fh )</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#a5c730e118a27d95c21388bcc2189cc76">f_cgas</a></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#aa55a0894ed331f2e462b83b8df1d265b">f_cpinfdot</a>( fRho, fP, falf, fntait, fBtait, advsrc, divu )</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#aa55a0894ed331f2e462b83b8df1d265b">  266</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fRho, fP, falf, fntait, fBtait, advsrc, divu</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: c2_liquid</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_cpinfdot</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">! get sound speed squared for liquid (only needed for pbdot)</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">! c_l^2 = gam (p+B) / (rho*(1-alf))</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">IF</span> (mpp_lim) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                c2_liquid =  fntait*(fp+fbtait)/frho</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                c2_liquid =  fntait*(fp+fbtait)/(frho*(1.d0-falf))</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="comment">! \dot{Cp_inf} = rho sound^2 (alf_src - divu) </span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            f_cpinfdot = frho*c2_liquid*(advsrc - divu)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#aa55a0894ed331f2e462b83b8df1d265b">f_cpinfdot</a></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#aa7656a8db7cafecfff27383756eacce7">f_hdot</a>( fCpbw, fCpinf, fCpinf_dot, fntait, fBtait, fgamma_gas, fR, fV, fR0, fpbdot )</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#aa7656a8db7cafecfff27383756eacce7">  298</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fCpbw, fCpinf, fCpinf_dot, fntait, fBtait</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fgamma_gas, fR, fV, fR0, fpbdot</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: tmp1, tmp2</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_Hdot</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">IF</span> (polytropic) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                tmp1 = ( fr0/fr )**( 3.d0*fgamma_gas )</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                tmp1 = -3.d0*fgamma_gas*( ca+2d0/web/fr0 )*tmp1*fv/fr</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                tmp1 = fpbdot</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            tmp2 = ( 2.d0/web + 4.d0*re_inv*fv )*fv/(fr**2.d0)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            f_hdot = &amp;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                ( fcpbw /(1.d0+fbtait)+1.d0 )**( -1.d0/fntait )*( tmp1+tmp2 ) &amp;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;              - ( fcpinf/(1.d0+fbtait)+1.d0 )**( -1.d0/fntait )*fcpinf_dot</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="comment">! Hdot = (Cpbw/(1+B) + 1)^(-1/n_tait)*(-3 gam)*(R0/R)^(3gam) V/R</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">!f_Hdot = ((fCpbw/(1d0+fBtait)+1.d0)**(-1.d0/fntait))*(-3.d0)*fgamma_gas * &amp;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment">!            ( (fR0/fR)**(3.d0*fgamma_gas ))*(fV/fR)</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="comment">! Hdot = Hdot - (Cpinf/(1+B) + 1)^(-1/n_tait) Cpinfdot</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">!f_Hdot = f_Hdot - ((fCpinf/(1.d0+fBtait)+1.d0)**(-1.d0/fntait))*fCpinf_dot</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#aa7656a8db7cafecfff27383756eacce7">f_hdot</a></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#a1795309127be53d799a3374ba984498c">f_rddot</a>( fCpbw, fR, fV, fH, fHdot, fcgas, fntait, fBtait )</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a1795309127be53d799a3374ba984498c">  337</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fCpbw, fR, fV, fH, fHdot</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fcgas, fntait, fBtait</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: tmp1, tmp2, tmp3</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_rddot</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            tmp1 = fv/fcgas</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            tmp2 = 1.d0 + 4.d0*re_inv/fcgas/fr*( fcpbw/(1.d0+fbtait)+1.d0 ) &amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        **( -1.d0/fntait )</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            tmp3 = 1.5d0*fv**2d0*( tmp1/3.d0-1.d0 ) + fh*( 1.d0+tmp1 ) &amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                        + fr*fhdot*( 1.d0-tmp1 )/fcgas</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            f_rddot = tmp3/( fr*(1.d0-tmp1)*tmp2 )</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#a1795309127be53d799a3374ba984498c">f_rddot</a></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#a3af121d17dd214c10e2ea5881e124e28">f_cpbw_km</a>( fR0, fR, fV, fgamma_gas, fpb )</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a3af121d17dd214c10e2ea5881e124e28">  362</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fR0, fR, fV, fgamma_gas, fpb</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_cpbw_KM</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">IF</span> (polytropic) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                f_cpbw_km = (ca + 2.d0/web/fr0)*((fr0/fr)**(3.d0*fgamma_gas)) - &amp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    ca - 4.d0*re_inv*fv/fr - 2.d0/(fr*web)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                f_cpbw_km = fpb - 4.d0*re_inv*fv/fr - 2.d0/(fr*web)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#a3af121d17dd214c10e2ea5881e124e28">f_cpbw_km</a></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#a0d72f8fddc9e7423b723b71bd792463e">f_rddot_km</a>( fpbdot, fgamma_gas, fCp, fCpbw, fRho, fR, fV, fR0, fC )</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a0d72f8fddc9e7423b723b71bd792463e">  388</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fpbdot, fgamma_gas, fCp, fCpbw</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fRho, fR, fV, fR0, fC</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: tmp1, tmp2, cdot_star</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>             :: f_rddot_KM</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">IF</span> (polytropic) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                tmp1 = ( fr0/fr )**( 3.d0*fgamma_gas )</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                tmp1 = -3.d0*fgamma_gas*( ca+2d0/web/fr0 )*tmp1*fv/fr</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                tmp1 = fpbdot</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            cdot_star = tmp1 + ( 2.d0/web + 4.d0*re_inv*fv )*fv/(fr**2.d0)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            tmp1 = fv/fc</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            tmp2 =  1.5d0*fv**2d0*( tmp1/3.d0-1.d0 ) +                      &amp;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    (fcpbw - fcp)/frho * (1.d0 - tmp1) +      &amp;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    cdot_star * fr/frho/fc</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                  </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            f_rddot_km = tmp2/( fr*(1.d0-tmp1) + 4.d0*re_inv/(frho*fc) )</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#a0d72f8fddc9e7423b723b71bd792463e">f_rddot_km</a></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__bubbles.html#a784afc585b20a8450d23867931c0b5fc">s_bwproperty</a>( pb, iR0 )</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a784afc585b20a8450d23867931c0b5fc">  416</a></span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: pb</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: iR0 </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: x_vw</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="comment">! mass fraction of vapor</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a> = 1.d0/( 1.d0+r_v/r_n*(pb/pv-1.d0) )</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment">! mole fraction of vapor &amp; thermal conductivity of gas mixture</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            x_vw = m_n*<a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a>/( m_v+(m_n-m_v)*<a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a> )</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <a class="code" href="namespacem__bubbles.html#a1ffd14079710afb89dad86916cbb91fc">k_mw</a> = x_vw*k_v(ir0)/( x_vw+(1.d0-x_vw)*phi_vn ) &amp;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                + ( 1.d0-x_vw )*k_n(ir0)/( x_vw*phi_nv+1.d0-x_vw )</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">! gas mixture density</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <a class="code" href="namespacem__bubbles.html#adeca2bd43645a6f7bcd59c88151eb3bc">rho_mw</a> = pv/( <a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a>*r_v*tw )</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__bubbles.html#a784afc585b20a8450d23867931c0b5fc">s_bwproperty</a></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#ac487d49429a9af0456e14bedbadd0ef0">f_vflux</a>( fR,fV,fmass_v, iR0 )</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#ac487d49429a9af0456e14bedbadd0ef0">  441</a></span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fR</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fV</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fmass_v</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: iR0</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: chi_bar</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: grad_chi</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: f_vflux</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">IF</span> ( thermal==3 ) <span class="keywordflow">THEN</span> <span class="comment">!transfer</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="comment">! constant transfer model</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                chi_bar = fmass_v/( fmass_v+mass_n0(ir0) )</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                grad_chi = -re_trans_c(ir0)*( chi_bar-<a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a> )</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                f_vflux = <a class="code" href="namespacem__bubbles.html#adeca2bd43645a6f7bcd59c88151eb3bc">rho_mw</a>*grad_chi/pe_c/( 1.d0-<a class="code" href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">chi_vw</a> )/fr</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="comment">! polytropic</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                f_vflux = pv*fv/( r_v*tw )</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__bubbles.html#ac487d49429a9af0456e14bedbadd0ef0">f_vflux</a></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__bubbles.html#a8d0c865e6ff2c884cb6b4147d7b58491">f_bpres_dot</a>( fvflux,fR,fV,fpb,fmass_v,iR0 )</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="namespacem__bubbles.html#a8d0c865e6ff2c884cb6b4147d7b58491">  473</a></span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fvflux</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fR</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fV</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fpb</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span>, <span class="keywordtype">INTENT(IN)</span> :: fmass_v</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: iR0</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: T_bar</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: grad_T</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: tmp1, tmp2</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordtype">REAL(KIND(0.D0))</span> :: f_bpres_dot</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">IF</span> ( thermal==3 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                t_bar = tw*( fpb/pb0(ir0) )*( fr/r0(ir0) )**3 &amp;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    * ( mass_n0(ir0)+mass_v0(ir0) )/( mass_n0(ir0)+fmass_v )</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                grad_t = -re_trans_t(ir0)*( t_bar-tw )</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                f_bpres_dot = 3.d0*gamma_m*( -fv*fpb+fvflux*r_v*tw &amp;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                   + pb0(ir0)*<a class="code" href="namespacem__bubbles.html#a1ffd14079710afb89dad86916cbb91fc">k_mw</a>*grad_t/pe_t(ir0)/fr )/fr</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                f_bpres_dot = -3.d0*gamma_m*fv/fr*( fpb-pv )</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keyword">    END FUNCTION </span><a class="code" href="namespacem__bubbles.html#a8d0c865e6ff2c884cb6b4147d7b58491">f_bpres_dot</a></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__bubbles.html">m_bubbles</a></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<div class="ttc" id="namespacem__bubbles_html_a784afc585b20a8450d23867931c0b5fc"><div class="ttname"><a href="namespacem__bubbles.html#a784afc585b20a8450d23867931c0b5fc">m_bubbles::s_bwproperty</a></div><div class="ttdeci">subroutine s_bwproperty(pb, iR0)</div><div class="ttdoc">Subroutine that computes bubble wall properties for vapor bubbles. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00416">m_bubbles.f90:416</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_afaab8f73b4f1cc413ad9ee2c2d32512a"><div class="ttname"><a href="namespacem__bubbles.html#afaab8f73b4f1cc413ad9ee2c2d32512a">m_bubbles::chi_vw</a></div><div class="ttdeci">real(kind(0.d0)) chi_vw</div><div class="ttdoc">Bubble wall properties (Ando 2010) </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00051">m_bubbles.f90:51</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2f790d774fdcc87779b89a71ae3f2674"><div class="ttname"><a href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_abstract_to_mixture_variables), pointer, public s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00158">m_variables_conversion.f90:158</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a0d72f8fddc9e7423b723b71bd792463e"><div class="ttname"><a href="namespacem__bubbles.html#a0d72f8fddc9e7423b723b71bd792463e">m_bubbles::f_rddot_km</a></div><div class="ttdeci">real(kind(0d0)) function f_rddot_km(fpbdot, fgamma_gas, fCp, fCpbw, fRho, fR, fV, fR0, fC)</div><div class="ttdoc">Function that computes the bubble radial acceleration for Keller–Miksis bubbles. ...</div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00388">m_bubbles.f90:388</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00247">m_global_parameters.f90:247</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">The module contains all of the parameters describing the program logistics, the computational domain ...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00040">m_global_parameters.f90:40</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00048">m_derived_types.f90:48</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdoc">Number of eq. bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00282">m_global_parameters.f90:282</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a5c730e118a27d95c21388bcc2189cc76"><div class="ttname"><a href="namespacem__bubbles.html#a5c730e118a27d95c21388bcc2189cc76">m_bubbles::f_cgas</a></div><div class="ttdeci">real(kind(0d0)) function f_cgas(fCpinf, fntait, fBtait, fH)</div><div class="ttdoc">Function that computes the sound speed for the bubble. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00242">m_bubbles.f90:242</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_af5559af46da9282b9cc64db837958f90"><div class="ttname"><a href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">m_bubbles::s_compute_bubble_source</a></div><div class="ttdeci">subroutine s_compute_bubble_source(idir, q_prim_vf, q_cons_vf, mydivu, bub_adv_src, bub_r_src, bub_v_src, bub_p_src, bub_m_src)</div><div class="ttdoc">The purpose of this procedure is to compute the source terms that are needed for the bubble modeling...</div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00070">m_bubbles.f90:70</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_acfe552b68c999e11b895e5cfca6a8786"><div class="ttname"><a href="namespacem__bubbles.html#acfe552b68c999e11b895e5cfca6a8786">m_bubbles::f_cpbw</a></div><div class="ttdeci">real(kind(0d0)) function f_cpbw(fR0, fR, fV, fgamma_gas, fpb)</div><div class="ttdoc">Function that computes that bubble wall pressure for Gilmore bubbles. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00201">m_bubbles.f90:201</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a2ac747380de0e6e5e11b01f4137fb75c"><div class="ttname"><a href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a></div><div class="ttdeci">integer l</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_adeca2bd43645a6f7bcd59c88151eb3bc"><div class="ttname"><a href="namespacem__bubbles.html#adeca2bd43645a6f7bcd59c88151eb3bc">m_bubbles::rho_mw</a></div><div class="ttdeci">real(kind(0.d0)) rho_mw</div><div class="ttdoc">Bubble wall properties (Ando 2010) </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00053">m_bubbles.f90:53</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a1795309127be53d799a3374ba984498c"><div class="ttname"><a href="namespacem__bubbles.html#a1795309127be53d799a3374ba984498c">m_bubbles::f_rddot</a></div><div class="ttdeci">real(kind(0d0)) function f_rddot(fCpbw, fR, fV, fH, fHdot, fcgas, fntait, fBtait)</div><div class="ttdoc">Function that computes the bubble radial acceleration. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00337">m_bubbles.f90:337</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_aa7656a8db7cafecfff27383756eacce7"><div class="ttname"><a href="namespacem__bubbles.html#aa7656a8db7cafecfff27383756eacce7">m_bubbles::f_hdot</a></div><div class="ttdeci">real(kind(0d0)) function f_hdot(fCpbw, fCpinf, fCpinf_dot, fntait, fBtait, fgamma_gas, fR, fV, fR0, fpbdot)</div><div class="ttdoc">Function that computes the time derivative of the enthalpy. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00298">m_bubbles.f90:298</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of fluids in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a8d0c865e6ff2c884cb6b4147d7b58491"><div class="ttname"><a href="namespacem__bubbles.html#a8d0c865e6ff2c884cb6b4147d7b58491">m_bubbles::f_bpres_dot</a></div><div class="ttdeci">real(kind(0.d0)) function f_bpres_dot(fvflux, fR, fV, fpb, fmass_v, iR0)</div><div class="ttdoc">Function that computes the time derivative of the internal bubble pressure. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00473">m_bubbles.f90:473</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acdaa3827df6fee38a3e55e8b13130c27"><div class="ttname"><a href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">m_global_parameters::s_comp_n_from_prim</a></div><div class="ttdeci">subroutine s_comp_n_from_prim(vftmp, Rtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the primitive variables . </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l01072">m_global_parameters.f90:1072</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00191">m_global_parameters.f90:191</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a3af121d17dd214c10e2ea5881e124e28"><div class="ttname"><a href="namespacem__bubbles.html#a3af121d17dd214c10e2ea5881e124e28">m_bubbles::f_cpbw_km</a></div><div class="ttdeci">real(kind(0d0)) function f_cpbw_km(fR0, fR, fV, fgamma_gas, fpb)</div><div class="ttdoc">Function that computes the bubble wall pressure for Keller–Miksis bubbles. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00362">m_bubbles.f90:362</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa5a48fa9cc196136634022cfa6708213"><div class="ttname"><a href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">m_global_parameters::s_quad</a></div><div class="ttdeci">subroutine s_quad(func, mom)</div><div class="ttdoc">Computes the quadrature for polydisperse bubble populations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l01087">m_global_parameters.f90:1087</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_af22c486581933c52df7d4aa306382074"><div class="ttname"><a href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a></div><div class="ttdeci">integer k</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00277">m_global_parameters.f90:277</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aef0de5da0e41de495e9fe67accd62d77"><div class="ttname"><a href="namespacem__global__parameters.html#aef0de5da0e41de495e9fe67accd62d77">m_global_parameters::bubble_model</a></div><div class="ttdeci">integer bubble_model</div><div class="ttdoc">Gilmore or Keller–Miksis bubble model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00293">m_global_parameters.f90:293</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a1ffd14079710afb89dad86916cbb91fc"><div class="ttname"><a href="namespacem__bubbles.html#a1ffd14079710afb89dad86916cbb91fc">m_bubbles::k_mw</a></div><div class="ttdeci">real(kind(0.d0)) k_mw</div><div class="ttdoc">Bubble wall properties (Ando 2010) </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00052">m_bubbles.f90:52</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a19a438a95f2945b7c9e492f2ee983263"><div class="ttname"><a href="m__rhs_8f90.html#a19a438a95f2945b7c9e492f2ee983263">we</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids, num_fluids) we</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03744">m_rhs.f90:3744</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a6c337b82dc4c47f2d3cc57408aa1fc9f"><div class="ttname"><a href="m__rhs_8f90.html#a6c337b82dc4c47f2d3cc57408aa1fc9f">re</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03743">m_rhs.f90:3743</a></div></div>
<div class="ttc" id="namespacem__bubbles_html"><div class="ttname"><a href="namespacem__bubbles.html">m_bubbles</a></div><div class="ttdoc">This module is used to compute the ensemble-averaged bubble dynamic variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00035">m_bubbles.f90:35</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a585a72037bbffe12e8d4512a57f52418"><div class="ttname"><a href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">m_global_parameters::r0</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable r0</div><div class="ttdoc">Bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00288">m_global_parameters.f90:288</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8d670f2f984167bae71b7b3f12d0908a"><div class="ttname"><a href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">m_global_parameters::polytropic</a></div><div class="ttdeci">logical polytropic</div><div class="ttdoc">Polytropic switch. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00291">m_global_parameters.f90:291</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_ac487d49429a9af0456e14bedbadd0ef0"><div class="ttname"><a href="namespacem__bubbles.html#ac487d49429a9af0456e14bedbadd0ef0">m_bubbles::f_vflux</a></div><div class="ttdeci">real(kind(0.d0)) function f_vflux(fR, fV, fmass_v, iR0)</div><div class="ttdoc">Function that computes the vapour flux. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00441">m_bubbles.f90:441</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a21765a90c01d221524670d1344b126cd"><div class="ttname"><a href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">m_global_parameters::pi</a></div><div class="ttdeci">real(kind(0d0)), parameter pi</div><div class="ttdoc">Pi. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00320">m_global_parameters.f90:320</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module features a database of subroutines that allow for the conversion of state variables from ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00047">m_variables_conversion.f90:47</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">The module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_a8f3891f06e63f4c4ee3d749f68bfabd8"><div class="ttname"><a href="namespacem__bubbles.html#a8f3891f06e63f4c4ee3d749f68bfabd8">m_bubbles::f_h</a></div><div class="ttdeci">real(kind(0d0)) function f_h(fCpbw, fCpinf, fntait, fBtait)</div><div class="ttdoc">Function that computes the bubble enthalpy. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00221">m_bubbles.f90:221</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_aa55a0894ed331f2e462b83b8df1d265b"><div class="ttname"><a href="namespacem__bubbles.html#aa55a0894ed331f2e462b83b8df1d265b">m_bubbles::f_cpinfdot</a></div><div class="ttdeci">real(kind(0d0)) function f_cpinfdot(fRho, fP, falf, fntait, fBtait, advsrc, divu)</div><div class="ttdoc">Function that computes the time derivative of the driving pressure. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00266">m_bubbles.f90:266</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_aeadbc0ce9b66517f8fde156199772ec1"><div class="ttname"><a href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a></div><div class="ttdeci">integer j</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cff1091173cf1fe67371edd427ba236f.html">simulation_code</a></li><li class="navelem"><a class="el" href="m__bubbles_8f90.html">m_bubbles.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
