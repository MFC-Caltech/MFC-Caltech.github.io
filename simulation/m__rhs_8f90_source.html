<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Simulation: m_rhs.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Simulation
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__rhs_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_rhs.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__rhs_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespacem__rhs.html">   46</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__rhs.html">m_rhs</a></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>        !&lt; definitions of the derived types</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>    !&lt; definitions of the global parameters</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>            !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a> !&lt; state variables type conversion procedures</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__weno.html">m_weno</a>                 !&lt; weighted and essentially non-oscillatory (weno)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                               <span class="comment">!! schemes for spatial reconstruction of variables</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__riemann__solvers.html">m_riemann_solvers</a>      !&lt; exact and approximate riemann problem solvers</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__cbc.html">m_cbc</a>                  !&lt; characteristic boundary conditions (cbc)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__bubbles.html">m_bubbles</a>              !&lt; bubble dynamic routines</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    </div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__rhs.html#ae6f7edb814859919c5d1f739574155bd">s_initialize_rhs_module</a>, &amp;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                       <a class="code" href="namespacem__rhs.html#a361f0038973069452cc88430c49bcfe8">s_compute_rhs</a>          , &amp;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                       s_pressure_relaxation_procedure, &amp;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                       <a class="code" href="namespacem__rhs.html#a5735aa0dc9d5759c2056a79d4a8c484b">s_populate_variables_buffers</a>, &amp;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                       <a class="code" href="namespacem__rhs.html#a73fc1430500bdd1786b121a9ed08a107">s_finalize_rhs_module</a>, &amp;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                       <a class="code" href="namespacem__rhs.html#ae70cf6ec305a948efab279a0bf802095">s_get_crv</a>, &amp;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                       <a class="code" href="namespacem__rhs.html#aac41721bd3275fb997f51c1afaebac4a">s_get_viscous</a></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    </div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">   80</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    </div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">   85</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">   95</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">   96</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">  103</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">  104</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">  113</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">  114</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">  115</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">  116</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">  124</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">  125</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">  126</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a></div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">  127</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">  128</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a></div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">  129</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">  132</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    </div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">  140</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a></div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">  141</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">  148</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a></div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">  149</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a></div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">  150</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a></div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">  151</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">  152</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">  153</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">  156</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">  166</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a></div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">  167</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">  176</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a></div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">  177</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a></div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">  178</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">  184</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a></div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">  185</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a></div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">  186</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">  187</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">  188</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">  189</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">  192</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a></div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">  193</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">  196</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">  202</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">  203</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">  204</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">  205</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">  210</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a></div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">  211</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">  212</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a></div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">  213</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a></div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">  214</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a></div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">  215</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a></div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">  216</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">  223</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>,<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>,<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">  230</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>,<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">  233</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    </div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">  237</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">  242</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">  243</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>, <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>, <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>, <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a></div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">  244</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>) :: <a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">  251</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>, <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a></div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">  252</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    </div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a32b605d9d7c6a2dd06b13df3beb0b4ce">  257</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1vector__field.html">vector_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__rhs.html#a32b605d9d7c6a2dd06b13df3beb0b4ce">myflux_vf</a>, <a class="code" href="namespacem__rhs.html#affa0b502273a1db4307c4c7d36a088e7">myflux_src_vf</a></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">  258</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>) :: <a class="code" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">alf_sum</a></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a31f27cef4252ee5a36802fd02b3f8ac9">  261</a></span>&#160;    <span class="keywordtype">character(50)</span> :: <a class="code" href="namespacem__rhs.html#a31f27cef4252ee5a36802fd02b3f8ac9">file_path</a></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ae6f7edb814859919c5d1f739574155bd">s_initialize_rhs_module</a>() <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ae6f7edb814859919c5d1f739574155bd">  269</a></span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            </div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">! Configuring Cell-Interior Quadrature Points ======================</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg = 0; <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg = 0; <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg = 0</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a5a340deb003a37dc81b7a560343242b1">commute_err</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg = -1; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg = -1; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg = -1</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end = -<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg; <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end = -<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg; <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end = -<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="comment">! Configuring Cell-Boundary Quadrature Points ======================</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg = 0; <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg = 0</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a9adf65c5de7c360aa44f595f561c87b0">split_err</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg = -1; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg = -1</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end = -<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg; <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end = -<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            </div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="comment">! Configuring Coordinate Direction Indexes =========================</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = 0; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = 0</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            </div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                             <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                             <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .AND. <a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                             <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                             <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            </div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">! Allocation/Association of q_cons_qp and q_prim_qp ================</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                     </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        <span class="keywordflow">IF</span>(i /= 0 .AND. abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                           </div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                            <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                            </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%end</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;       </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                     </div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            </div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">! Allocation/Association of qK_cons_ndqp and qK_prim_ndqp ==========</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a32b605d9d7c6a2dd06b13df3beb0b4ce">myflux_vf</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#affa0b502273a1db4307c4c7d36a088e7">myflux_src_vf</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                   <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">alf_sum</a>%sf( &amp;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                     </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a32b605d9d7c6a2dd06b13df3beb0b4ce">myflux_vf</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#affa0b502273a1db4307c4c7d36a088e7">myflux_src_vf</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            <span class="keywordflow">DO</span> l = 1,<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a32b605d9d7c6a2dd06b13df3beb0b4ce">myflux_vf</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#affa0b502273a1db4307c4c7d36a088e7">myflux_src_vf</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                            <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                              </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                              </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                              </div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%end</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                             </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                              </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                              </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                              </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                <span class="keywordflow">IF</span>( (<a class="code" href="namespacem__global__parameters.html#ab62b8c589dcddff0e6295f4956012c7a">char_decomp</a> .NEQV. .true.) &amp;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                               .AND.            &amp;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                       any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)       ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                        <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%end</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordflow">                                            END DO</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                              </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                               <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                               <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                              </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                           </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                            <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                           </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                            <span class="comment">!DO l = adv_idx%beg, adv_idx%end</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            <span class="comment">!    qL_prim_ndqp(i,j,k)%vf(l)%sf =&gt; &amp;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                            <span class="comment">!    qL_cons_ndqp(i,j,k)%vf(l)%sf</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                            <span class="comment">!    qR_prim_ndqp(i,j,k)%vf(l)%sf =&gt; &amp;</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            <span class="comment">!    qR_cons_ndqp(i,j,k)%vf(l)%sf</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            <span class="comment">!END DO</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end+1    </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                           </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                     </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">! END: Allocation/Association of qK_cons_ndqp and qK_prim_ndqp =====</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment">! Allocation of dq_prim_ds_qp ======================================</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .OR. <a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;               </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                        <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                        <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                        <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                        <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                         </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                            <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                         </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                            <span class="keywordflow">IF</span>(all((/i,j,k/) == 0) .AND. any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                            </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                                             <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                                             <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                                             <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                    <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                                             <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                                             <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                                             <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                            </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                               </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                               </div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                               </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                            </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                         </div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            <span class="keywordflow">IF</span>( (i /= 0 .AND. abs(j) &gt;= abs(k)) &amp;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                              .OR.              &amp;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                   all((/i,j,k/) == 0)       ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                            </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                                    <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                            </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                                    <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                            </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                         </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;               </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="comment">! END: Allocation of dq_prim_ds_qp =================================</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="comment">! Allocation/Association of dqK_prim_ds_ndqp =======================</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                       <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        </div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                            </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                            <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                               </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                  </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                  </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                  </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                                           <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                                           <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        </div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="comment">! END: Allocation/Association of dqK_prim_ds_ndqp ==================</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            </div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="comment">! Allocation of gm_alpha_qp ========================================</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>( <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                  <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                  <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                        </div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                            <span class="keywordflow">IF</span>(any(sum(abs((/i,j,k/))) == (/0,<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>/))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                                                    <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                        </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            </div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="comment">! Allocation of gm_alphaK_ndqp =====================================</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                     <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                     <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                     <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                     <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                        </div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        </div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                            <span class="keywordflow">IF</span> (abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                        </div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            </div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">! Allocation of un_alphaK_s_ndqp ===================================</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;               </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                           <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                      </div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                      </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                        <span class="keywordflow">IF</span> (abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            </div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                            <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(1,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(1,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(2,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                                                         <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                                                         <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                                                         <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(2,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                                                         <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                                                         <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                                                         <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(3,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                                                             <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                                                             <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                                                             <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(3,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                                                             <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                                                             <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                                                             <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;               </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="comment">! END: Allocation of un_alphaK_s_ndqp ==============================</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="comment">! Allocation of kappa_vf ===========================================</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;               </div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;               </div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;               </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            </div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">! Allocation/Association of kappaK_ndqp ============================</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                  <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                  <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                  <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                  <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                        </div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                        </div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                            <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf =&gt; &amp;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(1,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf =&gt; &amp;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(1,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        </div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3805bb400f71c84b76e3111dd595648d">alt_crv</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="comment">! Allocation of dgm_alpha_ds_qp &amp; un_alpha_s_qp ================</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                         <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                         <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                         <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                         <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                         <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                         <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                       <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                       <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                       <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                       <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg:<a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, &amp;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                       <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg:<a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, &amp;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                                       <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg:<a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end ))</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        </div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                <span class="keywordflow">IF</span> (any(sum(abs((/i,j,k/))) == (/0,<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>/))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                                                            <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l))%sf( &amp;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        </div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="comment">! ==============================================================</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    </div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="comment">! Allocation of laplacian_vf and alt_kappa_vf</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3805bb400f71c84b76e3111dd595648d">alt_crv</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a897b4f61353235b3af13bac633d5b9a0">we_src</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    </div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="comment">! Allocation of regularization terms</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>(1:<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>,0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>(1:<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>,0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>(1:<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>,0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>(1:<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>,0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a459b1e7574742f115d5562325c575428">monopole</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>,0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>%sf( &amp;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="comment">! Configuring Coordinate Direction Indexes =========================</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg = -1; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = -1; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = -1</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            </div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            </div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="comment">! Allocation/Association of flux_ndqp, flux_src_ndqp, and flux_gsrc_ndqp ===</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(     1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            </div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <span class="comment">! Allocation of variables for flux limiter</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end))</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    </div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(  1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                            <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(  1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                            <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(  1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                            <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(  1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                            <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(  1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                            <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(  1   :<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, &amp;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg:<a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, &amp;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                            <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg:<a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end ))</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                     </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                        <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                        </div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                        <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                            <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                              </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                                              <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                              </div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf(     &amp;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,     &amp;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,     &amp;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                            </div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(       &amp;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                                                   <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,   &amp;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                                                   <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,   &amp;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                                                   <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                                                 <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                    <span class="comment">!IF ( (num_fluids &gt; 1) .AND. (bubbles .NEQV. .TRUE.)) THEN</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                    <span class="comment">!END IF</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                              </div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                              </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                              </div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                     </div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                        </div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                            <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                            <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    </div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                            <span class="keywordflow">IF</span> (abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                <span class="keywordflow">IF</span> (i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                                                <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                                                     <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    </div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                    <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    </div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( &amp;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( &amp;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                                                                          <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf( &amp;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end, &amp;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end, &amp;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                                                        <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end ))</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                            <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                            <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                            <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                            <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                        <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                        <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                       <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                       <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                       <a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf =&gt; &amp;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                       <a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(1,j,k)%vf(l)%sf</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="comment">! END: Allocation/Association of flux_ndqp, flux_src_ndqp, and flux_gsrc_ndqp ===</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            </div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            </div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment">! Associating procedural pointer to the subroutine that will be</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <span class="comment">! utilized to calculate the solution of a given Riemann problem</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">s_hll_riemann_solver</a></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">s_hllc_riemann_solver</a></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">s_exact_riemann_solver</a></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            </div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            <span class="comment">! Associating the procedural pointer to the appropriate subroutine</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            <span class="comment">! that will be utilized in the conversion to the mixture variables</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span>          <span class="comment">! Volume fraction for bubbles</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a> </div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            </div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ae6f7edb814859919c5d1f739574155bd">s_initialize_rhs_module</a> <span class="comment">! -------------------------------</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        </div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        </div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        </div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a361f0038973069452cc88430c49bcfe8">s_compute_rhs</a>(q_cons_vf, q_prim_vf, rhs_vf, t_step) <span class="comment">! -------</span></div><div class="line"><a name="l01396"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a361f0038973069452cc88430c49bcfe8"> 1396</a></span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_prim_vf</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: rhs_vf</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: top, bottom</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            </div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(0:m,0:n,0:p)</span> :: blkmod1, blkmod2, alpha1, alpha2, Kterm</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            </div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            </div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            </div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="comment">! Configuring Coordinate Direction Indexes =========================</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = 0; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = 0</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            </div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            </div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          </div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            </div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="comment">! Association/Population of Working Variables ======================</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf =&gt; q_cons_vf(i)%sf</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(i)%sf =&gt; q_prim_vf(i)%sf</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            </div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a2647dbdf6b09315564ef060e1f49df0d">s_populate_conservative_variables_buffers</a>()</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;           </div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            <span class="keywordflow">IF</span>((<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .OR. <a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf = 1d0</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                </div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf = &amp;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf - &amp;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="comment">!adjust volume fractions, according to modeled gas void fraction</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                <a class="code" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">alf_sum</a>%sf = 0d0</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end - 1</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                    <a class="code" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">alf_sum</a>%sf = <a class="code" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">alf_sum</a>%sf + q_cons_vf(i)%sf</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                    q_cons_vf(i)%sf = q_cons_vf(i)%sf * (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf) &amp;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                            / <a class="code" href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">alf_sum</a>%sf</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="comment">! Computing Volume Fraction Gradients and Curvatures ===============</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#ad367bbe26f93b9fd058c58ec11337fdf">lsq_deriv</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">s_compute_lsq_gradient_curvature</a>(  <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>)</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">s_compute_lsq_gradient_curvature</a>(  <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>)</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  </div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a> &gt; 0) <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ae70cf6ec305a948efab279a0bf802095">s_get_crv</a>(q_cons_vf,q_prim_vf,rhs_vf)</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="comment">! Converting Conservative to Primitive Variables ===================</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = 1; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            </div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;           </div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordflow">IF</span>( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .OR. <a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3)  &amp;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                           .AND.           &amp;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.) &amp;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                           .AND.           &amp;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a5a340deb003a37dc81b7a560343242b1">commute_err</a>        ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                            </div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                            <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end)%sf = 1d0</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        </div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end)%sf = &amp;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end)%sf - &amp;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                        </div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            <span class="comment">!convert conservative variables to primative </span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="comment">!   (except first and last, \alpha \rho and \alpha)</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="comment">!we do this, though there is no actual loop, just (0,0,0)</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">s_convert_conservative_to_primitive_variables</a>( &amp;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                                                                  <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a> </div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;           </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ab3b720ac99f76621fd7086da9405490f">s_average_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>)</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;           </div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="keywordflow">IF</span>(t_step == <a class="code" href="namespacem__global__parameters.html#aff1140575af25247060f3e7f31a8a10f">t_step_stop</a>) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="comment">! Computing Velocity Gradients =====================================</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aac41721bd3275fb997f51c1afaebac4a">s_get_viscous</a>(q_cons_vf,q_prim_vf,rhs_vf)</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            </div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="comment">! Dimensional Splitting Loop =======================================</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;               </div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                <span class="comment">! Configuring Coordinate Direction Indexes ======================</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = 0; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = 0</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                </div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                </div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                </div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                <span class="comment">! Reconstructing Primitive/Conservative Variables ===============</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab62b8c589dcddff0e6295f4956012c7a">char_decomp</a> .OR. (all(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> == 0) .AND. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> == 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                   </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = 1;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>  </div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end+1</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                        </div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                    <span class="comment">!reconstruct either primative or conservative vars </span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                   <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                                                         <a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a>, i  )</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                                   <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                                         <a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a>, i  )</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;               </div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                <span class="comment">! Reconstructing Continuity Variables ===========================</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 2 .OR. all(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> == 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                     </div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                     </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                                   <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                     </div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;               </div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;               <span class="comment">! Reconstructing Momentum/Velocity Variables ====================</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    <span class="keywordflow">IF</span>(all(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> == 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                     </div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                     </div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(      &amp;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                                      <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                                                             <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(      &amp;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                      <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                                                             <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                     </div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;               </div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;               <span class="comment">! Reconstructing Partial or Mixture Energy/Pressure Variables ===</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                  </div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                   <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                   <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;              </div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;               <span class="comment">! Reconstructing Volume Fraction Variables ======================</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                     </div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                     </div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                                   <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                     </div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                     </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                            <span class="keywordflow">IF</span>(all(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a> /= l - <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                           </div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                                <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = l; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                                </div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(    &amp;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                                                               <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                           </div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                     </div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                <span class="keywordflow">IF</span>((<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .OR. <a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                        </div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                            <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf = 1d0</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                            <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf = 1d0</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                            </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                               </div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                                <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf = &amp;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                                <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf - &amp;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                                <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf </div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                                </div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                                <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf = &amp;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                                <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>)%sf - &amp;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                                <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                        </div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;               <span class="comment">! END: Reconstructing Volume Fraction Variables =================</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;               </div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;               <span class="comment">! Converting Conservative to Primitive Variables ================</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">weno_vars</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">s_convert_conservative_to_primitive_variables</a>( &amp;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">s_convert_conservative_to_primitive_variables</a>( &amp;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                </div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                <span class="comment">! Reconstructing First-Order Spatial Derivatives of Velocity ====</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3c3cd38abc3ece085bab77788afece73">weno_re_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(         &amp;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                                 <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                                                            <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                   </div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                           </div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(         &amp;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                                     <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                                                <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(         &amp;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                                         <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                                                                   <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                   </div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;               </div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;               <span class="comment">! Reconstructing Curvatures =====================================</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                  </div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(l); <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3805bb400f71c84b76e3111dd595648d">alt_crv</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                              <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(   &amp;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                                <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                                            <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i  )</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(    &amp;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                                    <a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),    &amp;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                                                <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                                <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>, i )</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                  </div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;               </div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;               <span class="comment">! Configuring Coordinate Direction Indexes ======================</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg = -1; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg =  0; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg =  0</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                <span class="keywordflow">ELSEIF</span>(i == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg =  0; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg = -1; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg =  0</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                    <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg =  0; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg =  0; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg = -1</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                </div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>; <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                    <span class="comment">! Compute Riemann solver flux and source flux </span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a>(      <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                                                    i, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a> )</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            </div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a>(      <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                                                       <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>, &amp;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(j,k,l)%vf, &amp;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                                                       <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>, &amp;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                                            <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                                         <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,k,l)%vf, &amp;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,k,l)%vf, &amp;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                                                    <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,k,l)%vf, &amp;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                                                                     i, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a> )</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                    <span class="comment">! Computing Riemann Solver Flux and Source Flux =================</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a>(     <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                                                        <a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                                                          <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                                                      <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf, &amp;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                                                                  i, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                  </div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = 1; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;       </div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,:,:))</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                   </div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                   </div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> /= 1) <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                   </div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,:,:))</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,:,:))</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                   <span class="comment">! ===============================================================</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                    <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                        <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                            <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                                blkmod1(j,k,l) = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma+1d0)*<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) + &amp;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                                blkmod2(j,k,l) = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma+1d0)*<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) + &amp;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                                alpha1(j,k,l) = <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l)</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                                </div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                                    alpha2(j,k,l) = <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>-1)%sf(j,k,l)</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                                    alpha2(j,k,l) = <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end)%sf(j,k,l)</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                                </div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                                kterm(j,k,l) = alpha1(j,k,l)*alpha2(j,k,l)*(blkmod2(j,k,l)-blkmod1(j,k,l)) / &amp;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                                                (alpha1(j,k,l)*blkmod2(j,k,l) + alpha2(j,k,l)*blkmod1(j,k,l))</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                <span class="comment">! RHS Contribution in x-direction ===============================</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                  </div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    <span class="comment">! Compute upwind slope and flux limiter function value if TVD</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                    <span class="comment">! flux limiter is chosen</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470">s_get_tvd_flux</a>(q_cons_vf, q_prim_vf, rhs_vf,i)</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                    <span class="comment">! Applying characteristic boundary conditions</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf, &amp;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf, i, -1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                    </div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf, &amp;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf, i,  1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            </div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                    <span class="comment">! Applying the Riemann fluxes</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                        <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                            rhs_vf(j)%sf(k,:,:) = 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                            ( <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                            - <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    </div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                    <span class="comment">! Applying source terms to the RHS of the advection equations</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                                rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                                rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                                <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                                <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                                    <span class="comment">!adv_idx%end, -k div(u)</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                                        rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                                        rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                        (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) - kterm(k,:,:)) * &amp;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg) .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                                    <span class="comment">!adv_idx%beg, +k div(u)</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                                        rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                                        rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                                        (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) + kterm(k,:,:)) * &amp;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                                    <span class="comment">!liquid part, +k div(u)</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                                        rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                                        rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                                        (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) + kterm(k,:,:)) * &amp;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>-1) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                                    <span class="comment">!resolved gas, -k div(u)</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                                        rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                                        rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                                        (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) - kterm(k,:,:)) * &amp;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                                    <span class="comment">!bubble part, no k div(u)</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                                        rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                                        rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="keywordflow">                              END IF</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                                <span class="comment">!no k \div u, just adds other part of the transport equation</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                                    rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                                        rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe">s_get_divergence</a>(i,q_prim_vf,<a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>)</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">s_compute_bubble_source</a>(i,q_prim_vf,q_cons_vf,<a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>, &amp;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                                <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>, <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>, <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>, <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>, <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>)</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                        </div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                                              rhs_vf( <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> )%sf(:,:,:) = rhs_vf( <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> )%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(:,:,:)</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                        <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt;1 )  rhs_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(:,:,:) - <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(:,:,:)</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                        <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                            rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>(k,:,:,:)</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                            rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>(k,:,:,:)</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>(k,:,:,:)</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>(k,:,:,:)</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="keywordflow">                   END IF</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                   <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a459b1e7574742f115d5562325c575428">monopole</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                        <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a> = 0d0; <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a> = 0d0; <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a> = 0d0;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                        <span class="keywordflow">DO</span> j = 1,<a class="code" href="namespacem__global__parameters.html#a987e51cca357206f1e35d38a1cb7e5e6">num_mono</a></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1">s_get_monopole</a>(i,q_prim_vf,t_step,<a class="code" href="namespacem__global__parameters.html#ac91cb1bc506e2e71e46001986a7232b4">mono</a>(j))</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                            rhs_vf(k)%sf(:,:,:) = rhs_vf(k)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>(:,:,:)</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                            rhs_vf(k)%sf(:,:,:) = rhs_vf(k)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(k-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end,:,:,:)</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a>(:,:,:)</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                    <span class="comment">! Applying source terms to the RHS of the internal energy equations</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                        <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                                rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(k,:,:) = &amp;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                                    rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(k,:,:) - 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                                    (<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) - &amp;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                    <span class="comment">! Applying the viscous and capillary source fluxes from the Riemann solver</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                                rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                                rhs_vf(j)%sf(k,:,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(k) * &amp;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf( k ,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                    <span class="comment">! Applying the capillary stress tensor calculated outside the Riemann solver</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(i, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf)</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(i, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf)</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                        <span class="comment">! Divergence of capillary stress tensor computed using finite differences</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                rhs_vf(j)%sf(k,:,:) = &amp;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                                rhs_vf(j)%sf(k,:,:) - 1d0/(<a class="code" href="namespacem__global__parameters.html#aea5b911d65b330f65e97052e9e8c0383">x_cc</a>(k+1) - <a class="code" href="namespacem__global__parameters.html#aea5b911d65b330f65e97052e9e8c0383">x_cc</a>(k-1)) * &amp;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(k+1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                - <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(k-1,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                    <span class="comment">! Applying capillary source terms in momentum and energy equations</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a897b4f61353235b3af13bac633d5b9a0">we_src</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda">s_compute_capillary_source</a>(i,q_prim_vf)</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(:,:,:)</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(:,:,:)</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                    </div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                    </div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;               </div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;               <span class="comment">! RHS Contribution in y-direction ===============================</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                <span class="keywordflow">ELSEIF</span>(i == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                    <span class="comment">! Compute upwind slope and flux limiter function value if TVD</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                    <span class="comment">! flux limiter is chosen</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                    </div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470">s_get_tvd_flux</a>(q_cons_vf, q_prim_vf, rhs_vf,i)</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                    <span class="comment">! Applying characteristic boundary conditions</span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg &lt;= -5 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg /= -13) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf, &amp;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf, i, -1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                    </div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf, &amp;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf, i,  1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                    <span class="comment">! Applying the Riemann fluxes</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                    <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                        <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                            rhs_vf(j)%sf(:,k,:) = &amp; </div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                            rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                            ( <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                            - <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                    <span class="comment">! Applying source terms to the RHS of the advection equations</span></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                                rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                                rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                                <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                                    <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                                        <span class="comment">!liquid part, +k div(u)</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                                            rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                                            (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) + kterm(:,k,:)) * &amp;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                                            - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>-1) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                                        <span class="comment">!resolved gas, -k div(u)</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                                            rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                                            (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) - kterm(:,k,:)) * &amp;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                                            - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                                        <span class="comment">!bubble part, no k div(u)</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                            rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                                            - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                                            rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                                            (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) - kterm(:,k,:)) * &amp;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                            - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                                            rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                                                rhs_vf(j)%sf(:,k,:) - kterm(:,k,:)/2d0/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) * &amp;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                                                + <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                                            rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                                            (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) + kterm(:,k,:)) * &amp;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                                              - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                                            rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                                                rhs_vf(j)%sf(:,k,:) + kterm(:,k,:)/2d0/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) * &amp;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                                                + <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                    rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                                        rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe">s_get_divergence</a>(i,q_prim_vf,<a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>)</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">s_compute_bubble_source</a>(i,q_prim_vf,q_cons_vf,<a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>, &amp;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                                <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>, <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>, <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>, <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>, <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>)</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                                              rhs_vf( <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> )%sf(:,:,:) = rhs_vf( <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> )%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(:,:,:)</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                        <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 1)  rhs_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(:,:,:) - <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(:,:,:)</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                        <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                            rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>(k,:,:,:)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                            rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>(k,:,:,:)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>(k,:,:,:)</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>(k,:,:,:)</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a459b1e7574742f115d5562325c575428">monopole</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                        <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a> = 0d0; <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a> = 0d0; <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a> = 0d0;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                        </div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                        <span class="keywordflow">DO</span> j = 1,<a class="code" href="namespacem__global__parameters.html#a987e51cca357206f1e35d38a1cb7e5e6">num_mono</a></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1">s_get_monopole</a>(i,q_prim_vf,t_step,<a class="code" href="namespacem__global__parameters.html#ac91cb1bc506e2e71e46001986a7232b4">mono</a>(j))</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                        </div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                            rhs_vf(k)%sf(:,:,:) = rhs_vf(k)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>(:,:,:)</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                        </div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                            rhs_vf(k)%sf(:,:,:) = rhs_vf(k)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(k-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end,:,:,:)</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a>(:,:,:)</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                    <span class="comment">! Applying source terms to the RHS of the internal energy equations</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                        <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                                rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                                    rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(:,k,:) - 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                                    (<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) - &amp;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                        <span class="comment">! Applying the additional geometrical inviscid Riemann </span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        <span class="comment">! source fluxes for the internal energy equations</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                        <span class="comment">! using the average of velocities at cell boundaries</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                            <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                                    rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                                        rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(:,k,:) - 5d-1/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) * &amp;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                                        <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) * &amp;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                                        (<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) + &amp;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                                        <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)) </div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                    <span class="comment">! Applying the geometrical inviscid Riemann source fluxes calculated as average</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                    <span class="comment">! of values at cell boundaries</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                        <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                rhs_vf(j)%sf(:,k,:) = &amp; </div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                                rhs_vf(j)%sf(:,k,:) - 5d-1/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) * &amp;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                                + <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                    <span class="comment">! Applying the viscous and capillary source fluxes from the Riemann solver</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a> .AND. ((<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -2) .OR. (<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -13))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a2da1b596b26740b8edff160297676447">s_compute_viscous_stress_tensor</a>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end) )</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                                <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a2da1b596b26740b8edff160297676447">s_compute_viscous_stress_tensor</a>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end) )</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                                <span class="keywordflow">DO</span> k = 1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                                    rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                                    rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                                    ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                                    - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                                rhs_vf(j)%sf(:,0,:) = &amp;</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                                rhs_vf(j)%sf(:,0,:) + 1d0/(<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(1) - <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(-1)) * &amp;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                                - <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, 1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                                    rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                                    rhs_vf(j)%sf(:,k,:) + 1d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k) * &amp;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                                    ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                                    - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                        <span class="comment">! Applying the geometrical viscous Riemann source fluxes calculated as average</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                        <span class="comment">! of values at cell boundaries</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                                <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -2) .OR. (<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -13)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                                    <span class="keywordflow">DO</span> k = 1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                                        rhs_vf(j)%sf(:,k,:) - 5d-1/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) * &amp;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                                        + <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                                    rhs_vf(j)%sf(:,0,:) = &amp;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                                    rhs_vf(j)%sf(:,0,:) - 1d0/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(0) * &amp;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                                        rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                                        rhs_vf(j)%sf(:,k,:) - 5d-1/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) * &amp;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                                        + <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, k ,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                    <span class="comment">! Applying the capillary stress tensor calculated outside the Riemann solver</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(i, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf)</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                        <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(i, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                        <span class="comment">! Divergence of capillary stress tensor computed using finite differences</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                                rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                                rhs_vf(j)%sf(:,k,:) - 1d0/(<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k+1) - <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k-1)) * &amp;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k+1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) &amp;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                                - <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k-1,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                        <span class="comment">! Applying the capillary contribution to geometric source term</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                                    rhs_vf(j)%sf(:,k,:) = &amp;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                                    rhs_vf(j)%sf(:,k,:) - <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,k,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                    </div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                    <span class="comment">! Applying capillary source terms in momentum and energy equations</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a897b4f61353235b3af13bac633d5b9a0">we_src</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda">s_compute_capillary_source</a>(i,q_prim_vf)</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(:,:,:)</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(:,:,:)</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                    <span class="comment">! Applying interface sharpening regularization source terms</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a> .AND. <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aa1cd3a5b83eabb0344ecae0cf321ca87">s_compute_regularization_source</a>(i,q_prim_vf)</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                            rhs_vf(j)%sf(:,:,:) = rhs_vf(j)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(j)%sf(:,:,:)</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;               </div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;               <span class="comment">! RHS Contribution in z-direction ===============================</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                    <span class="comment">! Compute upwind slope and flux limiter function value if TVD</span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                    <span class="comment">! flux limiter is chosen</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">tvd_rhs_flux</a>) <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470">s_get_tvd_flux</a>(q_cons_vf, q_prim_vf, rhs_vf,i)</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                    <span class="comment">! Applying characteristic boundary conditions</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf, &amp;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf, i, -1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                    </div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf, &amp;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf, i,  1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>  )</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                    </div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                    <span class="comment">! Applying the Riemann fluxes</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                    <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                            <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                                    rhs_vf(j)%sf(:,l,k) = &amp; </div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                                    rhs_vf(j)%sf(:,l,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                                    ( <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) &amp;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                                    - <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l, k ) )</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                                rhs_vf(j)%sf(:,:,k) = &amp; </div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                                rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) &amp;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                                - <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) )</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                    <span class="comment">! Applying source terms to the RHS of the advection equations</span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                                <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                                        rhs_vf(j)%sf(:,l,k) = &amp;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                                        rhs_vf(j)%sf(:,l,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                                        <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k) * &amp;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) &amp;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l, k ) )</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                                    rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                                    rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) * &amp;</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                                    ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) &amp;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                                    - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) )</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                                <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                                                rhs_vf(j)%sf(:,l,k) = &amp;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                                                rhs_vf(j)%sf(:,l,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                                                (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k) - kterm(:,l,k)) * &amp;</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l, k ) &amp;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) )</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                                                rhs_vf(j)%sf(:,l,k) = &amp;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                                                rhs_vf(j)%sf(:,l,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                                                (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k) + kterm(:,l,k)) * &amp;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l, k ) &amp;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) )</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="keywordflow">                                            END IF</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                                            rhs_vf(j)%sf(:,l,k) = &amp;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                                            rhs_vf(j)%sf(:,l,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k) * &amp;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l, k ) &amp;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                                            - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) )</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                                        <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                                            <span class="comment">!liquid part, +k div(u)</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                                            rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                                               rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                                               (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) + kterm(:,:,k)) * &amp;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) &amp;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) )</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>-1) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                                            <span class="comment">!resolved gas, -k div(u)</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                                            rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                                                rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                                                (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) - kterm(:,:,k)) * &amp;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) &amp;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) )</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. (j == <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                                            <span class="comment">!bubble part, no k div(u)</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                                            rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                                                rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) * &amp;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) &amp;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) )</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .AND. j == <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                                            rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                                               rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                                               (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) - kterm(:,:,k)) * &amp;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) &amp;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) )</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                                            rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                                                rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                                                (<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) + kterm(:,:,k)) * &amp;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) &amp;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) )</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                                        rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                                            rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) * &amp;</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                                            ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) &amp;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                                            - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) ) </div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                    </div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe">s_get_divergence</a>(i,q_prim_vf,<a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>)</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">s_compute_bubble_source</a>(i,q_prim_vf,q_cons_vf,<a class="code" href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">divu</a>, &amp;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                                <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>, <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>, <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>, <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>, <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>)</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                                              rhs_vf( <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> )%sf(:,:,:) = rhs_vf( <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> )%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(:,:,:)</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                        <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 1)  rhs_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(:,:,:) - <a class="code" href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">bub_adv_src</a>(:,:,:)</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                        <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                            rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">bub_r_src</a>(k,:,:,:)</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                            rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">bub_v_src</a>(k,:,:,:)</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">bub_p_src</a>(k,:,:,:)</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(k))%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(k))%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">bub_m_src</a>(k,:,:,:)</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="keywordflow">                    END IF</span> </div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a459b1e7574742f115d5562325c575428">monopole</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                        <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a> = 0d0; <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a> = 0d0; <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a> = 0d0;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                        <span class="keywordflow">DO</span> j = 1,<a class="code" href="namespacem__global__parameters.html#a987e51cca357206f1e35d38a1cb7e5e6">num_mono</a></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1">s_get_monopole</a>(i,q_prim_vf,t_step,<a class="code" href="namespacem__global__parameters.html#ac91cb1bc506e2e71e46001986a7232b4">mono</a>(j))</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                            rhs_vf(k)%sf(:,:,:) = rhs_vf(k)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>(:,:,:)</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                            rhs_vf(k)%sf(:,:,:) = rhs_vf(k)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(k-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end,:,:,:)</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a>(:,:,:)</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                    <span class="comment">! Applying source terms to the RHS of the internal energy equations</span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                        <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                                rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                                    rhs_vf(j+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(:,:,k) - 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(j+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) * &amp;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k) * &amp;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                                    (<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) - &amp;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1))</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                    <span class="comment">! Applying the geometrical inviscid Riemann source fluxes calculated as average</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                    <span class="comment">! of values at cell boundaries</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                        <span class="keywordflow">DO</span> j = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                            <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                                    rhs_vf(j)%sf(:,l,k) = &amp; </div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                                    rhs_vf(j)%sf(:,l,k) - 5d-1/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                                    ( <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) &amp;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                                    + <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l, k ) )</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                    <span class="comment">! Applying the viscous and capillary source fluxes from the Riemann solver</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                                rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                                rhs_vf(j)%sf(:,:,k) + 1d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(k) * &amp;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) &amp;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                                - <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) )</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                        <span class="comment">! Modifying momentum components of geometric source term</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(:,:,k) + 5d-1 * &amp;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) &amp;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                                + <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) )</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                        </div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                                rhs_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(:,:,k) - 5d-1 * &amp;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                                ( <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) &amp;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                                + <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, k ) )</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                    </div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    <span class="comment">! Applying the capillary stress tensor calculated outside the Riemann solver</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(i, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf)</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                        <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(i, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf, &amp;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                                            <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                                                                      <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf)</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                        <span class="comment">! Divergence of capillary stress tensor computed using finite differences</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                                <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                                    <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                                        rhs_vf(j)%sf(:,l,k) = &amp;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                                        rhs_vf(j)%sf(:,l,k) - 1d0/(<a class="code" href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">z_cc</a>(k+1) - <a class="code" href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">z_cc</a>(k-1))/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(l) * &amp;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                                        ( <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k+1) &amp;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                                        - <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,l,k-1) )</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                                    rhs_vf(j)%sf(:,:,k) = &amp;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                                    rhs_vf(j)%sf(:,:,k) - 1d0/(<a class="code" href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">z_cc</a>(k+1) - <a class="code" href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">z_cc</a>(k-1)) * &amp;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                    ( <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k+1) &amp;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                                    - <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(j)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,k-1) )</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                    </div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                    <span class="comment">! Applying capillary source terms in momentum and energy equations</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a897b4f61353235b3af13bac633d5b9a0">we_src</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda">s_compute_capillary_source</a>(i,q_prim_vf)</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(:,:,:)</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                        rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) = rhs_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(:,:,:)</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                  </div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                    <span class="comment">! Applying interface sharpening regularization source terms</span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a> .AND. <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aa1cd3a5b83eabb0344ecae0cf321ca87">s_compute_regularization_source</a>(i,q_prim_vf)</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                            rhs_vf(j)%sf(:,:,:) = rhs_vf(j)%sf(:,:,:) + <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(j)%sf(:,:,:)</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;               <span class="comment">! ===============================================================</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;               </div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            <span class="comment">! END: Dimensional Splitting Loop ==================================</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;           </div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            </div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            <span class="comment">! Disassociation of Working Variables ==============================</span></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(i)%sf)</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            </div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            </div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a361f0038973069452cc88430c49bcfe8">s_compute_rhs</a> <span class="comment">! -----------------------------------------</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        </div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        </div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        </div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aa8bc1b17f230cbd06b702f34bd199ef1">s_compute_flux_lim</a>(top,bottom,flux_lim_func) <span class="comment">! ---------------</span></div><div class="line"><a name="l02665"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aa8bc1b17f230cbd06b702f34bd199ef1"> 2665</a></span>&#160;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(INOUT)</span> :: top, bottom</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: slope</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: flux_lim_func</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;            <span class="comment">! Limit the flux limiter to be applied only where the change in</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            <span class="comment">! volume fraction is greater than machine precision so that insignificant</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            <span class="comment">! fluctuations do not trip the limiter</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            <span class="keywordflow">IF</span> (abs(top) &lt; 1d-8) top = 0d0</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            <span class="keywordflow">IF</span> (abs(bottom) &lt; 1d-8) bottom = 0d0</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            <span class="comment">! If top = bottom, then cell is in a smooth region of the flow</span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="comment">! and the high order flux should be used. Also ensures that areas</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            <span class="comment">! of no change in volume fraction (0/0) use the high order flux</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            <span class="keywordflow">IF</span> (top == bottom) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                slope = 1d0</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                slope = (top*bottom)/max(bottom**2d0,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="comment">! Flux limiter function</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 1) <span class="keywordflow">THEN</span> <span class="comment">! MINMOD (MM)</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                flux_lim_func = max(0d0,min(1d0,slope))</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 2) <span class="keywordflow">THEN</span> <span class="comment">! MUSCL (MC)</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                flux_lim_func = max(0d0,min(2d0*slope,5d-1*(1d0+slope),2d0))</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 3) <span class="keywordflow">THEN</span> <span class="comment">! OSPRE (OP)</span></div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                flux_lim_func = (15d-1*(slope**2d0+slope))/(slope**2d0+slope+1d0)</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 4) <span class="keywordflow">THEN</span> <span class="comment">! SUPERBEE (SB)</span></div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                flux_lim_func = max(0d0,min(1d0,2d0*slope),min(slope,2d0))</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 5) <span class="keywordflow">THEN</span> <span class="comment">! SWEBY (SW) (beta = 1.5)</span></div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                flux_lim_func = max(0d0,min(15d-1*slope,1d0),min(slope,15d-1))</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 6) <span class="keywordflow">THEN</span> <span class="comment">! VAN ALBADA (VA)</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                flux_lim_func = (slope**2d0+slope)/(slope**2d0+1d0)</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 7) <span class="keywordflow">THEN</span> <span class="comment">! VAN LEER (VL)</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                flux_lim_func = (abs(slope) + slope)/(1d0 + abs(slope))</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aa8bc1b17f230cbd06b702f34bd199ef1">s_compute_flux_lim</a> <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a2da1b596b26740b8edff160297676447">s_compute_viscous_stress_tensor</a>(q_prim_vf,grad_x_vf,grad_y_vf,grad_z_vf) <span class="comment">! ---</span></div><div class="line"><a name="l02715"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a2da1b596b26740b8edff160297676447"> 2715</a></span>&#160;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(num_dims)</span>, <span class="keywordtype">INTENT(IN)</span> :: grad_x_vf, grad_y_vf, grad_z_vf</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho_visc, gamma_visc, pi_inf_visc</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: Re_visc</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(1:num_fluids,1:num_fluids)</span> :: We_visc</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims,num_dims)</span> :: tau_Re</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: ix,iy,iz</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            </div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            ix%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iy%beg = 0; iz%beg = 0</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) iy%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) iz%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            ix%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - ix%beg; iy%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - iy%beg; iz%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - iz%beg</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(i)%sf = 0d0</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>    <span class="comment">! Shear stresses</span></div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                    <span class="keywordflow">DO</span> k = -1, 1</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                        <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(    q_prim_vf, rho_visc, &amp;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                                                                gamma_visc, pi_inf_visc, &amp;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                                                                re_visc, we_visc, j,k,l  )</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                            tau_re(2,1) = (grad_y_vf(1)%sf(j,k,l) + &amp;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                                           grad_x_vf(2)%sf(j,k,l))/ &amp;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                                               re_visc(1)</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                            tau_re(2,2) = ( 4d0*grad_y_vf(2)%sf(j,k,l) &amp;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                                          - 2d0*grad_x_vf(1)%sf(j,k,l) &amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                                          - 2d0*q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) ) / &amp;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                                          ( 3d0*re_visc(1) )</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                            <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                                tau_re(2,i)</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                                q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) * tau_re(2,i)</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>    <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                    <span class="keywordflow">DO</span> k = -1, 1</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                        <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(    q_prim_vf, rho_visc, &amp;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                                                                gamma_visc, pi_inf_visc, &amp;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                                                                re_visc, we_visc, j,k,l  )</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                            tau_re(2,2) = (grad_x_vf(1)%sf(j,k,l) + &amp;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                                           grad_y_vf(2)%sf(j,k,l) + &amp;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                                           q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) ) / &amp;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                                           re_visc(2)</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                            tau_re(2,2)</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                            q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) * tau_re(2,2)</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>    <span class="comment">! Shear stresses</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                    <span class="keywordflow">DO</span> k = -1, 1</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                        <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(    q_prim_vf, rho_visc, &amp;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                                                                gamma_visc, pi_inf_visc, &amp;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                                                                re_visc, we_visc, j,k,l  )</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                            tau_re(2,2) = -(2d0/3d0)*grad_z_vf(3)%sf(j,k,l) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) / &amp;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                                          re_visc(1)</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                            tau_re(2,3) = ((grad_z_vf(2)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                                          q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l)) / &amp;</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) + grad_y_vf(3)%sf(j,k,l) ) / &amp;</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                                          re_visc(1)</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                            <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                                tau_re(2,i)</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                                q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) * tau_re(2,i)</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>    <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                    <span class="keywordflow">DO</span> k = -1, 1</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                        <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                            tau_re(2,2) = grad_z_vf(3)%sf(j,k,l) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) / &amp;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                                          re_visc(2)</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                            tau_re(2,2)</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                            <a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                            q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) * tau_re(2,2)</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a2da1b596b26740b8edff160297676447">s_compute_viscous_stress_tensor</a> <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a>(norm_dir,q_prim_vf,grad_x_vf,grad_y_vf,grad_z_vf,norm_vf) <span class="comment">! -------</span></div><div class="line"><a name="l02870"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9"> 2870</a></span>&#160;            </div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(num_fluids)</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_vf, grad_x_vf, grad_y_vf, grad_z_vf</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho_cap, gamma_cap, pi_inf_cap</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: Re_cap</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(1:num_fluids,1:num_fluids)</span> :: We_cap</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims,num_dims)</span> :: tau_We</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: ix,iy,iz</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;            ix%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iy%beg = 0; iz%beg = 0</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) iy%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) iz%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;            ix%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - ix%beg; iy%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - iy%beg; iz%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - iz%beg</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(i)%sf = 0d0</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;            <span class="comment">! Capillary stresses in x-direction =============================</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            <span class="keywordflow">IF</span> (norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(   q_prim_vf, rho_cap, &amp;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                                                                    gamma_cap, pi_inf_cap, &amp;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                                                                    re_cap, we_cap, j,k,l  )</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                                tau_we(1,1) =  1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                                                   ( norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) - &amp;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>))</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                                tau_we(1,2) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                                <span class="keywordflow">DO</span> r = 1,2</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                                    tau_we(1,r)</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                                tau_we(1,1) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                                <span class="keywordflow">DO</span> r = 1,2</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) * tau_we(1,r)</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                        <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                            <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                                <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    </div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(   q_prim_vf, rho_cap, &amp;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                                                                        gamma_cap, pi_inf_cap, &amp;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                                                                        re_cap, we_cap, j,k,l  )</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    </div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                                    tau_we(1,3) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                                                       grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                                                       grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                                                     max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    </div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                                    tau_we(1,3)</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    </div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) * tau_we(1,3)</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    </div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            <span class="comment">! End capillary stresses in x-direction =============================</span></div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;            <span class="comment">! Capillary stresses in y-direction =============================</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;            <span class="keywordflow">ELSEIF</span> (norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(   q_prim_vf, rho_cap, &amp;</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                                                                    gamma_cap, pi_inf_cap, &amp;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                                                                    re_cap, we_cap, j,k,l  )</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                                tau_we(2,1) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                                tau_we(2,2) =  1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                                   ( norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) - &amp;</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>))</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                                <span class="keywordflow">DO</span> r = 1,2</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) = &amp;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) - &amp;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                                    tau_we(2,r)</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                                tau_we(2,2) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                                <span class="keywordflow">DO</span> r = 1,2</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) * tau_we(2,r)</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                        <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                            <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                                <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    </div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(   q_prim_vf, rho_cap, &amp;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                                                                        gamma_cap, pi_inf_cap, &amp;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                                                                        re_cap, we_cap, j,k,l  )</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    </div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                                    tau_we(2,3) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                                                       grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                                                       grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                                                     max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    </div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                                    tau_we(2,3)</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    </div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) * tau_we(2,3)</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    </div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            <span class="comment">! End capillary stresses in y-direction =============================</span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;            <span class="comment">! Capillary stresses in z-direction =============================</span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                                tau_we(3,1) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                                                   grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                                                   grad_x_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;                                tau_we(3,2) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                                                   grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                                                   grad_y_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                                tau_we(3,3) =  1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                                                   ( norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) - &amp;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                                                   grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                                                   grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>))</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                                <span class="keywordflow">DO</span> r = 1,3</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                                    tau_we(3,r)</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                                tau_we(3,3) = -1d0/ we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                                                   grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                                                   grad_z_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) / &amp;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                                                 max(norm_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                                <span class="keywordflow">DO</span> r = 1,3</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                                    <a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+r)%sf(j,k,l) * tau_we(3,r)</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;            <span class="comment">! End capillary stresses in z-direction =============================</span></div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">s_compute_capillary_stress_tensor</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda">s_compute_capillary_source</a>(i,q_prim_vf) <span class="comment">! ------------------------------</span></div><div class="line"><a name="l03104"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda"> 3104</a></span>&#160;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho_cap, gamma_cap, pi_inf_cap</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: Re_cap</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(1:num_fluids,1:num_fluids)</span> :: We_cap</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(1:num_fluids)</span> :: kappa_cap</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: F_sv</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l,r</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;            </div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;            <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                    <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                        <span class="keywordflow">DO</span> r = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3805bb400f71c84b76e3111dd595648d">alt_crv</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                                kappa_cap(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(r)) = <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(r))%sf(j,k,l)</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                                kappa_cap(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(r)) = <a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(r))%sf(j,k,l)</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(   q_prim_vf, rho_cap, &amp;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                                                            gamma_cap, pi_inf_cap, &amp;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                                                            re_cap, we_cap, j,k,l  )</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                        <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(j,k,l) = 0d0</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                        <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(j,k,l) = 0d0</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                        <span class="keywordflow">DO</span> r = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                            <span class="keywordflow">IF</span> (i == 1) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                                f_sv = -1d0/we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,2)) * &amp;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                                                     kappa_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,2)) * &amp;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                                <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l)</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                            <span class="keywordflow">ELSEIF</span> (i == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;                                f_sv = -1d0/we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,2)) * &amp;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                                                     kappa_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,2)) * &amp;</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;                                <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l)</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                            <span class="keywordflow">ELSEIF</span> (i == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                                f_sv = -1d0/we_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,2)) * &amp;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                                                     kappa_cap(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(r,2)) * &amp;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                                <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,l)</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                            <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(j,k,l) = <a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>(j,k,l) + f_sv</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                            <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(j,k,l) = <a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>(j,k,l) + f_sv * &amp;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                                        q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda">s_compute_capillary_source</a> <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe">s_get_divergence</a>(idir,q_prim_vf,mydivu)</div><div class="line"><a name="l03165"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe"> 3165</a></span>&#160;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">INTENT(inout)</span> :: mydivu</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: idir</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;            </div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            <span class="comment">!contribute to divergence computation \div(u)</span></div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;            <span class="keywordflow">IF</span> (idir == 1) mydivu%sf(:,:,:) = 0d0</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;            </div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;            <span class="keywordflow">DO</span> j = 0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                <span class="keywordflow">DO</span> k = 0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                    <span class="keywordflow">DO</span> l = 0,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                        <span class="keywordflow">IF</span> (idir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                            mydivu%sf(j,k,l) =                      0.5d0/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)*(q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+idir)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                                                                                 q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+idir)%sf(j-1, k , l )) </div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (idir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                            mydivu%sf(j,k,l) = mydivu%sf(j,k,l) +   0.5d0/<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)*(q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+idir)%sf(j,k+1,l) - &amp;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                                                                                 q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+idir)%sf( j ,k-1, l ))</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (idir == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                            mydivu%sf(j,k,l) = mydivu%sf(j,k,l) +   0.5d0/<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(l)*(q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+idir)%sf(j,k,l+1) - &amp;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;                                                                                 q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+idir)%sf( j , k ,l-1))</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe">s_get_divergence</a></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1">s_get_monopole</a>(idir, q_prim_vf,t_step,mymono) <span class="comment">! ------------------------------</span></div><div class="line"><a name="l03200"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1"> 3200</a></span>&#160;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1mono__parameters.html">mono_parameters</a>), <span class="keywordtype">INTENT(IN)</span> :: mymono</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: idir, t_step</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;            </div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;            <span class="keywordtype">INTEGER</span> :: ndirs,j,k,l</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;            </div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: mytime, sound, n_tait, B_tait</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: s2, myRho, const_sos</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;            </div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: Re</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION( num_fluids, &amp;
                                        num_fluids  )</span> :: We</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;           </div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;            ndirs = 1; <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) ndirs = 2; <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) ndirs = 3</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;            <span class="keywordflow">IF</span> (idir == ndirs) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                mytime = t_step*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                <span class="keywordflow">DO</span> j = 0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <span class="keywordflow">DO</span> k = 0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>; <span class="keywordflow">DO</span> l=0,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_prim_vf, myrho, n_tait, b_tait, re, we, j, k, l )</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                    n_tait = 1.d0/n_tait + 1.d0 <span class="comment">!make this the usual little &#39;gamma&#39;</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                    sound = n_tait*(q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) + ((n_tait-1d0)/n_tait)*b_tait)/myrho</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                    sound = dsqrt(sound)</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                    const_sos = dsqrt( n_tait )</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                    s2 = <a class="code" href="namespacem__rhs.html#ad316cbfbf94736b4677bacf07d8d9027">f_g</a>(mytime,sound,const_sos,mymono) * <a class="code" href="namespacem__rhs.html#a87bc24802f4abe7b3cb36864d631a275">f_delta</a>(j,k,l,mymono%loc,mymono%length,mymono)</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                   </div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                    <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>(j,k,l)    = <a class="code" href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">mono_mass_src</a>(j,k,l) + s2/sound</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> ==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                        </div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                        <span class="comment">! 1D</span></div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                        <span class="keywordflow">IF</span> (mymono%dir &lt; -0.1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                            <span class="comment">!left-going wave</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) = <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) - s2</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                            <span class="comment">!right-going wave</span></div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) = <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) + s2</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                        <span class="comment">! IF ( (j==1) .AND. (k==1) .AND. proc_rank == 0) &amp;</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                        <span class="comment">!    PRINT*, &#39;====== Monopole magnitude: &#39;, f_g(mytime,sound,const_sos,mymono) </span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160; </div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                        <span class="keywordflow">IF</span> (mymono%dir .NE. <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                            <span class="comment">! 2d</span></div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;                            <span class="comment">!mono_mom_src(1,j,k,l) = s2</span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                            <span class="comment">!mono_mom_src(2,j,k,l) = s2</span></div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) = <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) + s2*cos( mymono%dir )</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(2,j,k,l) = <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(2,j,k,l) + s2*sin( mymono%dir )</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;                    <span class="keywordflow">ELSE</span>    </div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                        <span class="comment">! 3D</span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                        <span class="keywordflow">IF</span> (mymono%dir .NE. <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) = <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(1,j,k,l) + s2*cos( mymono%dir )</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                            <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(2,j,k,l) = <a class="code" href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">mono_mom_src</a>(2,j,k,l) + s2*sin( mymono%dir )</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                        <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a>(j,k,l)   = <a class="code" href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">mono_e_src</a>(j,k,l) + s2*sound/(n_tait - 1.d0)</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="keyword">                END </span>DO; END DO; END do</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1">s_get_monopole</a></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;       </div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__rhs.html#ad316cbfbf94736b4677bacf07d8d9027">f_g</a>(mytime,sos,mysos,mymono)</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div><div class="line"><a name="l03278"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ad316cbfbf94736b4677bacf07d8d9027"> 3278</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: mytime, sos, mysos</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="keywordtype">TYPE</span>(mono_parameters), <span class="keywordtype">INTENT(IN)</span> :: mymono</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: period, t0, sigt, pa</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: f_g</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            <span class="keywordflow">IF</span> (mymono%pulse == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                <span class="comment">! Sine wave</span></div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                period = mymono%length/sos</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                <span class="keywordflow">IF</span> (mytime .le. mymono%npulse*period) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                    f_g = mymono%mag*sin(mytime*2.d0*pi/period)</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                    f_g = 0d0</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mymono%pulse == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                <span class="comment">! Gaussian pulse</span></div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                sigt = mymono%length/sos/7.d0</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;                t0 = 3.5d0*sigt </div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;                f_g = mymono%mag/(dsqrt(2.d0*pi) * sigt) * &amp;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                    dexp( -0.5d0 * ((mytime-t0)**2.d0)/(sigt**2.d0) )</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mymono%pulse == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;                <span class="comment">! Square wave</span></div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;                sigt = mymono%length/sos</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;                t0 = 0d0</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                <span class="keywordflow">IF</span> (mytime &gt; t0 .AND. mytime &lt; sigt) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                    f_g = mymono%mag</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                    f_g = 0d0</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;No pulse type detected. Exiting ...&#39;</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                <span class="keyword">CALL </span>s_mpi_abort()</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__rhs.html#ad316cbfbf94736b4677bacf07d8d9027">f_g</a></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__rhs.html#a87bc24802f4abe7b3cb36864d631a275">f_delta</a>(j,k,l,mono_loc,mono_leng,mymono)</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;            </div><div class="line"><a name="l03322"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a87bc24802f4abe7b3cb36864d631a275"> 3322</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(3)</span>, <span class="keywordtype">INTENT(IN)</span> :: mono_loc</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;            <span class="keywordtype">TYPE</span>(mono_parameters), <span class="keywordtype">INTENT(IN)</span> :: mymono</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: mono_leng</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(in)</span> :: j,k,l</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;            <span class="keywordtype">INTEGER</span> :: q</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: h,hx,hy,hz</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: hxnew,hynew</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: sig</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: f_delta</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;            <span class="keywordflow">IF</span> (n==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                sig = dx(j)</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                sig = sig*2.5d0</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (p==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                sig = maxval( (/ dx(j), dy(k) /) )</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                sig = sig*2.5d0</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;            <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                sig = maxval( (/ dx(j), dy(k), dz(l) /) )</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                sig = sig*2.5d0</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="keywordflow">            END IF</span>            </div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;            <span class="keywordflow">IF</span> (n==0) <span class="keywordflow">THEN</span>      <span class="comment">!1D</span></div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                <span class="keywordflow">IF</span> (mymono%support == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;                    <span class="comment">! 1D delta function</span></div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                    hx = abs(mono_loc(1) - x_cc(j))</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                    f_delta = 1.d0/(dsqrt(2.d0*pi)*sig/2.d0) * &amp;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                        dexp( -0.5d0 * (hx/(sig/2.d0))**2.d0 )</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mymono%support == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                    <span class="comment">! Support for all x</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                    f_delta = 1.d0</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (p==0) <span class="keywordflow">THEN</span> <span class="comment">!2D</span></div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                hx = mono_loc(1) - x_cc(j)</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                hy = mono_loc(2) - y_cc(k)</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                <span class="keywordflow">IF</span> (mymono%support == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                    <span class="comment">! 2D delta function</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                    sig = mono_leng/20.d0</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                    h = dsqrt(hx**2.d0 + hy**2.d0)</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                    f_delta = 1.d0/(dsqrt(2.d0*pi)*sig/2.d0) * &amp;</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;                        dexp( -0.5d0 * ((h/(sig/2.d0))**2.d0) )</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mymono%support == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;                    <span class="comment">!only support for y \pm some value</span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                    <span class="keywordflow">IF</span> ( abs(hy) &lt; mymono%length ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                        f_delta = 1.d0/(dsqrt(2.d0*pi)*sig/2.d0) * &amp;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                            dexp( -0.5d0 * (hx/(sig/2.d0))**2.d0 )</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                        f_delta = 0d0</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mymono%support == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                    <span class="comment">! Only support along some line</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                    hx = x_cc(j) - mono_loc(1) </div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                    hy = y_cc(k) - mono_loc(2)</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                    </div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                    <span class="comment">! Rotate actual point by -theta</span></div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                    hxnew = cos(      mymono%dir)*hx + sin(     mymono%dir)*hy</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                    hynew = -1.d0*sin(mymono%dir)*hx + cos(     mymono%dir)*hy</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                    <span class="keywordflow">IF</span> ( abs(hynew) &lt; mymono%loc(3)/2.d0 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                        f_delta = 1.d0/(dsqrt(2.d0*pi)*sig/2.d0) * &amp;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                            dexp( -0.5d0 * (hxnew/(sig/2.d0))**2.d0 )</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                        f_delta = 0d0</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (mymono%support == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                    <span class="comment">! Support for all y</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                    f_delta = 1.d0/(dsqrt(2.d0*pi)*sig) * &amp;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                        dexp( -0.5d0 * (hx/sig)**2.d0 ) </div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            <span class="keywordflow">ELSE</span> <span class="comment">!3D</span></div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                <span class="keywordflow">IF</span> (mymono%support == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                    <span class="comment">! Only support along some patch</span></div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                    hx = x_cc(j) - mono_loc(1) </div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                    hy = y_cc(k) - mono_loc(2)</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                    hz = z_cc(l) - mono_loc(3)</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                    <span class="comment">! Rotate actual point by -theta</span></div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                    hxnew = cos(      mymono%dir)*hx + sin(     mymono%dir)*hy</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                    hynew = -1.d0*sin(mymono%dir)*hx + cos(     mymono%dir)*hy</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                   </div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                    <span class="keywordflow">IF</span> ( abs(hynew) &lt; mymono%length/2. .AND. &amp;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                         abs(hz) &lt; mymono%length/2. ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                        f_delta = 1.d0/(dsqrt(2.d0*pi)*sig/2.d0) * &amp;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                            dexp( -0.5d0 * (hxnew/(sig/2.d0))**2.d0 )</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                        f_delta = 0d0</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                    print <span class="stringliteral">&#39;(a)&#39;</span>, <span class="stringliteral">&#39;Monopole support not properly defined&#39;</span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                    <span class="keyword">CALL </span>s_mpi_abort()</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; </div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__rhs.html#a87bc24802f4abe7b3cb36864d631a275">f_delta</a></div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aa1cd3a5b83eabb0344ecae0cf321ca87">s_compute_regularization_source</a>(i,q_prim_vf) <span class="comment">! -----------------</span></div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;</div><div class="line"><a name="l03427"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aa1cd3a5b83eabb0344ecae0cf321ca87"> 3427</a></span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">ALLOCATABLE</span> :: var</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">ALLOCATABLE</span> :: grad_x, grad_y, grad_z</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">ALLOCATABLE</span> :: alpharho_grad_x, alpharho_grad_y, alpharho_grad_z</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">ALLOCATABLE</span> :: norm</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">ALLOCATABLE</span> :: un_alpha_x, un_alpha_y, un_alpha_z</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(0:m,0:n,0:p)</span> :: Lheaviside, U0, velmag</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: U0_loc, U0_glb</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(0:m,0:n,0:p)</span> :: Rnohat, R1hat, R2hat</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: vel</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;            <span class="keywordtype">TYPE</span>(bounds_info) :: ix,iy,iz</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;            </div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l,r</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            ix%beg = -buff_size; iy%beg = -buff_size</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;            ix%end = m + buff_size; iy%end = n + buff_size</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;            <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                iz%beg = -buff_size; iz%end = p + buff_size</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                iz%beg = 0; iz%end = 0</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            <span class="keyword">ALLOCATE</span>(            var%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            <span class="keyword">ALLOCATE</span>(         grad_x%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;            <span class="keyword">ALLOCATE</span>(         grad_y%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            <span class="keyword">ALLOCATE</span>(         grad_z%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            <span class="keyword">ALLOCATE</span>(alpharho_grad_x%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;            <span class="keyword">ALLOCATE</span>(alpharho_grad_y%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            <span class="keyword">ALLOCATE</span>(alpharho_grad_z%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;            <span class="keyword">ALLOCATE</span>(           norm%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            <span class="keyword">ALLOCATE</span>(     un_alpha_x%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            <span class="keyword">ALLOCATE</span>(     un_alpha_y%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;            <span class="keyword">ALLOCATE</span>(     un_alpha_z%sf(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            <span class="keywordflow">DO</span> j = 0, m</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                <span class="keywordflow">DO</span> k = 0, n</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                    <span class="keywordflow">DO</span> l = 0, p</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;                        <span class="keywordflow">IF</span> ((q_prim_vf(adv_idx%beg)%sf(j,k,l) &gt; 1d-6) &amp;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;                                        .AND.                         &amp;</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;                            (q_prim_vf(adv_idx%beg)%sf(j,k,l) &lt; (1d0-1d-6))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                            lheaviside(j,k,l) = 1d0</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;                            lheaviside(j,k,l) = 0d0</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                        <span class="keywordflow">DO</span> r = 1, num_dims</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                            vel(r) = q_prim_vf(cont_idx%end+r)%sf(j,k,l)</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;                        velmag(j,k,l) = sqrt(dot_product(vel,vel))</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                        u0(j,k,l) = 4d0*q_prim_vf(adv_idx%beg)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                                    (1d0-q_prim_vf(adv_idx%beg)%sf(j,k,l)) * &amp;</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                                    velmag(j,k,l)</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            u0_loc = maxval(u0)</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;            <span class="keywordflow">IF</span> (num_procs &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                <span class="keyword">CALL </span>s_mpi_allreduce_max(u0_loc,u0_glb)</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                u0_glb = u0_loc</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;            var%sf(:,:,:) = q_prim_vf(adv_idx%beg)%sf(:,:,:)</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(var,grad_x,grad_y,grad_z,norm)</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            un_alpha_x%sf(:,:,:) = grad_x%sf(:,:,:)/max(norm%sf(:,:,:),sgm_eps)</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;            un_alpha_y%sf(:,:,:) = grad_y%sf(:,:,:)/max(norm%sf(:,:,:),sgm_eps)</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;            un_alpha_z%sf(:,:,:) = grad_z%sf(:,:,:)/max(norm%sf(:,:,:),sgm_eps)</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                        var%sf(j,k,l) = reg_eps*norm%sf(j,k,l) - q_prim_vf(adv_idx%beg)%sf(j,k,l) * &amp;</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                                                        (1d0 - q_prim_vf(adv_idx%beg)%sf(j,k,l))</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(var,grad_x,grad_y,grad_z,norm)</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            <span class="keywordflow">DO</span> j = 0, m</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                <span class="keywordflow">DO</span> k = 0, n</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                    <span class="keywordflow">DO</span> l = 0, p</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                        <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;                            rnohat(j,k,l) = lheaviside(j,k,l)*u0_glb * &amp;</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                                            (un_alpha_x%sf(j,k,l)*grad_x%sf(j,k,l) + &amp;</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;                                             un_alpha_y%sf(j,k,l)*grad_y%sf(j,k,l) + &amp;</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                                             un_alpha_z%sf(j,k,l)*grad_z%sf(j,k,l))</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                            rnohat(j,k,l) = lheaviside(j,k,l)*u0_glb * &amp;</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                                            (un_alpha_x%sf(j,k,l)*grad_x%sf(j,k,l) + &amp;</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                                             un_alpha_y%sf(j,k,l)*grad_y%sf(j,k,l))</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;            </div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;            <span class="keywordflow">DO</span> r = cont_idx%beg, cont_idx%end</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;                var%sf(:,:,:) = q_prim_vf(r)%sf(:,:,:)</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(var,alpharho_grad_x,alpharho_grad_y,alpharho_grad_z,norm)</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                    <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                        <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                            <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                                var%sf(j,k,l) = reg_eps * &amp;</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                                                (un_alpha_x%sf(j,k,l)*alpharho_grad_x%sf(j,k,l) + &amp;</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                                                 un_alpha_y%sf(j,k,l)*alpharho_grad_y%sf(j,k,l) + &amp;</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                                                 un_alpha_z%sf(j,k,l)*alpharho_grad_z%sf(j,k,l))</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                                var%sf(j,k,l) = reg_eps * &amp;</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                                                (un_alpha_x%sf(j,k,l)*alpharho_grad_x%sf(j,k,l) + &amp;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                                                 un_alpha_y%sf(j,k,l)*alpharho_grad_y%sf(j,k,l))</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(var,grad_x,grad_y,grad_z,norm)</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;                <span class="keywordflow">DO</span> j = 0, m</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;                    <span class="keywordflow">DO</span> k = 0, n</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;                        <span class="keywordflow">DO</span> l = 0, p</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                            <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                                var%sf(j,k,l) = lheaviside(j,k,l)*u0_glb * &amp;</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                                               (un_alpha_x%sf(j,k,l)*(grad_x%sf(j,k,l) - &amp;</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                                               (1d0-2d0*q_prim_vf(adv_idx%beg)%sf(j,k,l))*alpharho_grad_x%sf(j,k,l)) + &amp;</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                                                un_alpha_y%sf(j,k,l)*(grad_y%sf(j,k,l) - &amp;</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                                                (1d0-2d0*q_prim_vf(adv_idx%beg)%sf(j,k,l))*alpharho_grad_y%sf(j,k,l)) + &amp;</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;                                                un_alpha_z%sf(j,k,l)*(grad_z%sf(j,k,l) - &amp;</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                                                (1d0-2d0*q_prim_vf(adv_idx%beg)%sf(j,k,l))*alpharho_grad_z%sf(j,k,l)))</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                                var%sf(j,k,l) = lheaviside(j,k,l)*u0_glb * &amp;</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                                               (un_alpha_x%sf(j,k,l)*(grad_x%sf(j,k,l) - &amp;</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                                               (1d0-2d0*q_prim_vf(adv_idx%beg)%sf(j,k,l))*alpharho_grad_x%sf(j,k,l)) + &amp;</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                                                un_alpha_y%sf(j,k,l)*(grad_y%sf(j,k,l) - &amp;</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                                                (1d0-2d0*q_prim_vf(adv_idx%beg)%sf(j,k,l))*alpharho_grad_y%sf(j,k,l))) </div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                <span class="keywordflow">IF</span> (r == cont_idx%beg) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                    r1hat(:,:,:) = var%sf(0:m,0:n,0:p)</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                <span class="keywordflow">ELSEIF</span> (r == cont_idx%end) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                    r2hat(:,:,:) = var%sf(0:m,0:n,0:p)</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;            <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(cont_idx%beg)%sf(:,:,:) = r1hat(:,:,:)</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(cont_idx%end)%sf(:,:,:) = r2hat(:,:,:)</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            <span class="keywordflow">DO</span> r = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(r)%sf(:,:,:) = q_prim_vf(r)%sf(:,:,:)*(r1hat(:,:,:) + r2hat(:,:,:))</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(e_idx)%sf(:,:,:) = 5d-1*velmag(:,:,:)**2d0*(r1hat(:,:,:) + r2hat(:,:,:)) + &amp;</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                                            (q_prim_vf(e_idx)%sf(:,:,:)*(fluid_pp(1)%gamma - fluid_pp(2)%gamma) + &amp;</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;                                            fluid_pp(1)%pi_inf - fluid_pp(2)%pi_inf)*rnohat(:,:,:)</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(adv_idx%beg)%sf(:,:,:) = rnohat(:,:,:)</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;            <span class="keywordflow">IF</span> (adv_alphan) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                <a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(adv_idx%end)%sf(:,:,:) = -rnohat(:,:,:)</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;            <span class="keyword">DEALLOCATE</span>(var%sf, grad_x%sf, grad_y%sf, grad_z%sf, norm%sf)</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;            <span class="keyword">DEALLOCATE</span>(un_alpha_x%sf, un_alpha_y%sf, un_alpha_z%sf)</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;            <span class="keyword">DEALLOCATE</span>(alpharho_grad_x%sf, alpharho_grad_y%sf, alpharho_grad_z%sf)</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aa1cd3a5b83eabb0344ecae0cf321ca87">s_compute_regularization_source</a> <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(var,grad_x,grad_y,grad_z,norm)</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;</div><div class="line"><a name="l03604"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96"> 3604</a></span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">INTENT(IN)</span> :: var</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">INTENT(INOUT)</span> :: grad_x</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">INTENT(INOUT)</span> :: grad_y</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">INTENT(INOUT)</span> :: grad_z</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">INTENT(INOUT)</span> :: norm</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;            <span class="keywordtype">TYPE</span>(bounds_info) :: ix,iy,iz</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;            ix%beg = -buff_size; ix%end = m + buff_size;</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;            <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                iy%beg = -buff_size; iy%end = n + buff_size</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                    iz%beg = -buff_size; iz%end = p + buff_size</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                    iz%beg = -1; iz%end = 1</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                iy%beg = -1; iy%end = 1</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;            <span class="keywordflow">DO</span> j = ix%beg+1, ix%end-1</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg+1, iy%end-1</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg+1, iz%end-1</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                        grad_x%sf(j,k,l) = (var%sf(j+1,k,l) - var%sf(j-1,k,l))/(x_cc(j+1) - x_cc(j-1))</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                        <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                            grad_y%sf(j,k,l) = (var%sf(j,k+1,l) - var%sf(j,k-1,l))/(y_cc(k+1) - y_cc(k-1))</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                            <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                                grad_z%sf(j,k,l) = (var%sf(j,k,l+1) - var%sf(j,k,l-1))/(z_cc(l+1) - z_cc(l-1))</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            grad_x%sf(ix%beg,:,:) = (-3d0*var%sf(ix%beg,:,:) + 4d0*var%sf(ix%beg+1,:,:) - var%sf(ix%beg+2,:,:)) / &amp;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                                    (x_cc(ix%beg+2) - x_cc(ix%beg))</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;            grad_x%sf(ix%end,:,:) = ( 3d0*var%sf(ix%end,:,:) - 4d0*var%sf(ix%end-1,:,:) + var%sf(ix%end-2,:,:)) / &amp;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                                    (x_cc(ix%end) - x_cc(ix%end-2))</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;            <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                grad_y%sf(:,iy%beg,:) = (-3d0*var%sf(:,iy%beg,:) + 4d0*var%sf(:,iy%beg+1,:) - var%sf(:,iy%beg+2,:)) / &amp;</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                                        (y_cc(iy%beg+2) - y_cc(iy%beg))</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                grad_y%sf(:,iy%end,:) = ( 3d0*var%sf(:,iy%end,:) - 4d0*var%sf(:,iy%end-1,:) + var%sf(:,iy%end-2,:)) / &amp;</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                                        (y_cc(iy%end) - y_cc(iy%end-2))</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                    grad_z%sf(:,:,iz%beg) = (-3d0*var%sf(:,:,iz%beg) + 4d0*var%sf(:,:,iz%beg+1) - var%sf(:,:,iz%beg+2)) / &amp;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                                            (z_cc(iz%beg+2) - z_cc(iz%beg))</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                    grad_z%sf(:,:,iz%end) = ( 3d0*var%sf(:,:,iz%end) - 4d0*var%sf(:,:,iz%end-1) + var%sf(:,:,iz%end-2)) / &amp;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                                            (z_cc(iz%end) - z_cc(iz%end-2))</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;            <span class="keywordflow">IF</span> (bc_x%beg &lt;= -3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                grad_x%sf(0,:,:) = (-3d0*var%sf(0,:,:) + 4d0*var%sf(1,:,:) - var%sf(2,:,:)) / &amp;</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                                   (x_cc(2) - x_cc(0))</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            <span class="keywordflow">IF</span> (bc_x%end &lt;= -3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                grad_x%sf(m,:,:) = ( 3d0*var%sf(m,:,:) - 4d0*var%sf(m-1,:,:) + var%sf(m-2,:,:)) / &amp;</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                                   (x_cc(m) - x_cc(m-2))</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                <span class="keywordflow">IF</span> (bc_y%beg &lt;= -3 .AND. bc_y%beg /= -13) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                    grad_y%sf(:,0,:) = (-3d0*var%sf(:,0,:) + 4d0*var%sf(:,1,:) - var%sf(:,2,:)) / &amp;</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                                       (y_cc(2) - y_cc(0))</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                <span class="keywordflow">IF</span> (bc_y%end &lt;= -3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;                    grad_y%sf(:,n,:) = ( 3d0*var%sf(:,n,:) - 4d0*var%sf(:,n-1,:) + var%sf(:,n-2,:)) / &amp;</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;                                       (y_cc(n) - y_cc(n-2))</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;                <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                    <span class="keywordflow">IF</span> (bc_z%beg &lt;= -3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;                        grad_z%sf(:,:,0) = (-3d0*var%sf(:,:,0) + 4d0*var%sf(:,:,1) - var%sf(:,:,2)) / &amp;</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                                           (z_cc(2) - z_cc(0))</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;                    <span class="keywordflow">IF</span> (bc_z%end &lt;= -3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                        grad_z%sf(:,:,p) = ( 3d0*var%sf(:,:,p) - 4d0*var%sf(:,:,p-1) + var%sf(:,:,p-2)) / &amp;</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;                                           (z_cc(p) - z_cc(p-2))</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;            <span class="keywordflow">IF</span> (p == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                iz%beg = 0; iz%end = 0</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;                <span class="keywordflow">IF</span> (n == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;                    iy%beg = 0; iy%end = 0</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                        <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                            norm%sf(j,k,l) = sqrt(grad_x%sf(j,k,l)**2d0 + &amp;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                                                  grad_y%sf(j,k,l)**2d0 + &amp;</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;                                                  grad_z%sf(j,k,l)**2d0)</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                        <span class="keywordflow">ELSEIF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                            norm%sf(j,k,l) = sqrt(grad_x%sf(j,k,l)**2d0 + &amp;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                                                  grad_y%sf(j,k,l)**2d0)</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;                            norm%sf(j,k,l) = grad_x%sf(j,k,l)</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="keyword">        SUBROUTINE </span>s_pressure_relaxation_procedure(q_cons_vf) <span class="comment">! ----------------</span></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;           </div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;            </div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::  pres_relax</div><div class="line"><a name="l03730"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a9dff053a7e3f9c1702a161f55d3e1726"> 3730</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span>            :: <a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a></div><div class="line"><a name="l03731"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc"> 3731</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::      <a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a></div><div class="line"><a name="l03732"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc"> 3732</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::     <a class="code" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a></div><div class="line"><a name="l03733"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333"> 3733</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span>            ::     <a class="code" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a></div><div class="line"><a name="l03734"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0"> 3734</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::   <a class="code" href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2">sum_alpha</a></div><div class="line"><a name="l03735"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2"> 3735</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::         <a class="code" href="m__rhs_8f90.html#a340bafa0c8d745c3060facd9cfef7ec4">rho</a></div><div class="line"><a name="l03736"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a340bafa0c8d745c3060facd9cfef7ec4"> 3736</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::    <a class="code" href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d">dyn_pres</a></div><div class="line"><a name="l03737"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d"> 3737</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::        <a class="code" href="m__rhs_8f90.html#a4cb69ecc8e60cb3bfbe57aab771d6c48">e_we</a></div><div class="line"><a name="l03738"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a4cb69ecc8e60cb3bfbe57aab771d6c48"> 3738</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::       <a class="code" href="m__rhs_8f90.html#a298183e270a405e0f180d45940bb6f8a">gamma</a></div><div class="line"><a name="l03739"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a298183e270a405e0f180d45940bb6f8a"> 3739</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   ::      <a class="code" href="m__rhs_8f90.html#aeed4eb93ccb2725da7a4756e510dda03">pi_inf</a></div><div class="line"><a name="l03740"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#aeed4eb93ccb2725da7a4756e510dda03"> 3740</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span>            ::   <a class="code" href="m__rhs_8f90.html#aba715ebddc63d396377dc69d35cb50f8">gamma_min</a></div><div class="line"><a name="l03741"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#aba715ebddc63d396377dc69d35cb50f8"> 3741</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span>            ::    <a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a></div><div class="line"><a name="l03742"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81"> 3742</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>                     ::          <a class="code" href="m__rhs_8f90.html#a6c337b82dc4c47f2d3cc57408aa1fc9f">re</a></div><div class="line"><a name="l03743"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a6c337b82dc4c47f2d3cc57408aa1fc9f"> 3743</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,num_fluids)</span> ::          <a class="code" href="m__rhs_8f90.html#a19a438a95f2945b7c9e492f2ee983263">we</a></div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;            <span class="keywordtype">INTEGER</span> :: <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>,<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>,<a class="code" href="m__rhs_8f90.html#ae0579cdf6d579b6ff5e6a5945a99c42c">iter</a></div><div class="line"><a name="l03747"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c"> 3747</a></span>&#160;            <span class="keywordtype">INTEGER</span> :: <a class="code" href="m__rhs_8f90.html#a0048c79fcd5325fffae011dc032b86fb">relax</a></div><div class="line"><a name="l03748"></a><span class="lineno"><a class="line" href="m__rhs_8f90.html#a0048c79fcd5325fffae011dc032b86fb"> 3748</a></span>&#160;            </div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;                <a class="code" href="m__rhs_8f90.html#aba715ebddc63d396377dc69d35cb50f8">gamma_min</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) = 1d0/fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%gamma + 1d0</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;                <a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)  = fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%pi_inf / (1d0+fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%gamma)</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a> = 0, m</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;                <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a> = 0, n</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;                    <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a> = 0, p</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;                        <span class="comment">! Numerical correction of the volume fractions</span></div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;                        <span class="keywordflow">IF</span> (mpp_lim) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                            <a class="code" href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2">sum_alpha</a> = 0d0</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                                <span class="keywordflow">IF</span> ((q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+cont_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .LT. 0d0) .OR. &amp;</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;                                    (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .LT. 0d0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;                                    q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+cont_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 0d0</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;                                    q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)  = 0d0</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                                    q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+internalenergies_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)  = 0d0</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;                                <span class="keywordflow">IF</span> (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .GT. 1d0) &amp;</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                                    q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = 1d0</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;                                <a class="code" href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2">sum_alpha</a> = <a class="code" href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2">sum_alpha</a> + q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;                            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                                q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) / <a class="code" href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2">sum_alpha</a></div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                        <span class="comment">! Pressures relaxation procedure ===================================</span></div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                        <span class="comment">! Is the pressure relaxation procedure necessary?</span></div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                        <a class="code" href="m__rhs_8f90.html#a0048c79fcd5325fffae011dc032b86fb">relax</a> = 1</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                        <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                            <span class="keywordflow">IF</span> (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .GT. (1d0-sgm_eps)) <a class="code" href="m__rhs_8f90.html#a0048c79fcd5325fffae011dc032b86fb">relax</a> = 0</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="m__rhs_8f90.html#a0048c79fcd5325fffae011dc032b86fb">relax</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;                            <span class="comment">! Initial state</span></div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;                            pres_relax = 0d0</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;                                <span class="keywordflow">IF</span> (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .GT. sgm_eps) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                                    <a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) = &amp;</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                                            (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+internalenergies_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) / &amp;</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;                                            q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) &amp;</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                                            - fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%pi_inf) / fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%gamma</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;                           </div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) .LE. -(1d0 - 1d-8)*<a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) + 1d-8) &amp;</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;                                        <a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) = -(1d0 - 1d-8)*<a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) + 1d-8</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;                                    <a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) = 0d0</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                                pres_relax = pres_relax + q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>)*<a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;                            </div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                            <span class="comment">! Iterative process for relaxed pressure determination</span></div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                            <a class="code" href="m__rhs_8f90.html#ae0579cdf6d579b6ff5e6a5945a99c42c">iter</a>    = 0</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                            <a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a>  = 1d-9</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                            <a class="code" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a> = 1d9</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                                <a class="code" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) = 0d0</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                            <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span> (dabs(<a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a>) .GT. 1d-10)</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                pres_relax = pres_relax - <a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a> / <a class="code" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a></div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                                <span class="comment">! Convergence</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                                <a class="code" href="m__rhs_8f90.html#ae0579cdf6d579b6ff5e6a5945a99c42c">iter</a> = <a class="code" href="m__rhs_8f90.html#ae0579cdf6d579b6ff5e6a5945a99c42c">iter</a> + 1</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="m__rhs_8f90.html#ae0579cdf6d579b6ff5e6a5945a99c42c">iter</a> == 50) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                                    print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Pressure relaxation procedure failed to converge to a solution. Exiting ...&#39;</span></div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                                    <span class="keyword">CALL </span>s_mpi_abort()</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                                <span class="comment">! Physical pressure</span></div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                                <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                                    <span class="keywordflow">IF</span> (pres_relax .LE. -(1d0 - 1d-8)*<a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) + 1d-8) &amp;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                                        pres_relax = -(1d0 - 1d-8)*<a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) + 1d0</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                                <span class="comment">! Newton-Raphson method</span></div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                                <a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a>  = -1d0</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;                                <a class="code" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a> = 0d0</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                                <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                                    <span class="keywordflow">IF</span> (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .GT. sgm_eps) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;                                        <a class="code" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) = q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+cont_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) / &amp;</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                                                    max(q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>),sgm_eps) &amp;</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                                                    * ((pres_relax+<a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)) / (<a class="code" href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>) + &amp;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                                                    <a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)))**(1d0/<a class="code" href="m__rhs_8f90.html#aba715ebddc63d396377dc69d35cb50f8">gamma_min</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>))</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;                                        <a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a>      = <a class="code" href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a>  + q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+cont_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) &amp;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;                                            / <a class="code" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;                                        <a class="code" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a>     = <a class="code" href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a> - q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+cont_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) &amp;</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                                            / (<a class="code" href="m__rhs_8f90.html#aba715ebddc63d396377dc69d35cb50f8">gamma_min</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)*<a class="code" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)*(pres_relax+<a class="code" href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)))</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                            <span class="comment">! Cell update of the volume fraction</span></div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                            <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                                <span class="keywordflow">IF</span> (q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) .GT. sgm_eps) &amp;</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;                                    q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+cont_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) &amp;</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                                        / <a class="code" href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a>(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                        <span class="comment">! ==================================================================</span></div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;                        </div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                        <span class="comment">! Mixture-total-energy correction ==================================</span></div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                        <span class="comment">! The mixture-total-energy correction of the mixture pressure P is not necessary here</span></div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                        <span class="comment">! because the primitive variables are directly recovered later on by the conservative</span></div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                        <span class="comment">! variables (see s_convert_conservative_to_primitive_variables called in s_compute_rhs).</span></div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                        <span class="comment">! However, the internal-energy equations should be reset with the corresponding mixture</span></div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                        <span class="comment">! pressure from the correction. This step is carried out below.</span></div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                     </div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;                        <span class="keyword">CALL </span>s_convert_to_mixture_variables( q_cons_vf, <a class="code" href="m__rhs_8f90.html#a340bafa0c8d745c3060facd9cfef7ec4">rho</a>, &amp;</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;                                                             <a class="code" href="m__rhs_8f90.html#a298183e270a405e0f180d45940bb6f8a">gamma</a>, <a class="code" href="m__rhs_8f90.html#aeed4eb93ccb2725da7a4756e510dda03">pi_inf</a>,  &amp;</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;                                                             <a class="code" href="m__rhs_8f90.html#a6c337b82dc4c47f2d3cc57408aa1fc9f">re</a>, <a class="code" href="m__rhs_8f90.html#a19a438a95f2945b7c9e492f2ee983263">we</a>, <a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>   )</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                     </div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;                        <a class="code" href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d">dyn_pres</a> = 0d0</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;                        <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;                            <a class="code" href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d">dyn_pres</a> = <a class="code" href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d">dyn_pres</a> + 5d-1*q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) * &amp;</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;                                q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) / max(<a class="code" href="m__rhs_8f90.html#a340bafa0c8d745c3060facd9cfef7ec4">rho</a>,sgm_eps)</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;                        <a class="code" href="m__rhs_8f90.html#a4cb69ecc8e60cb3bfbe57aab771d6c48">e_we</a> = 0d0</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                     </div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                        pres_relax = (q_cons_vf(e_idx)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) - <a class="code" href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d">dyn_pres</a> - <a class="code" href="m__rhs_8f90.html#aeed4eb93ccb2725da7a4756e510dda03">pi_inf</a> - <a class="code" href="m__rhs_8f90.html#a4cb69ecc8e60cb3bfbe57aab771d6c48">e_we</a>) / <a class="code" href="m__rhs_8f90.html#a298183e270a405e0f180d45940bb6f8a">gamma</a></div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                        <span class="keywordflow">DO</span> <a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a> = 1, num_fluids</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                            q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+internalenergies_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) = &amp;</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                                q_cons_vf(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>+adv_idx%beg-1)%sf(<a class="code" href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a>,<a class="code" href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a>,<a class="code" href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a>) * &amp;</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                                (fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%gamma*pres_relax + fluid_pp(<a class="code" href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a>)%pi_inf)</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;                        <span class="comment">! ==================================================================</span></div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="keyword">        END SUBROUTINE </span>s_pressure_relaxation_procedure <span class="comment">! -----------------------</span></div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470">s_get_tvd_flux</a>(q_cons_vf, q_prim_vf, rhs_vf,i) <span class="comment">! -------</span></div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;            </div><div class="line"><a name="l03903"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470"> 3903</a></span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_prim_vf</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: rhs_vf</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(in)</span> :: i</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;            <span class="keywordtype">INTEGER</span> :: j,k,l,r</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: top, bottom</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;            </div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                        <span class="comment">! Upwind direction for slope chosen based on contact velocity</span></div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                        <span class="comment">! from Riemann solver (stored in adv_idx of flux_src). Slope</span></div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                        <span class="comment">! is calculated using the first volume fraction.</span></div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,0,0)%vf(adv_idx%beg)%sf(j,k,l) &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;                               top = <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf( j ,k,l) - &amp;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;                                 <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf(j-1,k,l)</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                            bottom = <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;                                 <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf( j ,k,l)</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                               top = <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf(j+2,k,l) - &amp;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                                 <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf(j+1,k,l)</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                            bottom = <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;                                 <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(adv_idx%beg)%sf( j ,k,l)</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;            </div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#aa8bc1b17f230cbd06b702f34bd199ef1">s_compute_flux_lim</a>(top,bottom,<a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>(j,k,l))</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;            <span class="comment">! Compile final flux and flux source</span></div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                    <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                            <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) = &amp;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                         <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) + &amp;</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) * &amp;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                        (<a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) - &amp;</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                         <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end))</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                    <span class="keywordflow">IF</span>(any(re_size &gt; 0) .OR. we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                        <span class="keywordflow">DO</span> l = mom_idx%beg, e_idx</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                            <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) = &amp;</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                         <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) + &amp;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) * &amp;</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                        (<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) - &amp;</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;                         <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end))</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                    <span class="keywordflow">DO</span> l = adv_idx%beg, adv_idx%end</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                            <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) = &amp;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                         <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) + &amp;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) * &amp;</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                        (<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) - &amp;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                         <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end))</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                    <span class="keywordflow">IF</span> (cyl_coord) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;                        <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                            <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) = &amp;</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;                         <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) + &amp;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                                             <a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) * &amp;</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                        (<a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) - &amp;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                         <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end))</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;            <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = 1; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = adv_idx%end</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        </div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,:,:))</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;            </div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;            <span class="keywordflow">IF</span>(any(re_size &gt; 0) .OR. we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;               <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = mom_idx%beg</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;               <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = adv_idx%beg</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;            </div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;            <span class="keywordflow">IF</span>(riemann_solver /= 1) <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = adv_idx%beg</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;            </div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,:,:))</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,:,:))</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470">s_get_tvd_flux</a></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aac41721bd3275fb997f51c1afaebac4a">s_get_viscous</a>(q_cons_vf, q_prim_vf, rhs_vf) <span class="comment">! -------</span></div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;            </div><div class="line"><a name="l03997"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#aac41721bd3275fb997f51c1afaebac4a"> 3997</a></span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_prim_vf</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: rhs_vf</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                    <span class="comment">! WENO reconstruct variables to cell boundaries</span></div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                    <span class="keywordflow">IF</span>(weno_vars == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;                     </div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = 1; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = mom_idx%end</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                        </div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;                                   <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;                                                          dflt_int, i  )</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;                        </div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;                                <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;                                 </div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf = sgm_eps</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf = sgm_eps</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;                                    </div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;                                    <span class="keywordflow">DO</span> r = 1, cont_idx%end</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;                                        <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf = &amp;</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                                        <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf + &amp;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;                                        <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(r)%sf</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                                        <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf = &amp;</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;                                        <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf + &amp;</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(r)%sf</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;                                    </div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf = &amp;</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf / &amp;</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf = &amp;</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf / &amp;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;                                 </div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;                     </div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;                     </div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;                        <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = mom_idx%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = mom_idx%end</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;                     </div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(       &amp;</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                                   <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                                                  <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                                                          dflt_int, i  )</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                     </div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                  </div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = mom_idx%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = mom_idx%end</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                  </div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:))</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:))</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;                <span class="keywordflow">IF</span> (weno_re_flux) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;                <span class="comment">! Compute velocity gradient at cell centers using scalar</span></div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;                <span class="comment">! divergence theorem</span></div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                    <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;                      </div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;                        <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>(           &amp;</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;                                     <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                                     <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), i )</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                        <span class="keywordflow">ELSEIF</span>(i == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>(           &amp;</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                                     <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                                     <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), i )</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>(           &amp;</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;                                     <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;                                     <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), i )</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                      </div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;                <span class="keywordflow">ELSE</span> <span class="comment">! Compute velocity gradient at cell centers using finite differences</span></div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = mom_idx%beg; <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = mom_idx%end</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;                            <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf( j ,:,:) = &amp;</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                                  (<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf( j ,:,:) - &amp;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                                   <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(j-1,:,:))/ &amp;</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                                                    (x_cc(j) - x_cc(j-1))</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;                            <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf( j ,:,:) = &amp;</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;                                  (<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(j+1,:,:) - &amp;</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;                                   <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf( j ,:,:))/ &amp;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;                                                    (x_cc(j+1) - x_cc(j))</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;                        <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                                <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:, j ,:) = &amp;</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;                                      (<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:, j ,:) - &amp;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;                                       <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:,j-1,:))/ &amp;</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                                                        (y_cc(j) - y_cc(j-1))</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:, j ,:) = &amp;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                                      (<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:,j+1,:) - &amp;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                                       <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:, j ,:))/ &amp;</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                                                        (y_cc(j+1) - y_cc(j))</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(2,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1, j ,:) = &amp;</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;                               (<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1, j ,:) + &amp;</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1, j ,:) + &amp;</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,j-1,:) + &amp;</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,j-1,:))</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(2,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1, j ,:) = &amp;</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;                               (<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,j+1,:) + &amp;</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,j+1,:) + &amp;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1, j ,:) + &amp;</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1, j ,:))</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                                <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(1,0,0)%vf(k)%sf( j ,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) = &amp;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                               (<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf( j ,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) + &amp;</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf( j ,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) + &amp;</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                                <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(j-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) + &amp;</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(j-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:))</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(1,0,0)%vf(k)%sf( j ,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) = &amp;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;                               (<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(j+1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) + &amp;</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(j+1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) + &amp;</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                                <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf( j ,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) + &amp;</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf( j ,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:))</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;                            <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(2,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,:) = 25d-2 * &amp;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;                            <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(2,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,:)</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;                            <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(2,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) = 25d-2 * &amp;</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                            <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(2,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:)</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                            <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) = 25d-2 * &amp;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                            <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:)</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                            <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:) = 25d-2 * &amp;</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;                            <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,:)</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                            <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:,:, j ) = &amp;</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                                          (<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:,:, j ) - &amp;</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                                           <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:,:,j-1))/ &amp;</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;                                                            (z_cc(j) - z_cc(j-1))</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:,:, j ) = &amp;</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;                                          (<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:,:,j+1) - &amp;</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;                                           <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k)%sf(:,:, j ))/ &amp;</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;                                                            (z_cc(j+1) - z_cc(j))</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(1,0,0)%vf(k)%sf( j ,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = &amp;</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf( j ,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf( j ,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(j-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(j-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1))</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(1,0,0)%vf(k)%sf( j ,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = &amp;</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(j+1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(j+1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf( j ,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf( j ,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1))</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(2,0,0)%vf(k)%sf(:, j ,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = &amp;</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:, j ,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:, j ,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:,j-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:,j-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1))</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(2,0,0)%vf(k)%sf(:, j ,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = &amp;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:,j+1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:,j+1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:, j ,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) + &amp;</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,0,0)%vf(k)%sf(:, j ,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1))</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(3,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1, j ) = &amp;</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1, j ) + &amp;</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1, j ) + &amp;</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,j-1) + &amp;</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,j-1))</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(3,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1, j ) = &amp;</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,j+1) + &amp;</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,j+1) + &amp;</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1, j ) + &amp;</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1, j ))</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(3,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:, j ) = &amp;</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:, j ) + &amp;</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:, j ) + &amp;</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,j-1) + &amp;</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,j-1))</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(3,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:, j ) = &amp;</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                                   (<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,j+1) + &amp;</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,j+1) + &amp;</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                                    <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:, j ) + &amp;</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:, j ))</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                                <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = 25d-2 * &amp;</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                                <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1)</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                                <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = 25d-2 * &amp;</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                                <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(1,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1)</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                                <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = 25d-2 * &amp;</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                                <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1)</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                                <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = 25d-2 * &amp;</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                                <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(2,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1)</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                                <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(3,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) = 25d-2 * &amp;</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                                <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(3,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end)</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(3,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = 25d-2 * &amp;</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                                <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(3,0,0)%vf(k)%sf(:,<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1:<a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1)</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(3,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end) = 25d-2 * &amp;</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(3,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end)</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(3,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1) = 25d-2 * &amp;</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(3,0,0)%vf(k)%sf(<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1:<a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1,:,<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg:<a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1)</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                                                               <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(0,0,0)%vf(k)  )</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                                                               <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(0,0,0)%vf(k)  )</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">s_compute_fd_gradient</a>(    <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                                                       <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(k), &amp;</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                                                           <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(0,0,0)%vf(k)  )</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#aac41721bd3275fb997f51c1afaebac4a">s_get_viscous</a></div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ae70cf6ec305a948efab279a0bf802095">s_get_crv</a>(q_cons_vf, q_prim_vf, rhs_vf) <span class="comment">! -------</span></div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;            </div><div class="line"><a name="l04281"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ae70cf6ec305a948efab279a0bf802095"> 4281</a></span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: q_prim_vf</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: rhs_vf</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;            <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;               </div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = e_idx + crv_idx(l); <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;               </div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;                    <span class="comment">! Reconstruct the volume fraction at the cell boundaries</span></div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(         &amp;</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                                 <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                                                <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                                                <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;                                                        dflt_int, i  )</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;                    <span class="comment">! Average the quadrature points at the cell boundaries to</span></div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                    <span class="comment">! obtain higher-order estimate of the volume fraction</span></div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,:,:))</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,:,:))</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                  </div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                <span class="keywordflow">IF</span> (lsq_deriv) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>)</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                    <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>)</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                        <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>)</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                    <span class="comment">! Apply the scalar divergence theorem to compute the volume</span></div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                    <span class="comment">! fraction gradient at the cell center</span></div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>( &amp;</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                            <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(1,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;                            <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(1,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;                            <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), 1 )</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;            </div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>)</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;                    <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>( &amp;</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;                                <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(2,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;                                <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(2,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;                                <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), 2 )</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;            </div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>)</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;                        <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>( &amp;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(3,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;                                    <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(3,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end),   &amp;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), 3 )</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            </div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>)</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;               </div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;                <span class="comment">! Compute the gradient magnitude at the cell center</span></div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;                     <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;                         <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;                             <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e">s_compute_gradient_magnitude</a>(              &amp;</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;                                     <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;                                     <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;                                     <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                                       <a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf( crv_idx(l):    &amp;</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;                                                              crv_idx(l)  )  )</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="keywordflow">                         END DO</span></div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;            </div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;               </div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;                <span class="comment">! Reconstruct the volume fraction gradient at the cell</span></div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;                <span class="comment">! boundaries</span></div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;                   </div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(           &amp;</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                                <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                                               <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                                               <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                                                           dflt_int, i  )</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                     <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(           &amp;</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;                                                   <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;                                                               dflt_int, i  )</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                         <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                             <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>(         &amp;</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                                      <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(0,0,0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                                                     <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,:,:), &amp;</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                                                                 dflt_int, i  )</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;<span class="keywordflow">                         END IF</span></div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;                <span class="comment">! Compute the gradient magnitude at the cell boundaries</span></div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                        <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e">s_compute_gradient_magnitude</a>(               &amp;</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                                  <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                                  <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                                  <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf( crv_idx(l):    &amp;</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                                                              crv_idx(l)  )  )</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e">s_compute_gradient_magnitude</a>(               &amp;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                                  <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;                                  <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;                                  <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf( crv_idx(l):    &amp;</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;                                                              crv_idx(l)  )  )</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;                <span class="keywordflow">IF</span> (alt_crv) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;                    <span class="comment">! Compute the normalized volume fraction gradient at the</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;                    <span class="comment">! cell center</span></div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;                                <a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(i,j,k)%vf(crv_idx(l))%sf = &amp;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                                    max(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;                                <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(i,j,k)%vf(crv_idx(l))%sf = &amp;</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;                                        <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;                                        max(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                                    <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                                        <a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(i,j,k)%vf(crv_idx(l))%sf = &amp;</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;                                            <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                                            max(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                    <span class="comment">! Apply the scalar divergence theorem to compute the gradient</span></div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;                    <span class="comment">! of the gradient magnitude at the cell center</span></div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>(             &amp;</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;                            <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(1,0,0)%vf(crv_idx(l):crv_idx(l)),&amp;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                            <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(1,0,0)%vf(crv_idx(l):crv_idx(l)),&amp;</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                            <a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(0,0,0)%vf(crv_idx(l):crv_idx(l)),1)</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                    <span class="comment">! CALL s_reconstruct_cell_interior_values(dgm_alpha_dx_qp)</span></div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;        </div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;                    <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>(             &amp;</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;                                <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(2,0,0)%vf(crv_idx(l):crv_idx(l)),&amp;</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;                                <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(2,0,0)%vf(crv_idx(l):crv_idx(l)),&amp;</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;                                <a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(0,0,0)%vf(crv_idx(l):crv_idx(l)),2)</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;                        <span class="comment">! CALL s_reconstruct_cell_interior_values(dgm_alpha_dy_qp)</span></div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;                        <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>(             &amp;</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(3,0,0)%vf(crv_idx(l):crv_idx(l)),&amp;</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(3,0,0)%vf(crv_idx(l):crv_idx(l)),&amp;</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(0,0,0)%vf(crv_idx(l):crv_idx(l)),3)</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;                            <span class="comment">! CALL s_reconstruct_cell_interior_values(dgm_alpha_dz_qp)</span></div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;                    </div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;                    <span class="comment">!Apply the vector divergence theorem to compute the  </span></div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;                    <span class="comment">! Laplacian of the volume fraction at the cell center</span></div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ad6141c10a72d8ff3a9fb5f16b89bdcc3">s_apply_vector_divergence_theorem</a>(     &amp;</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;                                        <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>,       &amp;</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;                                        <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>,       &amp;</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>,       &amp;</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>,       &amp;</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>,       &amp;</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>,       &amp;</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;                                        <a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a>(crv_idx(l):crv_idx(l)))</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;              </div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;                    <span class="comment">! Compute alternate volume fraction curvature</span></div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;                    <a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>(crv_idx(l))%sf = ( <a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(0,0,0)%vf(crv_idx(l))%sf * &amp;</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(0,0,0)%vf(crv_idx(l))%sf + &amp;</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(0,0,0)%vf(crv_idx(l))%sf * &amp;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(0,0,0)%vf(crv_idx(l))%sf + &amp;</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(0,0,0)%vf(crv_idx(l))%sf * &amp;</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;                                    <a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(0,0,0)%vf(crv_idx(l))%sf - &amp;</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;                                    <a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a>(crv_idx(l))%sf ) / &amp;</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;                                    max(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(0,0,0)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;        </div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;                    <span class="comment">! Compute the normalized volume fraction gradient at the cell</span></div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;                    <span class="comment">! boundaries</span></div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;                            <a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(1,j,k)%vf(crv_idx(l))%sf =           &amp;</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;                                <a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(1,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;                                max(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(1,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;                            <a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(1,j,k)%vf(crv_idx(l))%sf =           &amp;</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;                                <a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(1,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;                                max(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(1,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;                            <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;                                <a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(2,j,k)%vf(crv_idx(l))%sf =           &amp;</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                                    <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(2,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                                    max(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(2,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                                <a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(2,j,k)%vf(crv_idx(l))%sf =           &amp;</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(2,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                                    max(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(2,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;                                <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(3,j,k)%vf(crv_idx(l))%sf =           &amp;</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(3,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                                        max(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(3,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(3,j,k)%vf(crv_idx(l))%sf =           &amp;</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;                                        <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(3,j,k)%vf(e_idx+crv_idx(l))%sf / &amp;</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;                                        max(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(3,j,k)%vf(crv_idx(l))%sf,sgm_eps)</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;               </div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                    <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg = crv_idx(l); <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;                    <span class="comment">! Average the quadrature points at the cell boundaries to</span></div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;                    <span class="comment">! obtain higher-order estimate of the normalized volume fraction</span></div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;                    <span class="comment">! gradient</span></div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(1,:,:))</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(1,:,:))</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;                    <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(2,:,:))</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(2,:,:))</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                        <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(3,:,:))</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(<a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(3,:,:))</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;                    <span class="keywordflow">IF</span> (lsq_deriv .NEQV. .true.) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                       <span class="comment">! Apply the vector divergence theorem to compute the divergence</span></div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                       <span class="comment">! of the normalized volume fraction gradient</span></div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                       <span class="keyword">CALL </span><a class="code" href="namespacem__rhs.html#ad6141c10a72d8ff3a9fb5f16b89bdcc3">s_apply_vector_divergence_theorem</a>(     &amp;</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;                                                 <a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>, &amp;</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                                                 <a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>, &amp;</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;                                                 <a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>, &amp;</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;                                                 <a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>, &amp;</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                                                 <a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>, &amp;</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;                                                 <a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>, &amp;</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;                                           <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end) )</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;                       </div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;                       <a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(crv_idx(l))%sf = -<a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(crv_idx(l))%sf</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;            <span class="comment">! END: Computing Volume Fraction Gradients and Curvatures ==========</span></div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ae70cf6ec305a948efab279a0bf802095">s_get_crv</a></div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a5735aa0dc9d5759c2056a79d4a8c484b">s_populate_variables_buffers</a>(v_vf) <span class="comment">! ---------------</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;</div><div class="line"><a name="l04559"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a5735aa0dc9d5759c2056a79d4a8c484b"> 4559</a></span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: v_vf</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;            </div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;            </div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;            <span class="comment">! Population of Buffers in x-direction =============================</span></div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;            <span class="keywordflow">IF</span>(bc_x%beg &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at beginning</span></div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;                </div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                        v_vf(i)%sf(-j,0:n,0:p) = &amp;</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                        v_vf(i)%sf( 0,0:n,0:p)</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;                </div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%beg == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at beginning</span></div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                </div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;                    </div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;                    <span class="keywordflow">DO</span> i = 1, cont_idx%end</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;                        v_vf(i)%sf(-j ,0:n,0:p) = &amp;</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;                        v_vf(i)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;                    </div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;                    v_vf(mom_idx%beg)%sf(-j ,0:n,0:p) = &amp;</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                   -v_vf(mom_idx%beg)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                    </div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+1, sys_size</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                        v_vf(i)%sf(-j ,0:n,0:p) = &amp;</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;                        v_vf(i)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;                    </div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;                </div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%beg == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at beginning</span></div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;                </div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;                        v_vf(i)%sf(  -j   ,0:n,0:p) = &amp;</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;                        v_vf(i)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;                </div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at beginning</span></div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;                </div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;                                          v_vf, 1,-1 )</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;                </div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;            </div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            <span class="keywordflow">IF</span>(bc_x%end &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at end</span></div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;                </div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;                        v_vf(i)%sf(m+j,0:n,0:p) = &amp;</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;                        v_vf(i)%sf( m ,0:n,0:p)</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                </div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%end == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at end</span></div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;                </div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                    </div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                    <span class="keywordflow">DO</span> i = 1, cont_idx%end</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                        v_vf(i)%sf(  m+j  ,0:n,0:p) = &amp;</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;                        v_vf(i)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                    </div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                    v_vf(mom_idx%beg)%sf(  m+j  ,0:n,0:p) = &amp;</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                   -v_vf(mom_idx%beg)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                    </div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+1, sys_size</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;                        v_vf(i)%sf(  m+j  ,0:n,0:p) = &amp;</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;                        v_vf(i)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;                    </div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;                </div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%end == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at end</span></div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;                </div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;                        v_vf(i)%sf(m+j,0:n,0:p) = &amp;</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;                        v_vf(i)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;                </div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at end</span></div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;                </div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;                                          v_vf, 1, 1 )</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;                </div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;            </div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            <span class="comment">! END: Population of Buffers in x-direction ========================</span></div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;            </div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;            </div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;            <span class="comment">! Population of Buffers in y-direction =============================</span></div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;            </div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;            <span class="keywordflow">IF</span>(n == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;                </div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                </div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg &lt;= -3 .AND. bc_y%beg /= -13) <span class="keywordflow">THEN</span>     <span class="comment">! Ghost-cell extrap. BC at beginning</span></div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;                </div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;                        v_vf(i)%sf(:,-j,0:p) = &amp;</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                        v_vf(i)%sf(:, 0,0:p)</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                </div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg == -13) <span class="keywordflow">THEN</span>    <span class="comment">! Axis BC at beginning</span></div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;                    <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;                        <span class="keywordflow">IF</span> (z_cc(k) &lt; pi) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;                            <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                                v_vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;                                v_vf(i)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;                             v_vf(mom_idx%beg+1)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;                            -v_vf(mom_idx%beg+1)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;                            </div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;                             v_vf(mom_idx%end)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;                            -v_vf(mom_idx%end)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;                            </div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;                            <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;                                v_vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;                                v_vf(i)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                            <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;                                v_vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;                                v_vf(i)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;                             v_vf(mom_idx%beg+1)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;                            -v_vf(mom_idx%beg+1)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;                            </div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;                             v_vf(mom_idx%end)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                            -v_vf(mom_idx%end)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                            </div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;                            <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;                                v_vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                                v_vf(i)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at beginning</span></div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                </div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                    </div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;                        v_vf(i)%sf(:,-j ,0:p) = &amp;</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;                        v_vf(i)%sf(:,j-1,0:p)</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                    </div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;                    v_vf(mom_idx%beg+1)%sf(:,-j ,0:p) = &amp;</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;                   -v_vf(mom_idx%beg+1)%sf(:,j-1,0:p)</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;                    </div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+2, sys_size</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;                        v_vf(i)%sf(:,-j ,0:p) = &amp;</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;                        v_vf(i)%sf(:,j-1,0:p)</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;                    </div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;                </div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at beginning</span></div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;                </div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                        v_vf(i)%sf(:,  -j   ,0:p) = &amp;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;                        v_vf(i)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;                </div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at beginning</span></div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;                </div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;                                          v_vf, 2,-1 )</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;                </div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;            </div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;            <span class="keywordflow">IF</span>(bc_y%end &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at end</span></div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                </div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                        v_vf(i)%sf(:,n+j,0:p) = &amp;</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;                        v_vf(i)%sf(:, n ,0:p)</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                </div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%end == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at end</span></div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                </div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                    </div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                        v_vf(i)%sf(:,  n+j  ,0:p) = &amp;</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                        v_vf(i)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;                    </div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;                    v_vf(mom_idx%beg+1)%sf(:,  n+j  ,0:p) = &amp;</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                   -v_vf(mom_idx%beg+1)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;                    </div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+2, sys_size</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;                        v_vf(i)%sf(:,  n+j  ,0:p) = &amp;</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                        v_vf(i)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;                    </div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;                </div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%end == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at end</span></div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                </div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;                        v_vf(i)%sf(:,n+j,0:p) = &amp;</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                        v_vf(i)%sf(:,j-1,0:p)</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                </div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at end</span></div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;                </div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;                                          v_vf, 2, 1 )</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                </div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;            </div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;            <span class="comment">! END: Population of Buffers in y-direction ========================</span></div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;            </div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;            </div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;            <span class="comment">! Population of Buffers in z-direction =============================</span></div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;            </div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;            <span class="keywordflow">IF</span>(p == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                </div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                </div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%beg &lt;= -3) <span class="keywordflow">THEN</span>     <span class="comment">! Ghost-cell extrap. BC at beginning</span></div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                </div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                        v_vf(i)%sf(:,:,-j) = &amp;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                        v_vf(i)%sf(:,:, 0)</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                </div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%beg == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at beginning</span></div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                </div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;                    </div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg+1</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                        v_vf(i)%sf(:,:,-j ) = &amp;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                        v_vf(i)%sf(:,:,j-1)</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                    </div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                    v_vf(mom_idx%end)%sf(:,:,-j ) = &amp;</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                   -v_vf(mom_idx%end)%sf(:,:,j-1)</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                    </div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;                    <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                        v_vf(i)%sf(:,:,-j ) = &amp;</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;                        v_vf(i)%sf(:,:,j-1)</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                    </div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;                </div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%beg == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at beginning</span></div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                </div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;                        v_vf(i)%sf(:,:,  -j   ) = &amp;</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;                        v_vf(i)%sf(:,:,p-(j-1))</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                </div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at beginning</span></div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;                </div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;                                          v_vf, 3,-1 )</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;                </div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;            </div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;            <span class="keywordflow">IF</span>(bc_z%end &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at end</span></div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;                </div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;                        v_vf(i)%sf(:,:,p+j) = &amp;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;                        v_vf(i)%sf(:,:, p )</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;                </div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%end == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at end</span></div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;                </div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;                    </div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg+1</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                        v_vf(i)%sf(:,:,  p+j  ) = &amp;</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                        v_vf(i)%sf(:,:,p-(j-1))</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;                    </div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;                    v_vf(mom_idx%end)%sf(:,:,  p+j  ) = &amp;</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;                   -v_vf(mom_idx%end)%sf(:,:,p-(j-1))</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;                    </div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;                    <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;                        v_vf(i)%sf(:,:,  p+j  ) = &amp;</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;                        v_vf(i)%sf(:,:,p-(j-1))</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;                    </div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;                </div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%end == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at end</span></div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;                </div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;                        v_vf(i)%sf(:,:,p+j) = &amp;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;                        v_vf(i)%sf(:,:,j-1)</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;                </div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at end</span></div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;                </div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;                                          v_vf, 3, 1 )</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;                </div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;            </div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;            <span class="comment">! END: Population of Buffers in z-direction ========================</span></div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;            </div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;            </div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a5735aa0dc9d5759c2056a79d4a8c484b">s_populate_variables_buffers</a> <span class="comment">! -------------</span></div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a2647dbdf6b09315564ef060e1f49df0d">s_populate_conservative_variables_buffers</a>() <span class="comment">! ---------------</span></div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;           </div><div class="line"><a name="l04900"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a2647dbdf6b09315564ef060e1f49df0d"> 4900</a></span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;            </div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;            <span class="comment">! Population of Buffers in x-direction =============================</span></div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;            </div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;            <span class="keywordflow">IF</span>(bc_x%beg &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at beginning</span></div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;                </div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(-j,0:n,0:p) = &amp;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf( 0,0:n,0:p)</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;                </div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%beg == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at beginning</span></div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;                </div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;                    </div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                    <span class="keywordflow">DO</span> i = 1, cont_idx%end</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(-j ,0:n,0:p) = &amp;</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;                    </div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg)%sf(-j ,0:n,0:p) = &amp;</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;                   -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;                    </div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+1, sys_size</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(-j ,0:n,0:p) = &amp;</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;                    </div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;                </div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%beg == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at beginning</span></div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;                </div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(  -j   ,0:n,0:p) = &amp;</div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                </div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at beginning</span></div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;                </div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                                          <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf, 1,-1 )</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;                </div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;            </div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;            <span class="keywordflow">IF</span>(bc_x%end &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at end</span></div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;                </div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(m+j,0:n,0:p) = &amp;</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf( m ,0:n,0:p)</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;                </div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%end == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at end</span></div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;                </div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;                    </div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;                    <span class="keywordflow">DO</span> i = 1, cont_idx%end</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(  m+j  ,0:n,0:p) = &amp;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;                    </div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg)%sf(  m+j  ,0:n,0:p) = &amp;</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;                   -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;                    </div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+1, sys_size</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(  m+j  ,0:n,0:p) = &amp;</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(m-(j-1),0:n,0:p)</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;                    </div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;                </div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_x%end == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at end</span></div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;                </div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(m+j,0:n,0:p) = &amp;</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(j-1,0:n,0:p)</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                </div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at end</span></div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;                </div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                                          <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf, 1, 1 )</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;                </div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;            </div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;            <span class="keywordflow">IF</span>(commute_err) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;                            <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;                                <span class="keywordflow">DO</span> r = 1, buff_size</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf(-r ,0:n,0:p) = &amp;</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(l)%sf(-r ,0:n,0:p)</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf(m+r,0:n,0:p) = &amp;</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(l)%sf(m+r,0:n,0:p)</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;            </div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;            <span class="comment">! END: Population of Buffers in x-direction ========================</span></div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;            </div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;            </div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;            <span class="comment">! Population of Buffers in y-direction =============================</span></div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;            </div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;            <span class="keywordflow">IF</span>(n == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;                </div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;                </div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg &lt;= -3 .AND. bc_y%beg /= -13) <span class="keywordflow">THEN</span>     <span class="comment">! Ghost-cell extrap. BC at beginning</span></div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;                </div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j,0:p) = &amp;</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:, 0,0:p)</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;                </div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg == -13) <span class="keywordflow">THEN</span>    <span class="comment">! Axis BC at beginning</span></div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                    <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;                        <span class="keywordflow">IF</span> (z_cc(k) &lt; pi) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;                            <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;                             <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;                            -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;                            </div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;                             <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;                            -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;                            </div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;                            <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,k+((p+1)/2))</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;                            <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;                             <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;                            -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;                            </div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;                             <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;                            -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;                            </div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;                            <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j ,     k     ) = &amp;</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;                                <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,k-((p+1)/2))</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at beginning</span></div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;                </div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;                    </div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j ,0:p) = &amp;</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,0:p)</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;                    </div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,-j ,0:p) = &amp;</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;                   -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,j-1,0:p)</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;                    </div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+2, sys_size</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,-j ,0:p) = &amp;</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,0:p)</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;                    </div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;                </div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%beg == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at beginning</span></div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;                </div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,  -j   ,0:p) = &amp;</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;                </div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at beginning</span></div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;                </div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;                                          <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf, 2,-1 )</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;                </div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;            </div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;            <span class="keywordflow">IF</span>(bc_y%end &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at end</span></div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;                </div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,n+j,0:p) = &amp;</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:, n ,0:p)</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;                </div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%end == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at end</span></div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;                </div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;                    </div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,  n+j  ,0:p) = &amp;</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                    </div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,  n+j  ,0:p) = &amp;</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;                   -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%beg+1)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;                    </div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                    <span class="keywordflow">DO</span> i = mom_idx%beg+2, sys_size</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,  n+j  ,0:p) = &amp;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,n-(j-1),0:p)</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;                    </div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;                </div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_y%end == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at end</span></div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;                </div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,n+j,0:p) = &amp;</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,j-1,0:p)</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                </div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at end</span></div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;                </div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;                                          <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf, 2, 1 )</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;                </div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;            </div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;            <span class="keywordflow">IF</span>(commute_err) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                            <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                                <span class="keywordflow">DO</span> r = 1, buff_size</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf(:,-r ,0:p) = &amp;</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(l)%sf(:,-r ,0:p)</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf(:,n+r,0:p) = &amp;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(l)%sf(:,n+r,0:p)</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;            </div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;            <span class="comment">! END: Population of Buffers in y-direction ========================</span></div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;            </div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;            </div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;            <span class="comment">! Population of Buffers in z-direction =============================</span></div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;            </div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;            <span class="keywordflow">IF</span>(p == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                </div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                </div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%beg &lt;= -3) <span class="keywordflow">THEN</span>     <span class="comment">! Ghost-cell extrap. BC at beginning</span></div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                </div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,-j) = &amp;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:, 0)</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                </div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%beg == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at beginning</span></div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                </div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                    </div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg+1</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,-j ) = &amp;</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,j-1)</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                    </div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,:,-j ) = &amp;</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;                   -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,:,j-1)</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                    </div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                    <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,-j ) = &amp;</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,j-1)</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;                    </div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;                </div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%beg == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at beginning</span></div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;                </div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,  -j   ) = &amp;</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,p-(j-1))</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;                </div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at beginning</span></div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;                </div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                                          <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf, 3,-1 )</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                </div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;            </div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;            <span class="keywordflow">IF</span>(bc_z%end &lt;= -3) <span class="keywordflow">THEN</span>         <span class="comment">! Ghost-cell extrap. BC at end</span></div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                </div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,p+j) = &amp;</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:, p )</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;                </div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%end == -2) <span class="keywordflow">THEN</span>     <span class="comment">! Symmetry BC at end</span></div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;                </div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;                <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;                    </div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;                    <span class="keywordflow">DO</span> i = 1, mom_idx%beg+1</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,  p+j  ) = &amp;</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,p-(j-1))</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;                    </div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,:,  p+j  ) = &amp;</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;                   -<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(mom_idx%end)%sf(:,:,p-(j-1))</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                    </div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;                    <span class="keywordflow">DO</span> i = e_idx, sys_size</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,  p+j  ) = &amp;</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,p-(j-1))</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;                    </div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;                </div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;            <span class="keywordflow">ELSEIF</span>(bc_z%end == -1) <span class="keywordflow">THEN</span>     <span class="comment">! Periodic BC at end</span></div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;                </div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;                    <span class="keywordflow">DO</span> j = 1, buff_size</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,p+j) = &amp;</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;                        <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(i)%sf(:,:,j-1)</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;                </div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Processor BC at end</span></div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;                </div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;                <span class="keyword">CALL </span>s_mpi_sendrecv_conservative_variables_buffers( &amp;</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;                                          <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf, 3, 1 )</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;                </div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;            </div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;            <span class="keywordflow">IF</span>(commute_err) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;                            <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;                                <span class="keywordflow">DO</span> r = 1, buff_size</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf(:,:,-r ) = &amp;</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(l)%sf(:,:,-r )</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf(:,:,p+r) = &amp;</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                                    <a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(0,0,0)%vf(l)%sf(:,:,p+r)</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;            </div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;            <span class="comment">! END: Population of Buffers in z-direction ========================</span></div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;            </div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;            </div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a2647dbdf6b09315564ef060e1f49df0d">s_populate_conservative_variables_buffers</a> <span class="comment">! -------------</span></div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        </div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;        </div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;        </div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a>(v_qp) <span class="comment">! ------------------</span></div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;           </div><div class="line"><a name="l05291"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1"> 5291</a></span>&#160;            </div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;            <span class="keywordtype">TYPE</span>(vector_field),             &amp;</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;            <span class="keywordtype">DIMENSION( ieta%beg:ieta%end,   &amp;
                       iksi%beg:iksi%end,   &amp;
                       itau%beg:itau%end )</span>, &amp;</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: v_qp</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;            </div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;            <span class="keywordtype">TYPE</span>(bounds_info) :: is1,is2,is3</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;            </div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;            <span class="comment">! Reconstruction in x-direction ====================================</span></div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;            <span class="keywordflow">IF</span>(commute_err .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;            </div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;            is1 = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>; is2 = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>; is3 = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a></div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;            </div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;            is1%beg = is1%beg + weno_polyn; is1%end = is1%end - weno_polyn</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;            </div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp( 0, 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                         v_qp(-1, 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                         v_qp( 1, 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                         dflt_int, 1, 1, 2, is1,is2,is3    )</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;            </div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;            </div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;            <span class="comment">! Reconstruction in y-direction ====================================</span></div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;            <span class="keywordflow">IF</span>(n == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;            </div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;            is2%beg = is2%beg + weno_polyn; is2%end = is2%end - weno_polyn</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;            </div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp(-1, 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;                         v_qp(-1,-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;                         v_qp(-1, 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;                         dflt_int, 1, 2, 2, is1,is2,is3    )</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp( 1, 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;                         v_qp( 1,-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;                         v_qp( 1, 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;                         dflt_int, 1, 2, 2, is1,is2,is3    )</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;            </div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;            </div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;            <span class="comment">! Reconstruction in z-direction ====================================</span></div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;            <span class="keywordflow">IF</span>(p == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;            </div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;            is3%beg = is3%beg + weno_polyn; is3%end = is3%end - weno_polyn</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;            </div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp(-1,-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;                         v_qp(-1,-1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;                         v_qp(-1,-1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;                         dflt_int, 1, 3, 2, is1,is2,is3    )</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp(-1, 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;                         v_qp(-1, 1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;                         v_qp(-1, 1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;                         dflt_int, 1, 3, 2, is1,is2,is3    )</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp( 1,-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;                         v_qp( 1,-1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                         v_qp( 1,-1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;                         dflt_int, 1, 3, 2, is1,is2,is3    )</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;            <span class="keyword">CALL </span>s_weno( v_qp( 1, 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;                         v_qp( 1, 1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;                         v_qp( 1, 1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;                         dflt_int, 1, 3, 2, is1,is2,is3    )</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;            </div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;            </div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">s_reconstruct_cell_interior_values</a> <span class="comment">! --------------------</span></div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;        </div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;        </div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;        </div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ab3b720ac99f76621fd7086da9405490f">s_average_cell_interior_values</a>(v_qp) <span class="comment">! ----------------------</span></div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;            <span class="keywordtype">TYPE</span>(vector_field),             &amp;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;            <span class="keywordtype">DIMENSION( ieta%beg:ieta%end,   &amp;
                       iksi%beg:iksi%end,   &amp;
                       itau%beg:itau%end )</span>, &amp;</div><div class="line"><a name="l05367"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ab3b720ac99f76621fd7086da9405490f"> 5367</a></span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: v_qp</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;            </div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;            </div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;            </div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;            <span class="keywordflow">IF</span>(commute_err .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;            </div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                </div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;                v_qp(0,0,0)%vf(l)%sf = 0d0</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;                </div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end, 2</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end, 2</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end, 2</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;                            v_qp(0,0,0)%vf(l)%sf = v_qp(0,0,0)%vf(l)%sf &amp;</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;                                                 + v_qp(i,j,k)%vf(l)%sf</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;                </div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;                v_qp(0,0,0)%vf(l)%sf = v_qp(0,0,0)%vf(l)%sf / (2**num_dims)</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;                </div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;            </div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;            </div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ab3b720ac99f76621fd7086da9405490f">s_average_cell_interior_values</a> <span class="comment">! ------------------------</span></div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;        </div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;        </div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;        </div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;        </div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a>( v_vf, vL_qp, vR_qp, &amp; ! -</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;                                                        cd_vars, norm_dir  )</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;           </div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field), <span class="keywordtype">DIMENSION(iv%beg:iv%end)</span>, <span class="keywordtype">INTENT(IN)</span> :: v_vf</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;            </div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;            <span class="keywordtype">TYPE</span>(vector_field),             &amp;</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;            <span class="keywordtype">DIMENSION( ichi%beg:ichi%end,   &amp;
                       ipsi%beg:ipsi%end )</span>, &amp;</div><div class="line"><a name="l05415"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260"> 5415</a></span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: vL_qp, vR_qp</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;            </div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: cd_vars</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;            </div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;            <span class="keywordtype">INTEGER</span> :: weno_dir</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;            <span class="keywordtype">TYPE</span>(bounds_info) :: is1,is2,is3</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;            </div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;            <span class="comment">! Reconstruction in s1-direction ===================================</span></div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;            is1 = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>; is2 = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>; is3 = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a></div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;            </div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;                weno_dir = 1; is1%beg = is1%beg + weno_polyn</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;                              is1%end = is1%end - weno_polyn</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;                weno_dir = 2; is2%beg = is2%beg + weno_polyn</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;                              is2%end = is2%end - weno_polyn</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;                weno_dir = 3; is3%beg = is3%beg + weno_polyn</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;                              is3%end = is3%end - weno_polyn</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;            </div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;            <span class="keyword">CALL </span>s_weno(            v_vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;                         vl_qp( 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                         vr_qp( 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;                         cd_vars, norm_dir, weno_dir, 1, &amp;</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;            </div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;            <span class="comment">! Reconstruction in s2-direction ===================================</span></div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;            <span class="keywordflow">IF</span>(split_err .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;            </div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;            <span class="keywordflow">IF</span>(norm_dir /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                weno_dir = 1; is1%beg = is1%beg + weno_polyn</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;                              is1%end = is1%end - weno_polyn</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;                weno_dir = 2; is2%beg = is2%beg + weno_polyn</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;                              is2%end = is2%end - weno_polyn</div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;            </div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;            <span class="keyword">CALL </span>s_weno( vl_qp( 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;                         vl_qp(-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;                         vl_qp( 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;                         dflt_int, norm_dir,weno_dir, 2, &amp;</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;            <span class="keyword">CALL </span>s_weno( vr_qp( 0, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;                         vr_qp(-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;                         vr_qp( 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;                         dflt_int, norm_dir,weno_dir, 2, &amp;</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;            </div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;            </div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;            <span class="comment">! Reconstruction in s3-direction ===================================</span></div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;            <span class="keywordflow">IF</span>(p == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;            </div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;            <span class="keywordflow">IF</span>(norm_dir /= 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;                weno_dir = 3; is3%beg = is3%beg + weno_polyn</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;                              is3%end = is3%end - weno_polyn</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;                weno_dir = 2; is2%beg = is2%beg + weno_polyn</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;                              is2%end = is2%end - weno_polyn</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;            </div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;            <span class="keyword">CALL </span>s_weno( vl_qp(-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;                         vl_qp(-1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;                         vl_qp(-1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;                         dflt_int, norm_dir,weno_dir, 2, &amp;</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;            <span class="keyword">CALL </span>s_weno( vl_qp( 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;                         vl_qp( 1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;                         vl_qp( 1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;                         dflt_int, norm_dir,weno_dir, 2, &amp;</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;            <span class="keyword">CALL </span>s_weno( vr_qp(-1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;                         vr_qp(-1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;                         vr_qp(-1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;                         dflt_int, norm_dir,weno_dir, 2, &amp;</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;            <span class="keyword">CALL </span>s_weno( vr_qp( 1, 0)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;                         vr_qp( 1,-1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;                         vr_qp( 1, 1)%vf(<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg:<a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end), &amp;</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;                         dflt_int, norm_dir,weno_dir, 2, &amp;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;                         is1,is2,is3                     )</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;            </div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;            </div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">s_reconstruct_cell_boundary_values</a> <span class="comment">! --------------------</span></div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;        </div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;        </div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;        </div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a>(vK_qp) <span class="comment">! ---------------------</span></div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;            </div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;            <span class="keywordtype">TYPE</span>(vector_field),             &amp;</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;            <span class="keywordtype">DIMENSION( ichi%beg:ichi%end,   &amp;
                       ipsi%beg:ipsi%end )</span>, &amp;</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: vK_qp</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;            </div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l05522"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae"> 5522</a></span>&#160;            </div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;            <span class="keywordflow">IF</span>(split_err .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;            </div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;                </div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;                vk_qp(0,0)%vf(k)%sf = 0d0</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;                </div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end, 2</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end, 2</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;                        vk_qp(0,0)%vf(k)%sf = vk_qp(0,0)%vf(k)%sf &amp;</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;                                            + vk_qp(i,j)%vf(k)%sf</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;                </div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;                vk_qp(0,0)%vf(k)%sf = vk_qp(0,0)%vf(k)%sf / (2**(num_dims - 1))</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;                </div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;            </div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;            </div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">s_average_cell_boundary_values</a> <span class="comment">! ------------------------</span></div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;        </div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;        </div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;        </div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;        </div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a>( vL_vf, vR_vf, &amp; ! --------</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;                                                          dv_ds_vf, &amp;</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;                                                          norm_dir  )</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field),       &amp;</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;            <span class="keywordtype">DIMENSION(iv%beg:iv%end)</span>, &amp;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: vL_vf, vR_vf</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;            </div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field),       &amp;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;            <span class="keywordtype">DIMENSION(iv%beg:iv%end)</span>, &amp;</div><div class="line"><a name="l05565"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb"> 5565</a></span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: dv_ds_vf</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;            </div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;            </div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;            </div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;            <span class="comment">! First-Order Spatial Derivatives in x-direction ===================</span></div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;                </div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;                <span class="comment">! A general application of the scalar divergence theorem that</span></div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;                <span class="comment">! utilizes the left and right cell-boundary integral-averages,</span></div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;                <span class="comment">! inside each cell, or an arithmetic mean of these two at the</span></div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;                <span class="comment">! cell-boundaries, to calculate the cell-averaged first-order</span></div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;                <span class="comment">! spatial derivatives inside the cell.</span></div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;                                dv_ds_vf(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;                                             1d0/((1d0+wa_flg)*dx(j)) &amp;</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;                                       *( wa_flg*vl_vf(i)%sf(j+1,k,l) &amp;</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;                                        +        vr_vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;                                        -        vl_vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;                                        - wa_flg*vr_vf(i)%sf(j-1,k,l) )</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;                </div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;                <span class="comment">! Modifying the way the scalar divergence theorem is utilized</span></div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;                <span class="comment">! near beginning and end Riemann state extrapolation boundary</span></div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;                <span class="comment">! conditions, respectively, as to omit any contributions from</span></div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;                <span class="comment">! outside the physical computational domain in the calculated</span></div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;                <span class="comment">! cell-averaged first-order spatial derivatives</span></div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;                <span class="keywordflow">IF</span>(weno_avg .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;                </div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;                <span class="keywordflow">IF</span>(bc_x%beg == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at beg.</span></div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;                                dv_ds_vf(i)%sf(0,k,l) = 1d0/dx(0) &amp;</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;                                            *( vr_vf(i)%sf(0,k,l) &amp;</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;                                             - vl_vf(i)%sf(0,k,l) )</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;                </div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;                <span class="keywordflow">IF</span>(bc_x%end == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;                                dv_ds_vf(i)%sf(m,k,l) = 1d0/dx(m) &amp;</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;                                            *( vr_vf(i)%sf(m,k,l) &amp;</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;                                             - vl_vf(i)%sf(m,k,l) )</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;            <span class="comment">! END: First-Order Spatial Derivatives in x-direction ==============</span></div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;            </div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;            </div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;            <span class="comment">! First-Order Spatial Derivatives in y-direction ===================</span></div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;                </div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;                <span class="comment">! A general application of the scalar divergence theorem that</span></div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;                <span class="comment">! utilizes the left and right cell-boundary integral-averages,</span></div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;                <span class="comment">! inside each cell, or an arithmetic mean of these two at the</span></div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;                <span class="comment">! cell-boundaries, to calculate the cell-averaged first-order</span></div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;                <span class="comment">! spatial derivatives inside the cell.</span></div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;                                dv_ds_vf(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;                                             1d0/((1d0+wa_flg)*dy(k)) &amp;</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;                                       *( wa_flg*vl_vf(i)%sf(j,k+1,l) &amp;</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;                                        +        vr_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;                                        -        vl_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;                                        - wa_flg*vr_vf(i)%sf(j,k-1,l) )</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;                </div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;                <span class="comment">! Modifying the way the scalar divergence theorem is utilized</span></div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;                <span class="comment">! near beginning and end Riemann state extrapolation boundary</span></div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;                <span class="comment">! conditions, respectively, as to omit any contributions from</span></div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;                <span class="comment">! outside the physical computational domain in the calculated</span></div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;                <span class="comment">! cell-averaged first-order spatial derivatives</span></div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;                <span class="keywordflow">IF</span>(weno_avg .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;                </div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;                <span class="keywordflow">IF</span>(bc_y%beg == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at beg.</span></div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;                                dv_ds_vf(i)%sf(j,0,l) = 1d0/dy(0) &amp;</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;                                            *( vr_vf(i)%sf(j,0,l) &amp;</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;                                             - vl_vf(i)%sf(j,0,l) )</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;                </div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;                <span class="keywordflow">IF</span>(bc_y%end == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;                                dv_ds_vf(i)%sf(j,n,l) = 1d0/dy(n) &amp;</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;                                            *( vr_vf(i)%sf(j,n,l) &amp;</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;                                             - vl_vf(i)%sf(j,n,l) )</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;            <span class="comment">! END: First-Order Spatial Derivatives in y-direction ==============</span></div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;            </div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;            </div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;            <span class="comment">! First-Order Spatial Derivatives in z-direction ===================</span></div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;                </div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;                <span class="comment">! A general application of the scalar divergence theorem that</span></div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;                <span class="comment">! utilizes the left and right cell-boundary integral-averages,</span></div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;                <span class="comment">! inside each cell, or an arithmetic mean of these two at the</span></div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;                <span class="comment">! cell-boundaries, to calculate the cell-averaged first-order</span></div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;                <span class="comment">! spatial derivatives inside the cell.</span></div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;                                dv_ds_vf(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;                                             1d0/((1d0+wa_flg)*dz(l)) &amp;</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;                                       *( wa_flg*vl_vf(i)%sf(j,k,l+1) &amp;</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;                                        +        vr_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;                                        -        vl_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;                                        - wa_flg*vr_vf(i)%sf(j,k,l-1) )</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;                </div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;                <span class="comment">! Modifying the way the scalar divergence theorem is utilized</span></div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;                <span class="comment">! near beginning and end Riemann state extrapolation boundary</span></div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;                <span class="comment">! conditions, respectively, as to omit any contributions from</span></div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;                <span class="comment">! outside the physical computational domain in the calculated</span></div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;                <span class="comment">! cell-averaged first-order spatial derivatives</span></div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;                <span class="keywordflow">IF</span>(weno_avg .NEQV. .true.) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;                </div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;                <span class="keywordflow">IF</span>(bc_z%beg == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at beg.</span></div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;                                dv_ds_vf(i)%sf(j,k,0) = 1d0/dz(0) &amp;</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;                                            *( vr_vf(i)%sf(j,k,0) &amp;</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;                                             - vl_vf(i)%sf(j,k,0) )</div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;                </div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;                <span class="keywordflow">IF</span>(bc_z%end == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;                                dv_ds_vf(i)%sf(j,k,p) = 1d0/dz(p) &amp;</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;                                            *( vr_vf(i)%sf(j,k,p) &amp;</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;                                             - vl_vf(i)%sf(j,k,p) )</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;                </div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;            <span class="comment">! END: First-Order Spatial Derivatives in z-direction ==============</span></div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;            </div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;            </div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">s_apply_scalar_divergence_theorem</a> <span class="comment">! ---------------------</span></div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;        </div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;        </div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;        </div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ad6141c10a72d8ff3a9fb5f16b89bdcc3">s_apply_vector_divergence_theorem</a>(       &amp; ! ----------------</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;                           vL_x_ndqp, vL_y_ndqp, vL_z_ndqp, &amp;</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;                           vR_x_ndqp, vR_y_ndqp, vR_z_ndqp, &amp;</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;                                                  div_v_vf  )</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;            </div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;            <span class="keywordtype">TYPE</span>(vector_field),             &amp;</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;            <span class="keywordtype">DIMENSION(     1   :num_dims,   &amp;
                       ichi%beg:ichi%end,   &amp;
                       ipsi%beg:ipsi%end )</span>, &amp;</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: vL_x_ndqp, vR_x_ndqp, &amp;</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;                          vL_y_ndqp, vR_y_ndqp, &amp;</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;                          vL_z_ndqp, vR_z_ndqp</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;            </div><div class="line"><a name="l05767"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ad6141c10a72d8ff3a9fb5f16b89bdcc3"> 5767</a></span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field),       &amp;</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;            <span class="keywordtype">DIMENSION(iv%beg:iv%end)</span>, &amp;</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: div_v_vf</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;            </div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;            </div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;            </div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;            <span class="comment">! First-Order Spatial Derivatives in x-direction ===================</span></div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;            </div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;            <span class="comment">! General application of the vector divergence theorem which uses</span></div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;            <span class="comment">! the left and right cell-boundary integral-averages, inside each</span></div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;            <span class="comment">! cell, or an arithmetic mean of these two at the cell-boundaries,</span></div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;            <span class="comment">! in order to obtain cell-average first-order spatial derivatives</span></div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;            <span class="comment">! inside the cell</span></div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg+1, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end-1</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;                            div_v_vf(i)%sf(j,k,l) = 1d0/((1d0+wa_flg)*dx(j)) &amp;</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;                                *( wa_flg*vl_x_ndqp(1,0,0)%vf(i)%sf(j+1,k,l) &amp;</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;                                 +        vr_x_ndqp(1,0,0)%vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;                                 -        vl_x_ndqp(1,0,0)%vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;                                 - wa_flg*vr_x_ndqp(1,0,0)%vf(i)%sf(j-1,k,l) )</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;            </div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;            <span class="comment">! Customizing the way the vector divergence theorem is applied near</span></div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;            <span class="comment">! beginning and end Riemann state extrapolation boundary conditions,</span></div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;            <span class="comment">! respectively, as to avoid contributions from outside the physical</span></div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;            <span class="comment">! computational domain in the computation of the cell-average first-</span></div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;            <span class="comment">! order spatial derivatives</span></div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;            <span class="keywordflow">IF</span>(weno_avg) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;                <span class="keywordflow">IF</span>(bc_x%beg == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at beg.</span></div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;                                div_v_vf(i)%sf(0,k,l) = &amp;</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;                                       div_v_vf(i)%sf(0,k,l) - 5d-1/dx(0) &amp;</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;                                    *( vl_x_ndqp(1,0,0)%vf(i)%sf( 1 ,k,l) &amp;</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;                                     - vr_x_ndqp(1,0,0)%vf(i)%sf( 0 ,k,l) &amp;</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;                                     + vl_x_ndqp(1,0,0)%vf(i)%sf( 0 ,k,l) &amp;</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;                                     - vr_x_ndqp(1,0,0)%vf(i)%sf(-1 ,k,l) )</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;                </div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;                <span class="keywordflow">IF</span>(bc_x%end == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;                                div_v_vf(i)%sf(m,k,l) = &amp;</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;                                       div_v_vf(i)%sf(m,k,l) - 5d-1/dx(m) &amp;</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;                                    *( vl_x_ndqp(1,0,0)%vf(i)%sf(m+1,k,l) &amp;</div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;                                     - vr_x_ndqp(1,0,0)%vf(i)%sf( m ,k,l) &amp;</div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;                                     + vl_x_ndqp(1,0,0)%vf(i)%sf( m ,k,l) &amp;</div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;                                     - vr_x_ndqp(1,0,0)%vf(i)%sf(m-1,k,l) )</div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;                </div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;            </div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;            <span class="comment">! END: First-Order Spatial Derivatives in x-direction ==============</span></div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;            </div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;            </div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;            <span class="comment">! First-Order Spatial Derivatives in y-direction ===================</span></div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;            </div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;            <span class="comment">! General application of the vector divergence theorem which uses</span></div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;            <span class="comment">! the left and right cell-boundary integral-averages, inside each</span></div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;            <span class="comment">! cell, or an arithmetic mean of these two at the cell-boundaries,</span></div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;            <span class="comment">! in order to obtain cell-average first-order spatial derivatives</span></div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;            <span class="comment">! inside the cell</span></div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;            <span class="keywordflow">IF</span>(n == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;            </div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg+1, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end-1</div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;                            div_v_vf(i)%sf(j,k,l) =    div_v_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;                                                  + 1d0/((1d0+wa_flg)*dy(k)) &amp;</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;                                *( wa_flg*vl_y_ndqp(2,0,0)%vf(i)%sf(j,k+1,l) &amp;</div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;                                 +        vr_y_ndqp(2,0,0)%vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;                                 -        vl_y_ndqp(2,0,0)%vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;                                 - wa_flg*vr_y_ndqp(2,0,0)%vf(i)%sf(j,k-1,l) )</div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;            </div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;            <span class="comment">! Customizing the way the vector divergence theorem is applied near</span></div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;            <span class="comment">! beginning and end Riemann state extrapolation boundary conditions,</span></div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;            <span class="comment">! respectively, as to avoid contributions from outside the physical</span></div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;            <span class="comment">! computational domain in the computation of the cell-average first-</span></div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;            <span class="comment">! order spatial derivatives</span></div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;            <span class="keywordflow">IF</span>(weno_avg) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;</div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;                <span class="keywordflow">IF</span>(bc_y%beg == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at beg.</span></div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;                                div_v_vf(i)%sf(j,0,l) = &amp;</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;                                       div_v_vf(i)%sf(j,0,l) - 5d-1/dy(0) &amp;</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;                                    *( vl_y_ndqp(2,0,0)%vf(i)%sf(j, 1 ,l) &amp;</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;                                     - vr_y_ndqp(2,0,0)%vf(i)%sf(j, 0 ,l) &amp;</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;                                     + vl_y_ndqp(2,0,0)%vf(i)%sf(j, 0 ,l) &amp;</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;                                     - vr_y_ndqp(2,0,0)%vf(i)%sf(j,-1 ,l) )</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;                </div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;                <span class="keywordflow">IF</span>(bc_y%end == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;                                div_v_vf(i)%sf(j,n,l) = &amp;</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;                                       div_v_vf(i)%sf(j,n,l) - 5d-1/dy(n) &amp;</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;                                    *( vl_y_ndqp(2,0,0)%vf(i)%sf(j,n+1,l) &amp;</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;                                     - vr_y_ndqp(2,0,0)%vf(i)%sf(j, n ,l) &amp;</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;                                     + vl_y_ndqp(2,0,0)%vf(i)%sf(j, n ,l) &amp;</div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;                                     - vr_y_ndqp(2,0,0)%vf(i)%sf(j,n-1,l) )</div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;                </div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;            </div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;            <span class="comment">! END: First-Order Spatial Derivatives in y-direction ==============</span></div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;            </div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;            </div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;            <span class="comment">! First-Order Spatial Derivatives in z-direction ===================</span></div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;            </div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;            <span class="comment">! General application of the vector divergence theorem which uses</span></div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;            <span class="comment">! the left and right cell-boundary integral-averages, inside each</span></div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;            <span class="comment">! cell, or an arithmetic mean of these two at the cell-boundaries,</span></div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;            <span class="comment">! in order to obtain cell-average first-order spatial derivatives</span></div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;            <span class="comment">! inside the cell</span></div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;            <span class="keywordflow">IF</span>(p == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;            </div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg+1, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end-1</div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;                            div_v_vf(i)%sf(j,k,l) =    div_v_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;                                                  + 1d0/((1d0+wa_flg)*dz(l)) &amp;</div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;                                *( wa_flg*vl_z_ndqp(3,0,0)%vf(i)%sf(j,k,l+1) &amp;</div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;                                 +        vr_z_ndqp(3,0,0)%vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;                                 -        vl_z_ndqp(3,0,0)%vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;                                 - wa_flg*vr_z_ndqp(3,0,0)%vf(i)%sf(j,k,l-1) )</div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;            </div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;            <span class="comment">! Customizing the way the vector divergence theorem is applied near</span></div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;            <span class="comment">! beginning and end Riemann state extrapolation boundary conditions,</span></div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;            <span class="comment">! respectively, as to avoid contributions from outside the physical</span></div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;            <span class="comment">! computational domain in the computation of the cell-average first-</span></div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;            <span class="comment">! order spatial derivatives</span></div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;            <span class="keywordflow">IF</span>(weno_avg) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;                <span class="keywordflow">IF</span>(bc_z%beg == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at beg.</span></div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;                                div_v_vf(i)%sf(j,k,0) = &amp;</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;                                       div_v_vf(i)%sf(j,k,0) - 5d-1/dz(0) &amp;</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;                                    *( vl_z_ndqp(3,0,0)%vf(i)%sf(j,k, 1 ) &amp;</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;                                     - vr_z_ndqp(3,0,0)%vf(i)%sf(j,k, 0 ) &amp;</div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;                                     + vl_z_ndqp(3,0,0)%vf(i)%sf(j,k, 0 ) &amp;</div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;                                     - vr_z_ndqp(3,0,0)%vf(i)%sf(j,k,-1 ) )</div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;                </div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;                <span class="keywordflow">IF</span>(bc_z%end == -4) <span class="keywordflow">THEN</span>     <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;                                div_v_vf(i)%sf(j,k,p) = &amp;</div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;                                       div_v_vf(i)%sf(j,k,p) - 5d-1/dz(p) &amp;</div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;                                    *( vl_z_ndqp(3,0,0)%vf(i)%sf(j,k,p+1) &amp;</div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;                                     - vr_z_ndqp(3,0,0)%vf(i)%sf(j,k, p ) &amp;</div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;                                     + vl_z_ndqp(3,0,0)%vf(i)%sf(j,k, p ) &amp;</div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;                                     - vr_z_ndqp(3,0,0)%vf(i)%sf(j,k,p-1) )</div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;                </div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;            </div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;            <span class="comment">! END: First-Order Spatial Derivatives in z-direction ==============</span></div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;            </div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;            </div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ad6141c10a72d8ff3a9fb5f16b89bdcc3">s_apply_vector_divergence_theorem</a> <span class="comment">! ---------------------</span></div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;        </div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;        </div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;        </div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e">s_compute_gradient_magnitude</a>( dv_dx_vf, &amp; ! -----------------</div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;                                                 dv_dy_vf, &amp;</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;                                                 dv_dz_vf, &amp;</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;                                                  gm_v_vf  )</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field),       &amp;</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;            <span class="keywordtype">DIMENSION(iv%beg:iv%end)</span>, &amp;</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: dv_dx_vf, &amp;</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;                          dv_dy_vf, &amp;</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;                          dv_dz_vf</div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;            </div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;            <span class="keywordtype">TYPE</span>(scalar_field),       &amp;</div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;            <span class="keywordtype">DIMENSION(iv%beg:iv%end)</span>, &amp;</div><div class="line"><a name="l05994"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e"> 5994</a></span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: gm_v_vf</div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;            </div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;            </div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;            <span class="comment">! Scalar Product Contribution in x-direction =======================</span></div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;                            gm_v_vf(i)%sf(j,k,l) = dv_dx_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;                                                 * dv_dx_vf(i)%sf(j,k,l)</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;            </div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;            </div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;            <span class="comment">! Scalar Product Contribution in y-direction =======================</span></div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;            <span class="keywordflow">IF</span>(n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;               </div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;                                gm_v_vf(i)%sf(j,k,l) =  gm_v_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;                                                     + dv_dy_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;                                                     * dv_dy_vf(i)%sf(j,k,l)</div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;            </div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;            </div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;            <span class="comment">! Scalar Product Contribution in z-direction =======================</span></div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;                <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;                                    gm_v_vf(i)%sf(j,k,l) =  gm_v_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;                                                         + dv_dz_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;                                                         * dv_dz_vf(i)%sf(j,k,l)</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;               </div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;            </div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;            </div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;            <span class="comment">! Square Root of the Scalar Product ================================</span></div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%beg, <a class="code" href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">iv</a>%end</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%beg, <a class="code" href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">iz</a>%end</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%beg, <a class="code" href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">iy</a>%end</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%beg, <a class="code" href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">ix</a>%end</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;                            gm_v_vf(i)%sf(j,k,l) = sqrt(gm_v_vf(i)%sf(j,k,l))</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;            </div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;            </div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e">s_compute_gradient_magnitude</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;        </div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;        </div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;        </div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;        </div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;        </div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a73fc1430500bdd1786b121a9ed08a107">s_finalize_rhs_module</a>() <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;            </div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;            </div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;            <span class="comment">! Deallocation/Disassociation of q_cons_qp and q_prim_qp ===========</span></div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l06078"></a><span class="lineno"><a class="line" href="namespacem__rhs.html#a73fc1430500bdd1786b121a9ed08a107"> 6078</a></span>&#160;                     </div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;                        <span class="keywordflow">IF</span>(i /= 0 .AND. abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;                        </div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;                            <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;                        </div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;                            <span class="keywordflow">DO</span> l = mom_idx%beg, e_idx</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;                            <span class="keywordflow">IF</span> (model_eqns == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;                                <span class="keywordflow">DO</span> l = internalenergies_idx%beg, internalenergies_idx%end</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;                        </div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;                            <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;                                <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;                        </div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;                     </div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;                     </div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;            </div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">q_cons_qp</a>, <a class="code" href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">q_prim_qp</a>)</div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;            </div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;            </div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;            <span class="comment">! Deallocation/Disassociation of qK_cons_ndqp and qK_prim_ndqp =====</span></div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;                    <span class="keywordflow">DO</span> i = num_dims, 1, -1</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;                     </div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;                        <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;                        </div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;                            <span class="keywordflow">DO</span> l = 1, cont_idx%end</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                                <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;                                <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;                        </div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;                            <span class="keywordflow">DO</span> l = adv_idx%beg, adv_idx%end</div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;                                <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;                                <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;                            </div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;                            <span class="keywordflow">IF</span>(i /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;                               </div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                                <span class="keywordflow">IF</span>( (char_decomp .NEQV. .true.) &amp;</div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;                                               .AND.            &amp;</div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;                                        any(re_size &gt; 0)       ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;                                    <span class="keywordflow">IF</span>(weno_vars == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;                                        <span class="keywordflow">DO</span> l = 1, mom_idx%end</div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;                                        <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;                                        <span class="keywordflow">IF</span> (model_eqns == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;                                            <span class="keywordflow">DO</span> l = internalenergies_idx%beg, internalenergies_idx%end</div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;                                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;                                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;<span class="keywordflow">                                            END DO</span></div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;                               </div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;                                <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;                                                 e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;                                                 e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;                               </div><div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;                                <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;                                    <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;                                    <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;                                    <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;                                    <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;                               </div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;                               </div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;                                <span class="keywordflow">DO</span> l = 1, cont_idx%end</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;                               </div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;                                <span class="keywordflow">IF</span>(weno_vars == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;                                    <span class="keywordflow">DO</span> l = mom_idx%beg, e_idx</div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;                               </div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;                                <span class="keywordflow">DO</span> l = mom_idx%beg, e_idx</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;                                <span class="keywordflow">IF</span> (model_eqns == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;                                    <span class="keywordflow">DO</span> l = internalenergies_idx%beg, internalenergies_idx%end</div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;                               </div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;                                <span class="keywordflow">DO</span> l = adv_idx%beg, adv_idx%end</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;                               </div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;                        </div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;                     </div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;                     </div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;            </div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">ql_cons_ndqp</a>, <a class="code" href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">qr_cons_ndqp</a>, <a class="code" href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">ql_prim_ndqp</a>, <a class="code" href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">qr_prim_ndqp</a>)</div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;            <span class="comment">! END: Deallocation/Disassociation of qK_cons_ndqp and qK_prim_ndqp</span></div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;            </div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;            </div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;            <span class="comment">! Deallocation of dq_prim_ds_qp ====================================</span></div><div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;            <span class="keywordflow">IF</span>(any(re_size &gt; 0) .OR. we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;               </div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;                        </div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;                            <span class="keywordflow">IF</span>(all((/i,j,k/) == 0) .AND. any(re_size &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;                           </div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;                                <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;                           </div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;                                <span class="keywordflow">IF</span>(n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;                              </div><div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;                                    <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;                              </div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;                                    <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;                                        <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;                              </div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;                           </div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;                        </div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;                            <span class="keywordflow">IF</span>( (i /= 0 .AND. abs(j) &gt;= abs(k)) &amp;</div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;                                              .OR.              &amp;</div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;                                  all((/i,j,k/) == 0)       ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;                                <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;                                                    e_idx+crv_idx(l))%sf)</div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;                                    <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;                                                        e_idx+crv_idx(l))%sf)</div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;                                        <span class="keywordflow">IF</span> (p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;                                                            e_idx+crv_idx(l))%sf)</div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;                        </div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                        </div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;               </div><div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">dq_prim_dx_qp</a>, <a class="code" href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">dq_prim_dy_qp</a>, <a class="code" href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">dq_prim_dz_qp</a>, <a class="code" href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">gm_vel_qp</a>)</div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;               </div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;            <span class="comment">! END: Deallocation of dq_prim_ds_qp ===============================</span></div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;            </div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;            </div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;            <span class="comment">! Deallocation/Disassociation of dqK_prim_ds_ndqp ==================</span></div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;            <span class="keywordflow">IF</span>(any(re_size &gt; 0) .OR. we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;                        <span class="keywordflow">DO</span> i = num_dims, 1, -1</div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;                        </div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;                            <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;                           </div><div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;                                <span class="keywordflow">IF</span>(any(re_size &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;                              </div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;                                    <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;                              </div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;                                    <span class="keywordflow">IF</span>(n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;                                        <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;                              </div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;                                    <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;                                        <span class="keywordflow">DO</span> l = mom_idx%beg, mom_idx%end</div><div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;                              </div><div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;                           </div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;                                <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;                                                     e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;                                                     e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;                                    <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;                                                         e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;                                                         e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;                           </div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;                                <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;                                                         e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;                                                         e_idx+crv_idx(l))%sf  )</div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;                           </div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;                        </div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;                        </div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;            </div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">dql_prim_dx_ndqp</a>, <a class="code" href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">dql_prim_dy_ndqp</a>, <a class="code" href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">dql_prim_dz_ndqp</a>)</div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">dqr_prim_dx_ndqp</a>, <a class="code" href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">dqr_prim_dy_ndqp</a>, <a class="code" href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">dqr_prim_dz_ndqp</a>)</div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;            <span class="comment">! END: Deallocation/Disassociation of dqK_prim_ds_ndqp =============</span></div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;            </div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;            </div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;            <span class="comment">! Deallocation of gm_alpha_qp ======================================</span></div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;            <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;                        </div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;                            <span class="keywordflow">IF</span>(any(sum(abs((/i,j,k/))) == (/0,num_dims/))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;                                <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;                        </div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;                        </div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;            </div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">gm_alpha_qp</a>)</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;            </div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;            </div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;            <span class="comment">! Deallocation of gm_alphaK_ndqp ===================================</span></div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;            <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;                        <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;                        </div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;                            <span class="keywordflow">IF</span>(any(sum(abs((/j,k/))) == (/0,num_dims/))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;                                <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;                                                         crv_idx(l))%sf  )</div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                                                         crv_idx(l))%sf  )</div><div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;                        </div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;                        </div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;            </div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">gm_alphal_ndqp</a>, <a class="code" href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">gm_alphar_ndqp</a>)</div><div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;            </div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;            </div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;            <span class="comment">! Deallocation of un_alphaK_s_ndqp =================================</span></div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;            <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;               </div><div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;                     </div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;                        <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;                        </div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;                            <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(1,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(1,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;                                <span class="keywordflow">IF</span> (n &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(2,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(2,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;                        </div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;                            <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;                                <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(3,j,k)%vf( &amp;</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;                                                           crv_idx(l))%sf  )</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(3,j,k)%vf( &amp;</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;                                                           crv_idx(l))%sf  )</div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;                        </div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;                     </div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;                        <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;                     </div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;               </div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">un_alphal_x_ndqp</a>, <a class="code" href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">un_alphal_y_ndqp</a>, <a class="code" href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">un_alphal_z_ndqp</a>)</div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">un_alphar_x_ndqp</a>, <a class="code" href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">un_alphar_y_ndqp</a>, <a class="code" href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">un_alphar_z_ndqp</a>)</div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;               </div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;            </div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;            </div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;            <span class="comment">! Deallocation of kappa_vf =========================================</span></div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;            <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;               </div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                <span class="keywordflow">DO</span> i = 1, crv_size</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>(crv_idx(i))%sf)</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;               </div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">kappa_vf</a>)</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;               </div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;            </div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;            </div><div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;            <span class="comment">! Deallocation/Disassociation of kappaK_ndqp =======================</span></div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;            <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;                        <span class="keywordflow">DO</span> i = num_dims, 1, -1</div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;                        </div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;                            <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;                                <span class="keywordflow">IF</span>(i /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;                                                          crv_idx(l))%sf  )</div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf( &amp;</div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;                                                          crv_idx(l))%sf  )</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;                        </div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;                        </div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;            </div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">kappal_ndqp</a>, <a class="code" href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">kappar_ndqp</a>)</div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;            </div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;            <span class="keywordflow">IF</span> (alt_crv) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;                <span class="comment">! Deallocation of dgm_alpha_ds_qp &amp; un_alpha_s_qp</span></div><div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;                <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;                    <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%beg, <a class="code" href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">itau</a>%end</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;                        <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%beg, <a class="code" href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">iksi</a>%end</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%beg, <a class="code" href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">ieta</a>%end</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;    </div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;                                <span class="keywordflow">IF</span>(any(sum(abs((/i,j,k/))) == (/0,num_dims/))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, crv_size</div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(i,j,k)%vf(crv_idx(l))%sf)</div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;    </div><div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>(i,j,k)%vf)</div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;    </div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;    </div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">dgm_alpha_dx_qp</a>)</div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">dgm_alpha_dy_qp</a>)</div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">dgm_alpha_dz_qp</a>)</div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">un_alpha_x_qp</a>)</div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">un_alpha_y_qp</a>)</div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">un_alpha_z_qp</a>)</div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;</div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;            <span class="comment">! Deallocation of alt_kappa_vf &amp; laplacian_vf</span></div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;            <span class="keywordflow">IF</span>(we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                <span class="keywordflow">IF</span> (alt_crv) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;                    <span class="keywordflow">DO</span> i = 1, crv_size</div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>(crv_idx(i))%sf)</div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a>(crv_idx(i))%sf)</div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;            </div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">alt_kappa_vf</a>)</div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">laplacian_vf</a>)</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;</div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;                <span class="keywordflow">IF</span> (we_src) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">we_mtm_src</a>)</div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">we_nrg_src</a>)</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;</div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;                </div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;            <span class="keywordflow">IF</span> (we_size &gt; 0 .AND. we_rhs_flux) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;                <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(cont_idx%end+i)%sf)</div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>(e_idx)%sf)</div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;                                            </div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">tau_we_vf</a>)</div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;<span class="keywordflow">            END IF</span>    </div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;            <span class="keywordflow">IF</span> (any(re_size &gt; 0) .AND. cyl_coord) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;                <span class="keywordflow">DO</span> i = 1, num_dims</div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(cont_idx%end+i)%sf)</div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>(e_idx)%sf)</div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;                                            </div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">tau_re_vf</a>)</div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;            <span class="comment">! Deallocation of reg_src_vf</span></div><div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;            <span class="keywordflow">IF</span> (regularization) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;                <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>(i)%sf)</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">reg_src_vf</a>)</div><div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;            <span class="keywordflow">IF</span> (tvd_rhs_flux) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;                <span class="comment">! Deallocation of flux limiter variables</span></div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">flux_lim_func</a>)</div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;</div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;                        <span class="keywordflow">DO</span> i = num_dims, 1, -1</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;                            <span class="keywordflow">IF</span> (abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;                                <span class="keywordflow">IF</span> (i /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;                                        <span class="keyword">NULLIFY</span>(    <a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;                                        <span class="keyword">NULLIFY</span>(    <a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;                                    <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;</div><div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;                                    <span class="keywordflow">IF</span> (any(re_size &gt; 0) .OR. we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;                                        <span class="keywordflow">DO</span> l = mom_idx%beg, e_idx</div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;                                    </div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;                                    <span class="keywordflow">IF</span> (riemann_solver == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;                                        <span class="keywordflow">DO</span> l = adv_idx%beg+1, adv_idx%end</div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;                                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;                                        <span class="keywordflow">DO</span> l = adv_idx%beg+1, adv_idx%end</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;                                            <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;                                            <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;<span class="keywordflow">                                        END DO</span></div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;</div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf(adv_idx%beg)%sf)</div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf(adv_idx%beg)%sf)</div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;                            </div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;                            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;</div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">lo_flux_ndqp</a>, <a class="code" href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">lo_flux_src_ndqp</a>, <a class="code" href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">lo_flux_gsrc_ndqp</a>)</div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">hi_flux_ndqp</a>, <a class="code" href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">hi_flux_src_ndqp</a>, <a class="code" href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">hi_flux_gsrc_ndqp</a>)</div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;            <span class="comment">! Deallocation/Disassociation of flux_ndqp, flux_src_ndqp, and flux_gsrc_ndqp ====</span></div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%beg, <a class="code" href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">ipsi</a>%end</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%beg, <a class="code" href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">ichi</a>%end</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;                    <span class="keywordflow">DO</span> i = num_dims, 1, -1</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;                     </div><div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;                        <span class="keywordflow">IF</span>(abs(j) &gt;= abs(k)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;                            <span class="keywordflow">IF</span>(i /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;                           </div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;                                <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;                                    <span class="keyword">NULLIFY</span>(    <a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;                                    <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;                                    <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;                           </div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;                           </div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;                                <span class="keywordflow">DO</span> l = 1, sys_size</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;                                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;                           </div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;                                <span class="keywordflow">IF</span>(any(re_size &gt; 0) .OR. we_size &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;                                    <span class="keywordflow">DO</span> l = mom_idx%beg, e_idx</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;                           </div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;                                <span class="keywordflow">IF</span>(riemann_solver == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;                                    <span class="keywordflow">DO</span> l = adv_idx%beg+1, adv_idx%end</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;                                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;                                    <span class="keywordflow">DO</span> l = adv_idx%beg+1, adv_idx%end</div><div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;                                        <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(l)%sf)</div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;                           </div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;                                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf(adv_idx%beg)%sf)</div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;                           </div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;                     </div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>(i,j,k)%vf, <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>(i,j,k)%vf)</div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;                     </div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;            </div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">flux_ndqp</a>, <a class="code" href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">flux_src_ndqp</a>, <a class="code" href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">flux_gsrc_ndqp</a>)</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;                     </div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;            <span class="comment">! END: Deallocation/Disassociation of flux_ndqp, flux_src_ndqp, and flux_gsrc_ndqp  ===</span></div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;            </div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;            </div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;            <span class="comment">! Disassociating procedural pointer to the subroutine which was</span></div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;            <span class="comment">! utilized to calculate the solution of a given Riemann problem</span></div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;            s_riemann_solver =&gt; null()</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;            </div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;            <span class="comment">! Disassociating the pointer to the procedure that was utilized to</span></div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;            <span class="comment">! to convert mixture or species variables to the mixture variables</span></div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;            s_convert_to_mixture_variables =&gt; null()</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;            </div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__rhs.html#a73fc1430500bdd1786b121a9ed08a107">s_finalize_rhs_module</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;        </div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__rhs.html">m_rhs</a></div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;<div class="ttc" id="namespacem__rhs_html_addb553c30e5a799670b33c66a27995d6"><div class="ttname"><a href="namespacem__rhs.html#addb553c30e5a799670b33c66a27995d6">m_rhs::qr_prim_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable qr_prim_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00104">m_rhs.f90:104</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ad2c988fa9d53b74f824dfd0666df27c0"><div class="ttname"><a href="namespacem__rhs.html#ad2c988fa9d53b74f824dfd0666df27c0">m_rhs::mono_mom_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:,:), allocatable mono_mom_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00252">m_rhs.f90:252</a></div></div>
<div class="ttc" id="namespacem__rhs_html_af07ecd26e050830ebeedaae6da3eb72a"><div class="ttname"><a href="namespacem__rhs.html#af07ecd26e050830ebeedaae6da3eb72a">m_rhs::lo_flux_gsrc_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable lo_flux_gsrc_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00213">m_rhs.f90:213</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aff1140575af25247060f3e7f31a8a10f"><div class="ttname"><a href="namespacem__global__parameters.html#aff1140575af25247060f3e7f31a8a10f">m_global_parameters::t_step_stop</a></div><div class="ttdeci">integer t_step_stop</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00111">m_global_parameters.f90:111</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a6b6be41d990e9bda7c4830531d7c3470"><div class="ttname"><a href="namespacem__rhs.html#a6b6be41d990e9bda7c4830531d7c3470">m_rhs::s_get_tvd_flux</a></div><div class="ttdeci">subroutine s_get_tvd_flux(q_cons_vf, q_prim_vf, rhs_vf, i)</div><div class="ttdoc">This subroutine compute the TVD flux function. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03903">m_rhs.f90:3903</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa254277cf111be2267a61b7884279844"><div class="ttname"><a href="namespacem__global__parameters.html#aa254277cf111be2267a61b7884279844">m_global_parameters::weno_vars</a></div><div class="ttdeci">integer weno_vars</div><div class="ttdoc">WENO-reconstructed state variables type. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00124">m_global_parameters.f90:124</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a298183e270a405e0f180d45940bb6f8a"><div class="ttname"><a href="m__rhs_8f90.html#a298183e270a405e0f180d45940bb6f8a">gamma</a></div><div class="ttdeci">real(kind(0d0)) gamma</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03739">m_rhs.f90:3739</a></div></div>
<div class="ttc" id="namespacem__rhs_html_abb201391897c33f0eb782f74f88d4ec0"><div class="ttname"><a href="namespacem__rhs.html#abb201391897c33f0eb782f74f88d4ec0">m_rhs::lo_flux_src_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable lo_flux_src_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00212">m_rhs.f90:212</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6b9c81f07f8444654924e3075e4edaf8"><div class="ttname"><a href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">m_global_parameters::riemann_solver</a></div><div class="ttdeci">integer riemann_solver</div><div class="ttdoc">Riemann solver algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a40f05825c656c34602ba19e320537359"><div class="ttname"><a href="namespacem__rhs.html#a40f05825c656c34602ba19e320537359">m_rhs::dqr_prim_dy_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dqr_prim_dy_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00128">m_rhs.f90:128</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aeb611ac510e15d25ae5313627f9a55af"><div class="ttname"><a href="namespacem__rhs.html#aeb611ac510e15d25ae5313627f9a55af">m_rhs::ql_prim_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable ql_prim_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00103">m_rhs.f90:103</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a190b9d019243f3504246e0e621e4bc66"><div class="ttname"><a href="namespacem__rhs.html#a190b9d019243f3504246e0e621e4bc66">m_rhs::dqr_prim_dx_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dqr_prim_dx_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00127">m_rhs.f90:127</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ae064d7adeace0bde4fc2b42d437a01b1"><div class="ttname"><a href="namespacem__rhs.html#ae064d7adeace0bde4fc2b42d437a01b1">m_rhs::s_get_monopole</a></div><div class="ttdeci">subroutine s_get_monopole(idir, q_prim_vf, t_step, mymono)</div><div class="ttdoc">The purpose of this procedure is to compute the source term that are needed for generating one-way ac...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03200">m_rhs.f90:3200</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a5e9ec5159360030b214597511982bb81"><div class="ttname"><a href="m__rhs_8f90.html#a5e9ec5159360030b214597511982bb81">pres_inf</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids) pres_inf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03742">m_rhs.f90:3742</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ada159015fa6f204a01a0c1b254affdae"><div class="ttname"><a href="namespacem__rhs.html#ada159015fa6f204a01a0c1b254affdae">m_rhs::s_average_cell_boundary_values</a></div><div class="ttdeci">subroutine s_average_cell_boundary_values(vK_qp)</div><div class="ttdoc">The goal of the procedure is to numerically approximate the left or right cell-boundary integral-aver...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05522">m_rhs.f90:5522</a></div></div>
<div class="ttc" id="structm__derived__types_1_1vector__field_html"><div class="ttname"><a href="structm__derived__types_1_1vector__field.html">m_derived_types::vector_field</a></div><div class="ttdoc">Derived type annexing a vector field (VF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00058">m_derived_types.f90:58</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a0048c79fcd5325fffae011dc032b86fb"><div class="ttname"><a href="m__rhs_8f90.html#a0048c79fcd5325fffae011dc032b86fb">relax</a></div><div class="ttdeci">integer relax</div><div class="ttdoc">Relaxation procedure determination variable. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03748">m_rhs.f90:3748</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a4ab97e22609b5ebbb97524ca7bae05ef"><div class="ttname"><a href="namespacem__rhs.html#a4ab97e22609b5ebbb97524ca7bae05ef">m_rhs::iv</a></div><div class="ttdeci">type(bounds_info) iv</div><div class="ttdoc">Vector field indical bounds. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00233">m_rhs.f90:233</a></div></div>
<div class="ttc" id="namespacem__rhs_html"><div class="ttname"><a href="namespacem__rhs.html">m_rhs</a></div><div class="ttdoc">The module contains the subroutines used to calculate the right- hand-side (RHS) in the quasi-conserv...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00046">m_rhs.f90:46</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae8e6c40b6ec73cb126b0cce7496e0057"><div class="ttname"><a href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00189">m_global_parameters.f90:189</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a796247036b68f5c2f04db3b4c943b5f2"><div class="ttname"><a href="m__rhs_8f90.html#a796247036b68f5c2f04db3b4c943b5f2">sum_alpha</a></div><div class="ttdeci">real(kind(0d0)) sum_alpha</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03735">m_rhs.f90:3735</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2f790d774fdcc87779b89a71ae3f2674"><div class="ttname"><a href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_abstract_to_mixture_variables), pointer, public s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00158">m_variables_conversion.f90:158</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa46a7f3638e49fa9ec33ea859b9e6a5a"><div class="ttname"><a href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">m_global_parameters::bc_x</a></div><div class="ttdeci">type(bounds_info) bc_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a762d1c12479dcf998f8a5a47dc258ddc"><div class="ttname"><a href="m__rhs_8f90.html#a762d1c12479dcf998f8a5a47dc258ddc">pres_k_init</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids) pres_k_init</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03731">m_rhs.f90:3731</a></div></div>
<div class="ttc" id="namespacem__rhs_html_acc8e8d46f11ebb8f5c7389de8be28b60"><div class="ttname"><a href="namespacem__rhs.html#acc8e8d46f11ebb8f5c7389de8be28b60">m_rhs::tau_we_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable tau_we_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00204">m_rhs.f90:204</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3805bb400f71c84b76e3111dd595648d"><div class="ttname"><a href="namespacem__global__parameters.html#a3805bb400f71c84b76e3111dd595648d">m_global_parameters::alt_crv</a></div><div class="ttdeci">logical alt_crv</div><div class="ttdoc">Alternate curvature definition. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00138">m_global_parameters.f90:138</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00247">m_global_parameters.f90:247</a></div></div>
<div class="ttc" id="namespacem__rhs_html_adf3ae8008dd304f908c21bc0f0fcb2ac"><div class="ttname"><a href="namespacem__rhs.html#adf3ae8008dd304f908c21bc0f0fcb2ac">m_rhs::we_nrg_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable we_nrg_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00203">m_rhs.f90:203</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a3b8952eebc8ad3082a6dae29c2ddd480"><div class="ttname"><a href="namespacem__rhs.html#a3b8952eebc8ad3082a6dae29c2ddd480">m_rhs::lo_flux_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable lo_flux_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00211">m_rhs.f90:211</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a2d84a02a65f699f43818db9feca4e25d"><div class="ttname"><a href="m__rhs_8f90.html#a2d84a02a65f699f43818db9feca4e25d">dyn_pres</a></div><div class="ttdeci">real(kind(0d0)) dyn_pres</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03737">m_rhs.f90:3737</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7edc50538c81447bf49e9242d85ee1ff"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">m_riemann_solvers::s_riemann_solver</a></div><div class="ttdeci">procedure(s_abstract_riemann_solver), pointer, public s_riemann_solver</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00388">m_riemann_solvers.f90:388</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">The module contains all of the parameters describing the program logistics, the computational domain ...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00040">m_global_parameters.f90:40</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00048">m_derived_types.f90:48</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaa584e01b4153d246d84eef286482632"><div class="ttname"><a href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">m_global_parameters::y_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target y_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__rhs_html_adf9ba6fc1bd79727d1f7ce5fe7a302ed"><div class="ttname"><a href="namespacem__rhs.html#adf9ba6fc1bd79727d1f7ce5fe7a302ed">m_rhs::alt_kappa_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable alt_kappa_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00193">m_rhs.f90:193</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a340deb003a37dc81b7a560343242b1"><div class="ttname"><a href="namespacem__global__parameters.html#a5a340deb003a37dc81b7a560343242b1">m_global_parameters::commute_err</a></div><div class="ttdeci">logical commute_err</div><div class="ttdoc">Commutative error correction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00136">m_global_parameters.f90:136</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc2bc27e809a773b7f5a6a65edac3b89"><div class="ttname"><a href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">m_global_parameters::dy</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dy</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdoc">Number of eq. bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00282">m_global_parameters.f90:282</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a68eaaca2982b39252417b29ef5d0f9c3"><div class="ttname"><a href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">m_global_parameters::bc_y</a></div><div class="ttdeci">type(bounds_info) bc_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__bubbles_html_af5559af46da9282b9cc64db837958f90"><div class="ttname"><a href="namespacem__bubbles.html#af5559af46da9282b9cc64db837958f90">m_bubbles::s_compute_bubble_source</a></div><div class="ttdeci">subroutine s_compute_bubble_source(idir, q_prim_vf, q_cons_vf, mydivu, bub_adv_src, bub_r_src, bub_v_src, bub_p_src, bub_m_src)</div><div class="ttdoc">The purpose of this procedure is to compute the source terms that are needed for the bubble modeling...</div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00070">m_bubbles.f90:70</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adefe3b78bf286d73a56aef49880dfb0d"><div class="ttname"><a href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00186">m_global_parameters.f90:186</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a10d1ea6f5c8a0d7137be28b1e8c4780f"><div class="ttname"><a href="namespacem__rhs.html#a10d1ea6f5c8a0d7137be28b1e8c4780f">m_rhs::flux_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable flux_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00176">m_rhs.f90:176</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ab49ec164612765d8947ccf4250dd0fb0"><div class="ttname"><a href="namespacem__rhs.html#ab49ec164612765d8947ccf4250dd0fb0">m_rhs::un_alphal_x_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alphal_x_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00148">m_rhs.f90:148</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af7508eba0a53c9a35913a502d58dfb54"><div class="ttname"><a href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">m_global_parameters::dx</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a897b4f61353235b3af13bac633d5b9a0"><div class="ttname"><a href="namespacem__global__parameters.html#a897b4f61353235b3af13bac633d5b9a0">m_global_parameters::we_src</a></div><div class="ttdeci">logical we_src</div><div class="ttdoc">Account for capillary effects in non-conservative formulation in RHS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00150">m_global_parameters.f90:150</a></div></div>
<div class="ttc" id="namespacem__rhs_html_abf83c819d81616e9342f773a4067938c"><div class="ttname"><a href="namespacem__rhs.html#abf83c819d81616e9342f773a4067938c">m_rhs::divu</a></div><div class="ttdeci">type(scalar_field) divu</div><div class="ttdoc">matrix for div(u) </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00244">m_rhs.f90:244</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a2ac747380de0e6e5e11b01f4137fb75c"><div class="ttname"><a href="m__rhs_8f90.html#a2ac747380de0e6e5e11b01f4137fb75c">l</a></div><div class="ttdeci">integer l</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a09ebe4906d3bb2a6656da08fea5a4e49"><div class="ttname"><a href="namespacem__rhs.html#a09ebe4906d3bb2a6656da08fea5a4e49">m_rhs::bub_adv_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable bub_adv_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00242">m_rhs.f90:242</a></div></div>
<div class="ttc" id="namespacem__rhs_html_abe42bc1610e9369b701122a870fed48d"><div class="ttname"><a href="namespacem__rhs.html#abe42bc1610e9369b701122a870fed48d">m_rhs::ql_cons_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable ql_cons_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00095">m_rhs.f90:95</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aec977e848537c8ecd3317aefd2bd8607"><div class="ttname"><a href="namespacem__rhs.html#aec977e848537c8ecd3317aefd2bd8607">m_rhs::flux_src_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable flux_src_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00177">m_rhs.f90:177</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ace0c30f610f7a6b9e87eadd79e7197c0"><div class="ttname"><a href="namespacem__rhs.html#ace0c30f610f7a6b9e87eadd79e7197c0">m_rhs::we_mtm_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable we_mtm_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00202">m_rhs.f90:202</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_afab53b80fef38424acbbd772be46d333"><div class="ttname"><a href="m__rhs_8f90.html#afab53b80fef38424acbbd772be46d333">df_pres</a></div><div class="ttdeci">real(kind(0d0)) df_pres</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03733">m_rhs.f90:3733</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ab3b720ac99f76621fd7086da9405490f"><div class="ttname"><a href="namespacem__rhs.html#ab3b720ac99f76621fd7086da9405490f">m_rhs::s_average_cell_interior_values</a></div><div class="ttdeci">subroutine s_average_cell_interior_values(v_qp)</div><div class="ttdoc">The goal of this subroutine is to numerically approximate the cell-interior integral-average of the g...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05367">m_rhs.f90:5367</a></div></div>
<div class="ttc" id="namespacem__rhs_html_affa0b502273a1db4307c4c7d36a088e7"><div class="ttname"><a href="namespacem__rhs.html#affa0b502273a1db4307c4c7d36a088e7">m_rhs::myflux_src_vf</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable myflux_src_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00257">m_rhs.f90:257</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a6b5d4a4e84fc5b93c1a13151ae398cc6"><div class="ttname"><a href="namespacem__rhs.html#a6b5d4a4e84fc5b93c1a13151ae398cc6">m_rhs::iksi</a></div><div class="ttdeci">type(bounds_info) iksi</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00223">m_rhs.f90:223</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ada84d050bc469e99491f0df609abae94"><div class="ttname"><a href="namespacem__rhs.html#ada84d050bc469e99491f0df609abae94">m_rhs::dgm_alpha_dy_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dgm_alpha_dy_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00185">m_rhs.f90:185</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a3a70e0b6fb4faaa4800bf2a7aa2519af"><div class="ttname"><a href="namespacem__rhs.html#a3a70e0b6fb4faaa4800bf2a7aa2519af">m_rhs::un_alphal_z_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alphal_z_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00150">m_rhs.f90:150</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99557d578d538a853b5fd9e445ad6303"><div class="ttname"><a href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">m_global_parameters::we_riemann_flux</a></div><div class="ttdeci">logical we_riemann_flux</div><div class="ttdoc">Account for capillary effects in the Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_aeed4eb93ccb2725da7a4756e510dda03"><div class="ttname"><a href="m__rhs_8f90.html#aeed4eb93ccb2725da7a4756e510dda03">pi_inf</a></div><div class="ttdeci">real(kind(0d0)) pi_inf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03740">m_rhs.f90:3740</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a646c5130e5b695e4eecf0e85a797ba7c"><div class="ttname"><a href="namespacem__rhs.html#a646c5130e5b695e4eecf0e85a797ba7c">m_rhs::q_cons_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable q_cons_qp</div><div class="ttdoc">This variable contains the WENO-reconstructed values of the cell-average conservative variables...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00080">m_rhs.f90:80</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a32b605d9d7c6a2dd06b13df3beb0b4ce"><div class="ttname"><a href="namespacem__rhs.html#a32b605d9d7c6a2dd06b13df3beb0b4ce">m_rhs::myflux_vf</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable myflux_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00257">m_rhs.f90:257</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a35e063bb3f8fd0f8210a6305d01cae96"><div class="ttname"><a href="namespacem__rhs.html#a35e063bb3f8fd0f8210a6305d01cae96">m_rhs::bub_v_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:,:), allocatable bub_v_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00243">m_rhs.f90:243</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a9a204df83f1d0c0ce63177fbc33e1f76"><div class="ttname"><a href="namespacem__rhs.html#a9a204df83f1d0c0ce63177fbc33e1f76">m_rhs::un_alphar_z_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alphar_z_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00153">m_rhs.f90:153</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac91cb1bc506e2e71e46001986a7232b4"><div class="ttname"><a href="namespacem__global__parameters.html#ac91cb1bc506e2e71e46001986a7232b4">m_global_parameters::mono</a></div><div class="ttdeci">type(mono_parameters), dimension(num_probes_max) mono</div><div class="ttdoc">Monopole parameters. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00312">m_global_parameters.f90:312</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac60a57ea5298dde379e24b6b77762101"><div class="ttname"><a href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">m_global_parameters::regularization</a></div><div class="ttdeci">logical regularization</div><div class="ttdoc">Regularization terms of Tiwari (2013) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00140">m_global_parameters.f90:140</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a2b31029abb8eed5463485244c8029420"><div class="ttname"><a href="namespacem__rhs.html#a2b31029abb8eed5463485244c8029420">m_rhs::un_alphar_y_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alphar_y_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00152">m_rhs.f90:152</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0d20192b0175dc677ba88b14bf0d5104"><div class="ttname"><a href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">m_global_parameters::we_idx</a></div><div class="ttdeci">integer, dimension(:,:), allocatable we_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00210">m_global_parameters.f90:210</a></div></div>
<div class="ttc" id="namespacem__rhs_html_af321ac08aa0b1f2b444dc81d922445be"><div class="ttname"><a href="namespacem__rhs.html#af321ac08aa0b1f2b444dc81d922445be">m_rhs::dql_prim_dx_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dql_prim_dx_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00124">m_rhs.f90:124</a></div></div>
<div class="ttc" id="namespacem__cbc_html"><div class="ttname"><a href="namespacem__cbc.html">m_cbc</a></div><div class="ttdoc">The module features a large database of characteristic boundary conditions (CBC) for the Euler system...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00049">m_cbc.f90:49</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__rhs_html_abf11c6f8bb16f3c74cc0205b16d31e96"><div class="ttname"><a href="namespacem__rhs.html#abf11c6f8bb16f3c74cc0205b16d31e96">m_rhs::s_compute_fd_gradient</a></div><div class="ttdeci">subroutine s_compute_fd_gradient(var, grad_x, grad_y, grad_z, norm)</div><div class="ttdoc">Computes the scalar gradient fields via finite differences. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03604">m_rhs.f90:3604</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a9fa393b97819b253e8b85f0444a15c27"><div class="ttname"><a href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">m_riemann_solvers::s_exact_riemann_solver</a></div><div class="ttdeci">subroutine, public s_exact_riemann_solver(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">This procedure is the implementation of the exact Riemann solver, see Toro (1999). The effects of viscosity and the surface tension have been incorporated following the work of Perigaud and Saurel (2005). </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01517">m_riemann_solvers.f90:1517</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ade3320ea2b49d294014da588f54e09b4"><div class="ttname"><a href="namespacem__rhs.html#ade3320ea2b49d294014da588f54e09b4">m_rhs::dgm_alpha_dz_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dgm_alpha_dz_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00186">m_rhs.f90:186</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ad316cbfbf94736b4677bacf07d8d9027"><div class="ttname"><a href="namespacem__rhs.html#ad316cbfbf94736b4677bacf07d8d9027">m_rhs::f_g</a></div><div class="ttdeci">real(kind(0d0)) function f_g(mytime, sos, mysos, mymono)</div><div class="ttdoc">This function gives the temporally varying amplitude of the pulse. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03278">m_rhs.f90:3278</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ab733571c02acf3c3d16b0bfbed34b79e"><div class="ttname"><a href="namespacem__rhs.html#ab733571c02acf3c3d16b0bfbed34b79e">m_rhs::s_compute_gradient_magnitude</a></div><div class="ttdeci">subroutine s_compute_gradient_magnitude(dv_dx_vf, dv_dy_vf, dv_dz_vf, gm_v_vf)</div><div class="ttdoc">The purpose of the procedure is to utilize the inputted cell-averaged first-order spatial derivatives...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05994">m_rhs.f90:5994</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_aba715ebddc63d396377dc69d35cb50f8"><div class="ttname"><a href="m__rhs_8f90.html#aba715ebddc63d396377dc69d35cb50f8">gamma_min</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids) gamma_min</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03741">m_rhs.f90:3741</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99ba7e33a1870ac89386d376e0d20526"><div class="ttname"><a href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">m_global_parameters::dflt_real</a></div><div class="ttdeci">real(kind(0d0)), parameter dflt_real</div><div class="ttdoc">Default real value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html"><div class="ttname"><a href="namespacem__riemann__solvers.html">m_riemann_solvers</a></div><div class="ttdoc">This module features a database of approximate and exact Riemann problem solvers for the Navier-Stoke...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00049">m_riemann_solvers.f90:49</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aa2587a1fc99a23d4d7fe552602e72bbc"><div class="ttname"><a href="namespacem__rhs.html#aa2587a1fc99a23d4d7fe552602e72bbc">m_rhs::laplacian_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable laplacian_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00192">m_rhs.f90:192</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a93dc4910f18014dacfb740debe18356d"><div class="ttname"><a href="namespacem__rhs.html#a93dc4910f18014dacfb740debe18356d">m_rhs::flux_lim_func</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable flux_lim_func</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00210">m_rhs.f90:210</a></div></div>
<div class="ttc" id="namespacem__rhs_html_abd2dcf26ba04cbfac917774656aef38b"><div class="ttname"><a href="namespacem__rhs.html#abd2dcf26ba04cbfac917774656aef38b">m_rhs::dql_prim_dy_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dql_prim_dy_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00125">m_rhs.f90:125</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6e342ae3eb66f89e0eeb94e11aa42d92"><div class="ttname"><a href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">m_global_parameters::buff_size</a></div><div class="ttdeci">integer buff_size</div><div class="ttdoc">The number of cells that are necessary to be able to store enough boundary conditions data to march t...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9fef803dde37fd067fd4b2215df851b9"><div class="ttname"><a href="namespacem__global__parameters.html#a9fef803dde37fd067fd4b2215df851b9">m_global_parameters::z_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target z_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aca82442008ec6a9c478cdfa1b67b7e40"><div class="ttname"><a href="namespacem__rhs.html#aca82442008ec6a9c478cdfa1b67b7e40">m_rhs::un_alphar_x_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alphar_x_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00151">m_rhs.f90:151</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of fluids in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a1ecb03602517ea0c6a8594ac84d7baf6"><div class="ttname"><a href="namespacem__rhs.html#a1ecb03602517ea0c6a8594ac84d7baf6">m_rhs::dgm_alpha_dx_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dgm_alpha_dx_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00184">m_rhs.f90:184</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a250b49b4cd6e8ad9bcd9e2a7b46c39dc"><div class="ttname"><a href="m__rhs_8f90.html#a250b49b4cd6e8ad9bcd9e2a7b46c39dc">f_pres</a></div><div class="ttdeci">real(kind(0d0)) f_pres</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03732">m_rhs.f90:3732</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ae70cf6ec305a948efab279a0bf802095"><div class="ttname"><a href="namespacem__rhs.html#ae70cf6ec305a948efab279a0bf802095">m_rhs::s_get_crv</a></div><div class="ttdeci">subroutine, public s_get_crv(q_cons_vf, q_prim_vf, rhs_vf)</div><div class="ttdoc">Computes curvatures for surface tension terms. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l04281">m_rhs.f90:4281</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a4b22f555477e0d617f5cf53fd4e2fa38"><div class="ttname"><a href="namespacem__variables__conversion.html#a4b22f555477e0d617f5cf53fd4e2fa38">m_variables_conversion::s_convert_conservative_to_primitive_variables</a></div><div class="ttdeci">subroutine, public s_convert_conservative_to_primitive_variables(qK_cons_vf, qK_prim_vf, gm_alphaK_vf, ix, iy, iz)</div><div class="ttdoc">The following procedure handles the conversion between the conservative variables and the primitive v...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00521">m_variables_conversion.f90:521</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a613c09e8438e535e8c13f15282493793"><div class="ttname"><a href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">m_variables_conversion::s_convert_mixture_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_mixture_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00188">m_variables_conversion.f90:188</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a871a36bf12852bfc85560beba25cbfb9"><div class="ttname"><a href="namespacem__rhs.html#a871a36bf12852bfc85560beba25cbfb9">m_rhs::gm_alphar_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable gm_alphar_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00141">m_rhs.f90:141</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a95522bf6827d87664b25022fe145eddf"><div class="ttname"><a href="namespacem__rhs.html#a95522bf6827d87664b25022fe145eddf">m_rhs::hi_flux_gsrc_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable hi_flux_gsrc_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00216">m_rhs.f90:216</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acfd358e345eac06daf89ca40651ba2c8"><div class="ttname"><a href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">m_global_parameters::we_rhs_flux</a></div><div class="ttdeci">logical we_rhs_flux</div><div class="ttdoc">Account for capillary effects using the conservative formulation in RHS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00149">m_global_parameters.f90:149</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a307adefdd895260e42e85872aa306929"><div class="ttname"><a href="namespacem__rhs.html#a307adefdd895260e42e85872aa306929">m_rhs::mono_e_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable mono_e_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00251">m_rhs.f90:251</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ac7d49938e97f8843c84f335ff0f6cceb"><div class="ttname"><a href="namespacem__rhs.html#ac7d49938e97f8843c84f335ff0f6cceb">m_rhs::s_apply_scalar_divergence_theorem</a></div><div class="ttdeci">subroutine s_apply_scalar_divergence_theorem(vL_vf, vR_vf, dv_ds_vf, norm_dir)</div><div class="ttdoc">The purpose of this subroutine is to employ the inputted left and right cell-boundary integral-averag...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05565">m_rhs.f90:5565</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a2647dbdf6b09315564ef060e1f49df0d"><div class="ttname"><a href="namespacem__rhs.html#a2647dbdf6b09315564ef060e1f49df0d">m_rhs::s_populate_conservative_variables_buffers</a></div><div class="ttdeci">subroutine s_populate_conservative_variables_buffers()</div><div class="ttdoc">The purpose of this procedure is to populate the buffers of the conservative variables, depending on the selected boundary conditions. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l04900">m_rhs.f90:4900</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0a67704d4c227871a155d6c26590f685"><div class="ttname"><a href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">m_global_parameters::re_size</a></div><div class="ttdeci">integer, dimension(2) re_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00201">m_global_parameters.f90:201</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad367bbe26f93b9fd058c58ec11337fdf"><div class="ttname"><a href="namespacem__global__parameters.html#ad367bbe26f93b9fd058c58ec11337fdf">m_global_parameters::lsq_deriv</a></div><div class="ttdeci">logical lsq_deriv</div><div class="ttdoc">Use linear least squares to calculate normals and curvatures. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00152">m_global_parameters.f90:152</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a25b43c26b2e6ed431b9ec51d6af30c74"><div class="ttname"><a href="namespacem__rhs.html#a25b43c26b2e6ed431b9ec51d6af30c74">m_rhs::ix</a></div><div class="ttdeci">type(bounds_info) ix</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00237">m_rhs.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in system of eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00185">m_global_parameters.f90:185</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a87bc24802f4abe7b3cb36864d631a275"><div class="ttname"><a href="namespacem__rhs.html#a87bc24802f4abe7b3cb36864d631a275">m_rhs::f_delta</a></div><div class="ttdeci">real(kind(0d0)) function f_delta(j, k, l, mono_loc, mono_leng, mymono)</div><div class="ttdoc">This function give the spatial support of the acoustic source. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03322">m_rhs.f90:3322</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Mixture physical parameters (MPP) limits. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00122">m_global_parameters.f90:122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af329319354912b90787e0dff7cdc8a37"><div class="ttname"><a href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">m_global_parameters::we_size</a></div><div class="ttdeci">integer we_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00209">m_global_parameters.f90:209</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad138d35528cf27ff42dba00d13c269be"><div class="ttname"><a href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00187">m_global_parameters.f90:187</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ac5aa3e8228234f05fd5b899a6d309260"><div class="ttname"><a href="namespacem__rhs.html#ac5aa3e8228234f05fd5b899a6d309260">m_rhs::s_reconstruct_cell_boundary_values</a></div><div class="ttdeci">subroutine s_reconstruct_cell_boundary_values(v_vf, vL_qp, vR_qp, cd_vars, norm_dir)</div><div class="ttdoc">The purpose of this subroutine is to WENO-reconstruct the left and the right cell-boundary values...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05415">m_rhs.f90:5415</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a145666708445ab1fa66bb58fa248b0c1"><div class="ttname"><a href="namespacem__rhs.html#a145666708445ab1fa66bb58fa248b0c1">m_rhs::dq_prim_dz_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dq_prim_dz_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00115">m_rhs.f90:115</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00191">m_global_parameters.f90:191</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a5886ad6e79bba7c4cf7fa1475aac824a"><div class="ttname"><a href="namespacem__rhs.html#a5886ad6e79bba7c4cf7fa1475aac824a">m_rhs::gm_alphal_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable gm_alphal_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00140">m_rhs.f90:140</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a5735aa0dc9d5759c2056a79d4a8c484b"><div class="ttname"><a href="namespacem__rhs.html#a5735aa0dc9d5759c2056a79d4a8c484b">m_rhs::s_populate_variables_buffers</a></div><div class="ttdeci">subroutine, public s_populate_variables_buffers(v_vf)</div><div class="ttdoc">The purpose of this procedure is to populate the buffers of the conservative variables, depending on the selected boundary conditions. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l04559">m_rhs.f90:4559</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a459b1e7574742f115d5562325c575428"><div class="ttname"><a href="namespacem__global__parameters.html#a459b1e7574742f115d5562325c575428">m_global_parameters::monopole</a></div><div class="ttdeci">logical monopole</div><div class="ttdoc">Monopole switch. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00311">m_global_parameters.f90:311</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a3062ef97dfec8673afd80dcbee6e3814"><div class="ttname"><a href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">m_riemann_solvers::s_hll_riemann_solver</a></div><div class="ttdeci">subroutine, public s_hll_riemann_solver(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The procedure features the Harten, Lax and van Leer (HLL) approximate Riemann solver algorithm...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00464">m_riemann_solvers.f90:464</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a31f27cef4252ee5a36802fd02b3f8ac9"><div class="ttname"><a href="namespacem__rhs.html#a31f27cef4252ee5a36802fd02b3f8ac9">m_rhs::file_path</a></div><div class="ttdeci">character(50) file_path</div><div class="ttdoc">Local file path for saving debug files. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00261">m_rhs.f90:261</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a73fc1430500bdd1786b121a9ed08a107"><div class="ttname"><a href="namespacem__rhs.html#a73fc1430500bdd1786b121a9ed08a107">m_rhs::s_finalize_rhs_module</a></div><div class="ttdeci">subroutine, public s_finalize_rhs_module()</div><div class="ttdoc">Module deallocation and/or disassociation procedures. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l06078">m_rhs.f90:6078</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0f2d413d9739928f8e1a98f0a5783ab9"><div class="ttname"><a href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">m_global_parameters::grid_geometry</a></div><div class="ttdeci">integer grid_geometry</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00087">m_global_parameters.f90:87</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a806c4c0942bfd830bb0b8b6276258d01"><div class="ttname"><a href="namespacem__rhs.html#a806c4c0942bfd830bb0b8b6276258d01">m_rhs::ieta</a></div><div class="ttdeci">type(bounds_info) ieta</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00223">m_rhs.f90:223</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a30e6fe4c4ff6a8cfefa1bf882dc2e90e"><div class="ttname"><a href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">m_global_parameters::crv_size</a></div><div class="ttdeci">integer crv_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00217">m_global_parameters.f90:217</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_abe0d038aac3b3f0166c1a0c93c497e33"><div class="ttname"><a href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">m_variables_conversion::s_convert_species_to_mixture_variables_bubbles</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables_bubbles(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. Specifially designed for when subgrid bubbles must be included. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00226">m_variables_conversion.f90:226</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a1141883715f63c7b9d54dde459434fcc"><div class="ttname"><a href="namespacem__rhs.html#a1141883715f63c7b9d54dde459434fcc">m_rhs::gm_alpha_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable gm_alpha_qp</div><div class="ttdoc">The gradient magnitude of the volume fractions at cell-interior Gaussian quadrature points...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00132">m_rhs.f90:132</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a48f3d69bb519043ca76fb10f8a2f44c0"><div class="ttname"><a href="namespacem__rhs.html#a48f3d69bb519043ca76fb10f8a2f44c0">m_rhs::dq_prim_dx_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dq_prim_dx_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00113">m_rhs.f90:113</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_af22c486581933c52df7d4aa306382074"><div class="ttname"><a href="m__rhs_8f90.html#af22c486581933c52df7d4aa306382074">k</a></div><div class="ttdeci">integer k</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a19b6ba65c32dfc21f4762eceb25f29"><div class="ttname"><a href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">m_global_parameters::alt_soundspeed</a></div><div class="ttdeci">logical alt_soundspeed</div><div class="ttdoc">Alternate mixture sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00139">m_global_parameters.f90:139</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a987e51cca357206f1e35d38a1cb7e5e6"><div class="ttname"><a href="namespacem__global__parameters.html#a987e51cca357206f1e35d38a1cb7e5e6">m_global_parameters::num_mono</a></div><div class="ttdeci">integer num_mono</div><div class="ttdoc">Number of monopoles. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00313">m_global_parameters.f90:313</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ae60a6ab812c015411331658e16e5ab77"><div class="ttname"><a href="namespacem__rhs.html#ae60a6ab812c015411331658e16e5ab77">m_rhs::reg_src_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable reg_src_vf</div><div class="ttdoc">Additional field for regularization terms. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00196">m_rhs.f90:196</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aaaecb99341e4534ec839e9356bf90536"><div class="ttname"><a href="namespacem__rhs.html#aaaecb99341e4534ec839e9356bf90536">m_rhs::alf_sum</a></div><div class="ttdeci">type(scalar_field) alf_sum</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00258">m_rhs.f90:258</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3c3cd38abc3ece085bab77788afece73"><div class="ttname"><a href="namespacem__global__parameters.html#a3c3cd38abc3ece085bab77788afece73">m_global_parameters::weno_re_flux</a></div><div class="ttdeci">logical weno_re_flux</div><div class="ttdoc">WENO reconstruct velocity gradients for viscous stress tensor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00132">m_global_parameters.f90:132</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a53f0d5eed7783c9760aaeeaa0abbd58c"><div class="ttname"><a href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">m_global_parameters::cyl_coord</a></div><div class="ttdeci">logical cyl_coord</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00086">m_global_parameters.f90:86</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae2ad588d58b624a8320805f3860a3eb8"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">m_riemann_solvers::s_hllc_riemann_solver</a></div><div class="ttdeci">subroutine, public s_hllc_riemann_solver(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">This procedure is the implementation of the Harten, Lax, van Leer, and contact (HLLC) approximate Rie...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00849">m_riemann_solvers.f90:849</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7fa880b937b54214312469a34268b883"><div class="ttname"><a href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">m_global_parameters::dt</a></div><div class="ttdeci">real(kind(0d0)) dt</div><div class="ttdoc">Size of the time-step. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00106">m_global_parameters.f90:106</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a9cf1c914824cb4cc3476416da9be78f4"><div class="ttname"><a href="namespacem__rhs.html#a9cf1c914824cb4cc3476416da9be78f4">m_rhs::dqr_prim_dz_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dqr_prim_dz_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00129">m_rhs.f90:129</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a19e98f005eebfd43e924ed2339a1a430"><div class="ttname"><a href="namespacem__global__parameters.html#a19e98f005eebfd43e924ed2339a1a430">m_global_parameters::tvd_rhs_flux</a></div><div class="ttdeci">logical tvd_rhs_flux</div><div class="ttdoc">Apply TVD flux limiter to to intercell fluxes outside Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00145">m_global_parameters.f90:145</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ae49e4c2622ff0adf0b066da12e8256c8"><div class="ttname"><a href="namespacem__rhs.html#ae49e4c2622ff0adf0b066da12e8256c8">m_rhs::gm_vel_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable gm_vel_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00116">m_rhs.f90:116</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7b7945c133bf17eb1f25468a6d1a6925"><div class="ttname"><a href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">m_global_parameters::crv_idx</a></div><div class="ttdeci">integer, dimension(:), allocatable crv_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00218">m_global_parameters.f90:218</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aa727628a4ae8fa3af715f416b7bcadbe"><div class="ttname"><a href="namespacem__rhs.html#aa727628a4ae8fa3af715f416b7bcadbe">m_rhs::dq_prim_dy_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dq_prim_dy_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00114">m_rhs.f90:114</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a19a438a95f2945b7c9e492f2ee983263"><div class="ttname"><a href="m__rhs_8f90.html#a19a438a95f2945b7c9e492f2ee983263">we</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids, num_fluids) we</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03744">m_rhs.f90:3744</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aa0d0342fdf7c5d5f795c151fc10d1cee"><div class="ttname"><a href="namespacem__rhs.html#aa0d0342fdf7c5d5f795c151fc10d1cee">m_rhs::un_alpha_z_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alpha_z_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00189">m_rhs.f90:189</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a3d9a864b60496c110f161a93eebc86c6"><div class="ttname"><a href="namespacem__rhs.html#a3d9a864b60496c110f161a93eebc86c6">m_rhs::iy</a></div><div class="ttdeci">type(bounds_info) iy</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00237">m_rhs.f90:237</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_ae0579cdf6d579b6ff5e6a5945a99c42c"><div class="ttname"><a href="m__rhs_8f90.html#ae0579cdf6d579b6ff5e6a5945a99c42c">iter</a></div><div class="ttdeci">integer iter</div><div class="ttdoc">Generic loop iterators. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a361f0038973069452cc88430c49bcfe8"><div class="ttname"><a href="namespacem__rhs.html#a361f0038973069452cc88430c49bcfe8">m_rhs::s_compute_rhs</a></div><div class="ttdeci">subroutine, public s_compute_rhs(q_cons_vf, q_prim_vf, rhs_vf, t_step)</div><div class="ttdoc">The purpose of this procedure is to employ the inputted cell-average conservative variables in order ...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l01396">m_rhs.f90:1396</a></div></div>
<div class="ttc" id="structm__derived__types_1_1mono__parameters_html"><div class="ttname"><a href="structm__derived__types_1_1mono__parameters.html">m_derived_types::mono_parameters</a></div><div class="ttdoc">Monopole acoustic source parameters. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00114">m_derived_types.f90:114</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a5542f5954178123cbe052df43d09dc38"><div class="ttname"><a href="namespacem__rhs.html#a5542f5954178123cbe052df43d09dc38">m_rhs::flux_gsrc_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable flux_gsrc_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00178">m_rhs.f90:178</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_aaea4baed8fd8b780f6938f0dc1fb0f72"><div class="ttname"><a href="m__rhs_8f90.html#aaea4baed8fd8b780f6938f0dc1fb0f72">i</a></div><div class="ttdeci">integer i</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__rhs_html_acfcb0aeeb4659d44b0dd6fbf0b82ee79"><div class="ttname"><a href="namespacem__rhs.html#acfcb0aeeb4659d44b0dd6fbf0b82ee79">m_rhs::mono_mass_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable mono_mass_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00251">m_rhs.f90:251</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a33739bde53c5512b62c38b0575973897"><div class="ttname"><a href="namespacem__rhs.html#a33739bde53c5512b62c38b0575973897">m_rhs::kappa_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable kappa_vf</div><div class="ttdoc">The cell-average curvature of volume fractions. kappa_vf is calculated by the divergence theorem usin...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00156">m_rhs.f90:156</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aacbe385f29e71aa174541d4931bdcbbe"><div class="ttname"><a href="namespacem__rhs.html#aacbe385f29e71aa174541d4931bdcbbe">m_rhs::s_get_divergence</a></div><div class="ttdeci">subroutine s_get_divergence(idir, q_prim_vf, mydivu)</div><div class="ttdoc">Gets the divergence term for k div(U) </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03165">m_rhs.f90:3165</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aa1cd3a5b83eabb0344ecae0cf321ca87"><div class="ttname"><a href="namespacem__rhs.html#aa1cd3a5b83eabb0344ecae0cf321ca87">m_rhs::s_compute_regularization_source</a></div><div class="ttdeci">subroutine s_compute_regularization_source(i, q_prim_vf)</div><div class="ttdoc">The purpose of this procedure is to compute the interface sharpening regularization source terms...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03427">m_rhs.f90:3427</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aca45586b8c966f8e3a5477444cf60dda"><div class="ttname"><a href="namespacem__rhs.html#aca45586b8c966f8e3a5477444cf60dda">m_rhs::s_compute_capillary_source</a></div><div class="ttdeci">subroutine s_compute_capillary_source(i, q_prim_vf)</div><div class="ttdoc">The purpose of this procedure is to compute the source term that accounts for capillary effects in th...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03104">m_rhs.f90:3104</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_aa5195db0f89eb91b6f5544e9764412a0"><div class="ttname"><a href="m__rhs_8f90.html#aa5195db0f89eb91b6f5544e9764412a0">rho_k_s</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids) rho_k_s</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03734">m_rhs.f90:3734</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a41372eab4f40baf2501e543f406a1cab"><div class="ttname"><a href="namespacem__rhs.html#a41372eab4f40baf2501e543f406a1cab">m_rhs::hi_flux_src_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable hi_flux_src_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00215">m_rhs.f90:215</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0670171466cd1ce584495face34cc4de"><div class="ttname"><a href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, k, l, r)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00306">m_variables_conversion.f90:306</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a6c337b82dc4c47f2d3cc57408aa1fc9f"><div class="ttname"><a href="m__rhs_8f90.html#a6c337b82dc4c47f2d3cc57408aa1fc9f">re</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03743">m_rhs.f90:3743</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aa8bc1b17f230cbd06b702f34bd199ef1"><div class="ttname"><a href="namespacem__rhs.html#aa8bc1b17f230cbd06b702f34bd199ef1">m_rhs::s_compute_flux_lim</a></div><div class="ttdeci">subroutine s_compute_flux_lim(top, bottom, flux_lim_func)</div><div class="ttdoc">This subroutine takes the consecutive changes in volume fraction at a cell boundary and computes the ...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l02665">m_rhs.f90:2665</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a5114054db70e67aaf7b2c8e71d63c934"><div class="ttname"><a href="namespacem__rhs.html#a5114054db70e67aaf7b2c8e71d63c934">m_rhs::kappar_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable kappar_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00167">m_rhs.f90:167</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aac5ed9f316eeebbe04258bb1120cbea4"><div class="ttname"><a href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">m_global_parameters::internalenergies_idx</a></div><div class="ttdeci">type(bounds_info) internalenergies_idx</div><div class="ttdoc">Indexes of first &amp; last internal energy eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00190">m_global_parameters.f90:190</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a1b6a05895f56a60c075e4eee3f1b4d51"><div class="ttname"><a href="namespacem__rhs.html#a1b6a05895f56a60c075e4eee3f1b4d51">m_rhs::qr_cons_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable qr_cons_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00096">m_rhs.f90:96</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ae55731ba38044366ff7ddecf95297657"><div class="ttname"><a href="namespacem__rhs.html#ae55731ba38044366ff7ddecf95297657">m_rhs::ipsi</a></div><div class="ttdeci">type(bounds_info) ipsi</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00230">m_rhs.f90:230</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acbb163a79ff0011a4327c3fb65a04c14"><div class="ttname"><a href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">m_global_parameters::flux_lim</a></div><div class="ttdeci">integer flux_lim</div><div class="ttdoc">Choice of flux limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00147">m_global_parameters.f90:147</a></div></div>
<div class="ttc" id="namespacem__bubbles_html"><div class="ttname"><a href="namespacem__bubbles.html">m_bubbles</a></div><div class="ttdoc">This module is used to compute the ensemble-averaged bubble dynamic variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__bubbles_8f90_source.html#l00035">m_bubbles.f90:35</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aea5b911d65b330f65e97052e9e8c0383"><div class="ttname"><a href="namespacem__global__parameters.html#aea5b911d65b330f65e97052e9e8c0383">m_global_parameters::x_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target x_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a2b0b138349cb9c896cb7985bdcedafe1"><div class="ttname"><a href="namespacem__rhs.html#a2b0b138349cb9c896cb7985bdcedafe1">m_rhs::un_alpha_y_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alpha_y_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00188">m_rhs.f90:188</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a83ac0b7807345a6879af324bae08c419"><div class="ttname"><a href="namespacem__rhs.html#a83ac0b7807345a6879af324bae08c419">m_rhs::iz</a></div><div class="ttdeci">type(bounds_info) iz</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00237">m_rhs.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8d670f2f984167bae71b7b3f12d0908a"><div class="ttname"><a href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">m_global_parameters::polytropic</a></div><div class="ttdeci">logical polytropic</div><div class="ttdoc">Polytropic switch. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00291">m_global_parameters.f90:291</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ae6f7edb814859919c5d1f739574155bd"><div class="ttname"><a href="namespacem__rhs.html#ae6f7edb814859919c5d1f739574155bd">m_rhs::s_initialize_rhs_module</a></div><div class="ttdeci">subroutine, public s_initialize_rhs_module()</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00269">m_rhs.f90:269</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a04878814b8097100a179152ba853262a"><div class="ttname"><a href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">m_global_parameters::dz</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dz</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ad6141c10a72d8ff3a9fb5f16b89bdcc3"><div class="ttname"><a href="namespacem__rhs.html#ad6141c10a72d8ff3a9fb5f16b89bdcc3">m_rhs::s_apply_vector_divergence_theorem</a></div><div class="ttdeci">subroutine s_apply_vector_divergence_theorem(vL_x_ndqp, vL_y_ndqp, vL_z_ndqp, vR_x_ndqp, vR_y_ndqp, vR_z_ndqp, div_v_vf)</div><div class="ttdoc">The goal of this procedure is to utilize the inputted left and right cell-boundary integral-averaged ...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05767">m_rhs.f90:5767</a></div></div>
<div class="ttc" id="namespacem__rhs_html_afa742a72b96bfdbfa7d4ed2702f9d5f1"><div class="ttname"><a href="namespacem__rhs.html#afa742a72b96bfdbfa7d4ed2702f9d5f1">m_rhs::itau</a></div><div class="ttdeci">type(bounds_info) itau</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00223">m_rhs.f90:223</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a72cc3ba5a0de327fae70742734e77492"><div class="ttname"><a href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">m_cbc::s_cbc</a></div><div class="ttdeci">subroutine, public s_cbc(q_prim_vf, flux_vf, flux_src_vf, cbc_dir, cbc_loc, ix, iy, iz)</div><div class="ttdoc">The following is the implementation of the CBC based on the work of Thompson (1987, 1990) on hyperbolic systems. The CBC is indirectly applied in the computation of the right-hand-side (RHS) near the relevant domain boundary through the modification of the fluxes. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00539">m_cbc.f90:539</a></div></div>
<div class="ttc" id="namespacem__rhs_html_af2fd928afcca77f0351ad57592dc53f4"><div class="ttname"><a href="namespacem__rhs.html#af2fd928afcca77f0351ad57592dc53f4">m_rhs::hi_flux_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable hi_flux_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00214">m_rhs.f90:214</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a953abb55b23caddc730076fa837a8063"><div class="ttname"><a href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">m_variables_conversion::s_compute_lsq_gradient_curvature</a></div><div class="ttdeci">subroutine, public s_compute_lsq_gradient_curvature(v_vf, grad_x_vf, grad_y_vf, grad_z_vf, norm_vf, kappa_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01328">m_variables_conversion.f90:1328</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a2da1b596b26740b8edff160297676447"><div class="ttname"><a href="namespacem__rhs.html#a2da1b596b26740b8edff160297676447">m_rhs::s_compute_viscous_stress_tensor</a></div><div class="ttdeci">subroutine s_compute_viscous_stress_tensor(q_prim_vf, grad_x_vf, grad_y_vf, grad_z_vf)</div><div class="ttdoc">The purpose of this subroutine is to compute the viscous stress tensor for the cells directly next to...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l02715">m_rhs.f90:2715</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ab99096402fadc8b539f8a031dfdb3ffe"><div class="ttname"><a href="namespacem__rhs.html#ab99096402fadc8b539f8a031dfdb3ffe">m_rhs::un_alphal_y_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alphal_y_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00149">m_rhs.f90:149</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4e4e3806190a62a77cf6542f6d07dbbd"><div class="ttname"><a href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">m_global_parameters::dflt_int</a></div><div class="ttdeci">integer, parameter dflt_int</div><div class="ttdoc">Default integer value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00060">m_global_parameters.f90:60</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a7e3b4d8f32649ff607c52440009f903f"><div class="ttname"><a href="namespacem__rhs.html#a7e3b4d8f32649ff607c52440009f903f">m_rhs::tau_re_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable tau_re_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00205">m_rhs.f90:205</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a379b85ad4f20d9a3108b3a9df2ef9ff1"><div class="ttname"><a href="namespacem__rhs.html#a379b85ad4f20d9a3108b3a9df2ef9ff1">m_rhs::s_reconstruct_cell_interior_values</a></div><div class="ttdeci">subroutine s_reconstruct_cell_interior_values(v_qp)</div><div class="ttdoc">The goal of this procedure is to WENO-reconstruct the inputted cell-averaged variables at the cell-in...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l05291">m_rhs.f90:5291</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a4fdfac6ef18dff54b9f466f8cfb12c50"><div class="ttname"><a href="namespacem__rhs.html#a4fdfac6ef18dff54b9f466f8cfb12c50">m_rhs::dql_prim_dz_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable dql_prim_dz_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00126">m_rhs.f90:126</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module features a database of subroutines that allow for the conversion of state variables from ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00047">m_variables_conversion.f90:47</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a7b00376acfcaf5c7628428725986f223"><div class="ttname"><a href="namespacem__rhs.html#a7b00376acfcaf5c7628428725986f223">m_rhs::un_alpha_x_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable un_alpha_x_qp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00187">m_rhs.f90:187</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type annexing beginning and ending bounds information. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00064">m_derived_types.f90:64</a></div></div>
<div class="ttc" id="namespacem__rhs_html_af2af2a542d5af4fec546eda34af4ef74"><div class="ttname"><a href="namespacem__rhs.html#af2af2a542d5af4fec546eda34af4ef74">m_rhs::q_prim_qp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable q_prim_qp</div><div class="ttdoc">The primitive variables at cell-interior Gaussian quadrature points. These are calculated from the co...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00085">m_rhs.f90:85</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a52c1749bb933147f34129949411d72cd"><div class="ttname"><a href="namespacem__rhs.html#a52c1749bb933147f34129949411d72cd">m_rhs::kappal_ndqp</a></div><div class="ttdeci">type(vector_field), dimension(:,:,:), allocatable kappal_ndqp</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00166">m_rhs.f90:166</a></div></div>
<div class="ttc" id="namespacem__rhs_html_a45d112ac19bd1a893d86a1a49fd6d6b6"><div class="ttname"><a href="namespacem__rhs.html#a45d112ac19bd1a893d86a1a49fd6d6b6">m_rhs::bub_m_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:,:), allocatable bub_m_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00243">m_rhs.f90:243</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6769808569174ff0eef096e958889837"><div class="ttname"><a href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">m_global_parameters::bc_z</a></div><div class="ttdeci">type(bounds_info) bc_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ad2b935d288f68dbde65021da0498007d"><div class="ttname"><a href="namespacem__rhs.html#ad2b935d288f68dbde65021da0498007d">m_rhs::ichi</a></div><div class="ttdeci">type(bounds_info) ichi</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00230">m_rhs.f90:230</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab62b8c589dcddff0e6295f4956012c7a"><div class="ttname"><a href="namespacem__global__parameters.html#ab62b8c589dcddff0e6295f4956012c7a">m_global_parameters::char_decomp</a></div><div class="ttdeci">logical char_decomp</div><div class="ttdoc">Characteristic decomposition. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00128">m_global_parameters.f90:128</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ab0521faf3afa606d8ebfd272176f3301"><div class="ttname"><a href="namespacem__rhs.html#ab0521faf3afa606d8ebfd272176f3301">m_rhs::bub_p_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:,:), allocatable bub_p_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00243">m_rhs.f90:243</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a340bafa0c8d745c3060facd9cfef7ec4"><div class="ttname"><a href="m__rhs_8f90.html#a340bafa0c8d745c3060facd9cfef7ec4">rho</a></div><div class="ttdeci">real(kind(0d0)) rho</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03736">m_rhs.f90:3736</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">The module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aec97838cc58623019b07ae47da7f4c1c"><div class="ttname"><a href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">m_global_parameters::sgm_eps</a></div><div class="ttdeci">real(kind(0d0)), parameter sgm_eps</div><div class="ttdoc">Segmentation tolerance. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00061">m_global_parameters.f90:61</a></div></div>
<div class="ttc" id="namespacem__rhs_html_af771a6193fc6e856bcbfc269f096e3c9"><div class="ttname"><a href="namespacem__rhs.html#af771a6193fc6e856bcbfc269f096e3c9">m_rhs::s_compute_capillary_stress_tensor</a></div><div class="ttdeci">subroutine s_compute_capillary_stress_tensor(norm_dir, q_prim_vf, grad_x_vf, grad_y_vf, grad_z_vf, norm_vf)</div><div class="ttdoc">The purpose of this procedure is to calculate the capillary stress tensor at the cell centers in the ...</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l02870">m_rhs.f90:2870</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9adf65c5de7c360aa44f595f561c87b0"><div class="ttname"><a href="namespacem__global__parameters.html#a9adf65c5de7c360aa44f595f561c87b0">m_global_parameters::split_err</a></div><div class="ttdeci">logical split_err</div><div class="ttdoc">Dimensional splitting error correction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00137">m_global_parameters.f90:137</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_a4cb69ecc8e60cb3bfbe57aab771d6c48"><div class="ttname"><a href="m__rhs_8f90.html#a4cb69ecc8e60cb3bfbe57aab771d6c48">e_we</a></div><div class="ttdeci">real(kind(0d0)) e_we</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03738">m_rhs.f90:3738</a></div></div>
<div class="ttc" id="namespacem__weno_html"><div class="ttname"><a href="namespacem__weno.html">m_weno</a></div><div class="ttdoc">Weighted essentially non-oscillatory (WENO) reconstruction scheme that is supplemented with monotonic...</div><div class="ttdef"><b>Definition:</b> <a href="m__weno_8f90_source.html#l00043">m_weno.f90:43</a></div></div>
<div class="ttc" id="m__rhs_8f90_html_aeadbc0ce9b66517f8fde156199772ec1"><div class="ttname"><a href="m__rhs_8f90.html#aeadbc0ce9b66517f8fde156199772ec1">j</a></div><div class="ttdeci">integer j</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03747">m_rhs.f90:3747</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdoc">Bubbles on/off. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00290">m_global_parameters.f90:290</a></div></div>
<div class="ttc" id="namespacem__rhs_html_aac41721bd3275fb997f51c1afaebac4a"><div class="ttname"><a href="namespacem__rhs.html#aac41721bd3275fb997f51c1afaebac4a">m_rhs::s_get_viscous</a></div><div class="ttdeci">subroutine, public s_get_viscous(q_cons_vf, q_prim_vf, rhs_vf)</div><div class="ttdoc">Computes viscous terms. </div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l03997">m_rhs.f90:3997</a></div></div>
<div class="ttc" id="namespacem__rhs_html_ab1f280657ebd60c51baf22e79dffaeb2"><div class="ttname"><a href="namespacem__rhs.html#ab1f280657ebd60c51baf22e79dffaeb2">m_rhs::bub_r_src</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:,:), allocatable bub_r_src</div><div class="ttdef"><b>Definition:</b> <a href="m__rhs_8f90_source.html#l00243">m_rhs.f90:243</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cff1091173cf1fe67371edd427ba236f.html">simulation_code</a></li><li class="navelem"><a class="el" href="m__rhs_8f90.html">m_rhs.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
