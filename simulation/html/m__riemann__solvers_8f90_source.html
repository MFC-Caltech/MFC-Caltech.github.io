<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Simulation: m_riemann_solvers.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Simulation
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__riemann__solvers_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_riemann_solvers.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__riemann__solvers_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html">   49</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__riemann__solvers.html">m_riemann_solvers</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>        !&lt; definitions of the derived types</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>    !&lt; definitions of the global parameters</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>            !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a> !&lt; state variables type conversion procedures</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__riemann__solvers.html#aab7e6bf69b7d0b8b9d911f418b872130">s_initialize_riemann_solvers_module</a>, &amp;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                       <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a>                   , &amp;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                       <a class="code" href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">s_hll_riemann_solver</a>               , &amp;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                       <a class="code" href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">s_hllc_riemann_solver</a>              , &amp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                       <a class="code" href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">s_exact_riemann_solver</a>             , &amp;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                       <a class="code" href="namespacem__riemann__solvers.html#a5bd1ce6fbbb840b5b1c6dd97ccb8d674">s_finalize_riemann_solvers_module</a></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    </div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    abstract <span class="keyword">INTERFACE</span> <span class="comment">! =======================================================</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        </div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__abstract__riemann__solver.html">  107</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__abstract__riemann__solver.html">s_abstract_riemann_solver</a>( qL_prim_vf, dqL_prim_dx_vf, &amp;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                          dqL_prim_dy_vf, &amp;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                          dqL_prim_dz_vf, &amp;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                            gm_alphaL_vf, &amp;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                               kappaL_vf, &amp;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                              qR_prim_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                                          dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                                          dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                                            gm_alphaR_vf, &amp;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                                               kappaR_vf, &amp;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                                               q_prim_vf, &amp;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                    flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                            flux_gsrc_vf, &amp;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                                      norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__abstract__riemann__solver.html#ab54b3c177b8ba55e930c859cee028f8f">  121</a></span>&#160;            </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordtype">IMPORT </span>:: <a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>, <a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qL_prim_vf, qR_prim_vf</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: dqL_prim_dx_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                             dqL_prim_dy_vf, dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                             dqL_prim_dz_vf, dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                               gm_alphaL_vf,   gm_alphaR_vf, &amp;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                  kappaL_vf,      kappaR_vf</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf, flux_gsrc_vf</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__abstract__riemann__solver.html">s_abstract_riemann_solver</a></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        </div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__compute__abstract__average__state.html">  155</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__average__state.html">s_compute_abstract_average_state</a>(i,j,k)</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__compute__abstract__average__state.html#a52aac2be9b8c2a470c9b8142ab33d805">  156</a></span>&#160;            </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__average__state.html">s_compute_abstract_average_state</a></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        </div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds.html">  169</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds.html">s_compute_abstract_wave_speeds</a>(i,j,k)</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds.html#ad7f89b16e5768c11fcaf1c4b4d9a24b3">  170</a></span>&#160;            </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds.html">s_compute_abstract_wave_speeds</a></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        </div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux.html">  180</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux.html">s_compute_abstract_viscous_source_flux</a>(     velL_vf, &amp; ! -------------</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                                           dvelL_dx_vf, &amp; </div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                                           dvelL_dy_vf, &amp;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                                           dvelL_dz_vf, &amp;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                                               velR_vf, &amp;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                           dvelR_dx_vf, &amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                           dvelR_dy_vf, &amp;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                                           dvelR_dz_vf, &amp;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                           flux_src_vf, &amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                                              norm_dir, &amp;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                                              ix,iy,iz  )</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux.html#a056a0327dbad6c155aafe133092c0a7b">  191</a></span>&#160;            </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordtype">IMPORT </span>:: <a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>, <a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordtype">DIMENSION(num_dims)</span>, &amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordtype">INTENT(IN)</span> ::         velL_vf, velR_vf, &amp;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                          dvelL_dx_vf, dvelR_dx_vf, &amp;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                          dvelL_dy_vf, dvelR_dy_vf, &amp;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                          dvelL_dz_vf, dvelR_dz_vf</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_src_vf</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            </div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            </div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux.html">s_compute_abstract_viscous_source_flux</a></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">    END INTERFACE </span><span class="comment">! ============================================================</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">  220</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">  221</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">  222</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">  231</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">  239</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   </div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">  243</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    </div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! The cell-boundary values of the velocity. vel_src_rs_vf is determined as</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">! part of Riemann problem solution and is used to evaluate the source flux.</span></div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">  250</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    </div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">  259</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a></div><div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">  260</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::       <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">  261</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::       <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">  262</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::      <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>,      <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">  263</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a></div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">  264</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">  265</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::     <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>,     <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a></div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aef2c7eeabded0734aaa0cd95adac91ab">  266</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#ad79d372c1bc1971b870ab2c455d9ff90">y_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#aef2c7eeabded0734aaa0cd95adac91ab">y_r</a></div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">  267</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::     <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>,     <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a></div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">  268</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::    <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>,    <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">  269</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a></div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">  270</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>,              <span class="keywordtype">DIMENSION(2)</span>   ::        <a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>,        <a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a></div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">  271</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> ::        <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>,        <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a4b6ffaeeaa4365c642ef3a5295635b07">  279</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::       <a class="code" href="namespacem__riemann__solvers.html#afbf6423349d95b7b3472eb84b9ba7f56">nbub_l</a>,     <a class="code" href="namespacem__riemann__solvers.html#a4b6ffaeeaa4365c642ef3a5295635b07">nbub_r</a></div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">  280</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::         <a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">  281</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::         <a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a></div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aa7deddacb25e873c573761963f680efc">  282</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::         <a class="code" href="namespacem__riemann__solvers.html#a2b69a3c582d14aba043c3cb6376335a5">p0_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#aa7deddacb25e873c573761963f680efc">p0_r</a></div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">  283</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::        <a class="code" href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">pbw_l</a>,      <a class="code" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">pbw_r</a></div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">  284</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::     <a class="code" href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">ptilde_l</a>,   <a class="code" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">ptilde_r</a></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">  294</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a></div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">  295</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::       <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a></div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">  296</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::       <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>,       <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a></div><div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">  297</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::      <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>,      <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a></div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">  298</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a></div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a985a98321338d51bc8a43695b490b102">  299</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#a75cca68e31742083e0ebbef418300c78">lo_h_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#a985a98321338d51bc8a43695b490b102">lo_h_r</a></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">  300</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   ::     <a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>,     <a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a></div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">  301</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::     <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>,     <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a></div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">  302</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::    <a class="code" href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">lo_pi_inf_l</a>,    <a class="code" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">lo_pi_inf_r</a></div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">  303</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              ::         <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a>,         <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a></div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a6d89cb45833bdcb48f3f1b01badaedcf">  304</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>,              <span class="keywordtype">DIMENSION(2)</span>   ::        <a class="code" href="namespacem__riemann__solvers.html#abbde404883793a9aae3708896b4a2781">lo_re_l</a>,        <a class="code" href="namespacem__riemann__solvers.html#a6d89cb45833bdcb48f3f1b01badaedcf">lo_re_r</a></div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">  305</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> ::        <a class="code" href="namespacem__riemann__solvers.html#a8388f446036552682910bbe06da81f70">lo_we_l</a>,        <a class="code" href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">lo_we_r</a></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">  310</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#adbaf70dfc178970c3e210dddedc31971">g1_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">g1_r</a></div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">  311</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a80405eb6d8eaa75206edeef312c782d7">g2_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">g2_r</a></div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a1e94f6d0053552684cebcc569b1a6f8a">  312</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#ac58b25fbd4733d5adff39c28b32673b8">g3_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a1e94f6d0053552684cebcc569b1a6f8a">g3_r</a></div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">  313</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a>, <a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a></div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a8e9c08866eae6dd81d694a5685306973">  314</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#af4a82bacd4c2232f466428d41f34dffa">g5_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a8e9c08866eae6dd81d694a5685306973">g5_r</a></div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">  315</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">g6_l</a>, <a class="code" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">g6_r</a></div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a746eb452c1a5c1db204624afaad5b478">  316</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#abbed27f1ec9cca777a83635a05fc8525">g7_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a746eb452c1a5c1db204624afaad5b478">g7_r</a></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a6ece114ee17503f716a99a601c2ba5d1">  317</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a0f213519240daa52e669ecb053edae70">g8_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a6ece114ee17503f716a99a601c2ba5d1">g8_r</a></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">  322</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a></div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">  323</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">  328</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a></div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">  329</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a></div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">  330</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a></div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">  331</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a></div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">  332</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a></div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">  333</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">  338</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">dpres_we</a></div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">  339</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">  347</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                 :: <a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a></div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">  348</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>   , <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a></div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">  349</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                 :: <a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a></div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">  350</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a></div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">  351</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                 :: <a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">  352</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                                 :: <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a></div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">  353</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a></div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">  354</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: <a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a></div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">  355</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>   , <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">  360</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>, <a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">  365</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">rho_star</a>, <a class="code" href="namespacem__riemann__solvers.html#a74301c7719264f4c4ca9ab6318a438cb">e_star</a>, <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a>, <a class="code" href="namespacem__riemann__solvers.html#ac5dad78660af09505fe587f052afdfd5">p_k_star</a></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">  370</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>, <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">  375</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>, <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">  380</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a></div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">  381</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>, <a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a></div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">  382</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>, <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a></div><div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">  383</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>, <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a></div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">  384</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a>, <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a></div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">  385</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>, <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">  388</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__riemann__solvers_1_1s__abstract__riemann__solver.html">s_abstract_riemann_solver</a>), &amp;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; null() </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    </div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">  393</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__average__state.html">s_compute_abstract_average_state</a>), &amp;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">s_compute_average_state</a> =&gt; null() </div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    </div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">  398</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds.html">s_compute_abstract_wave_speeds</a>), &amp;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">s_compute_wave_speeds</a> =&gt; null() </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    </div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">  404</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux.html">s_compute_abstract_viscous_source_flux</a>), &amp;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a> =&gt; null() </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">  411</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>,<a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>,<a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">s_hll_riemann_solver</a>( qL_prim_vf, dqL_prim_dx_vf, &amp; ! -------</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                     dqL_prim_dy_vf, &amp;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                     dqL_prim_dz_vf, &amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                       gm_alphaL_vf, &amp;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                                          kappaL_vf, &amp;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                         qR_prim_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                     dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                                     dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                                       gm_alphaR_vf, &amp;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                          kappaR_vf, &amp;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                                          q_prim_vf, &amp;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                               flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                       flux_gsrc_vf, &amp;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                                 norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">  464</a></span>&#160;            </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qL_prim_vf, qR_prim_vf</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: dqL_prim_dx_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                             dqL_prim_dy_vf, dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                             dqL_prim_dz_vf, dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                               gm_alphaL_vf,   gm_alphaR_vf, &amp;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                  kappaL_vf,      kappaR_vf</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="comment">! Intercell fluxes</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf, flux_gsrc_vf</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            </div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;           </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="comment">! Placeholders for high- and low-order fluxes</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: hi_cons, hi_cons_L, hi_cons_R</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: lo_cons, lo_cons_L, lo_cons_R</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: tvd_cons, tvd_cons_L, tvd_cons_R</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: hi_flux_L, hi_flux_R, lo_flux_L, lo_flux_R</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: tvd_flux_L, tvd_flux_R</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="comment">! Populating the buffers of the left and right Riemann problem</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="comment">! states variables, based on the choice of boundary conditions</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b">s_populate_riemann_states_variables_buffers</a>( &amp;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                  ql_prim_vf, dql_prim_dx_vf, &amp;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                              dql_prim_dy_vf, &amp;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                              dql_prim_dz_vf, &amp;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                                gm_alphal_vf, &amp;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                   kappal_vf, &amp;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                  qr_prim_vf, dqr_prim_dx_vf, &amp;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                              dqr_prim_dy_vf, &amp;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                              dqr_prim_dz_vf, &amp;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                                gm_alphar_vf, &amp;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                                   kappar_vf, &amp;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                          norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="comment">! Reshaping inputted data based on dimensional splitting direction</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c">s_initialize_riemann_solver</a>( ql_prim_vf, kappal_vf, &amp;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                              qr_prim_vf, kappar_vf, &amp;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                                          q_prim_vf, &amp;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                               flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                                       flux_gsrc_vf, &amp;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                                 norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="comment">! Computing HLL flux and source flux for Euler system of equations</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">s_compute_average_state</a>(j,k,l)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">s_compute_wave_speeds</a>(j,k,l)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a6301a5631fda64dd97c11777807a22c9">s_compute_flux_limiter</a>(j,k,l,<a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>,norm_dir)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> = min(0d0,<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>); <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a> = max(0d0,<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>)</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a> = (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>)) &amp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                             + (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>)) &amp;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                             * (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>))</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a> = (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>)) &amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                             + (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>)) &amp;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                             * (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>))</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a> = min(0d0,<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>); <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a> = max(0d0,<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>)</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a> = (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>)) &amp; </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                + (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>)) &amp; </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                * (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>))</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a> = (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>)) &amp; </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                + (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>)) &amp; </div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                * (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>))</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a> = <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a> + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a> = <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a> + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a> - <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a>)</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a> = <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a> + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(<a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a> - <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a>)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a> = <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a> + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(<a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a> - <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a>)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                            <span class="comment">! Mass</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                </div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                 lo_cons   = <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(i) - <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(i)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                 hi_cons   = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i) - <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                tvd_cons   = lo_cons + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_cons - lo_cons)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                 lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(i)*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                 lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(i)*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                 hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i) * <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                 hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i) * <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                        ( <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_cons) &amp;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                        / (<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                        ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> * tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a> * tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a> * tvd_cons) / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                            <span class="comment">! Momentum</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                 lo_cons   = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) - <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                 hi_cons   = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a> * <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) - <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a> * <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                tvd_cons   = lo_cons + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_cons - lo_cons)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                 lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                 lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                 hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a> * <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) * <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                 hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a> * <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) * <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                        ( <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_cons) &amp;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                        / (<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>)</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                        ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>* tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>* tvd_cons) / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                            <span class="comment">! Energy</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                             lo_cons   = <a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                             hi_cons   = <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                            tvd_cons   = lo_cons + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_cons - lo_cons)</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                             lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                             lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                             hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                             hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                            tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                    ( <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_cons) &amp;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                    / (<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                    ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>* tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>* tvd_cons) / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                            <span class="comment">! Volume fraction</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                 lo_cons   =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j,k,l) -  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                 hi_cons   = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf(j,k,l) - <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                tvd_cons   =  lo_cons + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_cons - lo_cons)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                 lo_flux_l =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                 lo_flux_r =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                 hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                 hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                tvd_flux_l =  lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                tvd_flux_r =  lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                </div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = (tvd_cons*<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>) / (<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf(j,k,l) = (<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a>*tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>*tvd_flux_l) &amp;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                                    / (<a class="code" href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">tvd_s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">tvd_s_p</a>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = (tvd_cons*<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>) / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf(j,k,l) = (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>* tvd_flux_r - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>* tvd_flux_l) / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                            <span class="comment">! Source terms</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                     lo_cons_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                     lo_cons_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                     hi_cons_l = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                     hi_cons_r = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                     lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                         (<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))-<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                     lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                         (<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))-<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                     hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a> * <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                         (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                     hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a> * <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                         (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                     lo_cons_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                     lo_cons_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                     hi_cons_l = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                     hi_cons_r = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                     lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))-<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> * &amp;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                         <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                     lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))-<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> * &amp;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                         <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                     hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a> * <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                         <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                     hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a> * <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                         <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                tvd_cons_l = lo_cons_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_cons_l - lo_cons_l)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                tvd_cons_r = lo_cons_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_cons_r - lo_cons_r)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_flux_l - <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_flux_r) &amp;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                        / (<a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_cons_l - <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_cons_r)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_flux_l - <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>* tvd_flux_r) / (<a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_cons_l - <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*tvd_cons_r)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                      - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*<a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*( <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)             &amp;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                                - <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i) ) )         &amp;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                      / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                            </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                        ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*( <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))         &amp;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                     *<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))         &amp;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                              + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> )    &amp;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                        - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*( <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))         &amp;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                                     *<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))         &amp;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                              + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> )    &amp;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                        + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*( <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))     &amp;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                                  - <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) ) ) &amp;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                        / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                            </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                    ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>) &amp;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                    - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>) &amp;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                    + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>) )                &amp;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                    / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            </div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                         ( <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)   &amp;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                         - <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l) ) &amp;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                         * <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>/(<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                       ( <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*<a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)   &amp;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                                       - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l) ) &amp;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                       / (<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> - <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                            </div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                             ( <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))  * &amp;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                                    (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) - &amp;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))  * &amp;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                                    (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) ) &amp;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                     / ( <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                         <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) )</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            </div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="comment">! Computing the viscous and capillary source flux</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3c3cd38abc3ece085bab77788afece73">weno_re_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a>( &amp;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                   ql_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                               dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                               dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                               dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                   qr_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                               dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                               dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                               dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                       flux_src_vf, norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a>( &amp;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                               dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                               dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                               dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                               dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                               dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                               dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                       flux_src_vf, norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            </div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da">s_compute_capillary_source_flux</a>( &amp;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                             dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                             dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                             dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                                    gm_alphal_vf , &amp;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                             dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                             dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                             dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                                    gm_alphar_vf , &amp;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                 flux_src_vf, norm_dir, ix,iy,iz   )</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="comment">! Reshaping outputted data based on dimensional splitting direction</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19">s_finalize_riemann_solver</a>( flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                                    flux_gsrc_vf, &amp;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                              norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">s_hll_riemann_solver</a> <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">s_hllc_riemann_solver</a>( qL_prim_vf, dqL_prim_dx_vf, &amp; ! ------</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                                      dqL_prim_dy_vf, &amp;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                                                      dqL_prim_dz_vf, &amp;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                                        gm_alphaL_vf, &amp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                                           kappaL_vf, &amp;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                          qR_prim_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                                      dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                                      dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                                        gm_alphaR_vf, &amp;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                                           kappaR_vf, &amp;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                           q_prim_vf, &amp;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                                        flux_gsrc_vf, &amp;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                                  norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">  849</a></span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qL_prim_vf, qR_prim_vf</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: dqL_prim_dx_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                             dqL_prim_dy_vf, dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                             dqL_prim_dz_vf, dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                               gm_alphaL_vf,   gm_alphaR_vf, &amp;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                  kappaL_vf,      kappaR_vf</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="comment">! Intercell fluxes</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf, flux_gsrc_vf</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            </div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            </div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: xi_L, xi_R</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            </div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="comment">! Placeholders for high- and low-order fluxes</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: lo_xi_L, lo_xi_R</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: hi_flux_L, hi_flux_R, lo_flux_L, lo_flux_R</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: tvd_flux_L, tvd_flux_R</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            </div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="comment">! Populating the buffers of the left and right Riemann problem</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="comment">! states variables, based on the choice of boundary conditions</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b">s_populate_riemann_states_variables_buffers</a>( &amp;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                  ql_prim_vf, dql_prim_dx_vf, &amp;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                              dql_prim_dy_vf, &amp;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                              dql_prim_dz_vf, &amp;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                                gm_alphal_vf, &amp;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                                   kappal_vf, &amp;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                  qr_prim_vf, dqr_prim_dx_vf, &amp;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                                              dqr_prim_dy_vf, &amp;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                              dqr_prim_dz_vf, &amp;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                                                gm_alphar_vf, &amp;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                                   kappar_vf, &amp;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                          norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            </div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="comment">! Reshaping inputted data based on dimensional splitting direction</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c">s_initialize_riemann_solver</a>( ql_prim_vf, kappal_vf, &amp;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                              qr_prim_vf, kappar_vf, &amp;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                                                          q_prim_vf, &amp;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                               flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                                       flux_gsrc_vf, &amp;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                                 norm_dir, ix,iy,iz  )</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="comment">! Computing HLLC flux and source flux for Euler system of equations</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">s_compute_average_state</a>(j,k,l)</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">s_compute_wave_speeds</a>(j,k,l)</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                            <span class="comment">! Compute left solution state</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a> = <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> <span class="comment">! Only usefull to recalculate the radial momentum geometric source flux</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf( j ,k,l)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                    </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf( j ,k,l)*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                    </div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf( j ,k,l)*&amp;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf)*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg-1+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                    </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + &amp;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                    <span class="comment">! Compute the star velocities for the non-conservative terms</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = (<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                            <span class="comment">! Compute right solution state</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> &lt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a> = <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> </div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                <span class="comment">! Only usefull to recalculate the radial momentum geometric source flux</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j+1,k,l)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                    </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf(j+1,k,l)*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                    </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j+1,k,l) * &amp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf)*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">                                END DO</span> </div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg-1+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                    </div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + &amp;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) </div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                    <span class="comment">! Compute the star velocities for the non-conservative terms</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = (<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                            <span class="comment">! Compute left star solution state</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                xi_l = (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))/(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">rho_star</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*xi_l</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a74301c7719264f4c4ca9ab6318a438cb">e_star</a> = xi_l*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) * &amp;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                    (<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> / (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#ac5dad78660af09505fe587f052afdfd5">p_k_star</a> = (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(1d0+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma)) * &amp;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                        xi_l**(1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0) - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(1d0+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                    </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf( j ,k,l)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                    </div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf( j ,k,l)*xi_l*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                    </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf( j ,k,l) * &amp;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma*<a class="code" href="namespacem__riemann__solvers.html#ac5dad78660af09505fe587f052afdfd5">p_k_star</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg-1+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">rho_star</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                        (1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + &amp;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>*xi_l - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                    <span class="comment">! Compute the star velocities for the non-conservative terms</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = (<a class="code" href="namespacem__riemann__solvers.html#a74301c7719264f4c4ca9ab6318a438cb">e_star</a> + <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a>)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                            <span class="comment">! Compute right star solution state</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                xi_r = (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))/(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                                </div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">rho_star</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*xi_r</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                </div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a74301c7719264f4c4ca9ab6318a438cb">e_star</a> = xi_r*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) * &amp;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                    (<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> / (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#ac5dad78660af09505fe587f052afdfd5">p_k_star</a> = (<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(1d0+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma)) * &amp;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                        xi_r**(1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0) - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(1d0+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma)</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                    </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j+1,k,l)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                    </div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg-1)%sf(j+1,k,l)*xi_r*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                    </div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg-1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j+1,k,l) * &amp; </div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma*<a class="code" href="namespacem__riemann__solvers.html#ac5dad78660af09505fe587f052afdfd5">p_k_star</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                               </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg-1+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">rho_star</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> * &amp;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>*<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))) + &amp;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                    </div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + &amp;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>*xi_r - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) </div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                    <span class="comment">! Compute the star velocities for the non-conservative terms</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = (<a class="code" href="namespacem__riemann__solvers.html#a74301c7719264f4c4ca9ab6318a438cb">e_star</a> + <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a>)*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                       </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                            <span class="comment">! Geometrical source flux for cylindrical coordinates</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                            <span class="keywordflow">IF</span>(norm_dir == 2 .AND. <a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                <span class="comment">! Substituting the advective flux into the inviscid geometrical source flux</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">internalenergies_idx</a>%end</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l)</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                                <span class="comment">! Recalculating the radial momentum geometric source flux (substracting the pressure part)</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg-1+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg-1+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf(j,k,l) - <a class="code" href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">p_star</a></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                <span class="comment">! Geometrical source of the void fraction(s) is zero</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = 0d0</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = 0d0</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a6301a5631fda64dd97c11777807a22c9">s_compute_flux_limiter</a>(j,k,l,<a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>,norm_dir)</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                            <span class="comment">! follows Einfeldt et al.</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                            <span class="comment">! s_M/P = min/max(0.,s_L/R)</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a> = min(0d0,<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>); <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a> = max(0d0,<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>)</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                            </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                            <span class="comment">! goes with q_star_L/R = xi_L/R * (variable)</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                            <span class="comment">! xi_L/R = ( ( s_L/R - u_L/R )/(s_L/R - s_star) )</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                            xi_l = (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))/(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                            xi_r = (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))/(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                            </div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                            <span class="comment">! goes with numerical velocity in x/y/z directions</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                            <span class="comment">! xi_P/M = 0.5 +/m sgn(0.5,s_star) </span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a> = (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>))</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a> = (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>))</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a> = min(0d0,<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>); <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a> = max(0d0,<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>)</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                lo_xi_l = (<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))/(<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>)</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                lo_xi_r = (<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))/(<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a> = (5d-1 + sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>))</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a> = (5d-1 - sign(5d-1,<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>))</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a> = <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a> + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(<a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a> - <a class="code" href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">lo_xi_m</a>)</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a> = <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a> + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(<a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a> - <a class="code" href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">lo_xi_p</a>)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                <span class="comment">! Mass</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                         lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(i)*(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>*(lo_xi_l - 1d0))</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                                         lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(i)*(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a>*(lo_xi_r - 1d0))</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                                         hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) +    <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(   xi_l - 1d0))</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                                         hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) +    <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(   xi_r - 1d0))</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                         lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(i)*(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0))</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                         lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(i)*(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0))</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                         hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0))</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                                         hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0))</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                                    tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                                    tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    </div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_flux_r</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>* tvd_flux_r</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                <span class="comment">! Momentum</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                         lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>*(lo_xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*  &amp;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                         lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a>*(lo_xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*  &amp;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                                         hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(   xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*    &amp;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                                   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*   <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                         hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(   xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*    &amp;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                                                   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*   <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                         lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*   &amp;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                         lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*   &amp;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                         hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*   &amp;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                                   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*   <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                         hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))+       &amp;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+(1d0-<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))*   &amp;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                                   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))-   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))))+<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*   <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                    tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                    tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    </div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_flux_r</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>* tvd_flux_r</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    </div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                <span class="comment">! Energy</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                     lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>+<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>) + &amp;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>*(lo_xi_l*(<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>+(<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>-       &amp;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a> + &amp;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a>-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                     lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) * &amp;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                            (<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a>+<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>)+<a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a>*(lo_xi_r*(<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a>+(<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a>-  &amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a> + &amp;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a>-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a>)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                     hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(   <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>+   <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)+<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(   xi_l*(   <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>+(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>-  &amp;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*&amp;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                               (   <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+   <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>-   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-   <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                     hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(   <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>+   <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)+ &amp;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                         <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(   xi_r*(   <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>+(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>-     &amp;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(   <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+   &amp;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>-   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-   <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                     lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>+<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>)+<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>+(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>-        &amp;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> / &amp;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                            (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>-<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a>)</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                     lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a>+<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>)+<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a>+(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>-        &amp;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> / &amp;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                            (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>-<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a>)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                     hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(   <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>+   <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)+<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(   <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>+(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>-        &amp;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(   <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+   <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> / &amp;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                               (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a>-   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-   <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>)</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                     hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(   <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>+   <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)+<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(   <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>+(<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>-        &amp;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*(   <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a>+   <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> / &amp;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                               (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a>-   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))-   <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    </div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_flux_r</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>* tvd_flux_r</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                    </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                <span class="comment">! Volume fraction</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                         lo_flux_l =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf( j ,k,l)*(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+<a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>*(lo_xi_l-1d0))</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                         lo_flux_r =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j+1,k,l)*(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+<a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a>*(lo_xi_r-1d0))</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                         hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+   <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(   xi_l-1d0))</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                         hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+   <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(   xi_r-1d0))</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                         lo_flux_l =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf( j ,k,l)*(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l-1d0))</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                         lo_flux_r =  <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j+1,k,l)*(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r-1d0))</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                         hi_flux_l = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l-1d0))</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                         hi_flux_r = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))+<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r-1d0))</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                    tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                    tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                    </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_flux_r</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>* tvd_flux_r</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    </div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                <span class="comment">! Source terms</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                         lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">lo_s_m</a>*(lo_xi_l-1d0)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                         lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">lo_s_p</a>*(lo_xi_r-1d0)</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                         hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*   <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(   xi_l-1d0)</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                         hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*   <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(   xi_r-1d0)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                         lo_flux_l = <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l-1d0)</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                         lo_flux_r = <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r-1d0)</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                         hi_flux_l =    <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l-1d0)</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                         hi_flux_r =    <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r-1d0)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                    tvd_flux_l = lo_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_l - lo_flux_l)</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                    tvd_flux_r = lo_flux_r + <a class="code" href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">flux_lim_func</a>*(hi_flux_r - lo_flux_r)</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    </div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">tvd_xi_m</a>*tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">tvd_xi_p</a>*tvd_flux_r</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>* tvd_flux_l + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>* tvd_flux_r</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                                           <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*<a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)                    &amp;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                         * (<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0)) &amp;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                         + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*<a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)                    &amp;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                         * (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0))</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2) .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 1) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                                    <span class="comment">! Kill mass transport @ gas density</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)%sf(j,k,l) = 0.d0</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                <span class="comment">! Momentum flux. </span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                <span class="comment">! f = \rho u u + p I, q = \rho u, q_star = \xi * \rho*(s_star, v, w)</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *            &amp;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) +                         &amp;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +        &amp;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                            (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) *               &amp;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))) +  &amp;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>))      &amp;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                                        + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *              &amp;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) +                         &amp;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +        &amp;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                            (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) *               &amp;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))) +  &amp;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>))</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                    <span class="comment">! Include p_tilde</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *            &amp;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) +                         &amp;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +        &amp;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                            (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) *               &amp;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))) +  &amp;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">ptilde_l</a>))      &amp;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                        + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *              &amp;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) +                         &amp;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +        &amp;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                            (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) *               &amp;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))) - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)))) +  &amp;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">ptilde_r</a>))</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                <span class="comment">! Energy flux.</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                <span class="comment">! f = u*(E+p), q = E, q_star = \xi*E+(s-u)(\rho s_star + p/(s-u))</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                     <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">ptilde_l</a>) +     &amp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) * &amp;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> + (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - <a class="code" href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">ptilde_l</a>) /                        &amp;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))))) - <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>))          &amp;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                   + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">ptilde_r</a>) +     &amp;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) * &amp;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> + (<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - <a class="code" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">ptilde_r</a>) /                        &amp;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))))) - <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>))</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                     <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>) +     &amp;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) * &amp;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> /                        &amp;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))))) - <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a>))          &amp;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                   + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>) +     &amp;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + (<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) * &amp;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> /                        &amp;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                        (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))))) - <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a>))</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                                    <span class="comment">! Tait EOS, no energy equation</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = 0.d0</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                <span class="comment">! Volume fraction flux</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>, <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a> <span class="comment">!only advect the void fraction</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) =  &amp;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf(j,k,l)      &amp;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                                * (<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0)) &amp;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                                + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*<a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)      &amp;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                                * (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0))</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end </div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) =  &amp;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf(j,k,l)      &amp;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                                * (<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0)) &amp;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                                + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*<a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)      &amp;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                                * (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0))</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                <span class="comment">! Source for volume fraction advection equation</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(   <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + &amp;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0) ) &amp;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(   <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + &amp;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                            <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0) ) </div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                    </div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                    <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4 ) <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = 0d0</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                    <span class="comment">!IF ( (model_eqns == 4) .or. (num_fluids==1) ) vel_src_rs_vf(dir_idx(i))%sf(j,k,l) = 0d0</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                <span class="comment">! Add advection flux for bubble variables</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%beg,<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) =   &amp;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*<a class="code" href="namespacem__riemann__solvers.html#afbf6423349d95b7b3472eb84b9ba7f56">nbub_l</a>*<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf(j,k,l)      &amp;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                                * (<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l - 1d0)) &amp;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                                + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*<a class="code" href="namespacem__riemann__solvers.html#a4b6ffaeeaa4365c642ef3a5295635b07">nbub_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)      &amp;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                                * (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r - 1d0))</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                <span class="comment">! Geometrical source flux for cylindrical coordinates</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                <span class="keywordflow">IF</span>(norm_dir == 2 .AND. <a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                    <span class="comment">! Substituting the advective flux into the inviscid geometrical source flux</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                    <span class="comment">! Recalculating the radial momentum geometric source flux</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *           &amp;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) +                        &amp;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +       &amp;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                              (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) *              &amp;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))  &amp;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                                            + <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *           &amp;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) +                        &amp;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +       &amp;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                              (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) *              &amp;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                                    <span class="comment">! Geometrical source of the void fraction(s) is zero</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = 0d0</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                <span class="keywordflow">ELSEIF</span> (norm_dir == 3 .AND. <a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = 0d0</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                            - <a class="code" href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">xi_m</a>*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *           &amp;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) +                        &amp;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">s_m</a>*(xi_l*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +       &amp;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                              (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) *              &amp;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))  &amp;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                                            - <a class="code" href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">xi_p</a>*(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) *           &amp;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) +                        &amp;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">s_p</a>*(xi_r*(<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> +       &amp;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                              (1d0 - <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) *              &amp;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))))</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l)</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(j,k,l) = 0d0</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            </div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            </div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <span class="comment">! Computing the viscous and capillary source flux</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3c3cd38abc3ece085bab77788afece73">weno_re_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a>( &amp;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                   ql_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                               dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                               dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                               dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                                   qr_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                               dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                               dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                               dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                                       flux_src_vf, norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a>( &amp;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                               dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                               dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                               dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                               dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                               dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                               dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                       flux_src_vf, norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            </div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da">s_compute_capillary_source_flux</a>( &amp;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                             dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                             dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                             dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                                    gm_alphal_vf , &amp;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                             dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                             dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                             dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                                    gm_alphar_vf , &amp;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                 flux_src_vf, norm_dir, ix,iy,iz   )</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            </div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            </div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="comment">! Reshaping outputted data based on dimensional splitting direction</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19">s_finalize_riemann_solver</a>( flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                                    flux_gsrc_vf, &amp;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                              norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            </div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            </div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">s_hllc_riemann_solver</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        </div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        </div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        </div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">s_exact_riemann_solver</a>( qL_prim_vf, dqL_prim_dx_vf, &amp; ! -----</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                                       dqL_prim_dy_vf, &amp;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                                       dqL_prim_dz_vf, &amp;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                                         gm_alphaL_vf, &amp;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                                            kappaL_vf, &amp;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                           qR_prim_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                                       dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                                       dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                                                         gm_alphaR_vf, &amp;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                                                            kappaR_vf, &amp;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                                            q_prim_vf, &amp;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                                 flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                                         flux_gsrc_vf, &amp;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                                   norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01517"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27"> 1517</a></span>&#160;            </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qL_prim_vf, qR_prim_vf</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: dqL_prim_dx_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                             dqL_prim_dy_vf, dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                             dqL_prim_dz_vf, dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                               gm_alphaL_vf,   gm_alphaR_vf, &amp;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                  kappaL_vf,      kappaR_vf</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            </div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf, flux_gsrc_vf</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            </div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            </div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            </div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <span class="comment">! Populating the buffers of the left and right Riemann problem</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="comment">! states variables, based on the choice of boundary conditions</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b">s_populate_riemann_states_variables_buffers</a>( &amp;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                  ql_prim_vf, dql_prim_dx_vf, &amp;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                                              dql_prim_dy_vf, &amp;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                                              dql_prim_dz_vf, &amp;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                                gm_alphal_vf, &amp;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                                   kappal_vf, &amp;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                  qr_prim_vf, dqr_prim_dx_vf, &amp;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                              dqr_prim_dy_vf, &amp;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                              dqr_prim_dz_vf, &amp;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                                gm_alphar_vf, &amp;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                                                   kappar_vf, &amp;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                                          norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            </div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            </div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="comment">! Reshaping inputted data based on dimensional splitting direction</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c">s_initialize_riemann_solver</a>( ql_prim_vf, kappal_vf, &amp;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                              qr_prim_vf, kappar_vf, &amp;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                                          q_prim_vf, &amp;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                               flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                                                       flux_gsrc_vf, &amp;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                                 norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            </div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            </div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            <span class="comment">! Computing exact flux and source flux for Euler system of equations</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                    <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg, <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a16383eccdd2d0ecca7d1c26467daaaab">s_compute_constant_states</a>(j,k,l)</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;            </div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                        <span class="comment">! Check for pressure positivity condition</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                        <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> + <a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>) &lt; (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))-<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                            print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39;Vacuum is generated by Riemann data. Exiting...&#39;</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            </div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a947bc1c7da743ee0820ff6648fef3c25">s_compute_star_region</a>()</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            </div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a68651027acd974568fd5f94ed39c8e82">s_compute_intercell_solution</a>()</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            </div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i)*<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            </div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) + <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            </div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))*(<a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a>)</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            </div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i)*<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            </div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf(j,k,l) = <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            </div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            </div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="comment">! Computing the viscous and capillary source flux</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3c3cd38abc3ece085bab77788afece73">weno_re_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a>( &amp;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                   ql_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                               dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                               dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                               dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                   qr_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                               dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                               dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                               dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                                       flux_src_vf, norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a>( &amp;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                               dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                               dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                               dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                    q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                               dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                               dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                               dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end), &amp;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                                       flux_src_vf, norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da">s_compute_capillary_source_flux</a>( &amp;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                             dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                             dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                             dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                                    gm_alphal_vf , &amp;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                             dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                             dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                             dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end), &amp;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                                                    gm_alphar_vf , &amp;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                                 flux_src_vf, norm_dir, ix,iy,iz   )</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            </div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            </div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            <span class="comment">! Reshaping outputted data based on dimensional splitting direction</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19">s_finalize_riemann_solver</a>( flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                                                    flux_gsrc_vf, &amp;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                                              norm_dir, ix,iy,iz  )</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            </div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            </div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">s_exact_riemann_solver</a> <span class="comment">! --------------------------------</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        </div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        </div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        </div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a16383eccdd2d0ecca7d1c26467daaaab">s_compute_constant_states</a>(j,k,l) <span class="comment">! --------------------------</span></div><div class="line"><a name="l01664"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a16383eccdd2d0ecca7d1c26467daaaab"> 1664</a></span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            <span class="comment">! Left and Right Riemann States</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf( j ,k,l)</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j+1,k,l)</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf( j ,k,l)</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j+1,k,l)</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>, &amp;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>, &amp;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>,  j ,k,l  )</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>, &amp;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a>, &amp;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>, j+1,k,l  )</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> = <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>**2d0)</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> = <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>**2d0)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a> = (<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a> = (<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5">s_compute_mixture_sound_speeds</a>(j,k,l)</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                    5d-1*(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) + <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)))</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            <span class="keywordflow">DO</span> i = 1, 2</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i) &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(i)%sf(j,k,l) = 2d0/(1d0/<a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>(i) + 1d0/<a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a>(i))</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) = &amp;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                             5d-1*( <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) &amp;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                  + <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) )</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) = &amp;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                    5d-1*( <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( j ,k,l) &amp;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                         + <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j+1,k,l) )</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            <span class="comment">! Compute gamma-related constants</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#adbaf70dfc178970c3e210dddedc31971">g1_l</a> = 1d0/(2d0*(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">g1_r</a> = 1d0/(2d0*(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a80405eb6d8eaa75206edeef312c782d7">g2_l</a> = (1d0 + 2d0*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>)/(2d0*(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">g2_r</a> = (1d0 + 2d0*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>)/(2d0*(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac58b25fbd4733d5adff39c28b32673b8">g3_l</a> = 2d0*(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0)</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a1e94f6d0053552684cebcc569b1a6f8a">g3_r</a> = 2d0*(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0)</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a> = 2d0*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a> = 2d0*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#af4a82bacd4c2232f466428d41f34dffa">g5_l</a> = 2d0/((1d0/<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>) + 2d0)</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a8e9c08866eae6dd81d694a5685306973">g5_r</a> = 2d0/((1d0/<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>) + 2d0)</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">g6_l</a> = 1d0/(1d0 + 2d0*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>)</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">g6_r</a> = 1d0/(1d0 + 2d0*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>)</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abbed27f1ec9cca777a83635a05fc8525">g7_l</a> = 1d0/(2d0*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>)</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a746eb452c1a5c1db204624afaad5b478">g7_r</a> = 1d0/(2d0*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>)</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a0f213519240daa52e669ecb053edae70">g8_l</a> = 1d0/<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a6ece114ee17503f716a99a601c2ba5d1">g8_r</a> = 1d0/<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="comment">! Surface tension pressure contribution</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">dpres_we</a> = 0d0</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> = 0d0</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> = 0d0</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">dpres_we</a> = <a class="code" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">dpres_we</a> &amp;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                             - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                                                            <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                                                            ( <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))   &amp;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                                            - <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) )</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> = 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">dpres_we</a></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> = -5d-1*<a class="code" href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">dpres_we</a></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        </div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a16383eccdd2d0ecca7d1c26467daaaab">s_compute_constant_states</a> <span class="comment">! -----------------------------</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5">s_compute_mixture_sound_speeds</a>(j,k,l) <span class="comment">! ---------------------</span></div><div class="line"><a name="l01766"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5"> 1766</a></span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: blkmod1, blkmod2</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .or. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf( j ,k,l)</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j+1,k,l)</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + &amp;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + &amp;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = 1d0/(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(1)/blkmod1 + <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(2)/blkmod2))</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + &amp;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + &amp;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = 1d0/(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(1)/blkmod1 + <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(2)/blkmod2))</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = 0d0</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = 0d0</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> + <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf( j ,k,l) * (1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0) * &amp;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                        (<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf( j ,k,l) + <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0))</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j+1,k,l) * (1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0) * &amp;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                        (<a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j+1,k,l) + <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0))</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>/<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>/<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keywordflow">ELSEIF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) .or. (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) ) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                <span class="comment">! Sound speed for bubble mmixture to order O(\alpha)</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf( j ,k,l)</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j+1,k,l)</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                </div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 1)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> =   (1d0/<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0) *   &amp;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>) / <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>  </div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> =   (1d0/<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0) *   &amp;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>) / <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>  </div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> =   &amp; </div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                            (1d0/<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0) *   &amp;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>) /   &amp;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(1d0-<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))) </div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> =   &amp; </div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                            (1d0/<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0) *   &amp;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>) /   &amp;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(1d0-<a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))) </div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf( j ,k,l)</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j+1,k,l)</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = ((<a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>)</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = ((<a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>)</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = 100.d0*<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> = sqrt(<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>)</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = 100.d0*<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> = sqrt(<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>)</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf( j ,k,l)</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j+1,k,l)</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                    blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> + &amp;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                    blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> + &amp;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a> = 1d0/(<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>(1)/blkmod1 + <a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>(2)/blkmod2))</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> + &amp;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                    blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma+1d0)*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> + &amp;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a> = 1d0/(<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a>(1)/blkmod1 + <a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a>(2)/blkmod2))</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf( j ,k,l)</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j+1,k,l)</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a> = ((<a class="code" href="namespacem__riemann__solvers.html#a75cca68e31742083e0ebbef418300c78">lo_h_l</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>)</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a> = ((<a class="code" href="namespacem__riemann__solvers.html#a985a98321338d51bc8a43695b490b102">lo_h_r</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>)</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a> &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a> = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a> = sqrt(<a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a>)</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a> &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a> = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a> = sqrt(<a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a>)</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5">s_compute_mixture_sound_speeds</a> <span class="comment">! ------------------------</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a947bc1c7da743ee0820ff6648fef3c25">s_compute_star_region</a>() <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l01891"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a947bc1c7da743ee0820ff6648fef3c25"> 1891</a></span>&#160;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: change, f_L, dfdp_L, f_R, dfdp_R, pres_old, &amp; </div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                        pres_start, pres_tol, vel_diff</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            <span class="keywordtype">INTEGER</span> :: iter</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            pres_tol = 1d-10</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            change = -1d0*<a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            <span class="comment">! Compute starting guess value for pressure</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a7e533d9eadb12af316d72f1b722735d8">s_guess_pressure</a>(pres_start)</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            pres_old = pres_start</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;            vel_diff = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            iter = 0</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <span class="comment">! Solve iteratively for pressure in the star region</span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span> (change &gt; pres_tol)</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#aba768ee53f47327a70508a913b55254d">s_pressure_function</a>(f_l, dfdp_l, pres_old, 1)</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#aba768ee53f47327a70508a913b55254d">s_pressure_function</a>(f_r, dfdp_r, pres_old, 2)</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> = pres_old - (f_l + f_r + vel_diff)/(dfdp_l + dfdp_r)</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                <span class="keywordflow">IF</span> (iter &gt; 10000) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Too many iterations in pressure&#39;</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                change = 2d0*abs((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> - pres_old)/(<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + pres_old))</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                pres_old = <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                iter = iter + 1</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            <span class="comment">! Compute velocity in star region</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a> = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + f_r - f_l)</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a947bc1c7da743ee0820ff6648fef3c25">s_compute_star_region</a> <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aba768ee53f47327a70508a913b55254d">s_pressure_function</a>(f_K, dfdp_K, pres, side) <span class="comment">! -</span></div><div class="line"><a name="l01934"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aba768ee53f47327a70508a913b55254d"> 1934</a></span>&#160;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: pres</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: side</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: f_K, dfdp_K</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gam_L, pinf_L, gam_R, pinf_R, c_SL, c_SR</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <span class="keywordflow">IF</span> (side == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                gam_l = (<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0)/<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                pinf_l = <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0)</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                <span class="keywordflow">IF</span> (pres + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> &lt;= <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                   <span class="comment">! Rarefaction wave</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                    c_sl = <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*((pres+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>+pinf_l)/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l))**<a class="code" href="namespacem__riemann__solvers.html#adbaf70dfc178970c3e210dddedc31971">g1_l</a></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                    f_k = <a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a>*(c_sl/<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> - 1d0)*<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                    dfdp_k = c_sl/(gam_l*(<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>+pres+pinf_l))</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                <span class="keywordflow">ELSEIF</span> (pres + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> &gt; <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                    <span class="comment">! Shock wave</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                    f_k = (<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>/gam_l*((pres+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - 1d0)*(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l))) / &amp;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                            sqrt(<a class="code" href="namespacem__riemann__solvers.html#a80405eb6d8eaa75206edeef312c782d7">g2_l</a>*((pres+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - 1d0)*(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l)) + 1d0)</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                    dfdp_k = 2d0*<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>/gam_l/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l) / &amp;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                                sqrt(2d0*(gam_l+1d0)*(pres+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/gam_l/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l)+4d0) - &amp;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                             2d0*<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*(pres+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)*(gam_l+1d0)/gam_l**2d0/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l)**2d0 / &amp;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                                sqrt(2d0*(gam_l+1d0)*(pres+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/gam_l/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l)+4d0)**3d0</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39;Error in evaluating left pressure function. Exiting...&#39;</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <span class="keywordflow">ELSEIF</span> (side == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                gam_r = (<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0)/<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                pinf_r = <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0)</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                <span class="keywordflow">IF</span> (pres + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> &lt;= <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                    <span class="comment">! Rarefaction wave</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                    c_sr = <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*((pres+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>+pinf_r)/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r))**<a class="code" href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">g1_r</a></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                    f_k = <a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a>*(c_sr/<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> - 1d0)*<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                    dfdp_k = c_sr/(gam_r*(<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>+pres+pinf_r))</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                <span class="keywordflow">ELSEIF</span> (pres + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> &gt; <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                    <span class="comment">! Shock wave</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                    f_k = (<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>/gam_r*((pres+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - 1d0)*(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r))) / &amp;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                            sqrt(<a class="code" href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">g2_r</a>*((pres+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - 1d0)*(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r)) + 1d0)</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                    dfdp_k = 2d0*<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>/gam_r/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r) / &amp;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                                sqrt(2d0*(gam_r+1d0)*(pres+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/gam_r/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r)+4d0) - &amp;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                             2d0*<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*(pres+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)*(gam_r+1d0)/gam_r**2d0/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r)**2d0 / &amp;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                                sqrt(2d0*(gam_r+1d0)*(pres+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/gam_r/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r)+4d0)**3d0</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39;Error in evaluating right pressure function. Exiting...&#39;</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aba768ee53f47327a70508a913b55254d">s_pressure_function</a> <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a7e533d9eadb12af316d72f1b722735d8">s_guess_pressure</a>(pres_start) <span class="comment">! -------------------------------</span></div><div class="line"><a name="l01994"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a7e533d9eadb12af316d72f1b722735d8"> 1994</a></span>&#160;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(INOUT)</span> :: pres_start</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: CUP, pres_max, pres_min, pres_PV, &amp; </div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                                Q_max, Q_user, pres_TS, pres_TR</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pinf_L, pinf_R,A,B</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            q_user = 2d0</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            <span class="comment">! Compute guess pressure from PVRS Riemann solver</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            cup = 25d-2*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>)*(<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>)</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            pres_pv = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>) + 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))*cup</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            pres_pv = max(0d0, pres_pv)</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            pres_min = min(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>, <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            pres_max = max(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>, <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            q_max = pres_max / pres_min </div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;            <span class="keywordflow">IF</span> ((q_max &lt;= q_user) .AND. (pres_min &lt;= pres_pv) .AND. (pres_pv &lt;= pres_max)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                <span class="comment">! Select PVRS Riemann solver</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                pres_start = pres_pv</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                <span class="keywordflow">IF</span> (pres_start /= pres_start) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39;NaN guess for pressure using PVRS&#39;</span></div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            <span class="keywordflow">ELSEIF</span> (pres_pv &lt; pres_min) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                <span class="comment">! Select TRRS Riemann solver</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                pinf_l = <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0)</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                pinf_r = <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0)</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                pres_tr = ((((-<a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*(((pres_pv+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>+pinf_r)/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r))**<a class="code" href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">g1_r</a> - 1d0) - &amp;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))) / <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>/<a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a> )+1d0)**<a class="code" href="namespacem__riemann__solvers.html#ac58b25fbd4733d5adff39c28b32673b8">g3_l</a>) * &amp;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                            (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l) - (<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>+pinf_l)</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                pres_start = max(0d0,pres_tr)</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                <span class="keywordflow">IF</span> (pres_start /= pres_start) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39;NaN guess for pressure using TRRS&#39;</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                <span class="comment">! Select TSRS Riemann solver with pres_PV as estimate</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                a = sqrt(<a class="code" href="namespacem__riemann__solvers.html#a80405eb6d8eaa75206edeef312c782d7">g2_l</a>*((pres_pv+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l)) + 1d0)</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                b = sqrt(<a class="code" href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">g2_r</a>*((pres_pv+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r)) + 1d0)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                pres_ts = (<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0)/a*((<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>)/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l)) + &amp;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                           <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0)/b*((<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>)/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r)) - &amp;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                          (<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))) / &amp;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                          (<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0)/a/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+pinf_l) + &amp;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                           <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0)/b/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+pinf_r))</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                pres_start = max(0d0,pres_ts)</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                <span class="keywordflow">IF</span> (pres_start /= pres_start) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39;NaN guess for pressure using TSRS&#39;</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;            </div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a7e533d9eadb12af316d72f1b722735d8">s_guess_pressure</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a68651027acd974568fd5f94ed39c8e82">s_compute_intercell_solution</a>() <span class="comment">! --------------------</span></div><div class="line"><a name="l02061"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a68651027acd974568fd5f94ed39c8e82"> 2061</a></span>&#160;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: c_IC</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: s_HL, S_TL, c_SL, pres_SL, s_L</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: s_HR, S_TR, c_SR, pres_SR, s_R</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            <span class="keywordflow">IF</span> (0d0 &lt;= <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                <span class="comment">! IC lies to the left of the contact discontinuity</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a>  + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> &lt;= <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                    <span class="comment">! Left rarefaction</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                    s_hl = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                    <span class="keywordflow">IF</span> (0d0 &lt;= s_hl) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                        <span class="comment">! IC is left data state</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(i)</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i)</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                        c_sl = <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0)))**<a class="code" href="namespacem__riemann__solvers.html#adbaf70dfc178970c3e210dddedc31971">g1_l</a></div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                        s_tl = <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a> - c_sl</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                        <span class="keywordflow">IF</span> (0d0 &gt; s_tl) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                            <span class="comment">! IC is star left state</span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)*((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))/ &amp;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                                    (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0)))**(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0))</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0)) / &amp;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                                (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0)))**(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0))</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) = <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>**2d0) </div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i)</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                            <span class="comment">! IC is inside left rarefaction</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) = <a class="code" href="namespacem__riemann__solvers.html#af4a82bacd4c2232f466428d41f34dffa">g5_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> + <a class="code" href="namespacem__riemann__solvers.html#abbed27f1ec9cca777a83635a05fc8525">g7_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + 0d0)</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                            c_ic = <a class="code" href="namespacem__riemann__solvers.html#af4a82bacd4c2232f466428d41f34dffa">g5_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a> + <a class="code" href="namespacem__riemann__solvers.html#abbed27f1ec9cca777a83635a05fc8525">g7_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - 0d0))</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)*(c_ic/<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>)**<a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(c_ic/<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>)**<a class="code" href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">g4_l</a></div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))*(c_ic/<a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>)**<a class="code" href="namespacem__riemann__solvers.html#ac58b25fbd4733d5adff39c28b32673b8">g3_l</a> - (<a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>**2d0) </div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                    <span class="comment">! Left shock</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                    pres_sl = (<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + 1d0))</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                    s_l = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*sqrt(<a class="code" href="namespacem__riemann__solvers.html#a80405eb6d8eaa75206edeef312c782d7">g2_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a>+<a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a>-<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>+<a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>+1d0)) +1d0)</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                    <span class="keywordflow">IF</span> (0d0 &lt;= s_l) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                        <span class="comment">! IC is left data state</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(i)</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i)</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        <span class="comment">! IC is star left state</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i)*(pres_sl + <a class="code" href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">g6_l</a>)/(pres_sl*<a class="code" href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">g6_l</a> + 1d0)</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(pres_sl + <a class="code" href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">g6_l</a>)/(pres_sl*<a class="code" href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">g6_l</a> + 1d0)</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) = <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                        <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">dpres_l</a></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>**2d0) </div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i)</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                <span class="comment">! IC is to the right of the contact discontinuity</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> &gt; <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                    <span class="comment">! Right shock</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                    pres_sr = (<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                    s_r = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*sqrt(<a class="code" href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">g2_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a>+<a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a>-<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>+<a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0)) +1d0)</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                    <span class="keywordflow">IF</span> (0d0 &gt;= s_r) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                        <span class="comment">! IC is right data state</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(i)</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i)</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                        <span class="comment">! IC is star right state</span></div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)*(pres_sr + <a class="code" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">g6_r</a>)/(pres_sr*<a class="code" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">g6_r</a> + 1d0)</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(pres_sr + <a class="code" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">g6_r</a>)/(pres_sr*<a class="code" href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">g6_r</a> + 1d0)</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) = <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                        <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>**2d0) </div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i)</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                    <span class="comment">! Right rarefaction</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                    s_hr = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                    <span class="keywordflow">IF</span> (0d0 &gt;= s_hr) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                        <span class="comment">! IC is right data state</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(i)</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i)</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                        c_sr = <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0)))**<a class="code" href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">g1_r</a></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                        s_tr = <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a> + c_sr</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                        <span class="keywordflow">IF</span> (0d0 &lt;= s_tr) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                            <span class="comment">! IC is star right state</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)*((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))/ &amp;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                                    (<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0)))**(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0))</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*((<a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))/(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + &amp;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0)))**(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>+1d0))</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) = <a class="code" href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">vel_s</a></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">pres_s</a> + <a class="code" href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">dpres_r</a></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>**2d0) </div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i)</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                            <span class="comment">! IC is inside right rarefaction</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) = <a class="code" href="namespacem__riemann__solvers.html#a8e9c08866eae6dd81d694a5685306973">g5_r</a>*(-1d0*<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a746eb452c1a5c1db204624afaad5b478">g7_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + 0d0)</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                            c_ic = <a class="code" href="namespacem__riemann__solvers.html#a8e9c08866eae6dd81d694a5685306973">g5_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a746eb452c1a5c1db204624afaad5b478">g7_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - 0d0))</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i)*(c_ic/<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>)**<a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(c_ic/<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>)**<a class="code" href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">g4_r</a></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> = (<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))*(c_ic/<a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>)**<a class="code" href="namespacem__riemann__solvers.html#a1e94f6d0053552684cebcc569b1a6f8a">g3_r</a> - (<a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a> + 1d0))</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">e_ic</a> = <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">pres_ic</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">rho_ic</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>**2d0) </div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> </div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i)</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a68651027acd974568fd5f94ed39c8e82">s_compute_intercell_solution</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aeeea1cc689aa550f3c1f182fe33a4939">s_compute_roe_average_state</a>(j,k,l) <span class="comment">! ---------------</span></div><div class="line"><a name="l02315"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aeeea1cc689aa550f3c1f182fe33a4939"> 2315</a></span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            </div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            <span class="comment">! Left and Right Riemann Problem States ============================</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            </div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf( j ,k,l)</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j+1,k,l)</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            </div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf( j ,k,l)</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j+1,k,l)</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            </div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(  <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>, &amp;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>, &amp;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>,  j ,k,l  )</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(  <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>, &amp;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a>, &amp;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>, j+1,k,l  )</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            </div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> = <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>**2d0)</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> = <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>**2d0)</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            </div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a> = (<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a> = (<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            </div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf( j ,k,l)</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j+1,k,l)</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf( j ,k,l)</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j+1,k,l)</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>,&amp;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">lo_pi_inf_l</a>, <a class="code" href="namespacem__riemann__solvers.html#abbde404883793a9aae3708896b4a2781">lo_re_l</a>,&amp;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a8388f446036552682910bbe06da81f70">lo_we_l</a>,  j , k, l)</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>,&amp;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">lo_pi_inf_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a6d89cb45833bdcb48f3f1b01badaedcf">lo_re_r</a>,&amp;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">lo_we_r</a>, j+1, k, l)</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a> = <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">lo_pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>**2d0)</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">lo_pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>**2d0)</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                </div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a75cca68e31742083e0ebbef418300c78">lo_h_l</a> = (<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a985a98321338d51bc8a43695b490b102">lo_h_r</a> = (<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a></div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;            </div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5">s_compute_mixture_sound_speeds</a>(j,k,l)</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;            </div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            </div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            <span class="comment">! Roe Average Riemann Problem State ================================</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a> = sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>)</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;            </div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a> = (sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>)*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a> + sqrt(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>)*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>) / &amp;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                      (sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>) + sqrt(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>))</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            </div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> = (sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>)*<a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a> + sqrt(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>)*<a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a>) / &amp;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                    (sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>) + sqrt(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>))</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            </div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                        5d-1*(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) + <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)))</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            </div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a> = (sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>)*<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + sqrt(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>)*<a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>) / &amp;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;                        (sqrt(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>) + sqrt(<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>))</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;            </div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>**2d0)) &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> = sqrt((<a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a>)</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> = sqrt((<a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a>)</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            </div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i) &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                  <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(i)%sf(j,k,l) = 2d0/(1d0/<a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>(i) + 1d0/<a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a>(i))</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            </div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) = &amp;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                            5d-1*( <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) &amp;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                                 + <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) )</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            </div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) = &amp;</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                         5d-1*( <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( j ,k,l) &amp;</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                              + <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j+1,k,l) )</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            </div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            </div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aeeea1cc689aa550f3c1f182fe33a4939">s_compute_roe_average_state</a> <span class="comment">! ---------------------------</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;        </div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;        </div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a14b6f4fa2f3b1d567a3f3347105ce61e">s_compute_arithmetic_average_state</a>(j,k,l) <span class="comment">! --------</span></div><div class="line"><a name="l02443"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a14b6f4fa2f3b1d567a3f3347105ce61e"> 2443</a></span>&#160;           </div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            </div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma_gas</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            <span class="comment">!ensemble-averaged bubble variables</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: PbwR3Lbar, Pbwr3Rbar</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: R3Lbar, R3Rbar</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: R3V2Lbar, R3V2Rbar</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                gamma_gas = 1.d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>+1)%gamma + 1.d0</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                gamma_gas = 1.d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>  )%gamma + 1.d0</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            </div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <span class="comment">! Left and Right Riemann Problem States ============================</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            </div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf( j ,k,l)</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j+1,k,l)</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;         </div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(  <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>, &amp;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>, &amp;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>,  j ,k,l  )</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(  <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>, &amp;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a>, &amp;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                                                  <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>, j+1,k,l  )</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf( j ,k,l)</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j+1,k,l)</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> = <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>**2d0)</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> = <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>**2d0)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            </div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a> = (<a class="code" href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a> = (<a class="code" href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            <span class="comment">! Compute left/right states for bubble number density</span></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf( j ,k,l)</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j+1,k,l)</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l)</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j+1,k,l)</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                </div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i))%sf(j,k,l)</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i))%sf(j+1,k,l)</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a2b69a3c582d14aba043c3cb6376335a5">p0_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(i))%sf(j,k,l)</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#aa7deddacb25e873c573761963f680efc">p0_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(i))%sf(j+1,k,l)</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                </div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                <span class="comment">!nbub_L = (3.d0/(4.d0*pi)) * alpha_L(1)/(R0_L**3.d0)</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                <span class="comment">!nbub_R = (3.d0/(4.d0*pi)) * alpha_R(1)/(R0_R**3.d0)</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">s_comp_n_from_prim</a>(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>),<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>,<a class="code" href="namespacem__riemann__solvers.html#afbf6423349d95b7b3472eb84b9ba7f56">nbub_l</a>)</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">s_comp_n_from_prim</a>(<a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>),<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>,<a class="code" href="namespacem__riemann__solvers.html#a4b6ffaeeaa4365c642ef3a5295635b07">nbub_r</a>)</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                </div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                <span class="comment">!pbw = p_g0*(R0/R)^(3\gamma_gas)</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                    <span class="comment">!pbw_L(i) = (R0(i)/R0_L(i))**(3d0*gamma_gas)</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                    <span class="comment">!pbw_R(i) = (R0(i)/R0_R(i))**(3d0*gamma_gas)</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">pbw_l</a>(i) = (<a class="code" href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">ca</a>+2.d0/<a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>/<a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i))*((<a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i)/<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(i))**(3.d0*gamma_gas)) - <a class="code" href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">ca</a> + 1.d0 &amp;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                            - 4.d0*<a class="code" href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">re_inv</a>*<a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>(i)/<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(i) - 2.d0/(<a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>*<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(i))</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">pbw_r</a>(i) = (<a class="code" href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">ca</a>+2.d0/<a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>/<a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i))*((<a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i)/<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(i))**(3.d0*gamma_gas)) - <a class="code" href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">ca</a> + 1.d0 &amp;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                            - 4.d0*<a class="code" href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">re_inv</a>*<a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a>(i)/<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(i) - 2.d0/(<a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>*<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(i))</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">pbw_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#a2b69a3c582d14aba043c3cb6376335a5">p0_l</a>(i) - 4.d0*<a class="code" href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">re_inv</a>*<a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>(i)/<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(i) - 2.d0/(<a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>*<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(i))</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">pbw_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#aa7deddacb25e873c573761963f680efc">p0_r</a>(i) - 4.d0*<a class="code" href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">re_inv</a>*<a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a>(i)/<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(i) - 2.d0/(<a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>*<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(i))</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>(<a class="code" href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">pbw_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>**3.d0), pbwr3lbar)</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>(<a class="code" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">pbw_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>**3.d0), pbwr3rbar)</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                </div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>(<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>**3.d0, r3lbar)</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>(<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>**3.d0, r3rbar)</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                </div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>((<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>**3.d0)*(<a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>**2.d0), r3v2lbar)</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">s_quad</a>((<a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>**3.d0)*(<a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a>**2.d0), r3v2rbar)</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;                </div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                <span class="comment">!ptilde = \alf( pl - \bar{ pbw R^3)/\bar{R^3} - rho \bar{R^3 \Rdot^2}/\bar{R^3} ) </span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">ptilde_l</a> = <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)*(<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - pbwr3lbar/r3lbar - &amp; </div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*r3v2lbar/r3lbar )</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">ptilde_r</a> = <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)*(<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - pbwr3rbar/r3rbar - &amp; </div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*r3v2rbar/r3rbar )</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                <a class="code" href="namespacem__global__parameters.html#ac6ff480000eaa7af51481d0f17b78423">ptil</a>(j,k,l) = 0.5d0*(<a class="code" href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">ptilde_l</a>+<a class="code" href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">ptilde_r</a>)</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf( j ,k,l)</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(j+1,k,l)</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    </div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf( j ,k,l)</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(i) = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j+1,k,l)</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    </div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf( j ,k,l)</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j+1,k,l)</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                </div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>,&amp;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">lo_pi_inf_l</a>, <a class="code" href="namespacem__riemann__solvers.html#abbde404883793a9aae3708896b4a2781">lo_re_l</a>,&amp;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a8388f446036552682910bbe06da81f70">lo_we_l</a>,  j , k, l)</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>,&amp;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">lo_pi_inf_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a6d89cb45833bdcb48f3f1b01badaedcf">lo_re_r</a>,&amp;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">lo_we_r</a>, j+1, k, l)</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            </div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a> = <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">lo_pi_inf_l</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>**2d0)</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">lo_pi_inf_r</a> + 5d-1*<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*sum(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>**2d0)</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;            </div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a75cca68e31742083e0ebbef418300c78">lo_h_l</a> = (<a class="code" href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">lo_e_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a>)/<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a985a98321338d51bc8a43695b490b102">lo_h_r</a> = (<a class="code" href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">lo_e_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a>)/<a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5">s_compute_mixture_sound_speeds</a>(j,k,l)</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            </div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            </div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;            <span class="comment">! Arithmetic Average Riemann Problem State =========================</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a> = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>)</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            </div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a> = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>)</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            </div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">h_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">h_r</a>)</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            </div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                        5d-1*(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) + <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)))</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;            </div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a> = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>)</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            </div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>**2d0)) &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> = sqrt((<a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a>)</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> = sqrt((<a class="code" href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">h_avg</a> - 5d-1*sum(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>**2d0))/<a class="code" href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">gamma_avg</a>)</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            </div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i) &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                  <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(i)%sf(j,k,l) = 2d0/(1d0/<a class="code" href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">re_l</a>(i) + 1d0/<a class="code" href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">re_r</a>(i))</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            </div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) = &amp;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                            5d-1*( <a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) &amp;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                 + <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) )</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            </div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) = &amp;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                         5d-1*( <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( j ,k,l) &amp;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                              + <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j+1,k,l) )</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;           </div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;            </div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a14b6f4fa2f3b1d567a3f3347105ce61e">s_compute_arithmetic_average_state</a> <span class="comment">! --------------------</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        </div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        </div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a1adcb619a7800a87bf5785ca59c63233">s_compute_direct_wave_speeds</a>(j,k,l) <span class="comment">! -----------------------</span></div><div class="line"><a name="l02640"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a1adcb619a7800a87bf5785ca59c63233"> 2640</a></span>&#160;           </div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;            </div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: denom, dpres_We</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            </div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            </div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            </div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            dpres_we = 0d0</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            </div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#afe755241e6fe1e3a132aec6feab74ae4">we_wave_speeds</a> .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                  dpres_we = dpres_we &amp;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                           - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                                                          <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                                                          ( <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))   &amp;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                                                          - <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) )</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                  </div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            </div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> = min(<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>) </div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> = max(<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>, <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>) </div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            </div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> = ( <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - dpres_we + <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))  * &amp;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                                                (<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))  * &amp;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                                                (<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) ) &amp;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                / ( <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) )</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            denom = <a class="code" href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - <a class="code" href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) </div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a> = min(<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a>)</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a> = max(<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a>)</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    </div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a> = (<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> - <a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> - dpres_we + <a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) * &amp;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                                    (<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*<a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) * &amp;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                                    (<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))) &amp; </div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                        / (<a class="code" href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">lo_rho_l</a>*(<a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a> - <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) - &amp;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                           <a class="code" href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">lo_rho_r</a>*(<a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a> - <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))))</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a1adcb619a7800a87bf5785ca59c63233">s_compute_direct_wave_speeds</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        </div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        </div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a107a13616d23f81b60bab83209067b01">s_compute_pressure_velocity_wave_speeds</a>(j,k,l) <span class="comment">! ------------</span></div><div class="line"><a name="l02699"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a107a13616d23f81b60bab83209067b01"> 2699</a></span>&#160;            </div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            </div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            <span class="comment">! Left and right pressures in the star region</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pres_SL, pres_SR</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: lo_pres_SL, lo_pres_SR</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            </div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: dpres_We</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            </div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;            <span class="comment">! Left and right shock Mach numbers</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: Ms_L, Ms_R</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: lo_Ms_L, lo_Ms_R</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;            </div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            </div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            </div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;            dpres_we = 0d0</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            </div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#afe755241e6fe1e3a132aec6feab74ae4">we_wave_speeds</a> .AND. <a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                  dpres_we = dpres_we &amp;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                           - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(j,k,l) * &amp;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                                                          <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                                                          ( <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))   &amp;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                                                          - <a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) )</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                  </div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            </div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            pres_sl = 5d-1*( <a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - dpres_we + <a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a>*<a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> * &amp;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                                                    ( <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - &amp;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                                                      <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) ) )</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            pres_sr = pres_sl + dpres_we</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;            </div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            ms_l = max(1d0, sqrt(1d0 + ((5d-1 + <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>)/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>))    * &amp;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                                       (pres_sl/<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - 1d0)*<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a>         / &amp;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                                       ((<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">pi_inf_l</a>/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">gamma_l</a>))) ) )</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;            ms_r = max(1d0, sqrt(1d0 + ((5d-1 + <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>)/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>))    * &amp;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                                       (pres_sr/<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> - 1d0)*<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a>         / &amp;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                                       ((<a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">pi_inf_r</a>/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">gamma_r</a>))) ) )</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            </div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">s_l</a> = <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">c_l</a>*ms_l</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">s_r</a> = <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">c_r</a>*ms_r</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            </div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">s_s</a> = 5d-1*( (<a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) + &amp;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                         (<a class="code" href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">pres_l</a> - <a class="code" href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">pres_r</a> + dpres_we)            / &amp;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                         (<a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a>*<a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a>)                           )</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            </div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">tvd_wave_speeds</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                lo_pres_sl = 5d-1*(<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> - dpres_we + <a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a>*<a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a> * &amp;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                                        ( <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - &amp;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                                        <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))))</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                lo_pres_sr = lo_pres_sl + dpres_we</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    </div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                lo_ms_l = max(1d0, sqrt(1d0 + ((5d-1 + <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>)/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>)) * &amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                                (lo_pres_sl/<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> - 1d0)*<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> / &amp;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                                ((<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> + <a class="code" href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">lo_pi_inf_l</a>/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">lo_gamma_l</a>)))))</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                lo_ms_r = max(1d0, sqrt(1d0 + ((5d-1 + <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>)/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>)) * &amp;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                                (lo_pres_sr/<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> - 1d0)*<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> / &amp;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                ((<a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> + <a class="code" href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">lo_pi_inf_r</a>/(1d0 + <a class="code" href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">lo_gamma_r</a>)))))</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    </div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">lo_s_l</a> = <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">lo_c_l</a>*lo_ms_l</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">lo_s_r</a> = <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">lo_c_r</a>*lo_ms_r</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    </div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">lo_s_s</a> = 5d-1*( (<a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) + &amp;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                        (<a class="code" href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">lo_pres_l</a> - <a class="code" href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">lo_pres_r</a> + dpres_we) / &amp;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                        (<a class="code" href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">rho_avg</a>*<a class="code" href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">c_avg</a>))</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            </div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a107a13616d23f81b60bab83209067b01">s_compute_pressure_velocity_wave_speeds</a> <span class="comment">! ---------------</span></div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        </div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        </div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        </div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        </div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a6301a5631fda64dd97c11777807a22c9">s_compute_flux_limiter</a>(j,k,l,flux_lim_func,norm_dir) <span class="comment">! ------</span></div><div class="line"><a name="l02782"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a6301a5631fda64dd97c11777807a22c9"> 2782</a></span>&#160;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l,norm_dir</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: flux_lim_func</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: top, bottom, slope</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+norm_dir)%sf(j,k,l) &gt;= 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                  top = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( j ,k,l) - &amp;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j-1,k,l)</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                   bottom = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( j ,k,l)</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                  top = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+2,k,l) - &amp;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+1,k,l)</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                   bottom = <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j+1,k,l) - &amp;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( j ,k,l)</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        </div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            <span class="comment">! Limit the flux limiter to only be applied where the change in</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            <span class="comment">! volume fraction is greater than machine precision so that </span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="comment">! insignificant fluctuations do not trip the limiter</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment">!           IF (ABS(top) &lt; sgm_eps) top = 0d0</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment">!           IF (ABS(bottom) &lt; sgm_eps) bottom = 0d0</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            <span class="keywordflow">IF</span> (abs(top) &lt; 1d-8) top = 0d0</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            <span class="keywordflow">IF</span> (abs(bottom) &lt; 1d-8) bottom = 0d0</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <span class="comment">! If top = bottom, then cell boundary is in a smooth region of</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            <span class="comment">! the flow and the high order flux should be used. Also ensures</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            <span class="comment">! that areas of no change in volume fraction (0/0) use the high</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="comment">! order flux</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;            <span class="keywordflow">IF</span> (top == bottom) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                slope = 1d0</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                slope = (top*bottom)/max(bottom**2d0,<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            <span class="comment">! Flux limiter function</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 1) <span class="keywordflow">THEN</span> <span class="comment">! MINMOD (MM)</span></div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                flux_lim_func = max(0d0,min(1d0,slope))</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 2) <span class="keywordflow">THEN</span> <span class="comment">! MUSCL (MC)</span></div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                flux_lim_func = max(0d0,min(2d0*slope,5d-1*(1d0+slope),2d0))</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 3) <span class="keywordflow">THEN</span> <span class="comment">! OSPRE (OP)</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                flux_lim_func = (15d-1*(slope**2d0+slope))/(slope**2d0+slope+1d0)</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 4) <span class="keywordflow">THEN</span> <span class="comment">! SUPERBEE (SB)</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                flux_lim_func = max(0d0,min(1d0,2d0*slope),min(slope,2d0))</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 5) <span class="keywordflow">THEN</span> <span class="comment">! SWEBY (SW) (beta = 1.5)</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                flux_lim_func = max(0d0,min(15d-1*slope,1d0),min(slope,15d-1))</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 6) <span class="keywordflow">THEN</span> <span class="comment">! VAN ALBADA (VA)</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                flux_lim_func = (slope**2d0+slope)/(slope**2d0+1d0)</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a> == 7) <span class="keywordflow">THEN</span> <span class="comment">! VAN LEER (VL)</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                flux_lim_func = (abs(slope) + slope)/(1d0 + abs(slope))</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a6301a5631fda64dd97c11777807a22c9">s_compute_flux_limiter</a> <span class="comment">! --------------------------------</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aab7e6bf69b7d0b8b9d911f418b872130">s_initialize_riemann_solvers_module</a>() <span class="comment">! ---------------------</span></div><div class="line"><a name="l02843"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aab7e6bf69b7d0b8b9d911f418b872130"> 2843</a></span>&#160;            </div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            </div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            <span class="comment">! Allocating the variables that will be utilized to formulate the</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;            <span class="comment">! left, right, and average states of the Riemann problem, as well</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;            <span class="comment">! the Riemann problem solution</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>), <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;            </div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>), <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;            </div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;            </div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;            </div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end), <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end), <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;           </div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;            </div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;            </div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;              </div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                </div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                <span class="keyword">ALLOCATE</span>(   <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                </div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;              </div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;            </div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;            </div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1:2))</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;            </div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end), <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end), <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a8388f446036552682910bbe06da81f70">lo_we_l</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>, 1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">lo_we_r</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>, 1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>(1:<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end), <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>(1:<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>))</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            </div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;            <span class="comment">! Associating procedural pointer to the subroutine that will be</span></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;            <span class="comment">! utilized to calculate the solution of a given Riemann problem</span></div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">s_hll_riemann_solver</a></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">s_hllc_riemann_solver</a></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">s_exact_riemann_solver</a></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;           </div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                <span class="keyword">allocate</span>( <a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>), <a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>), <a class="code" href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">pbw_l</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>) )</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                <span class="keyword">allocate</span>( <a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>), <a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>), <a class="code" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">pbw_r</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>) )</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                    <span class="keyword">allocate</span>( <a class="code" href="namespacem__riemann__solvers.html#a2b69a3c582d14aba043c3cb6376335a5">p0_l</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>), <a class="code" href="namespacem__riemann__solvers.html#aa7deddacb25e873c573761963f680efc">p0_r</a>(<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>) )</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="keywordflow">                END IF</span> </div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;            </div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;            <span class="comment">! Associating the procedural pointers to the procedures that will be</span></div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;            <span class="comment">! utilized to compute the average state and estimate the wave speeds</span></div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> /= 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;              </div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a1a3314b39e21e17d7e72a9837db2ab42">avg_state</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">s_compute_average_state</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#aeeea1cc689aa550f3c1f182fe33a4939">s_compute_roe_average_state</a></div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">s_compute_average_state</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a14b6f4fa2f3b1d567a3f3347105ce61e">s_compute_arithmetic_average_state</a></div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                </div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0f798e4b3d19b7d49d747cc89cbe0b69">wave_speeds</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">s_compute_wave_speeds</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a1adcb619a7800a87bf5785ca59c63233">s_compute_direct_wave_speeds</a></div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">s_compute_wave_speeds</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a107a13616d23f81b60bab83209067b01">s_compute_pressure_velocity_wave_speeds</a></div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;              </div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;            <span class="comment">! Associating procedural pointer to the subroutine that will be</span></div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;            <span class="comment">! utilized to compute the viscous source flux</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a50ff087624d23846c62cd711dd003757">s_compute_cylindrical_viscous_source_flux</a></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a> =&gt; <a class="code" href="namespacem__riemann__solvers.html#a58c0a2ab06eb5094f60c5e68dbde7300">s_compute_cartesian_viscous_source_flux</a></div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;            </div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            </div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            <span class="comment">! Associating the procedural pointer to the appropriate subroutine</span></div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;            <span class="comment">! that will be utilized in the conversion to the mixture variables</span></div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;            </div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a></div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span>           <span class="comment">! Volume fraction for bubbles</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a> </div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a></div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            </div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;            </div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aab7e6bf69b7d0b8b9d911f418b872130">s_initialize_riemann_solvers_module</a> <span class="comment">! -------------------</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        </div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        </div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        </div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b">s_populate_riemann_states_variables_buffers</a>( &amp; ! ------------</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                                    qL_prim_vf, dqL_prim_dx_vf, &amp;</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                                                dqL_prim_dy_vf, &amp;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                                                dqL_prim_dz_vf, &amp;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                                                  gm_alphaL_vf, &amp;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                                                     kappaL_vf, &amp;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                                    qR_prim_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                                                dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                                                dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                                                  gm_alphaR_vf, &amp;</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                                                     kappaR_vf, &amp;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                                            norm_dir, ix,iy,iz  )</div><div class="line"><a name="l03002"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b"> 3002</a></span>&#160;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: qL_prim_vf, qR_prim_vf</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;            </div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: dqL_prim_dx_vf, dqR_prim_dx_vf, &amp;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                             dqL_prim_dy_vf, dqR_prim_dy_vf, &amp;</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;                             dqL_prim_dz_vf, dqR_prim_dz_vf, &amp;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;                               gm_alphaL_vf,   gm_alphaR_vf, &amp;</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                                  kappaL_vf,      kappaR_vf</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            </div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;            </div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            </div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;            </div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            </div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="comment">! Population of Buffers in x-direction =============================</span></div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;              </div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -4) <span class="keywordflow">THEN</span>    <span class="comment">! Riemann state extrap. BC at beginning</span></div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                </div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                        ql_prim_vf(i)%sf(-1,iy%beg:iy%end,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                        qr_prim_vf(i)%sf( 0,iy%beg:iy%end,iz%beg:iz%end)</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                </div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                  </div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                            dql_prim_dx_vf(i)%sf(      -1      , &amp;</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                                                  iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                            dqr_prim_dx_vf(i)%sf(       0      , &amp;</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                                                  iz%beg:iz%end  )</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                  </div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;                    </div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                                dql_prim_dy_vf(i)%sf(      -1      , &amp;</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                                                      iy%beg:iy%end, &amp;</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                                                      iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;                                dqr_prim_dy_vf(i)%sf(       0      , &amp;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;                                                      iy%beg:iy%end, &amp;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                                                      iz%beg:iz%end  )</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                    </div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                                    dql_prim_dz_vf(i)%sf(      -1      , &amp;</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;                                                          iy%beg:iy%end, &amp;</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;                                                          iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                                    dqr_prim_dz_vf(i)%sf(       0      , &amp;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                                                          iy%beg:iy%end, &amp;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;                                                          iz%beg:iz%end  )</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                    </div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                  </div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                </div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                        dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(      -1      , &amp;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                                                             iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                        dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(       0      , &amp;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                                                             iz%beg:iz%end  )</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                          gm_alphal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(      -1      , &amp;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                                                             iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                          gm_alphar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(       0      , &amp;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                                                             iz%beg:iz%end  )</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                             kappal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(      -1      , &amp;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                                                             iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                             kappar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(       0      , &amp;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                                                             iz%beg:iz%end  )</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                            dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(      -1      , &amp;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                            dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(       0      , &amp;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                </div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                            dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(      -1      , &amp;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                            dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(       0      , &amp;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                </div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;              </div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -4) <span class="keywordflow">THEN</span>    <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                </div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                        qr_prim_vf(i)%sf(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1,iy%beg:iy%end,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                        ql_prim_vf(i)%sf( <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> ,iy%beg:iy%end,iz%beg:iz%end)</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                </div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                  </div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                            dqr_prim_dx_vf(i)%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                                                  iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                            dql_prim_dx_vf(i)%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                                                  iz%beg:iz%end  )</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;                  </div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                    </div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                                dqr_prim_dy_vf(i)%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                                                      iy%beg:iy%end, &amp;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                                                      iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                                dql_prim_dy_vf(i)%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                                                      iy%beg:iy%end, &amp;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                                                      iz%beg:iz%end  )</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                    </div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;                                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                                    dqr_prim_dz_vf(i)%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;                                                          iy%beg:iy%end, &amp;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                                                          iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                                    dql_prim_dz_vf(i)%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                                                          iy%beg:iy%end, &amp;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                                                          iz%beg:iz%end  )</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                    </div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                  </div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                            dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                            dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;                              gm_alphar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                              gm_alphal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                                 kappar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                                 kappal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                                                                 iy%beg:iy%end, &amp;</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;                                dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;                                                                     iy%beg:iy%end, &amp;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                                                                     iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                                dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                                                                     iy%beg:iy%end, &amp;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                                                                     iz%beg:iz%end  )</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                  </div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                                dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(      <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1     , &amp;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;                                                                     iy%beg:iy%end, &amp;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                                                                     iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                                dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(       <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>      , &amp;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;                                                                     iy%beg:iy%end, &amp;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                                                                     iz%beg:iz%end  )</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;                  </div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;                </div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;            <span class="comment">! END: Population of Buffers in x-direction ========================</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;            </div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;            </div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;            <span class="comment">! Population of Buffers in y-direction =============================</span></div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;              </div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -4) <span class="keywordflow">THEN</span>    <span class="comment">! Riemann state extrap. BC at beginning</span></div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                </div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                        ql_prim_vf(i)%sf(ix%beg:ix%end,-1,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                        qr_prim_vf(i)%sf(ix%beg:ix%end, 0,iz%beg:iz%end)</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                </div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                  </div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                            dql_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                                                       -1      , &amp;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                                                  iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                            dqr_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                                                        0      , &amp;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                                                  iz%beg:iz%end  )</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                                dql_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                                                           -1      , &amp;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                                                      iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                                dqr_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                                                            0      , &amp;</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                                                      iz%beg:iz%end  )</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                  </div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                                dql_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                                                           -1      , &amp;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                                                      iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                                dqr_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                                                            0      , &amp;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                                                      iz%beg:iz%end  )</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                  </div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                </div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                        dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                                                                  -1      , &amp;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                                                             iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                        dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                                                                   0      , &amp;</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                                                             iz%beg:iz%end  )</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                          gm_alphal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;                                                                  -1      , &amp;</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                                                             iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;                          gm_alphar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;                                                                   0      , &amp;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                                                             iz%beg:iz%end  )</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;                             kappal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                                                                  -1      , &amp;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                                                             iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                             kappar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                                                                   0      , &amp;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                                                             iz%beg:iz%end  )</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                            dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                                                                      -1      , &amp;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                            dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                                                                       0      , &amp;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                    </div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                            dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;                                                                      -1      , &amp;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;                            dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;                                                                       0      , &amp;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                </div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;              </div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -4) <span class="keywordflow">THEN</span>    <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                </div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                        qr_prim_vf(i)%sf(ix%beg:ix%end,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                        ql_prim_vf(i)%sf(ix%beg:ix%end, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> ,iz%beg:iz%end)</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                </div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                  </div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                            dqr_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;                                                  iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                            dql_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;                                                  iz%beg:iz%end  )</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;                                dqr_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                                                           <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                                                      iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                                dql_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                                                            <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;                                                      iz%beg:iz%end  )</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                  </div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                                dqr_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;                                                           <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                                                      iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;                                dql_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                                                            <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                                                      iz%beg:iz%end  )</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;                  </div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                            dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;                            dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                                                                       <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                              gm_alphar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                              gm_alphal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                                                                       <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                                 kappar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                                                                 iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                                 kappal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                                                                       <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                                                                 iz%beg:iz%end  )</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                                dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                                                                          <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                                                                     iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                                dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                                                                           <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                                                                     iz%beg:iz%end  )</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;                  </div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                                dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                                                                    <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1     , &amp;</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                                                               iz%beg:iz%end  ) = &amp;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                                dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>      , &amp;</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                                                               iz%beg:iz%end  )</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                  </div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                </div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;            <span class="comment">! END: Population of Buffers in y-direction ========================</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;            </div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;            </div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;            <span class="comment">! Population of Buffers in z-direction =============================</span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;              </div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -4) <span class="keywordflow">THEN</span>    <span class="comment">! Riemann state extrap. BC at beginning</span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                </div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;                        ql_prim_vf(i)%sf(ix%beg:ix%end,iy%beg:iy%end,-1) = &amp;</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                        qr_prim_vf(i)%sf(ix%beg:ix%end,iy%beg:iy%end, 0)</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                </div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                            dql_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                                                       -1        ) = &amp;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                            dqr_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                                                        0        )</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                            dql_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                                                       -1        ) = &amp;</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                            dqr_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                                                        0        )</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                            dql_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                                                       -1        ) = &amp;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                            dqr_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                                                        0        )</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                </div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                        dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                                                                  -1        ) = &amp;</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                        dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                                                                   0        )</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                        dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                                                                  -1        ) = &amp;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                        dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                                                                   0        )</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                        dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                                                                  -1        ) = &amp;</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                        dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                                                                   0        )</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                          gm_alphal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                                                                  -1        ) = &amp;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                          gm_alphar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;                                                                   0        )</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                             kappal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                                                                  -1        ) = &amp;</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                             kappar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                                                                   0        )</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                </div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;              </div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -4) <span class="keywordflow">THEN</span>    <span class="comment">! Riemann state extrap. BC at end</span></div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                </div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                        qr_prim_vf(i)%sf(ix%beg:ix%end,iy%beg:iy%end,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) = &amp;</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                        ql_prim_vf(i)%sf(ix%beg:ix%end,iy%beg:iy%end, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> )</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                </div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                    <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                            dqr_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                            dql_prim_dx_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                            dqr_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;                            dql_prim_dy_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                            dqr_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                            dql_prim_dz_vf(i)%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                                                  iy%beg:iy%end, &amp;</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                </div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                        dqr_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;                        dql_prim_dx_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                                                                   <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                        dqr_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;                        dql_prim_dy_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                                                                   <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;                        dqr_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                        dql_prim_dz_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                                                                   <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                          gm_alphar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;                          gm_alphal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;                                                                   <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;                             kappar_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1       ) = &amp;</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                             kappal_vf(   <a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)   )%sf( ix%beg:ix%end, &amp;</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                                                             iy%beg:iy%end, &amp;</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;                                                                   <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>        )</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                </div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;              </div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            <span class="comment">! END: Population of Buffers in z-direction ========================</span></div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            </div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            </div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b">s_populate_riemann_states_variables_buffers</a> <span class="comment">! -----------</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        </div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160; </div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c">s_initialize_riemann_solver</a>( qL_prim_vf, kappaL_vf, &amp; ! -----</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;                                                qR_prim_vf, kappaR_vf, &amp;</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                                                            q_prim_vf, &amp;</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;                                                 flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                                                         flux_gsrc_vf, &amp;</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                                                   norm_dir, ix,iy,iz  )</div><div class="line"><a name="l03531"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c"> 3531</a></span>&#160;</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: qL_prim_vf, qR_prim_vf</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;            </div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),        &amp;</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>, &amp;</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: kappaL_vf, kappaR_vf</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            </div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf, flux_gsrc_vf</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;            </div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;            </div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;            </div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;           </div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;            <span class="keywordtype">INTEGER</span> :: xbeg,xend,ybeg,yend,zbeg,zend</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;            <span class="keywordtype">INTEGER</span> :: s1beg,s1end,s2beg,s2end,s3beg,s3end</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            </div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            <span class="comment">! Configuring the coordinate direction indexes and flags</span></div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a> = ix; <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a> = iy; <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a> = iz</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;               <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/1,2,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/1d0,0d0,0d0/)</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a> = iy; <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a> = ix; <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a> = iz</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;               <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/2,1,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/0d0,1d0,0d0/)</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;               <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a> = iz; <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a> = iy; <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a> = ix</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;               <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/3,1,2/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/0d0,0d0,1d0/)</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;            </div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;            <span class="comment">! Setting up special bounds for cell-average values</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;            xbeg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; ybeg = 0; zbeg = 0</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) ybeg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) zbeg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;            xend = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - xbeg; yend = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - ybeg; zend = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - zbeg</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;            <span class="comment">! Configuring the coordinate direction indexes</span></div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;            <span class="keywordflow">IF</span> (norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                s1beg = xbeg; s1end = xend; s2beg = ybeg; s2end = yend; s3beg = zbeg; s3end = zend</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;            <span class="keywordflow">ELSEIF</span> (norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                s1beg = ybeg; s1end = yend; s2beg = xbeg; s2end = xend; s3beg = zbeg; s3end = zend</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                s1beg = zbeg; s1end = zend; s2beg = ybeg; s2end = yend; s3beg = xbeg; s3end = xend</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            </div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;            <span class="comment">! Allocating Left, Right and Average Riemann Problem States ========</span></div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end  , &amp;</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end  , &amp;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end   ))</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg+1 : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end+1, &amp;</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end  , &amp;</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end   ))</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(    s1beg : s1end, &amp;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                                                    s2beg : s2end, &amp;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                                                    s3beg : s3end ))</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            </div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;               <span class="keyword">ALLOCATE</span>(   <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end  , &amp;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                                                        <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end  , &amp;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;                                                        <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end   ))</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;               <span class="keyword">ALLOCATE</span>(   <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg+1 : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end+1, &amp;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                                                        <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end  , &amp;</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                                                        <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end   ))</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end  , &amp;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                                                        <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end  , &amp;</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                                                        <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg   : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end   ))</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;            </div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;            <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i) &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(i)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                                                 <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;            </div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                                       <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                                                          <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                                                          <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;            </div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;            </div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;            <span class="comment">! Allocating Intercell Fluxes and Velocity =========================</span></div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;            <span class="keywordflow">IF</span>(norm_dir /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;               </div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                                                    <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                                                    <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;              </div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                                                         <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                                                         <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;               </div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                                                       <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                                                       <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                <span class="comment">!ELSE</span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                <span class="comment">!    DO i = adv_idx%beg,sys_size</span></div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                <span class="comment">!        ALLOCATE(flux_src_rs_vf(i)%sf( is1%beg : is1%end, &amp;</span></div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                <span class="comment">!                                       is2%beg : is2%end, &amp;</span></div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                <span class="comment">!                                       is3%beg : is3%end ))</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;                <span class="comment">!    END DO</span></div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;                <span class="comment">!END IF</span></div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;               </div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf     =&gt; flux_vf(i)%sf</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf =&gt; flux_src_vf(i)%sf</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf =&gt; flux_gsrc_vf(i)%sf</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;               </div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            </div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                    flux_src_vf(i)%sf = 0d0</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;            </div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;                                                       <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                                                       <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf =&gt; <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;            </div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf( <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">is1</a>%end, &amp;</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                                                       <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">is2</a>%end, &amp;</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;                                                       <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%beg : <a class="code" href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">is3</a>%end ))</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;            <span class="comment">! END: Allocating Intercell Fluxes and Velocity ====================</span></div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;           </div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                        </div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;            <span class="comment">! Reshaping Inputted Data in x-direction ===========================</span></div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;               </div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf = ql_prim_vf(i)%sf( ix%beg   : ix%end  , &amp;</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                                                            iy%beg   : iy%end  , &amp;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                                                            iz%beg   : iz%end    )</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf = qr_prim_vf(i)%sf( ix%beg+1 : ix%end+1, &amp;</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                                                            iy%beg   : iy%end  , &amp;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                                                            iz%beg   : iz%end    )</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf = q_prim_vf(i)%sf(   xbeg : xend, &amp;</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                                                                ybeg : yend, &amp;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                                                                zbeg : zend  )</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf = kappal_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( &amp;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                                                       ix%beg   : ix%end  , &amp;</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;                                                       iy%beg   : iy%end  , &amp;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;                                                       iz%beg   : iz%end    )</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf = kappar_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( &amp;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                                                       ix%beg+1 : ix%end+1, &amp;</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;                                                       iy%beg   : iy%end  , &amp;</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;                                                       iz%beg   : iz%end    )</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;            </div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;            <span class="comment">! Reshaping Inputted Data in y-direction ===========================</span></div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;               </div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf( k, j,:) = &amp;</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                                  ql_prim_vf(i)%sf(j, k ,iz%beg:iz%end)</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(k+1,j,:) = &amp;</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                                  qr_prim_vf(i)%sf(j,k+1,iz%beg:iz%end)</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;                        <span class="keywordflow">DO</span> j = xbeg, xend</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;                            <span class="keywordflow">DO</span> k = ybeg, yend</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                                 <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(k,j,:) = &amp;</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;                                    q_prim_vf(i)%sf(j,k,zbeg:zend)</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;               </div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( k ,j,:) = &amp;</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;                              kappal_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j, k ,iz%beg:iz%end)</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(k+1,j,:) = &amp;</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;                              kappar_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,k+1,iz%beg:iz%end)</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;            </div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;            </div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;            <span class="comment">! Reshaping Inputted Data in z-direction ===========================</span></div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;               </div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;                        <span class="keywordflow">DO</span> k = iz%beg, iz%end</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf(k,:, j ) = &amp;</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;                                  ql_prim_vf(i)%sf(j,iy%beg:iy%end, k )</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf(k+1,:,j) = &amp;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                                  qr_prim_vf(i)%sf(j,iy%beg:iy%end,k+1)</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;                        <span class="keywordflow">DO</span> j = xbeg, xend</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;                            <span class="keywordflow">DO</span> k = zbeg, zend</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                                 <a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf(k,:,j) = &amp;</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                                    q_prim_vf(i)%sf(j,ybeg:yend,k)</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;               </div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                        <span class="keywordflow">DO</span> k = iz%beg, iz%end</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf( k ,:,j) = &amp;</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;                              kappal_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,iy%beg:iy%end ,k )</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(k+1,:,j) = &amp;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                              kappar_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,iy%beg:iy%end,k+1)</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;               </div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;            </div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;            </div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c">s_initialize_riemann_solver</a> <span class="comment">! ---------------------------</span></div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        </div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        </div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        </div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        </div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a50ff087624d23846c62cd711dd003757">s_compute_cylindrical_viscous_source_flux</a>(     velL_vf, &amp; ! -------------</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                                                              dvelL_dx_vf, &amp;</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                                                              dvelL_dy_vf, &amp;</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                                                              dvelL_dz_vf, &amp;</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                                                                  velR_vf, &amp;</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                                              dvelR_dx_vf, &amp;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                                                              dvelR_dy_vf, &amp;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                                                              dvelR_dz_vf, &amp;</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                                                              flux_src_vf, &amp;</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                                                                 norm_dir, &amp;</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                                                                 ix,iy,iz  )</div><div class="line"><a name="l03820"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a50ff087624d23846c62cd711dd003757"> 3820</a></span>&#160;</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;            <span class="keywordtype">DIMENSION(num_dims)</span>, &amp;</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;            <span class="keywordtype">INTENT(IN)</span> ::         velL_vf, velR_vf, &amp;</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                          dvelL_dx_vf, dvelR_dx_vf, &amp;</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                          dvelL_dy_vf, dvelR_dy_vf, &amp;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                          dvelL_dz_vf, dvelR_dz_vf</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;            </div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_src_vf</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;            </div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;            </div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;            </div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;            <span class="comment">! Arithmetic mean of the left and right, WENO-reconstructed, cell-</span></div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;            <span class="comment">! boundary values of cell-average first-order spatial derivatives</span></div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;            <span class="comment">! of velocity</span></div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: avg_vel</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: dvel_avg_dx</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: dvel_avg_dy</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: dvel_avg_dz</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;            </div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;            <span class="comment">! Viscous stress tensor</span></div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims,num_dims)</span> :: tau_Re</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;            </div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            </div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;            </div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;            <span class="comment">! Viscous Stresses in z-direction ==================================</span></div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;               </div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;                           </div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j+1,k,l) )</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;                           </div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                                tau_re(1,1) = (4d0/3d0)*dvel_avg_dx(1) / &amp;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                           </div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                                </div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;                           </div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;               </div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                           </div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf( j, k,l) &amp;</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j+1,k,l) )</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                           </div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;                                tau_re(1,1) = dvel_avg_dx(1) / &amp;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(j,k,l)</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;                           </div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;                                </div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;                           </div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;               </div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;               </div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                           </div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;                                avg_vel(2) = 5d-1*( vell_vf(2)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                                                  + velr_vf(2)%sf(j+1,k,l) )</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                           </div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                                    dvel_avg_dy(i) = &amp;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                                      5d-1*( dvell_dy_vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                                           + dvelr_dy_vf(i)%sf(j+1,k,l) )</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;                                dvel_avg_dx(2) = 5d-1*( dvell_dx_vf(2)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                                                      + dvelr_dx_vf(2)%sf(j+1,k,l) )</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;                                tau_re(1,1) = -(2d0/3d0)*(dvel_avg_dy(2) + &amp;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                                                avg_vel(2) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)) / &amp;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                                                <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                                </div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;                                tau_re(1,2) = (dvel_avg_dy(1) + dvel_avg_dx(2)) / &amp;</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;                                </div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;                              </div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                                    </div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                              </div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                           </div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;               </div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;                           </div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                                avg_vel(2) = 5d-1*( vell_vf(2)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                                                  + velr_vf(2)%sf(j+1,k,l) )</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                           </div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                                dvel_avg_dy(2) = 5d-1*( dvell_dy_vf(2)%sf( j, k,l) &amp;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                                                      + dvelr_dy_vf(2)%sf(j+1,k,l) )</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                                </div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                                tau_re(1,1) = ( dvel_avg_dy(2) + &amp;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                                               avg_vel(2) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)) / &amp;</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(j,k,l)</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                                </div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                                </div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;                           </div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;               </div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;               </div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                           </div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3,2</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                                    dvel_avg_dz(i) = &amp;</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;                                      5d-1*( dvell_dz_vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                                           + dvelr_dz_vf(i)%sf(j+1,k,l) )</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                           </div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                                dvel_avg_dx(3) = 5d-1*( dvell_dx_vf(3)%sf( j ,k,l) &amp;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                                                      + dvelr_dx_vf(3)%sf(j+1,k,l) )</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                                </div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                                tau_re(1,1) = -(2d0/3d0)*dvel_avg_dz(3) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) / &amp;</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;                                </div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;                                tau_re(1,3) = (dvel_avg_dz(1)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) + dvel_avg_dx(3)) / &amp;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;                                </div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3,2</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;                                   </div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                                    </div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                                   </div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                           </div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;               </div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;                           </div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;                                dvel_avg_dz(3) = 5d-1*( dvell_dz_vf(3)%sf( j, k,l) &amp;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;                                                      + dvelr_dz_vf(3)%sf(j+1,k,l) )</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                                </div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;                                tau_re(1,1) = dvel_avg_dz(3) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) / &amp;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(j,k,l)</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                                </div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                           </div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;            <span class="comment">! END: Viscous Stresses in z-direction =============================</span></div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;            </div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;            </div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;            <span class="comment">! Viscous Stresses in r-direction ==================================</span></div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;               </div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                           </div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;                                avg_vel(2) = 5d-1*( vell_vf(2)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                                                  + velr_vf(2)%sf(j,k+1,l) )</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                           </div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                              </div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;                                    dvel_avg_dx(i) = &amp;</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;                                            5d-1*( dvell_dx_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;                                                 + dvelr_dx_vf(i)%sf(j,k+1,l) )</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;                                    </div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;                                    dvel_avg_dy(i) = &amp;</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;                                            5d-1*( dvell_dy_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                                                 + dvelr_dy_vf(i)%sf(j,k+1,l) )</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;                              </div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;                           </div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;                                tau_re(2,1) = (dvel_avg_dy(1) + dvel_avg_dx(2)) / &amp;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l)</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                                tau_re(2,2) = ( 4d0*dvel_avg_dy(2)           &amp;</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                                              - 2d0*dvel_avg_dx(1)           &amp;</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                                              - 2d0*avg_vel(2) / <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k) ) / &amp;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                                              ( 3d0*<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l))</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;                           </div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                              </div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                                    </div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;                              </div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                           </div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;               </div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;                           </div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;                                avg_vel(2) = 5d-1*( vell_vf(2)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;                                                  + velr_vf(2)%sf(j,k+1,l) )</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;                           </div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j,k+1,l) )</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;                           </div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;                                dvel_avg_dy(2) = 5d-1*( dvell_dy_vf(2)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;                                                      + dvelr_dy_vf(2)%sf(j,k+1,l) )</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                                </div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;                                tau_re(2,2) = (dvel_avg_dx(1) + dvel_avg_dy(2) + &amp;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;                                               avg_vel(2) / <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k)) / &amp;</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(k,j,l)</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                                </div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(2)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;                           </div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;               </div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;               </div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                           </div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                                avg_vel(3) = 5d-1*( vell_vf(3)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                                                  + velr_vf(3)%sf(j,k+1,l) )</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                           </div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                                    dvel_avg_dz(i) = &amp;</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;                                      5d-1*( dvell_dz_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                                           + dvelr_dz_vf(i)%sf(j,k+1,l) )</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;                           </div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                                dvel_avg_dy(3) = 5d-1*( dvell_dy_vf(3)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                                                      + dvelr_dy_vf(3)%sf(j,k+1,l) )</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                                </div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;                                tau_re(2,2) = -(2d0/3d0)*dvel_avg_dz(3) / <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k) / &amp;</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l)</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;                                </div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;                                tau_re(2,3) = ((dvel_avg_dz(2) - avg_vel(3)) / &amp;</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                                              <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k) + dvel_avg_dy(3)) / &amp;</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l)</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                                </div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;                                   </div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                                    </div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;                                   </div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                           </div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;               </div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                           </div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                                dvel_avg_dz(3) = 5d-1*( dvell_dz_vf(3)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                                                      + dvelr_dz_vf(3)%sf(j,k+1,l) )</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                                </div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                                tau_re(2,2) = dvel_avg_dz(3) / <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k) / &amp;</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(k,j,l)</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                                </div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;                                </div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(2)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;                           </div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;            <span class="comment">! END: Viscous Stresses in r-direction =============================</span></div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;            </div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;            </div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;            <span class="comment">! Viscous Stresses in theta-direction ==================================</span></div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;               </div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;                           </div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                                    avg_vel(i) = 5d-1*( vell_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;                                                      + velr_vf(i)%sf(j,k,l+1) )</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                           </div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3,2</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                                    dvel_avg_dx(i) = &amp;</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                      5d-1*( dvell_dx_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                                           + dvelr_dx_vf(i)%sf(j,k,l+1) )                 </div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                           </div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                                    dvel_avg_dy(i) = &amp;</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                                      5d-1*( dvell_dy_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                                           + dvelr_dy_vf(i)%sf(j,k,l+1) )</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                           </div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                                    dvel_avg_dz(i) = &amp;</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                                      5d-1*( dvell_dz_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                                           + dvelr_dz_vf(i)%sf(j,k,l+1) )</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                                tau_re(3,1) = (dvel_avg_dz(1)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) + dvel_avg_dx(3)) / &amp;</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(l,k,j) / &amp;</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                                              <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                                </div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                                tau_re(3,2) = ((dvel_avg_dz(2) - avg_vel(3)) / &amp;</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                                              <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) + dvel_avg_dy(3)) / &amp;</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(l,k,j) / &amp;</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                                              <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                                </div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                                tau_re(3,3) = ( 4d0*dvel_avg_dz(3)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) &amp;</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;                                              - 2d0*dvel_avg_dx(1)         &amp;</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;                                              - 2d0*dvel_avg_dy(2)         &amp;</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;                                              + 4d0*avg_vel(2)/<a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) ) / &amp;</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;                                              ( 3d0*<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(l,k,j)) / &amp;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;                                              <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                              </div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;                                    tau_re(3,i)</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;                                    </div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(l,k,j)   * &amp;</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;                                    tau_re(3,i)</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                              </div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                           </div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;               </div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;                           </div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;                                avg_vel(2) = 5d-1*( vell_vf(2)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;                                                  + velr_vf(2)%sf(j,k,l+1) )</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;                                </div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j,k,l+1) )</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                                </div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;                                dvel_avg_dy(2) = 5d-1*( dvell_dy_vf(2)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                                                      + dvelr_dy_vf(2)%sf(j,k,l+1) )</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                                </div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                                dvel_avg_dz(3) = 5d-1*( dvell_dz_vf(3)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;                                                      + dvelr_dz_vf(3)%sf(j,k,l+1) )</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;                                </div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;                                tau_re(3,3) = ( dvel_avg_dx(1)           &amp;</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;                                              + dvel_avg_dy(2)           &amp;</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                                              + dvel_avg_dz(3) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) &amp;</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;                                              + avg_vel(2) / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k) ) / &amp;</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(l,k,j) / &amp;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;                                              <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(k)</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;                                </div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;                                tau_re(3,3)</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                                </div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(3)%sf(l,k,j)   * &amp;</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                                tau_re(3,3)</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                           </div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;               </div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;            <span class="comment">! END: Viscous Stresses in theta-direction =============================</span></div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;            </div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;            </div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a50ff087624d23846c62cd711dd003757">s_compute_cylindrical_viscous_source_flux</a> <span class="comment">! -------------------------</span></div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;        </div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;       </div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a58c0a2ab06eb5094f60c5e68dbde7300">s_compute_cartesian_viscous_source_flux</a>(     velL_vf, &amp; ! -------------</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;                                                            dvelL_dx_vf, &amp;</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;                                                            dvelL_dy_vf, &amp;</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;                                                            dvelL_dz_vf, &amp;</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;                                                                velR_vf, &amp;</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;                                                            dvelR_dx_vf, &amp;</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;                                                            dvelR_dy_vf, &amp;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;                                                            dvelR_dz_vf, &amp;</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;                                                            flux_src_vf, &amp;</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;                                                               norm_dir, &amp;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;                                                               ix,iy,iz  )</div><div class="line"><a name="l04333"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a58c0a2ab06eb5094f60c5e68dbde7300"> 4333</a></span>&#160;</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;            <span class="keywordtype">DIMENSION(num_dims)</span>, &amp;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;            <span class="keywordtype">INTENT(IN)</span> ::         velL_vf, velR_vf, &amp;</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;                          dvelL_dx_vf, dvelR_dx_vf, &amp;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;                          dvelL_dy_vf, dvelR_dy_vf, &amp;</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;                          dvelL_dz_vf, dvelR_dz_vf</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            </div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_src_vf</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;            </div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;            </div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;            </div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;            <span class="comment">! Arithmetic mean of the left and right, WENO-reconstructed, cell-</span></div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;            <span class="comment">! boundary values of cell-average first-order spatial derivatives</span></div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;            <span class="comment">! of velocity</span></div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: dvel_avg_dx</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: dvel_avg_dy</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: dvel_avg_dz</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;            </div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims,num_dims)</span> :: tau_Re</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;            </div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;            </div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;            </div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;            <span class="comment">! Viscous Stresses in x-direction ==================================</span></div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;               </div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                           </div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf( j ,k,l) &amp;</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j+1,k,l) )</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                           </div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                                tau_re(1,1) = (4d0/3d0)*dvel_avg_dx(1) / &amp;</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;                           </div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                                </div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;                           </div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;               </div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                           </div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf( j, k,l) &amp;</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j+1,k,l) )</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                           </div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                                tau_re(1,1) = dvel_avg_dx(1) / &amp;</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(j,k,l)</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                           </div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;                                </div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;                           </div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;               </div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;               </div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;                           </div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;                                    dvel_avg_dy(i) = &amp;</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                                      5d-1*( dvell_dy_vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                                           + dvelr_dy_vf(i)%sf(j+1,k,l) )</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                           </div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                                dvel_avg_dx(2) = 5d-1*( dvell_dx_vf(2)%sf( j ,k,l) &amp;</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                                                      + dvelr_dx_vf(2)%sf(j+1,k,l) )</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;                           </div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                                tau_re(1,1) = -(2d0/3d0)*dvel_avg_dy(2) / &amp;</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;                                </div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                                tau_re(1,2) = (dvel_avg_dy(1) + dvel_avg_dx(2)) / &amp;</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;                                </div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;                              </div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;                                    </div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;                              </div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;                           </div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;               </div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;                           </div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;                                dvel_avg_dy(2) = 5d-1*( dvell_dy_vf(2)%sf( j, k,l) &amp;</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;                                                      + dvelr_dy_vf(2)%sf(j+1,k,l) )</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;                                </div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;                                tau_re(1,1) = dvel_avg_dy(2) / &amp;</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(j,k,l)</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;                                </div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;                                </div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;                           </div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;               </div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;               </div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;                           </div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3,2</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;                                    dvel_avg_dz(i) = &amp;</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;                                      5d-1*( dvell_dz_vf(i)%sf( j ,k,l) &amp;</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;                                           + dvelr_dz_vf(i)%sf(j+1,k,l) )</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;                           </div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;                                dvel_avg_dx(3) = 5d-1*( dvell_dx_vf(3)%sf( j ,k,l) &amp;</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;                                                      + dvelr_dx_vf(3)%sf(j+1,k,l) )</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;                                </div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                                tau_re(1,1) = -(2d0/3d0)*dvel_avg_dz(3) / &amp;</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                                </div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                                tau_re(1,3) = (dvel_avg_dz(1) + dvel_avg_dx(3)) / &amp;</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(j,k,l)</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;                                </div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3,2</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                                   </div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;                                    </div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;                                    tau_re(1,i)</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;                                   </div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                           </div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;               </div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                           </div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;                                dvel_avg_dz(3) = 5d-1*( dvell_dz_vf(3)%sf( j, k,l) &amp;</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;                                                      + dvelr_dz_vf(3)%sf(j+1,k,l) )</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;                                </div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;                                tau_re(1,1) = dvel_avg_dz(3) / &amp;</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(j,k,l)</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                                </div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                                </div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(1)%sf(j,k,l)   * &amp;</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;                                tau_re(1,1)</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;                           </div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;            <span class="comment">! END: Viscous Stresses in x-direction =============================</span></div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;            </div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;            </div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;            <span class="comment">! Viscous Stresses in y-direction ==================================</span></div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;               </div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;                           </div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                              </div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;                                    dvel_avg_dx(i) = &amp;</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                                            5d-1*( dvell_dx_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                                                 + dvelr_dx_vf(i)%sf(j,k+1,l) )</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;                                    </div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;                                    dvel_avg_dy(i) = &amp;</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;                                            5d-1*( dvell_dy_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;                                                 + dvelr_dy_vf(i)%sf(j,k+1,l) )</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;                              </div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;                           </div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;                                tau_re(2,1) = (dvel_avg_dy(1) + dvel_avg_dx(2)) / &amp;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l)</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                                </div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                                tau_re(2,2) = ( 4d0*dvel_avg_dy(2) &amp;</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                                              - 2d0*dvel_avg_dx(1) ) / &amp;</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;                                              (3d0*<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l))</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;                           </div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                                <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;                              </div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;                                    </div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                              </div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                           </div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;               </div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;                           </div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j,k+1,l) )</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                           </div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;                                dvel_avg_dy(2) = 5d-1*( dvell_dy_vf(2)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;                                                      + dvelr_dy_vf(2)%sf(j,k+1,l) )</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;                                </div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;                                tau_re(2,2) = (dvel_avg_dx(1) + dvel_avg_dy(2)) / &amp;</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(k,j,l)</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;                                </div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;                                </div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(2)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;                           </div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;               </div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;               </div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                           </div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                                    dvel_avg_dz(i) = &amp;</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;                                      5d-1*( dvell_dz_vf(i)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;                                           + dvelr_dz_vf(i)%sf(j,k+1,l) )</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;                           </div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;                                dvel_avg_dy(3) = 5d-1*( dvell_dy_vf(3)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;                                                      + dvelr_dy_vf(3)%sf(j,k+1,l) )</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;                                </div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;                                tau_re(2,2) = -(2d0/3d0)*dvel_avg_dz(3) / &amp;</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;                                               <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l)</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                                </div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;                                tau_re(2,3) = (dvel_avg_dz(2) + dvel_avg_dy(3)) / &amp;</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(k,j,l)</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;                                </div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;                                   </div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;                                    </div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;                                    tau_re(2,i)</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;                                   </div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;                           </div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;               </div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;                           </div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;                                dvel_avg_dz(3) = 5d-1*( dvell_dz_vf(3)%sf(j, k ,l) &amp;</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                                                      + dvelr_dz_vf(3)%sf(j,k+1,l) )</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                                </div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                                tau_re(2,2) = dvel_avg_dz(3) / &amp;</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(k,j,l)</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;                                </div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;                                </div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(2)%sf(k,j,l)   * &amp;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;                                tau_re(2,2)</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                           </div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;            <span class="comment">! END: Viscous Stresses in y-direction =============================</span></div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;            </div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;            </div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;            <span class="comment">! Viscous Stresses in z-direction ==================================</span></div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;               </div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(1) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Shear stresses</span></div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;                           </div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3,2</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;                                    dvel_avg_dx(i) = &amp;</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;                                      5d-1*( dvell_dx_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;                                           + dvelr_dx_vf(i)%sf(j,k,l+1) )                 </div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                           </div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                                <span class="keywordflow">DO</span> i = 2,3</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;                                    dvel_avg_dy(i) = &amp;</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;                                      5d-1*( dvell_dy_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                                           + dvelr_dy_vf(i)%sf(j,k,l+1) )</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                           </div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;                                    dvel_avg_dz(i) = &amp;</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                                      5d-1*( dvell_dz_vf(i)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;                                           + dvelr_dz_vf(i)%sf(j,k,l+1) )</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;                           </div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                                tau_re(3,1) = (dvel_avg_dz(1) + dvel_avg_dx(3)) / &amp;</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(l,k,j)</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;                                </div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;                                tau_re(3,2) = (dvel_avg_dz(2) + dvel_avg_dy(3)) / &amp;</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(l,k,j)</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                                </div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;                                tau_re(3,3) = ( 4d0*dvel_avg_dz(3) &amp;</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;                                              - 2d0*dvel_avg_dx(1) &amp;</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;                                              - 2d0*dvel_avg_dy(2) ) / &amp;</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;                                              (3d0*<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(1)%sf(l,k,j))</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;                           </div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;                                <span class="keywordflow">DO</span> i = 1,3</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;                              </div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;                                    tau_re(3,i)</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;                                    </div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(i)%sf(l,k,j)   * &amp;</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                                    tau_re(3,i)</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;                              </div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;                           </div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;               </div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(2) &gt; 0) <span class="keywordflow">THEN</span>              <span class="comment">! Bulk stresses</span></div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;                    <span class="keywordflow">DO</span> l = iz%beg, iz%end</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                           </div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                                dvel_avg_dx(1) = 5d-1*( dvell_dx_vf(1)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                                                      + dvelr_dx_vf(1)%sf(j,k,l+1) )</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                                </div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;                                dvel_avg_dy(2) = 5d-1*( dvell_dy_vf(2)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                                                      + dvelr_dy_vf(2)%sf(j,k,l+1) )</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;                                </div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                                dvel_avg_dz(3) = 5d-1*( dvell_dz_vf(3)%sf(j,k, l ) &amp;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;                                                      + dvelr_dz_vf(3)%sf(j,k,l+1) )</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                                </div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                                tau_re(3,3) = ( dvel_avg_dx(1) &amp;</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                                              + dvel_avg_dy(2) &amp;</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                                              + dvel_avg_dz(3) ) / &amp;</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                                              <a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(2)%sf(l,k,j)</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                                </div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;                                tau_re(3,3)</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                                </div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) - &amp;</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(3)%sf(l,k,j)   * &amp;</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                                tau_re(3,3)</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;                           </div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;               </div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;            <span class="comment">! END: Viscous Stresses in z-direction =============================</span></div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;            </div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;            </div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a58c0a2ab06eb5094f60c5e68dbde7300">s_compute_cartesian_viscous_source_flux</a> <span class="comment">! -------------------------</span></div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;        </div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        </div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da">s_compute_capillary_source_flux</a>( dalphaL_dx_vf, &amp; ! ---------</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                                                    dalphaL_dy_vf, &amp;</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                                                    dalphaL_dz_vf, &amp;</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                                                     gm_alphaL_vf, &amp;</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                                                    dalphaR_dx_vf, &amp;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                                                    dalphaR_dy_vf, &amp;</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                                                    dalphaR_dz_vf, &amp;</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                                                     gm_alphaR_vf, &amp;</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                                                      flux_src_vf, &amp;</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;                                                         norm_dir, &amp;</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                                                         ix,iy,iz  )</div><div class="line"><a name="l04810"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da"> 4810</a></span>&#160;           </div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),    &amp;</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;            <span class="keywordtype">DIMENSION(num_fluids)</span>, &amp;</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: dalphaL_dx_vf, dalphaR_dx_vf, &amp;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                          dalphaL_dy_vf, dalphaR_dy_vf, &amp;</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;                          dalphaL_dz_vf, dalphaR_dz_vf, &amp;</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                           gm_alphaL_vf,  gm_alphaR_vf</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;            </div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_src_vf</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;            </div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;            </div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;            </div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;            <span class="comment">! Arithmetic average of the left and right, WENO-reconstructed,</span></div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;            <span class="comment">! cell-boundary values of the cell-average first-order spatial</span></div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;            <span class="comment">! derivative of the volume fractions and gradient magnitude of</span></div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;            <span class="comment">! the volume fractions</span></div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> :: dalpha_avg_dx</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> :: dalpha_avg_dy</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> :: dalpha_avg_dz</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> ::  gm_alpha_avg</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;            </div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;            <span class="comment">! Capillary stress tensor</span></div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims,num_dims)</span> :: tau_We</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;            </div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;            </div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;            </div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;            <span class="comment">! Capillary Stresses in x-direction ================================</span></div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;               </div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                    <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;                        <span class="keywordflow">DO</span> l = iy%beg, iy%end</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;                            <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;                           </div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;                              </div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;                                      5d-1*( dalphal_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf( k ,l,r) &amp;</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;                                           + dalphar_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k+1,l,r) )</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;                                    </div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                                      5d-1*( dalphal_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf( k ,l,r) &amp;</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                                           + dalphar_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k+1,l,r) )</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;                                    </div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;                                    gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;                                      5d-1*( gm_alphal_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf( k ,l,r) &amp;</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;                                           + gm_alphar_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k+1,l,r) )</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;                              </div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;                          </div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;                                tau_we(1,1)= &amp;</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;                                                  1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(k,l,r) * &amp;</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;                                               (     gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) - &amp;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;                                               (     gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) - &amp;</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;                                </div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;                                tau_we(1,2) = &amp;</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;                                                - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(k,l,r) * &amp;</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;                                               (    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;                                               (    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;                                   flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+j)%sf(k,l,r) = &amp;</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;                                   flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+j)%sf(k,l,r) - &amp;</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;                                   tau_we(1,j)</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;                           </div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;                                tau_we(1,1)= &amp;</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;                                               - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;                                                     <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(k,l,r) * &amp;</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;                                     ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;                                              (    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;                                                   dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;                                                max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;                                     + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;                                              (    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;                                                   dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;                                                max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;                           </div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) = &amp;</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) - &amp;</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(j)%sf(k,l,r)   * &amp;</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;                                    tau_we(1,j)</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                           </div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;               </div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;               </div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;                    <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;                        <span class="keywordflow">DO</span> l = iy%beg, iy%end</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;                            <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                           </div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;                              </div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;                                      5d-1*( dalphal_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf( k ,l,r) &amp;</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                                           + dalphar_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k+1,l,r) )</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                                    </div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;                                      5d-1*( dalphal_dz_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf( k ,l,r) &amp;</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                                           + dalphar_dz_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k+1,l,r) )</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                                    </div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;                                    gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;                                      5d-1*( gm_alphal_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf( k ,l,r) &amp;</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;                                           + gm_alphar_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k+1,l,r) )</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;                              </div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;                           </div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;                                tau_we(1,3) = &amp;</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;                                                - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(k,l,r) * &amp;</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;                                               (    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(k,l,r) * &amp;</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;                                               (    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;                                </div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(k,l,r) = &amp;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(k,l,r) - &amp;</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;                                tau_we(1,3)</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;                                </div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) = &amp;</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) - &amp;</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(3)%sf(k,l,r)   * &amp;</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;                                tau_we(1,3)</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;                           </div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;            <span class="comment">! END: Capillary Stresses in x-direction ===========================</span></div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;            </div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;            </div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;            <span class="comment">! Capillary Stresses in y-direction ================================</span></div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;               </div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                    <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;                        <span class="keywordflow">DO</span> l = iy%beg, iy%end</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;                            <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                           </div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;                              </div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;                                      5d-1*( dalphal_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k, l ,r) &amp;</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                                           + dalphar_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l+1,r) )</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;                                    </div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;                                      5d-1*( dalphal_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k, l ,r) &amp;</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;                                           + dalphar_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l+1,r) )</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;                                    </div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;                                    gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;                                      5d-1*( gm_alphal_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k, l ,r) &amp;</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;                                           + gm_alphar_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l+1,r) )</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;                              </div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;                           </div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;                                tau_we(2,1) = &amp;</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;                                                - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(l,k,r) * &amp;</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;                                               (    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;                                               (    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;                                </div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;                                tau_we(2,2) = &amp;</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;                                                  1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(l,k,r) * &amp;</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;                                               (     gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) - &amp;</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;                                               (     gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) - &amp;</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+j)%sf(k,l,r) = &amp;</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+j)%sf(k,l,r) - &amp;</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;                                    tau_we(2,j)</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;                           </div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;                                tau_we(2,2) = &amp;</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;                                               - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;                                                     <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(l,k,r) * &amp;</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;                                     ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;                                              (    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                                                   dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                                                max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                                     + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                                              (    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                                                   dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;                                                max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;                           </div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) = &amp;</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) - &amp;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(j)%sf(l,k,r)   * &amp;</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;                                    tau_we(2,j)</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;                           </div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;               </div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;               </div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;                    <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;                        <span class="keywordflow">DO</span> l = iy%beg, iy%end</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;                            <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;                           </div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;                              </div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;                                      5d-1*( dalphal_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k, l ,r) &amp;</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;                                           + dalphar_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l+1,r) )</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;                                    </div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;                                      5d-1*( dalphal_dz_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k, l ,r) &amp;</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;                                           + dalphar_dz_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l+1,r) )</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;                                    </div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;                                    gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;                                      5d-1*( gm_alphal_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k, l ,r) &amp;</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;                                           + gm_alphar_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l+1,r) )</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;                              </div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;                           </div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;                                tau_we(2,3) = &amp;</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;                                                - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(l,k,r) * &amp;</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;                                               (    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(l,k,r) * &amp;</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;                                               (    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;                                </div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(k,l,r) = &amp;</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(k,l,r) - &amp;</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;                                tau_we(2,3)</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;                                </div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) = &amp;</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;                                flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) - &amp;</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(3)%sf(l,k,r)   * &amp;</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;                                tau_we(2,3)</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;                           </div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;            <span class="comment">! END: Capillary Stresses in y-direction ===========================</span></div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;            </div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;            </div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;            <span class="comment">! Capillary Stresses in z-direction ================================</span></div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;               </div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;                    <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;                        <span class="keywordflow">DO</span> l = iy%beg, iy%end</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;                            <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;                           </div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;                                <span class="keywordflow">DO</span> j = 1,2</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;                              </div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;                                      5d-1*( dalphal_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l, r ) &amp;</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;                                           + dalphar_dx_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l,r+1) )</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;                                    </div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;                                      5d-1*( dalphal_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l, r ) &amp;</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;                                           + dalphar_dy_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l,r+1) )</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;                                    </div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                                      5d-1*( dalphal_dz_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l, r ) &amp;</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;                                           + dalphar_dz_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l,r+1) )</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;                                    </div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;                                    gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j)) = &amp;</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;                                      5d-1*( gm_alphal_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l, r ) &amp;</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;                                           + gm_alphar_vf(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,j))%sf(k,l,r+1) )</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;                              </div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                           </div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;                                tau_we(3,1) = &amp;</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                                                - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(r,l,k) * &amp;</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;                                               (    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;                                               (    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;                                                    dalpha_avg_dx(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;                                </div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;                                tau_we(3,2) = &amp;</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;                                                - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(r,l,k) * &amp;</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;                                               (    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                                               (    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;                                                    dalpha_avg_dy(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                                </div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                                tau_we(3,3) = &amp;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                                                  1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                                                      <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(r,l,k) * &amp;</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;                                      ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                                               (     gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) - &amp;</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                                      + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                                               (     gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) - &amp;</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;                                                    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                                                 max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;                                                                      <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;                                </div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                                <span class="keywordflow">DO</span> j = 1,3</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+j)%sf(k,l,r) = &amp;</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+j)%sf(k,l,r) - &amp;</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                                    tau_we(3,j)</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;                           </div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;                                tau_we(3,3) = &amp;</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;                                               - 1d0/<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>( <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1), &amp;</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;                                                     <a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)  )%sf(r,l,k) * &amp;</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;                                     ( <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;                                              (    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) * &amp;</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;                                                   dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;                                                max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) &amp;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;                                     + <a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf(r,l,k) * &amp;</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;                                              (    dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) * &amp;</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;                                                   dalpha_avg_dz(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) / &amp;</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;                                                max(gm_alpha_avg(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;                                                                     <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;                           </div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                                <span class="keywordflow">DO</span> j = 1,3</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) = &amp;</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;                                    flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(k,l,r) - &amp;</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;                                    <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(j)%sf(r,l,k)   * &amp;</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                                    tau_we(3,j)</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                           </div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;               </div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;            <span class="comment">! END: Capillary Stresses in z-direction ===========================</span></div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;            </div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;            </div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da">s_compute_capillary_source_flux</a> <span class="comment">! -----------------------</span></div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;        </div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;        </div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;        </div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19">s_finalize_riemann_solver</a>( flux_vf, flux_src_vf, &amp; ! --------</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;                                                      flux_gsrc_vf, &amp;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;                                                norm_dir, ix,iy,iz  )</div><div class="line"><a name="l05244"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19"> 5244</a></span>&#160;           </div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf, flux_gsrc_vf</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;            </div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: norm_dir</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;            </div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;            </div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;            </div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;            </div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;            <span class="comment">! Reshaping Outputted Data in y-direction ==========================</span></div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;            <span class="keywordflow">IF</span>(norm_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;               </div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;                    <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;                        <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;                            flux_vf(i)%sf(j,k,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(k,j,:)</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;                            flux_gsrc_vf(i)%sf(j,k,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(k,j,:)</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;               </div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;                <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k,j,:)</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;               </div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                  </div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;                                flux_src_vf(i)%sf(j,k,iz%beg:iz%end) = &amp;</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf(k,j,:)</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                  </div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;            </div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;            </div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;            <span class="comment">! Reshaping Outputted Data in z-direction ==========================</span></div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;            <span class="keywordflow">ELSEIF</span>(norm_dir == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;               </div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;                    <span class="keywordflow">DO</span> k = iz%beg, iz%end</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;                        <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;                            flux_vf(i)%sf(j,iy%beg:iy%end,k) = &amp;</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf(k,:,j)</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;                            flux_gsrc_vf(i)%sf(j,iy%beg:iy%end,k) = &amp;</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;                            <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf(k,:,j)</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;               </div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                <span class="keywordflow">DO</span> k = iz%beg, iz%end</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                    <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,iy%beg:iy%end,k) = &amp;</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;                        <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k,:,j)</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;               </div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;                  </div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;                        <span class="keywordflow">DO</span> k = iz%beg, iz%end</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;                            <span class="keywordflow">DO</span> j = ix%beg, ix%end</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;                                flux_src_vf(i)%sf(j,iy%beg:iy%end,k) = &amp;</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;                                <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf(k,:,j)</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;                  </div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;               </div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;            </div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;            </div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;            <span class="comment">! Deallocating Left, Right and Average Riemann Problem States ======</span></div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>(i)%sf, <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>(i)%sf)</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>(i)%sf)</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;            </div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;                <span class="keyword">DEALLOCATE</span>(   <a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;                <span class="keyword">DEALLOCATE</span>(   <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;            </div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;            <span class="keywordflow">DO</span> i = 1,2</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a>(i) &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>(i)%sf)</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;            </div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2))%sf)</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;            </div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;            </div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;            <span class="comment">! Deallocating Intercell Fluxes and Velocity =======================</span></div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;            <span class="keywordflow">IF</span>(norm_dir /= 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;               </div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf)</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf)</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;               </div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;                    <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf)</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;               </div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf)</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;               </div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;               </div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>(i)%sf     =&gt; null()</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>(i)%sf =&gt; null()</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                    <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>(i)%sf =&gt; null()</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;               </div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;            </div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf)</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;                <a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))%sf =&gt; null()</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;            </div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i))%sf)</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;            </div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;            </div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19">s_finalize_riemann_solver</a> <span class="comment">! -----------------------------</span></div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;        </div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;        </div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;        </div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;        </div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;        </div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a5bd1ce6fbbb840b5b1c6dd97ccb8d674">s_finalize_riemann_solvers_module</a>() <span class="comment">! -----------------------</span></div><div class="line"><a name="l05400"></a><span class="lineno"><a class="line" href="namespacem__riemann__solvers.html#a5bd1ce6fbbb840b5b1c6dd97ccb8d674"> 5400</a></span>&#160;</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;            </div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;            </div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;            <span class="comment">! Deallocating the variables that were utilized to formulate the</span></div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;            <span class="comment">! left, right and average states of the Riemann problem, as well</span></div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;            <span class="comment">! the Riemann problem solution</span></div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">ql_prim_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">qr_prim_rs_vf</a>)</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;            </div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">flux_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">flux_src_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">flux_gsrc_rs_vf</a>)</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;            </div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">vel_src_rs_vf</a>)</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;            </div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">alpha_rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">vel_l</a>)</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">alpha_rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">vel_r</a>)</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;            </div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">vel_avg</a>)</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;            </div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">alpha_l</a>, <a class="code" href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">alpha_r</a>)</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;            </div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;                </div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">kappal_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">kappar_rs_vf</a>)</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">alpha_avg_rs_vf</a>, <a class="code" href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">kappa_avg</a>, <a class="code" href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">we_avg_rs_vf</a>)</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;                </div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;            </div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">we_l</a>, <a class="code" href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">we_r</a>)</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;            </div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">re_avg_rs_vf</a>)</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;            </div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">tvd_riemann_flux</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">q_prim_rs_vf</a>)</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">lo_alpha_rho_l</a>, <a class="code" href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">lo_vel_l</a>)</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">lo_alpha_rho_r</a>, <a class="code" href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">lo_vel_r</a>)</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">lo_alpha_l</a>)</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">lo_alpha_r</a>)</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a8388f446036552682910bbe06da81f70">lo_we_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">lo_we_r</a>)</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">alpha_rho_ic</a>, <a class="code" href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">vel_ic</a>)</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">alpha_ic</a>)</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;            </div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;                <span class="keyword">deallocate</span>(<a class="code" href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">r0_l</a>, <a class="code" href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">v0_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">pbw_l</a>, <a class="code" href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">r0_r</a>, <a class="code" href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">v0_r</a>, <a class="code" href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">pbw_r</a>)</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;            <span class="comment">! Disassociating procedural pointer to the subroutine which was</span></div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;            <span class="comment">! utilized to calculate the solution of a given Riemann problem</span></div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">s_riemann_solver</a> =&gt; null()</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;            </div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;            </div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;            <span class="comment">! Disassociating the procedural pointers to the procedures that were</span></div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;            <span class="comment">! utilized to compute the average state and estimate the wave speeds</span></div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">s_compute_average_state</a> =&gt; null(); <a class="code" href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">s_compute_wave_speeds</a> =&gt; null()</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;            </div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;           </div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;            <span class="comment">! Disassociating procedural pointer to the subroutine which was</span></div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;            <span class="comment">! utilized to calculate the viscous source flux</span></div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;            <a class="code" href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">s_compute_viscous_source_flux</a> =&gt; null()</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;            <span class="comment">! Disassociating the pointer to the procedure that was utilized to</span></div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;            <span class="comment">! to convert mixture or species variables to the mixture variables</span></div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; null()</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;            </div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;            </div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__riemann__solvers.html#a5bd1ce6fbbb840b5b1c6dd97ccb8d674">s_finalize_riemann_solvers_module</a> <span class="comment">! ---------------------</span></div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;        </div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;        </div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;        </div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;        </div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;        </div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__riemann__solvers.html">m_riemann_solvers</a></div><div class="ttc" id="namespacem__global__parameters_html_a5c017ac8b7bf0d36b4b3b88efe5ffc5f"><div class="ttname"><a href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">m_global_parameters::dir_idx</a></div><div class="ttdeci">integer, dimension(3) dir_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00226">m_global_parameters.f90:226</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af2383f23c599d5936d0559dac1edee9b"><div class="ttname"><a href="namespacem__global__parameters.html#af2383f23c599d5936d0559dac1edee9b">m_global_parameters::tvd_riemann_flux</a></div><div class="ttdeci">logical tvd_riemann_flux</div><div class="ttdoc">Apply TVD flux limiter to left and right states inside Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00144">m_global_parameters.f90:144</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac459ed9a3a6c08d8032f3e06ccf96885"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac459ed9a3a6c08d8032f3e06ccf96885">m_riemann_solvers::alpha_avg_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable alpha_avg_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00350">m_riemann_solvers.f90:350</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a576586da8d3d80052a335d379001059a"><div class="ttname"><a href="namespacem__riemann__solvers.html#a576586da8d3d80052a335d379001059a">m_riemann_solvers::s_s</a></div><div class="ttdeci">real(kind(0d0)) s_s</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00360">m_riemann_solvers.f90:360</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_af7c9f253cc0584146992cc0b1858e888"><div class="ttname"><a href="namespacem__riemann__solvers.html#af7c9f253cc0584146992cc0b1858e888">m_riemann_solvers::lo_s_m</a></div><div class="ttdeci">real(kind(0d0)) lo_s_m</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00382">m_riemann_solvers.f90:382</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a8ac4fca37ee46e90e61ca83a1e4eb2c5"><div class="ttname"><a href="namespacem__riemann__solvers.html#a8ac4fca37ee46e90e61ca83a1e4eb2c5">m_riemann_solvers::lo_pres_r</a></div><div class="ttdeci">real(kind(0d0)) lo_pres_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00297">m_riemann_solvers.f90:297</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae880c4216083a3203b42996f2010f080"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae880c4216083a3203b42996f2010f080">m_riemann_solvers::lo_s_r</a></div><div class="ttdeci">real(kind(0d0)) lo_s_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00381">m_riemann_solvers.f90:381</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4438313a11564fa911c586d2dee15b8d"><div class="ttname"><a href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">m_global_parameters::re_inv</a></div><div class="ttdeci">real(kind(0d0)) re_inv</div><div class="ttdoc">Inverse Reynolds number. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00286">m_global_parameters.f90:286</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a485dc456f00eaa35c862ca3a2daa3d8c"><div class="ttname"><a href="namespacem__riemann__solvers.html#a485dc456f00eaa35c862ca3a2daa3d8c">m_riemann_solvers::alpha_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00265">m_riemann_solvers.f90:265</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ad79d372c1bc1971b870ab2c455d9ff90"><div class="ttname"><a href="namespacem__riemann__solvers.html#ad79d372c1bc1971b870ab2c455d9ff90">m_riemann_solvers::y_l</a></div><div class="ttdeci">real(kind(0d0)) y_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00266">m_riemann_solvers.f90:266</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a57eb3b7013680ab3c30a1e8f049a0402"><div class="ttname"><a href="namespacem__riemann__solvers.html#a57eb3b7013680ab3c30a1e8f049a0402">m_riemann_solvers::lo_alpha_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable lo_alpha_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00300">m_riemann_solvers.f90:300</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6b9c81f07f8444654924e3075e4edaf8"><div class="ttname"><a href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">m_global_parameters::riemann_solver</a></div><div class="ttdeci">integer riemann_solver</div><div class="ttdoc">Riemann solver algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abc4d393041248b9e5f72a38f797e4683"><div class="ttname"><a href="namespacem__riemann__solvers.html#abc4d393041248b9e5f72a38f797e4683">m_riemann_solvers::dpres_l</a></div><div class="ttdeci">real(kind(0d0)) dpres_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00339">m_riemann_solvers.f90:339</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a29b168c298a62892312beaf804d88ebd"><div class="ttname"><a href="namespacem__riemann__solvers.html#a29b168c298a62892312beaf804d88ebd">m_riemann_solvers::g2_r</a></div><div class="ttdeci">real(kind(0d0)) g2_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00311">m_riemann_solvers.f90:311</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_af4a82bacd4c2232f466428d41f34dffa"><div class="ttname"><a href="namespacem__riemann__solvers.html#af4a82bacd4c2232f466428d41f34dffa">m_riemann_solvers::g5_l</a></div><div class="ttdeci">real(kind(0d0)) g5_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00314">m_riemann_solvers.f90:314</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a107a13616d23f81b60bab83209067b01"><div class="ttname"><a href="namespacem__riemann__solvers.html#a107a13616d23f81b60bab83209067b01">m_riemann_solvers::s_compute_pressure_velocity_wave_speeds</a></div><div class="ttdeci">subroutine s_compute_pressure_velocity_wave_speeds(j, k, l)</div><div class="ttdoc">Estimation of the left, right and star region wave speeds by the approximation of the pressures and v...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02699">m_riemann_solvers.f90:2699</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abdd33525dd128beda2d0c33454e0d9de"><div class="ttname"><a href="namespacem__riemann__solvers.html#abdd33525dd128beda2d0c33454e0d9de">m_riemann_solvers::alpha_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00265">m_riemann_solvers.f90:265</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_af060aa45ac1c0c96428fd428ca3f63af"><div class="ttname"><a href="namespacem__riemann__solvers.html#af060aa45ac1c0c96428fd428ca3f63af">m_riemann_solvers::lo_c_l</a></div><div class="ttdeci">real(kind(0d0)) lo_c_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00303">m_riemann_solvers.f90:303</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a2a804f5759af46c82fdd62633b5e7605"><div class="ttname"><a href="namespacem__riemann__solvers.html#a2a804f5759af46c82fdd62633b5e7605">m_riemann_solvers::re_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00270">m_riemann_solvers.f90:270</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a5bd1ce6fbbb840b5b1c6dd97ccb8d674"><div class="ttname"><a href="namespacem__riemann__solvers.html#a5bd1ce6fbbb840b5b1c6dd97ccb8d674">m_riemann_solvers::s_finalize_riemann_solvers_module</a></div><div class="ttdeci">subroutine, public s_finalize_riemann_solvers_module()</div><div class="ttdoc">Module deallocation and/or disassociation procedures. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l05400">m_riemann_solvers.f90:5400</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a8159569b322091efa55bbeb377532352"><div class="ttname"><a href="namespacem__riemann__solvers.html#a8159569b322091efa55bbeb377532352">m_riemann_solvers::gamma_l</a></div><div class="ttdeci">real(kind(0d0)) gamma_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00267">m_riemann_solvers.f90:267</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a549a425e9a863451e770d405f092417c"><div class="ttname"><a href="namespacem__riemann__solvers.html#a549a425e9a863451e770d405f092417c">m_riemann_solvers::xi_p</a></div><div class="ttdeci">real(kind(0d0)) xi_p</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00375">m_riemann_solvers.f90:375</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac277f9426d7112e2b42fdc0fd6583f5e"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac277f9426d7112e2b42fdc0fd6583f5e">m_riemann_solvers::kappal_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable kappal_rs_vf</div><div class="ttdoc">The left and right, WENO-reconstructed, cell-boundary values of the cell- average curvatures of the v...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00231">m_riemann_solvers.f90:231</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae8e6c40b6ec73cb126b0cce7496e0057"><div class="ttname"><a href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00189">m_global_parameters.f90:189</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a1cfaf511a3605cef96d95b88de661071"><div class="ttname"><a href="namespacem__riemann__solvers.html#a1cfaf511a3605cef96d95b88de661071">m_riemann_solvers::lo_pi_inf_l</a></div><div class="ttdeci">real(kind(0d0)) lo_pi_inf_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00302">m_riemann_solvers.f90:302</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a6ece114ee17503f716a99a601c2ba5d1"><div class="ttname"><a href="namespacem__riemann__solvers.html#a6ece114ee17503f716a99a601c2ba5d1">m_riemann_solvers::g8_r</a></div><div class="ttdeci">real(kind(0d0)) g8_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00317">m_riemann_solvers.f90:317</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a25a8dae8bbd769f28c67f1747520f373"><div class="ttname"><a href="namespacem__riemann__solvers.html#a25a8dae8bbd769f28c67f1747520f373">m_riemann_solvers::dpres_r</a></div><div class="ttdeci">real(kind(0d0)) dpres_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00339">m_riemann_solvers.f90:339</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a81973da2ed5f2e08dd363d889c0e21d7"><div class="ttname"><a href="namespacem__riemann__solvers.html#a81973da2ed5f2e08dd363d889c0e21d7">m_riemann_solvers::pres_l</a></div><div class="ttdeci">real(kind(0d0)) pres_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00262">m_riemann_solvers.f90:262</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a62f6549c30232e14a06efa8dfe7f19a4"><div class="ttname"><a href="namespacem__riemann__solvers.html#a62f6549c30232e14a06efa8dfe7f19a4">m_riemann_solvers::lo_s_p</a></div><div class="ttdeci">real(kind(0d0)) lo_s_p</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00382">m_riemann_solvers.f90:382</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2f790d774fdcc87779b89a71ae3f2674"><div class="ttname"><a href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_abstract_to_mixture_variables), pointer, public s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00158">m_variables_conversion.f90:158</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a48b0505675e2bd1d0b36bda9de508655"><div class="ttname"><a href="namespacem__riemann__solvers.html#a48b0505675e2bd1d0b36bda9de508655">m_riemann_solvers::lo_gamma_r</a></div><div class="ttdeci">real(kind(0d0)) lo_gamma_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00301">m_riemann_solvers.f90:301</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ab9b568d4ea77b665c1f6cea77144acc8"><div class="ttname"><a href="namespacem__riemann__solvers.html#ab9b568d4ea77b665c1f6cea77144acc8">m_riemann_solvers::we_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable we_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00271">m_riemann_solvers.f90:271</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a1e94f6d0053552684cebcc569b1a6f8a"><div class="ttname"><a href="namespacem__riemann__solvers.html#a1e94f6d0053552684cebcc569b1a6f8a">m_riemann_solvers::g3_r</a></div><div class="ttdeci">real(kind(0d0)) g3_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00312">m_riemann_solvers.f90:312</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa46a7f3638e49fa9ec33ea859b9e6a5a"><div class="ttname"><a href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">m_global_parameters::bc_x</a></div><div class="ttdeci">type(bounds_info) bc_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_adbaf70dfc178970c3e210dddedc31971"><div class="ttname"><a href="namespacem__riemann__solvers.html#adbaf70dfc178970c3e210dddedc31971">m_riemann_solvers::g1_l</a></div><div class="ttdeci">real(kind(0d0)) g1_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00310">m_riemann_solvers.f90:310</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a0b6d2f192a1df76abc59b85b03f7a187"><div class="ttname"><a href="namespacem__riemann__solvers.html#a0b6d2f192a1df76abc59b85b03f7a187">m_riemann_solvers::flux_src_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable flux_src_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00239">m_riemann_solvers.f90:239</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1a3314b39e21e17d7e72a9837db2ab42"><div class="ttname"><a href="namespacem__global__parameters.html#a1a3314b39e21e17d7e72a9837db2ab42">m_global_parameters::avg_state</a></div><div class="ttdeci">integer avg_state</div><div class="ttdoc">Average state evaluation method. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00135">m_global_parameters.f90:135</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a28e9af865b5ffd2a8cef04c1004b3aea"><div class="ttname"><a href="namespacem__riemann__solvers.html#a28e9af865b5ffd2a8cef04c1004b3aea">m_riemann_solvers::lo_s_s</a></div><div class="ttdeci">real(kind(0d0)) lo_s_s</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00381">m_riemann_solvers.f90:381</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00247">m_global_parameters.f90:247</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a985a98321338d51bc8a43695b490b102"><div class="ttname"><a href="namespacem__riemann__solvers.html#a985a98321338d51bc8a43695b490b102">m_riemann_solvers::lo_h_r</a></div><div class="ttdeci">real(kind(0d0)) lo_h_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00299">m_riemann_solvers.f90:299</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a61bf6c3eebae289a1826c4acd303ae6e"><div class="ttname"><a href="namespacem__riemann__solvers.html#a61bf6c3eebae289a1826c4acd303ae6e">m_riemann_solvers::lo_s_l</a></div><div class="ttdeci">real(kind(0d0)) lo_s_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00381">m_riemann_solvers.f90:381</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ad13ea7f1ad55e7119a36ca61bb353ded"><div class="ttname"><a href="namespacem__riemann__solvers.html#ad13ea7f1ad55e7119a36ca61bb353ded">m_riemann_solvers::tvd_xi_m</a></div><div class="ttdeci">real(kind(0d0)) tvd_xi_m</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00385">m_riemann_solvers.f90:385</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7edc50538c81447bf49e9242d85ee1ff"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7edc50538c81447bf49e9242d85ee1ff">m_riemann_solvers::s_riemann_solver</a></div><div class="ttdeci">procedure(s_abstract_riemann_solver), pointer, public s_riemann_solver</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00388">m_riemann_solvers.f90:388</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">The module contains all of the parameters describing the program logistics, the computational domain ...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00040">m_global_parameters.f90:40</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a132ff53b628e32e8d047d3a3f983b933"><div class="ttname"><a href="namespacem__riemann__solvers.html#a132ff53b628e32e8d047d3a3f983b933">m_riemann_solvers::r0_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable r0_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00280">m_riemann_solvers.f90:280</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a746eb452c1a5c1db204624afaad5b478"><div class="ttname"><a href="namespacem__riemann__solvers.html#a746eb452c1a5c1db204624afaad5b478">m_riemann_solvers::g7_r</a></div><div class="ttdeci">real(kind(0d0)) g7_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00316">m_riemann_solvers.f90:316</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00048">m_derived_types.f90:48</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a2739a94dffd4557f28f432f86aff6c45"><div class="ttname"><a href="namespacem__riemann__solvers.html#a2739a94dffd4557f28f432f86aff6c45">m_riemann_solvers::c_avg</a></div><div class="ttdeci">real(kind(0d0)) c_avg</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00352">m_riemann_solvers.f90:352</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_af14a2b29ba2692adfb1ed257e91482e8"><div class="ttname"><a href="namespacem__riemann__solvers.html#af14a2b29ba2692adfb1ed257e91482e8">m_riemann_solvers::pbw_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable pbw_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00283">m_riemann_solvers.f90:283</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaa584e01b4153d246d84eef286482632"><div class="ttname"><a href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">m_global_parameters::y_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target y_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a418fedb6a95524db57eeb364db8c5c0c"><div class="ttname"><a href="namespacem__riemann__solvers.html#a418fedb6a95524db57eeb364db8c5c0c">m_riemann_solvers::s_m</a></div><div class="ttdeci">real(kind(0d0)) s_m</div><div class="ttdoc">Minus (M) and plus (P) wave speeds. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00370">m_riemann_solvers.f90:370</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa0a8636a3aef10f1989ce432bd825bf5"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa0a8636a3aef10f1989ce432bd825bf5">m_riemann_solvers::tvd_s_p</a></div><div class="ttdeci">real(kind(0d0)) tvd_s_p</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00383">m_riemann_solvers.f90:383</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdoc">Number of eq. bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00282">m_global_parameters.f90:282</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac44a4218c43a64bbe1b4d0dadc4726f1"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac44a4218c43a64bbe1b4d0dadc4726f1">m_riemann_solvers::g4_l</a></div><div class="ttdeci">real(kind(0d0)) g4_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00313">m_riemann_solvers.f90:313</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_adeb97ac789df26b14a090d09fb8598b7"><div class="ttname"><a href="namespacem__riemann__solvers.html#adeb97ac789df26b14a090d09fb8598b7">m_riemann_solvers::lo_xi_m</a></div><div class="ttdeci">real(kind(0d0)) lo_xi_m</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00384">m_riemann_solvers.f90:384</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa7deddacb25e873c573761963f680efc"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa7deddacb25e873c573761963f680efc">m_riemann_solvers::p0_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable p0_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00282">m_riemann_solvers.f90:282</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a2da04da751b4d4e1e1d8783d80f4ebe1"><div class="ttname"><a href="namespacem__riemann__solvers.html#a2da04da751b4d4e1e1d8783d80f4ebe1">m_riemann_solvers::xi_m</a></div><div class="ttdeci">real(kind(0d0)) xi_m</div><div class="ttdoc">Minus and plus wave speeds functions. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00375">m_riemann_solvers.f90:375</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a68eaaca2982b39252417b29ef5d0f9c3"><div class="ttname"><a href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">m_global_parameters::bc_y</a></div><div class="ttdeci">type(bounds_info) bc_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adefe3b78bf286d73a56aef49880dfb0d"><div class="ttname"><a href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00186">m_global_parameters.f90:186</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aef2c7eeabded0734aaa0cd95adac91ab"><div class="ttname"><a href="namespacem__riemann__solvers.html#aef2c7eeabded0734aaa0cd95adac91ab">m_riemann_solvers::y_r</a></div><div class="ttdeci">real(kind(0d0)) y_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00266">m_riemann_solvers.f90:266</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a80405eb6d8eaa75206edeef312c782d7"><div class="ttname"><a href="namespacem__riemann__solvers.html#a80405eb6d8eaa75206edeef312c782d7">m_riemann_solvers::g2_l</a></div><div class="ttdeci">real(kind(0d0)) g2_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00311">m_riemann_solvers.f90:311</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a16d6f8f4c3ad64fdb574a50c189750c5"><div class="ttname"><a href="namespacem__riemann__solvers.html#a16d6f8f4c3ad64fdb574a50c189750c5">m_riemann_solvers::s_compute_mixture_sound_speeds</a></div><div class="ttdeci">subroutine s_compute_mixture_sound_speeds(j, k, l)</div><div class="ttdoc">Compute mixture sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01766">m_riemann_solvers.f90:1766</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_afbf6423349d95b7b3472eb84b9ba7f56"><div class="ttname"><a href="namespacem__riemann__solvers.html#afbf6423349d95b7b3472eb84b9ba7f56">m_riemann_solvers::nbub_l</a></div><div class="ttdeci">real(kind(0d0)) nbub_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00279">m_riemann_solvers.f90:279</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_acfbe99c9151b71dadc19e80851d33bfe"><div class="ttname"><a href="namespacem__riemann__solvers.html#acfbe99c9151b71dadc19e80851d33bfe">m_riemann_solvers::alpha_rho_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_rho_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00259">m_riemann_solvers.f90:259</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac422e0817e2011364cc6fc9c9a56b82b"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac422e0817e2011364cc6fc9c9a56b82b">m_riemann_solvers::gamma_r</a></div><div class="ttdeci">real(kind(0d0)) gamma_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00267">m_riemann_solvers.f90:267</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a8e9c08866eae6dd81d694a5685306973"><div class="ttname"><a href="namespacem__riemann__solvers.html#a8e9c08866eae6dd81d694a5685306973">m_riemann_solvers::g5_r</a></div><div class="ttdeci">real(kind(0d0)) g5_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00314">m_riemann_solvers.f90:314</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a27a761fd83f4f8f7178b8c57b09b825e"><div class="ttname"><a href="namespacem__riemann__solvers.html#a27a761fd83f4f8f7178b8c57b09b825e">m_riemann_solvers::vel_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00261">m_riemann_solvers.f90:261</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a03542f2527def3010f55cd456ccca698"><div class="ttname"><a href="namespacem__riemann__solvers.html#a03542f2527def3010f55cd456ccca698">m_riemann_solvers::rho_r</a></div><div class="ttdeci">real(kind(0d0)) rho_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00260">m_riemann_solvers.f90:260</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abbed27f1ec9cca777a83635a05fc8525"><div class="ttname"><a href="namespacem__riemann__solvers.html#abbed27f1ec9cca777a83635a05fc8525">m_riemann_solvers::g7_l</a></div><div class="ttdeci">real(kind(0d0)) g7_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00316">m_riemann_solvers.f90:316</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a0e605952054968421a3e444c8ba71063"><div class="ttname"><a href="namespacem__riemann__solvers.html#a0e605952054968421a3e444c8ba71063">m_riemann_solvers::alpha_ic</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_ic</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00333">m_riemann_solvers.f90:333</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a5f6f2613083fc30ff684c4183014a67c"><div class="ttname"><a href="namespacem__riemann__solvers.html#a5f6f2613083fc30ff684c4183014a67c">m_riemann_solvers::alpha_rho_ic</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_rho_ic</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00328">m_riemann_solvers.f90:328</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a58c0a2ab06eb5094f60c5e68dbde7300"><div class="ttname"><a href="namespacem__riemann__solvers.html#a58c0a2ab06eb5094f60c5e68dbde7300">m_riemann_solvers::s_compute_cartesian_viscous_source_flux</a></div><div class="ttdeci">subroutine s_compute_cartesian_viscous_source_flux(velL_vf, dvelL_dx_vf, dvelL_dy_vf, dvelL_dz_vf, velR_vf, dvelR_dx_vf, dvelR_dy_vf, dvelR_dz_vf, flux_src_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The goal of this subroutine is to evaluate and account for the contribution of viscous stresses in th...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l04333">m_riemann_solvers.f90:4333</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ab48bf742ff1449dd3e044ce44cc59a56"><div class="ttname"><a href="namespacem__riemann__solvers.html#ab48bf742ff1449dd3e044ce44cc59a56">m_riemann_solvers::p_star</a></div><div class="ttdeci">real(kind(0d0)) p_star</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00365">m_riemann_solvers.f90:365</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99557d578d538a853b5fd9e445ad6303"><div class="ttname"><a href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">m_global_parameters::we_riemann_flux</a></div><div class="ttdeci">logical we_riemann_flux</div><div class="ttdoc">Account for capillary effects in the Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a075a895b8ab81335f21a168603f29f37"><div class="ttname"><a href="namespacem__riemann__solvers.html#a075a895b8ab81335f21a168603f29f37">m_riemann_solvers::h_l</a></div><div class="ttdeci">real(kind(0d0)) h_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00264">m_riemann_solvers.f90:264</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a953a81975cc1627c87baca12ed51ed95"><div class="ttname"><a href="namespacem__riemann__solvers.html#a953a81975cc1627c87baca12ed51ed95">m_riemann_solvers::we_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable we_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00271">m_riemann_solvers.f90:271</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a14b6f4fa2f3b1d567a3f3347105ce61e"><div class="ttname"><a href="namespacem__riemann__solvers.html#a14b6f4fa2f3b1d567a3f3347105ce61e">m_riemann_solvers::s_compute_arithmetic_average_state</a></div><div class="ttdeci">subroutine s_compute_arithmetic_average_state(j, k, l)</div><div class="ttdoc">This procedure calculates the arithmetic average density, velocity, enthalpy, volume fractions...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02443">m_riemann_solvers.f90:2443</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa0a0c169528cc9c4a379f641fb653712"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa0a0c169528cc9c4a379f641fb653712">m_riemann_solvers::lo_gamma_l</a></div><div class="ttdeci">real(kind(0d0)) lo_gamma_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00301">m_riemann_solvers.f90:301</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7596585d3504d397f16723b6a6ffd862"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7596585d3504d397f16723b6a6ffd862">m_riemann_solvers::lo_e_r</a></div><div class="ttdeci">real(kind(0d0)) lo_e_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00298">m_riemann_solvers.f90:298</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac60a57ea5298dde379e24b6b77762101"><div class="ttname"><a href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">m_global_parameters::regularization</a></div><div class="ttdeci">logical regularization</div><div class="ttdoc">Regularization terms of Tiwari (2013) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00140">m_global_parameters.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0d20192b0175dc677ba88b14bf0d5104"><div class="ttname"><a href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">m_global_parameters::we_idx</a></div><div class="ttdeci">integer, dimension(:,:), allocatable we_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00210">m_global_parameters.f90:210</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aeeea1cc689aa550f3c1f182fe33a4939"><div class="ttname"><a href="namespacem__riemann__solvers.html#aeeea1cc689aa550f3c1f182fe33a4939">m_riemann_solvers::s_compute_roe_average_state</a></div><div class="ttdeci">subroutine s_compute_roe_average_state(j, k, l)</div><div class="ttdoc">The procedure computes the Roe average density, velocity, enthalpy, volume fractions, specific heat ratio function, speed of sound, shear and volume Reynolds numbers, Weber numbers and curvatures, at the cell-boundaries, from the left and right states of the Riemann problem. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02315">m_riemann_solvers.f90:2315</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a31ac5fad05a69c3c0c76fbdc872f5494"><div class="ttname"><a href="namespacem__riemann__solvers.html#a31ac5fad05a69c3c0c76fbdc872f5494">m_riemann_solvers::pbw_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable pbw_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00283">m_riemann_solvers.f90:283</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a9fa393b97819b253e8b85f0444a15c27"><div class="ttname"><a href="namespacem__riemann__solvers.html#a9fa393b97819b253e8b85f0444a15c27">m_riemann_solvers::s_exact_riemann_solver</a></div><div class="ttdeci">subroutine, public s_exact_riemann_solver(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">This procedure is the implementation of the exact Riemann solver, see Toro (1999). The effects of viscosity and the surface tension have been incorporated following the work of Perigaud and Saurel (2005). </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01517">m_riemann_solvers.f90:1517</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ab17d29f1de63b4669165d7d92f209986"><div class="ttname"><a href="namespacem__riemann__solvers.html#ab17d29f1de63b4669165d7d92f209986">m_riemann_solvers::vel_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00261">m_riemann_solvers.f90:261</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a8388f446036552682910bbe06da81f70"><div class="ttname"><a href="namespacem__riemann__solvers.html#a8388f446036552682910bbe06da81f70">m_riemann_solvers::lo_we_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable lo_we_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00305">m_riemann_solvers.f90:305</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_adb408aa0458d5f80528aff6fa2d7eeb1"><div class="ttname"><a href="namespacem__riemann__solvers.html#adb408aa0458d5f80528aff6fa2d7eeb1">m_riemann_solvers::g4_r</a></div><div class="ttdeci">real(kind(0d0)) g4_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00313">m_riemann_solvers.f90:313</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99ba7e33a1870ac89386d376e0d20526"><div class="ttname"><a href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">m_global_parameters::dflt_real</a></div><div class="ttdeci">real(kind(0d0)), parameter dflt_real</div><div class="ttdoc">Default real value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html"><div class="ttname"><a href="namespacem__riemann__solvers.html">m_riemann_solvers</a></div><div class="ttdoc">This module features a database of approximate and exact Riemann problem solvers for the Navier-Stoke...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00049">m_riemann_solvers.f90:49</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7e533d9eadb12af316d72f1b722735d8"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7e533d9eadb12af316d72f1b722735d8">m_riemann_solvers::s_guess_pressure</a></div><div class="ttdeci">subroutine s_guess_pressure(pres_start)</div><div class="ttdoc">The purpose of this subroutine is to provide a guess value for pressure in the star region...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01994">m_riemann_solvers.f90:1994</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a1b9d56d4ae46805db6489e72a09f765b"><div class="ttname"><a href="namespacem__riemann__solvers.html#a1b9d56d4ae46805db6489e72a09f765b">m_riemann_solvers::tvd_s_m</a></div><div class="ttdeci">real(kind(0d0)) tvd_s_m</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00383">m_riemann_solvers.f90:383</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ad0d94c92ddccee51dc2412707fcab447"><div class="ttname"><a href="namespacem__riemann__solvers.html#ad0d94c92ddccee51dc2412707fcab447">m_riemann_solvers::is2</a></div><div class="ttdeci">type(bounds_info) is2</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00411">m_riemann_solvers.f90:411</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ad7ef4f9e239961cacd291ee2e31bf0be"><div class="ttname"><a href="namespacem__riemann__solvers.html#ad7ef4f9e239961cacd291ee2e31bf0be">m_riemann_solvers::is1</a></div><div class="ttdeci">type(bounds_info) is1</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00411">m_riemann_solvers.f90:411</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aff8b1fce6e33a0d7e18fbf87c252f1cd"><div class="ttname"><a href="namespacem__riemann__solvers.html#aff8b1fce6e33a0d7e18fbf87c252f1cd">m_riemann_solvers::g6_r</a></div><div class="ttdeci">real(kind(0d0)) g6_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00315">m_riemann_solvers.f90:315</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa0c3d3e0ab3821f201308018c8d3e550"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa0c3d3e0ab3821f201308018c8d3e550">m_riemann_solvers::g6_l</a></div><div class="ttdeci">real(kind(0d0)) g6_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00315">m_riemann_solvers.f90:315</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a41ed4fe5b767afd06561f8618d1d7012"><div class="ttname"><a href="namespacem__riemann__solvers.html#a41ed4fe5b767afd06561f8618d1d7012">m_riemann_solvers::pres_s</a></div><div class="ttdeci">real(kind(0d0)) pres_s</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00322">m_riemann_solvers.f90:322</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a3d8e1f9ad9ca68e97109e0cff7aa1c4b"><div class="ttname"><a href="namespacem__riemann__solvers.html#a3d8e1f9ad9ca68e97109e0cff7aa1c4b">m_riemann_solvers::flux_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable flux_rs_vf</div><div class="ttdoc">The cell-boundary values of the fluxes (src - source) that are computed through the chosen Riemann pr...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00239">m_riemann_solvers.f90:239</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1fcd6cc13ad7f604ef81708716a1feac"><div class="ttname"><a href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">m_global_parameters::ca</a></div><div class="ttdeci">real(kind(0d0)) ca</div><div class="ttdoc">Cavitation number. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00284">m_global_parameters.f90:284</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6e342ae3eb66f89e0eeb94e11aa42d92"><div class="ttname"><a href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">m_global_parameters::buff_size</a></div><div class="ttdeci">integer buff_size</div><div class="ttdoc">The number of cells that are necessary to be able to store enough boundary conditions data to march t...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abbde404883793a9aae3708896b4a2781"><div class="ttname"><a href="namespacem__riemann__solvers.html#abbde404883793a9aae3708896b4a2781">m_riemann_solvers::lo_re_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) lo_re_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00304">m_riemann_solvers.f90:304</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa67462b01acb62fbe8730a28aa37b7a9"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa67462b01acb62fbe8730a28aa37b7a9">m_riemann_solvers::flux_gsrc_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable flux_gsrc_rs_vf</div><div class="ttdoc">The cell-boundary values of the geometrical source flux that are computed through the chosen Riemann ...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00243">m_riemann_solvers.f90:243</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of fluids in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac58b25fbd4733d5adff39c28b32673b8"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac58b25fbd4733d5adff39c28b32673b8">m_riemann_solvers::g3_l</a></div><div class="ttdeci">real(kind(0d0)) g3_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00312">m_riemann_solvers.f90:312</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a89059f36a5b3db54b3bd35cc3215a4be"><div class="ttname"><a href="namespacem__riemann__solvers.html#a89059f36a5b3db54b3bd35cc3215a4be">m_riemann_solvers::lo_alpha_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable lo_alpha_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00300">m_riemann_solvers.f90:300</a></div></div>
<div class="ttc" id="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds_html"><div class="ttname"><a href="interfacem__riemann__solvers_1_1s__compute__abstract__wave__speeds.html">m_riemann_solvers::s_compute_abstract_wave_speeds</a></div><div class="ttdoc">The abstract interface to the subroutines that are utilized to compute the wave speeds of the Riemann...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00169">m_riemann_solvers.f90:169</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7883028b185740c1d507b486eceef969"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7883028b185740c1d507b486eceef969">m_riemann_solvers::lo_we_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable lo_we_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00305">m_riemann_solvers.f90:305</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a613c09e8438e535e8c13f15282493793"><div class="ttname"><a href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">m_variables_conversion::s_convert_mixture_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_mixture_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00188">m_variables_conversion.f90:188</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae941c64575d69a7b369f9f5bb921a384"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae941c64575d69a7b369f9f5bb921a384">m_riemann_solvers::s_p</a></div><div class="ttdeci">real(kind(0d0)) s_p</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00370">m_riemann_solvers.f90:370</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a5c08b40ab939ec42b3eb2f50f41a045d"><div class="ttname"><a href="namespacem__riemann__solvers.html#a5c08b40ab939ec42b3eb2f50f41a045d">m_riemann_solvers::e_r</a></div><div class="ttdeci">real(kind(0d0)) e_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00263">m_riemann_solvers.f90:263</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac997c4db6eac9f175803bc4fd81ef096"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac997c4db6eac9f175803bc4fd81ef096">m_riemann_solvers::e_ic</a></div><div class="ttdeci">real(kind(0d0)) e_ic</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00332">m_riemann_solvers.f90:332</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0a67704d4c227871a155d6c26590f685"><div class="ttname"><a href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">m_global_parameters::re_size</a></div><div class="ttdeci">integer, dimension(2) re_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00201">m_global_parameters.f90:201</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in system of eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00185">m_global_parameters.f90:185</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Mixture physical parameters (MPP) limits. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00122">m_global_parameters.f90:122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af329319354912b90787e0dff7cdc8a37"><div class="ttname"><a href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">m_global_parameters::we_size</a></div><div class="ttdeci">integer we_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00209">m_global_parameters.f90:209</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad138d35528cf27ff42dba00d13c269be"><div class="ttname"><a href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00187">m_global_parameters.f90:187</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_afc9d9cb504eca33ca970f4340c259161"><div class="ttname"><a href="namespacem__riemann__solvers.html#afc9d9cb504eca33ca970f4340c259161">m_riemann_solvers::rho_l</a></div><div class="ttdeci">real(kind(0d0)) rho_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00260">m_riemann_solvers.f90:260</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acdaa3827df6fee38a3e55e8b13130c27"><div class="ttname"><a href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">m_global_parameters::s_comp_n_from_prim</a></div><div class="ttdeci">subroutine s_comp_n_from_prim(vftmp, Rtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the primitive variables . </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l01072">m_global_parameters.f90:1072</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a81bfe96b264a5bba316c60965e787cbf"><div class="ttname"><a href="namespacem__riemann__solvers.html#a81bfe96b264a5bba316c60965e787cbf">m_riemann_solvers::vel_ic</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_ic</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00330">m_riemann_solvers.f90:330</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0f798e4b3d19b7d49d747cc89cbe0b69"><div class="ttname"><a href="namespacem__global__parameters.html#a0f798e4b3d19b7d49d747cc89cbe0b69">m_global_parameters::wave_speeds</a></div><div class="ttdeci">integer wave_speeds</div><div class="ttdoc">Wave speeds estimation method. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00134">m_global_parameters.f90:134</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ab0807a312841bf144ff78338bf11a89b"><div class="ttname"><a href="namespacem__riemann__solvers.html#ab0807a312841bf144ff78338bf11a89b">m_riemann_solvers::lo_pres_l</a></div><div class="ttdeci">real(kind(0d0)) lo_pres_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00297">m_riemann_solvers.f90:297</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a6301a5631fda64dd97c11777807a22c9"><div class="ttname"><a href="namespacem__riemann__solvers.html#a6301a5631fda64dd97c11777807a22c9">m_riemann_solvers::s_compute_flux_limiter</a></div><div class="ttdeci">subroutine s_compute_flux_limiter(j, k, l, flux_lim_func, norm_dir)</div><div class="ttdoc">This subroutine computes the flux limiter function value at the cell boundary. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02782">m_riemann_solvers.f90:2782</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ff480000eaa7af51481d0f17b78423"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ff480000eaa7af51481d0f17b78423">m_global_parameters::ptil</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable ptil</div><div class="ttdoc">Pressure modification. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00295">m_global_parameters.f90:295</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00191">m_global_parameters.f90:191</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a3062ef97dfec8673afd80dcbee6e3814"><div class="ttname"><a href="namespacem__riemann__solvers.html#a3062ef97dfec8673afd80dcbee6e3814">m_riemann_solvers::s_hll_riemann_solver</a></div><div class="ttdeci">subroutine, public s_hll_riemann_solver(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The procedure features the Harten, Lax and van Leer (HLL) approximate Riemann solver algorithm...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00464">m_riemann_solvers.f90:464</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4bb8b661a170fc6ccd9fa3cc4b32c960"><div class="ttname"><a href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">m_global_parameters::y_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target y_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00092">m_global_parameters.f90:92</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac5dad78660af09505fe587f052afdfd5"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac5dad78660af09505fe587f052afdfd5">m_riemann_solvers::p_k_star</a></div><div class="ttdeci">real(kind(0d0)) p_k_star</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00365">m_riemann_solvers.f90:365</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a594596688927700679b18b484a495504"><div class="ttname"><a href="namespacem__riemann__solvers.html#a594596688927700679b18b484a495504">m_riemann_solvers::vel_s</a></div><div class="ttdeci">real(kind(0d0)) vel_s</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00323">m_riemann_solvers.f90:323</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a1bf4d8c27c1ed947af13b86a63f5b3aa"><div class="ttname"><a href="namespacem__riemann__solvers.html#a1bf4d8c27c1ed947af13b86a63f5b3aa">m_riemann_solvers::v0_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable v0_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00281">m_riemann_solvers.f90:281</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a9c1dab7bfde55cdc6f738752c077f08a"><div class="ttname"><a href="namespacem__riemann__solvers.html#a9c1dab7bfde55cdc6f738752c077f08a">m_riemann_solvers::c_l</a></div><div class="ttdeci">real(kind(0d0)) c_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00269">m_riemann_solvers.f90:269</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0f2d413d9739928f8e1a98f0a5783ab9"><div class="ttname"><a href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">m_global_parameters::grid_geometry</a></div><div class="ttdeci">integer grid_geometry</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00087">m_global_parameters.f90:87</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abe054616c664c4f090dfff5ba0aa679d"><div class="ttname"><a href="namespacem__riemann__solvers.html#abe054616c664c4f090dfff5ba0aa679d">m_riemann_solvers::pres_r</a></div><div class="ttdeci">real(kind(0d0)) pres_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00262">m_riemann_solvers.f90:262</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a3874a511fdd71a444bfcc9193103e148"><div class="ttname"><a href="namespacem__riemann__solvers.html#a3874a511fdd71a444bfcc9193103e148">m_riemann_solvers::lo_alpha_rho_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable lo_alpha_rho_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00294">m_riemann_solvers.f90:294</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a30e6fe4c4ff6a8cfefa1bf882dc2e90e"><div class="ttname"><a href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">m_global_parameters::crv_size</a></div><div class="ttdeci">integer crv_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00217">m_global_parameters.f90:217</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_afe755241e6fe1e3a132aec6feab74ae4"><div class="ttname"><a href="namespacem__global__parameters.html#afe755241e6fe1e3a132aec6feab74ae4">m_global_parameters::we_wave_speeds</a></div><div class="ttdeci">logical we_wave_speeds</div><div class="ttdoc">Account for capillary effects when computing the contact wave speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00151">m_global_parameters.f90:151</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa5a48fa9cc196136634022cfa6708213"><div class="ttname"><a href="namespacem__global__parameters.html#aa5a48fa9cc196136634022cfa6708213">m_global_parameters::s_quad</a></div><div class="ttdeci">subroutine s_quad(func, mom)</div><div class="ttdoc">Computes the quadrature for polydisperse bubble populations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l01087">m_global_parameters.f90:1087</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_abe0d038aac3b3f0166c1a0c93c497e33"><div class="ttname"><a href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">m_variables_conversion::s_convert_species_to_mixture_variables_bubbles</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables_bubbles(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. Specifially designed for when subgrid bubbles must be included. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00226">m_variables_conversion.f90:226</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a68651027acd974568fd5f94ed39c8e82"><div class="ttname"><a href="namespacem__riemann__solvers.html#a68651027acd974568fd5f94ed39c8e82">m_riemann_solvers::s_compute_intercell_solution</a></div><div class="ttdeci">subroutine s_compute_intercell_solution()</div><div class="ttdoc">Computes the averaged intrercell variables for the Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02061">m_riemann_solvers.f90:2061</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae8a2bf891d899a2441210a29da0e03a1"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae8a2bf891d899a2441210a29da0e03a1">m_riemann_solvers::kappar_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable kappar_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00231">m_riemann_solvers.f90:231</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a19b6ba65c32dfc21f4762eceb25f29"><div class="ttname"><a href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">m_global_parameters::alt_soundspeed</a></div><div class="ttdeci">logical alt_soundspeed</div><div class="ttdoc">Alternate mixture sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00139">m_global_parameters.f90:139</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac5cbbc98622cdafe56142b26d67ad2d9"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac5cbbc98622cdafe56142b26d67ad2d9">m_riemann_solvers::s_r</a></div><div class="ttdeci">real(kind(0d0)) s_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00360">m_riemann_solvers.f90:360</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a2d815c8ccf9b96727876621c46f3da00"><div class="ttname"><a href="namespacem__riemann__solvers.html#a2d815c8ccf9b96727876621c46f3da00">m_riemann_solvers::alpha_rho_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_rho_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00259">m_riemann_solvers.f90:259</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7af64bd01982bc9c8e40b9a662d106c5"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7af64bd01982bc9c8e40b9a662d106c5">m_riemann_solvers::flux_lim_func</a></div><div class="ttdeci">real(kind(0d0)) flux_lim_func</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00380">m_riemann_solvers.f90:380</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a0f213519240daa52e669ecb053edae70"><div class="ttname"><a href="namespacem__riemann__solvers.html#a0f213519240daa52e669ecb053edae70">m_riemann_solvers::g8_l</a></div><div class="ttdeci">real(kind(0d0)) g8_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00317">m_riemann_solvers.f90:317</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a44eda4124cd70f22697144d295b47009"><div class="ttname"><a href="namespacem__riemann__solvers.html#a44eda4124cd70f22697144d295b47009">m_riemann_solvers::e_l</a></div><div class="ttdeci">real(kind(0d0)) e_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00263">m_riemann_solvers.f90:263</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_acf54d997ef4105fd507c180db700c873"><div class="ttname"><a href="namespacem__riemann__solvers.html#acf54d997ef4105fd507c180db700c873">m_riemann_solvers::lo_vel_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable lo_vel_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00296">m_riemann_solvers.f90:296</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_af425cfd91bc8a567e44b36c9bdbfb2bc"><div class="ttname"><a href="namespacem__riemann__solvers.html#af425cfd91bc8a567e44b36c9bdbfb2bc">m_riemann_solvers::v0_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable v0_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00281">m_riemann_solvers.f90:281</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3c3cd38abc3ece085bab77788afece73"><div class="ttname"><a href="namespacem__global__parameters.html#a3c3cd38abc3ece085bab77788afece73">m_global_parameters::weno_re_flux</a></div><div class="ttdeci">logical weno_re_flux</div><div class="ttdoc">WENO reconstruct velocity gradients for viscous stress tensor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00132">m_global_parameters.f90:132</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a9393a8d17da2a98f5061804baca0349d"><div class="ttname"><a href="namespacem__riemann__solvers.html#a9393a8d17da2a98f5061804baca0349d">m_riemann_solvers::c_r</a></div><div class="ttdeci">real(kind(0d0)) c_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00269">m_riemann_solvers.f90:269</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a53f0d5eed7783c9760aaeeaa0abbd58c"><div class="ttname"><a href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">m_global_parameters::cyl_coord</a></div><div class="ttdeci">logical cyl_coord</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00086">m_global_parameters.f90:86</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae2ad588d58b624a8320805f3860a3eb8"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae2ad588d58b624a8320805f3860a3eb8">m_riemann_solvers::s_hllc_riemann_solver</a></div><div class="ttdeci">subroutine, public s_hllc_riemann_solver(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">This procedure is the implementation of the Harten, Lax, van Leer, and contact (HLLC) approximate Rie...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00849">m_riemann_solvers.f90:849</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a16383eccdd2d0ecca7d1c26467daaaab"><div class="ttname"><a href="namespacem__riemann__solvers.html#a16383eccdd2d0ecca7d1c26467daaaab">m_riemann_solvers::s_compute_constant_states</a></div><div class="ttdeci">subroutine s_compute_constant_states(j, k, l)</div><div class="ttdoc">The procedure assigns and computes the left and right states of the Riemann problem. </div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01664">m_riemann_solvers.f90:1664</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ad1c29f933978f01c9402ad5287abdfe6"><div class="ttname"><a href="namespacem__riemann__solvers.html#ad1c29f933978f01c9402ad5287abdfe6">m_riemann_solvers::lo_alpha_rho_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable lo_alpha_rho_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00294">m_riemann_solvers.f90:294</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7b7945c133bf17eb1f25468a6d1a6925"><div class="ttname"><a href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">m_global_parameters::crv_idx</a></div><div class="ttdeci">integer, dimension(:), allocatable crv_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00218">m_global_parameters.f90:218</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abeca9cdf8ede1fe479660ab70ff789c7"><div class="ttname"><a href="namespacem__riemann__solvers.html#abeca9cdf8ede1fe479660ab70ff789c7">m_riemann_solvers::ptilde_l</a></div><div class="ttdeci">real(kind(0d0)) ptilde_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00284">m_riemann_solvers.f90:284</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a86766279fcf7527f2b148adff4666b1c"><div class="ttname"><a href="namespacem__riemann__solvers.html#a86766279fcf7527f2b148adff4666b1c">m_riemann_solvers::s_initialize_riemann_solver</a></div><div class="ttdeci">subroutine s_initialize_riemann_solver(qL_prim_vf, kappaL_vf, qR_prim_vf, kappaR_vf, q_prim_vf, flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l03531">m_riemann_solvers.f90:3531</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aab7e6bf69b7d0b8b9d911f418b872130"><div class="ttname"><a href="namespacem__riemann__solvers.html#aab7e6bf69b7d0b8b9d911f418b872130">m_riemann_solvers::s_initialize_riemann_solvers_module</a></div><div class="ttdeci">subroutine, public s_initialize_riemann_solvers_module()</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02843">m_riemann_solvers.f90:2843</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a31045aff8e978fd620943eaed4fbb973"><div class="ttname"><a href="namespacem__riemann__solvers.html#a31045aff8e978fd620943eaed4fbb973">m_riemann_solvers::re_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00270">m_riemann_solvers.f90:270</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a81537cffcfd4fb575ffaffdc1ed64028"><div class="ttname"><a href="namespacem__riemann__solvers.html#a81537cffcfd4fb575ffaffdc1ed64028">m_riemann_solvers::lo_rho_r</a></div><div class="ttdeci">real(kind(0d0)) lo_rho_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00295">m_riemann_solvers.f90:295</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae939a1e2f36044a0729480d09e05d74f"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae939a1e2f36044a0729480d09e05d74f">m_riemann_solvers::lo_vel_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable lo_vel_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00296">m_riemann_solvers.f90:296</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a6d89cb45833bdcb48f3f1b01badaedcf"><div class="ttname"><a href="namespacem__riemann__solvers.html#a6d89cb45833bdcb48f3f1b01badaedcf">m_riemann_solvers::lo_re_r</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) lo_re_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00304">m_riemann_solvers.f90:304</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4ed04ef4019b9be697d7f13b3d207a17"><div class="ttname"><a href="namespacem__global__parameters.html#a4ed04ef4019b9be697d7f13b3d207a17">m_global_parameters::tvd_wave_speeds</a></div><div class="ttdeci">logical tvd_wave_speeds</div><div class="ttdoc">Use TVD wavespeeds when computing fluxes inside Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00146">m_global_parameters.f90:146</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af2ed21959a90158c2459574230cdfcff"><div class="ttname"><a href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">m_global_parameters::web</a></div><div class="ttdeci">real(kind(0d0)) web</div><div class="ttdoc">Weber number. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00285">m_global_parameters.f90:285</a></div></div>
<div class="ttc" id="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux_html"><div class="ttname"><a href="interfacem__riemann__solvers_1_1s__compute__abstract__viscous__source__flux.html">m_riemann_solvers::s_compute_abstract_viscous_source_flux</a></div><div class="ttdoc">The abstract interface to the subroutines that are utilized to compute the viscous source fluxes for ...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00180">m_riemann_solvers.f90:180</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9dc07be63393049ae70d9dceeff403e9"><div class="ttname"><a href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">m_global_parameters::dir_flg</a></div><div class="ttdeci">real(kind(0d0)), dimension(3) dir_flg</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00227">m_global_parameters.f90:227</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a6c0b79ed34cb9be88abdd713eb207295"><div class="ttname"><a href="namespacem__riemann__solvers.html#a6c0b79ed34cb9be88abdd713eb207295">m_riemann_solvers::pres_ic</a></div><div class="ttdeci">real(kind(0d0)) pres_ic</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00331">m_riemann_solvers.f90:331</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aba768ee53f47327a70508a913b55254d"><div class="ttname"><a href="namespacem__riemann__solvers.html#aba768ee53f47327a70508a913b55254d">m_riemann_solvers::s_pressure_function</a></div><div class="ttdeci">subroutine s_pressure_function(f_K, dfdp_K, pres, side)</div><div class="ttdoc">The purpose of this subroutine is to evaluate the pressure functions f_K in the exact Riemann solver...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01934">m_riemann_solvers.f90:1934</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a6c143ed17587d6f4b1a39e1f49e030e8"><div class="ttname"><a href="namespacem__riemann__solvers.html#a6c143ed17587d6f4b1a39e1f49e030e8">m_riemann_solvers::rho_star</a></div><div class="ttdeci">real(kind(0d0)) rho_star</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00365">m_riemann_solvers.f90:365</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abf27be79fc84bb7830520e08774fd56c"><div class="ttname"><a href="namespacem__riemann__solvers.html#abf27be79fc84bb7830520e08774fd56c">m_riemann_solvers::lo_e_l</a></div><div class="ttdeci">real(kind(0d0)) lo_e_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00298">m_riemann_solvers.f90:298</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac99e69e03846f742aa0ce5e228d5167f"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac99e69e03846f742aa0ce5e228d5167f">m_riemann_solvers::lo_rho_l</a></div><div class="ttdeci">real(kind(0d0)) lo_rho_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00295">m_riemann_solvers.f90:295</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a2378fe152ecbad0e98558ae177297493"><div class="ttname"><a href="namespacem__riemann__solvers.html#a2378fe152ecbad0e98558ae177297493">m_riemann_solvers::dpres_we</a></div><div class="ttdeci">real(kind(0d0)) dpres_we</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00338">m_riemann_solvers.f90:338</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0670171466cd1ce584495face34cc4de"><div class="ttname"><a href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, k, l, r)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00306">m_variables_conversion.f90:306</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a334d729c58a5c746cb0045d1f5f00b01"><div class="ttname"><a href="namespacem__riemann__solvers.html#a334d729c58a5c746cb0045d1f5f00b01">m_riemann_solvers::s_compute_viscous_source_flux</a></div><div class="ttdeci">procedure(s_compute_abstract_viscous_source_flux), pointer s_compute_viscous_source_flux</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00404">m_riemann_solvers.f90:404</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a4b6ffaeeaa4365c642ef3a5295635b07"><div class="ttname"><a href="namespacem__riemann__solvers.html#a4b6ffaeeaa4365c642ef3a5295635b07">m_riemann_solvers::nbub_r</a></div><div class="ttdeci">real(kind(0d0)) nbub_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00279">m_riemann_solvers.f90:279</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ab679d890c95c6cb1ee3dc5e5a9ae1c19"><div class="ttname"><a href="namespacem__riemann__solvers.html#ab679d890c95c6cb1ee3dc5e5a9ae1c19">m_riemann_solvers::s_finalize_riemann_solver</a></div><div class="ttdeci">subroutine s_finalize_riemann_solver(flux_vf, flux_src_vf, flux_gsrc_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">Deallocation and/or disassociation procedures that are needed to finalize the selected Riemann proble...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l05244">m_riemann_solvers.f90:5244</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aac5ed9f316eeebbe04258bb1120cbea4"><div class="ttname"><a href="namespacem__global__parameters.html#aac5ed9f316eeebbe04258bb1120cbea4">m_global_parameters::internalenergies_idx</a></div><div class="ttdeci">type(bounds_info) internalenergies_idx</div><div class="ttdoc">Indexes of first &amp; last internal energy eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00190">m_global_parameters.f90:190</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acbb163a79ff0011a4327c3fb65a04c14"><div class="ttname"><a href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">m_global_parameters::flux_lim</a></div><div class="ttdeci">integer flux_lim</div><div class="ttdoc">Choice of flux limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00147">m_global_parameters.f90:147</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a70fefa4f5849fa4c952030b0ac04482a"><div class="ttname"><a href="namespacem__riemann__solvers.html#a70fefa4f5849fa4c952030b0ac04482a">m_riemann_solvers::qr_prim_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable qr_prim_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00221">m_riemann_solvers.f90:221</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a585a72037bbffe12e8d4512a57f52418"><div class="ttname"><a href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">m_global_parameters::r0</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable r0</div><div class="ttdoc">Bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00288">m_global_parameters.f90:288</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_abff32786a11d3a71828b4e30d26773fb"><div class="ttname"><a href="namespacem__riemann__solvers.html#abff32786a11d3a71828b4e30d26773fb">m_riemann_solvers::h_avg</a></div><div class="ttdeci">real(kind(0d0)) h_avg</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00349">m_riemann_solvers.f90:349</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac90ee6bf146aa47944bb11cd5de0a580"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac90ee6bf146aa47944bb11cd5de0a580">m_riemann_solvers::pi_inf_l</a></div><div class="ttdeci">real(kind(0d0)) pi_inf_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00268">m_riemann_solvers.f90:268</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a45a3cc332ef2fd7fc391a4ae82763f1a"><div class="ttname"><a href="namespacem__riemann__solvers.html#a45a3cc332ef2fd7fc391a4ae82763f1a">m_riemann_solvers::rho_ic</a></div><div class="ttdeci">real(kind(0d0)) rho_ic</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00329">m_riemann_solvers.f90:329</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a1adcb619a7800a87bf5785ca59c63233"><div class="ttname"><a href="namespacem__riemann__solvers.html#a1adcb619a7800a87bf5785ca59c63233">m_riemann_solvers::s_compute_direct_wave_speeds</a></div><div class="ttdeci">subroutine s_compute_direct_wave_speeds(j, k, l)</div><div class="ttdoc">The direct estimation of the left, right and middle wave speeds, proposed by Batten et al...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l02640">m_riemann_solvers.f90:2640</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ad056500eedb3761b13485edb94ec773e"><div class="ttname"><a href="namespacem__riemann__solvers.html#ad056500eedb3761b13485edb94ec773e">m_riemann_solvers::lo_c_r</a></div><div class="ttdeci">real(kind(0d0)) lo_c_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00303">m_riemann_solvers.f90:303</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8d670f2f984167bae71b7b3f12d0908a"><div class="ttname"><a href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">m_global_parameters::polytropic</a></div><div class="ttdeci">logical polytropic</div><div class="ttdoc">Polytropic switch. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00291">m_global_parameters.f90:291</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a09cb56d16d4e4c5300be1ceee6e15acf"><div class="ttname"><a href="namespacem__riemann__solvers.html#a09cb56d16d4e4c5300be1ceee6e15acf">m_riemann_solvers::rho_avg</a></div><div class="ttdeci">real(kind(0d0)) rho_avg</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00347">m_riemann_solvers.f90:347</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a04ac565bad2b22dc045a5eeb4f516e2e"><div class="ttname"><a href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">m_mpi_proxy::s_mpi_abort</a></div><div class="ttdeci">subroutine s_mpi_abort()</div><div class="ttdoc">The subroutine terminates the MPI execution environment. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00104">m_mpi_proxy.f90:104</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a3e2b4d51fda04b61d6f54069c5bb66c6"><div class="ttname"><a href="namespacem__riemann__solvers.html#a3e2b4d51fda04b61d6f54069c5bb66c6">m_riemann_solvers::s_compute_wave_speeds</a></div><div class="ttdeci">procedure(s_compute_abstract_wave_speeds), pointer s_compute_wave_speeds</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00398">m_riemann_solvers.f90:398</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a74301c7719264f4c4ca9ab6318a438cb"><div class="ttname"><a href="namespacem__riemann__solvers.html#a74301c7719264f4c4ca9ab6318a438cb">m_riemann_solvers::e_star</a></div><div class="ttdeci">real(kind(0d0)) e_star</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00365">m_riemann_solvers.f90:365</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ada8ab10b02113187113eed8f49f1ed2d"><div class="ttname"><a href="namespacem__riemann__solvers.html#ada8ab10b02113187113eed8f49f1ed2d">m_riemann_solvers::re_avg_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable re_avg_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00353">m_riemann_solvers.f90:353</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aeab4abb9a37e1f537fee511bdcadc9da"><div class="ttname"><a href="namespacem__riemann__solvers.html#aeab4abb9a37e1f537fee511bdcadc9da">m_riemann_solvers::s_compute_capillary_source_flux</a></div><div class="ttdeci">subroutine s_compute_capillary_source_flux(dalphaL_dx_vf, dalphaL_dy_vf, dalphaL_dz_vf, gm_alphaL_vf, dalphaR_dx_vf, dalphaR_dy_vf, dalphaR_dz_vf, gm_alphaR_vf, flux_src_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The purpose of the subroutine is to evaluate and account for the contribution of capillary stresses i...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l04810">m_riemann_solvers.f90:4810</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a75cca68e31742083e0ebbef418300c78"><div class="ttname"><a href="namespacem__riemann__solvers.html#a75cca68e31742083e0ebbef418300c78">m_riemann_solvers::lo_h_l</a></div><div class="ttdeci">real(kind(0d0)) lo_h_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00299">m_riemann_solvers.f90:299</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ae82ad8216dcc6938b86cf0bd5c17467b"><div class="ttname"><a href="namespacem__riemann__solvers.html#ae82ad8216dcc6938b86cf0bd5c17467b">m_riemann_solvers::s_populate_riemann_states_variables_buffers</a></div><div class="ttdeci">subroutine s_populate_riemann_states_variables_buffers(qL_prim_vf, dqL_prim_dx_vf, dqL_prim_dy_vf, dqL_prim_dz_vf, gm_alphaL_vf, kappaL_vf, qR_prim_vf, dqR_prim_dx_vf, dqR_prim_dy_vf, dqR_prim_dz_vf, gm_alphaR_vf, kappaR_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The purpose of this subroutine is to populate the buffers of the left and right Riemann states variab...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l03002">m_riemann_solvers.f90:3002</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a50ff087624d23846c62cd711dd003757"><div class="ttname"><a href="namespacem__riemann__solvers.html#a50ff087624d23846c62cd711dd003757">m_riemann_solvers::s_compute_cylindrical_viscous_source_flux</a></div><div class="ttdeci">subroutine s_compute_cylindrical_viscous_source_flux(velL_vf, dvelL_dx_vf, dvelL_dy_vf, dvelL_dz_vf, velR_vf, dvelR_dx_vf, dvelR_dy_vf, dvelR_dz_vf, flux_src_vf, norm_dir, ix, iy, iz)</div><div class="ttdoc">The goal of this subroutine is to evaluate and account for the contribution of viscous stresses in th...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l03820">m_riemann_solvers.f90:3820</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a122bd2abb655fffd36e070fa376c131d"><div class="ttname"><a href="namespacem__riemann__solvers.html#a122bd2abb655fffd36e070fa376c131d">m_riemann_solvers::gamma_avg</a></div><div class="ttdeci">real(kind(0d0)) gamma_avg</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00351">m_riemann_solvers.f90:351</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a7bf84258c88a5e2c0accdc130ac812d9"><div class="ttname"><a href="namespacem__riemann__solvers.html#a7bf84258c88a5e2c0accdc130ac812d9">m_riemann_solvers::s_compute_average_state</a></div><div class="ttdeci">procedure(s_compute_abstract_average_state), pointer s_compute_average_state</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00393">m_riemann_solvers.f90:393</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a947bc1c7da743ee0820ff6648fef3c25"><div class="ttname"><a href="namespacem__riemann__solvers.html#a947bc1c7da743ee0820ff6648fef3c25">m_riemann_solvers::s_compute_star_region</a></div><div class="ttdeci">subroutine s_compute_star_region()</div><div class="ttdoc">The purpose of this subroutine is to compute the solution for pressure and velocity in the star regio...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l01891">m_riemann_solvers.f90:1891</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_afe077d6837688601705ac13df3d9c3dc"><div class="ttname"><a href="namespacem__riemann__solvers.html#afe077d6837688601705ac13df3d9c3dc">m_riemann_solvers::q_prim_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable q_prim_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00222">m_riemann_solvers.f90:222</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_ac585ca9198161cf6d9130b696a2f1196"><div class="ttname"><a href="namespacem__riemann__solvers.html#ac585ca9198161cf6d9130b696a2f1196">m_riemann_solvers::h_r</a></div><div class="ttdeci">real(kind(0d0)) h_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00264">m_riemann_solvers.f90:264</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a44476fe6f5a4cfd8e7bd9b7369a2bfd8"><div class="ttname"><a href="namespacem__riemann__solvers.html#a44476fe6f5a4cfd8e7bd9b7369a2bfd8">m_riemann_solvers::g1_r</a></div><div class="ttdeci">real(kind(0d0)) g1_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00310">m_riemann_solvers.f90:310</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a298482aa3e595dfe2401920ad841eb8f"><div class="ttname"><a href="namespacem__riemann__solvers.html#a298482aa3e595dfe2401920ad841eb8f">m_riemann_solvers::we_avg_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:,:), allocatable we_avg_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00354">m_riemann_solvers.f90:354</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_addd3d84b7a9bae473b0c17744d5cac31"><div class="ttname"><a href="namespacem__riemann__solvers.html#addd3d84b7a9bae473b0c17744d5cac31">m_riemann_solvers::ptilde_r</a></div><div class="ttdeci">real(kind(0d0)) ptilde_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00284">m_riemann_solvers.f90:284</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa4fd04af7adfbb38e425f6e91e041ecc"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa4fd04af7adfbb38e425f6e91e041ecc">m_riemann_solvers::ql_prim_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable ql_prim_rs_vf</div><div class="ttdoc">The left (L) and right (R) WENO-reconstructed cell-boundary values of the cell-average primitive vari...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00220">m_riemann_solvers.f90:220</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a0fd22ed964af8ed09333c72744f561bd"><div class="ttname"><a href="namespacem__riemann__solvers.html#a0fd22ed964af8ed09333c72744f561bd">m_riemann_solvers::vel_avg</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel_avg</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00348">m_riemann_solvers.f90:348</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aee9f1299db2c29eabb5d2ef096f0abe0"><div class="ttname"><a href="namespacem__riemann__solvers.html#aee9f1299db2c29eabb5d2ef096f0abe0">m_riemann_solvers::vel_src_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable vel_src_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00250">m_riemann_solvers.f90:250</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module features a database of subroutines that allow for the conversion of state variables from ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00047">m_variables_conversion.f90:47</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a5e4f81b0b96e326a19154e0a4b8ae01a"><div class="ttname"><a href="namespacem__riemann__solvers.html#a5e4f81b0b96e326a19154e0a4b8ae01a">m_riemann_solvers::tvd_xi_p</a></div><div class="ttdeci">real(kind(0d0)) tvd_xi_p</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00385">m_riemann_solvers.f90:385</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a2b69a3c582d14aba043c3cb6376335a5"><div class="ttname"><a href="namespacem__riemann__solvers.html#a2b69a3c582d14aba043c3cb6376335a5">m_riemann_solvers::p0_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable p0_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00282">m_riemann_solvers.f90:282</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type annexing beginning and ending bounds information. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00064">m_derived_types.f90:64</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aad491932ac39e9c830cb24d395a00c3c"><div class="ttname"><a href="namespacem__riemann__solvers.html#aad491932ac39e9c830cb24d395a00c3c">m_riemann_solvers::lo_xi_p</a></div><div class="ttdeci">real(kind(0d0)) lo_xi_p</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00384">m_riemann_solvers.f90:384</a></div></div>
<div class="ttc" id="interfacem__riemann__solvers_1_1s__abstract__riemann__solver_html"><div class="ttname"><a href="interfacem__riemann__solvers_1_1s__abstract__riemann__solver.html">m_riemann_solvers::s_abstract_riemann_solver</a></div><div class="ttdoc">Abstract interface to the subroutines that are utilized to compute the Riemann problem solution...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00107">m_riemann_solvers.f90:107</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a90256be0540e3f9279305be0e9ab32f4"><div class="ttname"><a href="namespacem__riemann__solvers.html#a90256be0540e3f9279305be0e9ab32f4">m_riemann_solvers::is3</a></div><div class="ttdeci">type(bounds_info) is3</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00411">m_riemann_solvers.f90:411</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6769808569174ff0eef096e958889837"><div class="ttname"><a href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">m_global_parameters::bc_z</a></div><div class="ttdeci">type(bounds_info) bc_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a83a70908c66bbb071647bb383dc72975"><div class="ttname"><a href="namespacem__riemann__solvers.html#a83a70908c66bbb071647bb383dc72975">m_riemann_solvers::s_l</a></div><div class="ttdeci">real(kind(0d0)) s_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00360">m_riemann_solvers.f90:360</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a925187e709792a5fcfa80daebd568e8f"><div class="ttname"><a href="namespacem__riemann__solvers.html#a925187e709792a5fcfa80daebd568e8f">m_riemann_solvers::pi_inf_r</a></div><div class="ttdeci">real(kind(0d0)) pi_inf_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00268">m_riemann_solvers.f90:268</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">The module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aec97838cc58623019b07ae47da7f4c1c"><div class="ttname"><a href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">m_global_parameters::sgm_eps</a></div><div class="ttdeci">real(kind(0d0)), parameter sgm_eps</div><div class="ttdoc">Segmentation tolerance. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00061">m_global_parameters.f90:61</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_aa6e6b00985be177b0a4a92f1aed48629"><div class="ttname"><a href="namespacem__riemann__solvers.html#aa6e6b00985be177b0a4a92f1aed48629">m_riemann_solvers::kappa_avg</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable kappa_avg</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00355">m_riemann_solvers.f90:355</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_af0757998bd9843f9bb978a600d0ae2b0"><div class="ttname"><a href="namespacem__riemann__solvers.html#af0757998bd9843f9bb978a600d0ae2b0">m_riemann_solvers::r0_l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable r0_l</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00280">m_riemann_solvers.f90:280</a></div></div>
<div class="ttc" id="interfacem__riemann__solvers_1_1s__compute__abstract__average__state_html"><div class="ttname"><a href="interfacem__riemann__solvers_1_1s__compute__abstract__average__state.html">m_riemann_solvers::s_compute_abstract_average_state</a></div><div class="ttdoc">The abstract interface to the subroutines that are used to calculate the Roe and arithmetic average s...</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00155">m_riemann_solvers.f90:155</a></div></div>
<div class="ttc" id="namespacem__riemann__solvers_html_a5e682fb9d377f50935dfbe4d5dd67120"><div class="ttname"><a href="namespacem__riemann__solvers.html#a5e682fb9d377f50935dfbe4d5dd67120">m_riemann_solvers::lo_pi_inf_r</a></div><div class="ttdeci">real(kind(0d0)) lo_pi_inf_r</div><div class="ttdef"><b>Definition:</b> <a href="m__riemann__solvers_8f90_source.html#l00302">m_riemann_solvers.f90:302</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3981c7e6886ba3cde245ce4dcc6ca664"><div class="ttname"><a href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">m_global_parameters::mixture_err</a></div><div class="ttdeci">logical mixture_err</div><div class="ttdoc">Mixture properties correction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00143">m_global_parameters.f90:143</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdoc">Bubbles on/off. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00290">m_global_parameters.f90:290</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cff1091173cf1fe67371edd427ba236f.html">simulation_code</a></li><li class="navelem"><a class="el" href="m__riemann__solvers_8f90.html">m_riemann_solvers.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
