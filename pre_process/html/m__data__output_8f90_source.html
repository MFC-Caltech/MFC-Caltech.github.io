<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Pre_process: m_data_output.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Pre_process
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__data__output_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_data_output.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__data__output_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacem__data__output.html">   39</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__data__output.html">m_data_output</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>         !&lt; definitions of the derived types</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>     !&lt; global parameters for the code</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>             !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">USE </span>mpi                     !&lt; message passing interface (mpi) module</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__compile__specific.html">m_compile_specific</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__data__output.html#abaf86e34cd05a2227a23bcef0671a391">s_write_serial_data_files</a>, &amp;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                       <a class="code" href="namespacem__data__output.html#a12a171700eb3f8a63d17c01a0033cf39">s_write_parallel_data_files</a>, &amp;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                       <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a>, &amp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                       <a class="code" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">s_initialize_data_output_module</a>, &amp;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                       <a class="code" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">s_finalize_data_output_module</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    abstract <span class="keyword">INTERFACE</span> <span class="comment">! ===================================================</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="interfacem__data__output_1_1s__write__abstract__data__files.html">   69</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__data__output_1_1s__write__abstract__data__files.html">s_write_abstract_data_files</a>(q_cons_vf)</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="interfacem__data__output_1_1s__write__abstract__data__files.html#ae1ed4cd5dd22a52d0d7e91a127452b80">   70</a></span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordtype">IMPORT </span>:: <a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">! Conservative variables</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__data__output_1_1s__write__abstract__data__files.html">s_write_abstract_data_files</a> <span class="comment">! -------------------</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">    END INTERFACE </span><span class="comment">! ========================================================</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">   84</a></span>&#160;    <span class="keywordtype">CHARACTER(LEN = path_len + 2*name_len)</span>, <span class="keywordtype">PRIVATE</span> :: <a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    </div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">   87</a></span>&#160;    <span class="keywordtype">CHARACTER(LEN = path_len + 2*name_len)</span>, <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">   90</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__data__output_1_1s__write__abstract__data__files.html">s_write_abstract_data_files</a>), <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; null()</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#abaf86e34cd05a2227a23bcef0671a391">s_write_serial_data_files</a>(q_cons_vf) <span class="comment">! -----------</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#abaf86e34cd05a2227a23bcef0671a391">   98</a></span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordtype">LOGICAL</span> :: file_exist</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordtype">CHARACTER(LEN=15)</span> :: FMT</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordtype">CHARACTER</span>(len = &amp;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            int(floor(log10(<span class="keywordtype">REAL</span>(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>, kind(0d0))))) + 1) :: file_num</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordtype">CHARACTER(LEN = LEN_TRIM(t_step_dir) + name_len)</span> :: file_loc</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            </div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordtype">INTEGER</span> :: t_step</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;           </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(nb)</span> :: nRtmp</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nbub</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma, lit_gamma, pi_inf</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            t_step = 0</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="comment">! Outputting the Locations of the Cell-boundaries ==================</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="comment">! x-coordinate direction</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/x_cb.dat&#39;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keyword">OPEN</span>(1, file = trim(file_loc), form = <span class="stringliteral">&#39;unformatted&#39;</span>, status = <span class="stringliteral">&#39;new&#39;</span>)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keyword">WRITE</span>(1) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keyword">CLOSE</span>(1)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="comment">! y- and z-coordinate directions</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="comment">! y-coordinate direction</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/y_cb.dat&#39;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keyword">OPEN</span>(1, file = trim(file_loc), form = <span class="stringliteral">&#39;unformatted&#39;</span>, &amp;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        status = <span class="stringliteral">&#39;new&#39;</span>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keyword">WRITE</span>(1) <a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keyword">CLOSE</span>(1)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="comment">! z-coordinate direction</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/z_cb.dat&#39;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <span class="keyword">OPEN</span>(1, file = trim(file_loc), form = <span class="stringliteral">&#39;unformatted&#39;</span>, &amp;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                            status = <span class="stringliteral">&#39;new&#39;</span>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="keyword">WRITE</span>(1) <a class="code" href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">z_cb</a></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    <span class="keyword">CLOSE</span>(1)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="comment">! Outputting Conservative Variables ================================</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keyword">WRITE</span>(file_num, <span class="stringliteral">&#39;(I0)&#39;</span>) i</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/q_cons_vf&#39;</span> // trim(file_num) &amp;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                       // <span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keyword">OPEN</span>(1, file = trim(file_loc), form = <span class="stringliteral">&#39;unformatted&#39;</span>, &amp;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    status = <span class="stringliteral">&#39;new&#39;</span>)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keyword">WRITE</span>(1) q_cons_vf(i)%sf</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keyword">CLOSE</span>(1)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    </div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            gamma = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            lit_gamma = 1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1d0</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            pi_inf = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">precision</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                fmt=<span class="stringliteral">&quot;(2F30.7)&quot;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                fmt=<span class="stringliteral">&quot;(2F40.14)&quot;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="comment">!1D</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> ==0 .AND. <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> ==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="comment">! writting an output directory</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keyword">WRITE</span>(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>,<span class="stringliteral">&#39;(A,I0,A,I0)&#39;</span>) trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/D&#39;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/.&#39;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keyword">INQUIRE</span>( file = trim(file_loc), exist = file_exist )</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            </div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keywordflow">IF</span>(.NOT.file_exist) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>))</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        <span class="keyword">WRITE</span>(file_loc,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/prim.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        <span class="keyword">OPEN</span>(2,file= trim(file_loc) )</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a>( q_cons_vf, j, 0, 0, rho, gamma, pi_inf)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                lit_gamma = 1d0/gamma + 1d0</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                <span class="keywordflow">IF</span> ( ((i.ge.<a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%beg) .AND. (i.le.<a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end))    &amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                          .OR.                          &amp;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                     ((i.ge.<a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg)  .AND. (i.le.<a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end))     &amp;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                                         ) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),q_cons_vf(i)%sf(j,0,0)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i.eq.<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg) <span class="keywordflow">THEN</span> <span class="comment">!u</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg)%sf(j,0,0)/rho</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i.eq.<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>) <span class="keywordflow">THEN</span> <span class="comment">!p</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                        <span class="comment">!Tait pressure from density</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j), &amp;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a> + pi_inf) * (                     &amp;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                            ( q_cons_vf(1)%sf(j,0,0)/               &amp;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.d0-q_cons_vf(4)%sf(j,0,0)))  &amp; </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                            ) ** lit_gamma )                        &amp;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                            - pi_inf</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                        <span class="comment">!Stiffened gas pressure from energy</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j), &amp;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                            (                                       &amp; </div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                            q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,0,0)  -            &amp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                            0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg)%sf(j,0,0)**2.d0)/rho - &amp;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                            pi_inf &amp;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                            ) / gamma</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                        <span class="comment">!Stiffened gas pressure from energy with bubbles</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j), &amp;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                            (                                       &amp; </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                            (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,0,0)  -            &amp;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                            0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg)%sf(j,0,0)**2.d0)/rho) / &amp;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                            (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,0,0)) - &amp;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                            pi_inf &amp;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                            ) / gamma</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((i .GT. <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                    <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                        nrtmp(k) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(j,0,0)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,0,0), nrtmp, nbub)                                </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                    </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),q_cons_vf(i)%sf(j,0,0)/nbub</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>    </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    <span class="keyword">WRITE</span>(file_loc,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/cons.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <span class="keyword">OPEN</span>(2,file= trim(file_loc) )</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                            <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),q_cons_vf(i)%sf(j,0,0)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="comment">!2D</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> ==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keyword">WRITE</span>(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>,<span class="stringliteral">&#39;(A,I0,A,I0)&#39;</span>) trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/D&#39;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/.&#39;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keyword">INQUIRE</span>( file      = trim(file_loc), exist     = file_exist       )</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">IF</span>(.not.file_exist) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>))</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <span class="keyword">WRITE</span>(file_loc,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/prim.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <span class="keyword">OPEN</span>(2,file=trim(file_loc) )</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <span class="keywordflow">DO</span> k=0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a>( q_cons_vf, j, k, 0, rho, gamma, pi_inf)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                            lit_gamma = 1d0/gamma + 1d0</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                            </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                            <span class="keywordflow">IF</span> (i==1 .OR. i==5) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k),q_cons_vf(i)%sf(j,k,0)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i==2 .OR. i==3) <span class="keywordflow">THEN</span> <span class="comment">!u</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k),q_cons_vf(i)%sf(j,k,0)/rho</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i==4) <span class="keywordflow">THEN</span> <span class="comment">!p</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k), &amp;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf) *                     &amp;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                        ((                                               &amp; </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                        q_cons_vf(1)%sf(j,k,0)/                          &amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.-q_cons_vf(4)%sf(j,k,0)))             &amp; </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                        ) ** (1./<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1.)) - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                    <span class="comment">!Stiffened gas pressure from energy</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k), &amp;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                        (                                       &amp; </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                        q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,0)  -            &amp;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                        0.5d0*(q_cons_vf(2)%sf(j,k,0)**2.d0)/rho - &amp;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                        pi_inf &amp;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                        ) / gamma</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                    <span class="comment">!Stiffened gas pressure from energy with bubbles</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k), &amp;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                        (                                       &amp; </div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                        (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,0)  -            &amp;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                        0.5d0*( q_cons_vf(2)%sf(j,k,0)**2.d0 + q_cons_vf(3)%sf(j,k,0)**2.d0 ) &amp;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                        / rho) / &amp;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                        (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,0)) - &amp;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                        pi_inf &amp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                        ) / gamma</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( (i .GT. <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                <span class="keywordflow">DO</span> l = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                    nrtmp(l) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(l))%sf(j,k,0)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,0), nrtmp, nbub)                                </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j), <a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k), q_cons_vf(i)%sf(j,k,0)/nbub</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">                           END IF</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <span class="keyword">WRITE</span>(file_loc,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/cons.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    <span class="keyword">OPEN</span>(2,file= trim(file_loc) )</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        <span class="keywordflow">DO</span> k=0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                            <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k),q_cons_vf(i)%sf(j,k,0)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">! 3D</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    <span class="keyword">WRITE</span>(file_loc,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/cons.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keyword">OPEN</span>(2,file= trim(file_loc) )</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        <span class="keywordflow">DO</span> k=0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <span class="keywordflow">DO</span> l=0,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                            <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>(k),<a class="code" href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">z_cb</a>(l), q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#abaf86e34cd05a2227a23bcef0671a391">s_write_serial_data_files</a> <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a12a171700eb3f8a63d17c01a0033cf39">s_write_parallel_data_files</a>(q_cons_vf) <span class="comment">! --</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a12a171700eb3f8a63d17c01a0033cf39">  352</a></span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">! Conservative variables</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordtype">INTEGER</span> :: ifile, ierr, data_size</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(MPI_STATUS_SIZE)</span> :: status</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: disp</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: m_MOK, n_MOK, p_MOK</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: WP_MOK, var_MOK, str_MOK</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: NVARS_MOK</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: MOK</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordtype">CHARACTER(LEN=path_len + 2*name_len)</span> :: file_loc </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordtype">LOGICAL</span> :: file_exist</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">! Generic loop iterator</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="comment">! Initialize MPI data I/O</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">s_initialize_mpi_data</a>(q_cons_vf)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="comment">! Open the file to write all flow variables</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keyword">WRITE</span>(file_loc, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;0.dat&#39;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            file_loc = trim(<a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a>) // trim(<a class="code" href="namespacem__global__parameters.html#ad4713c1e89eaa8fac3bb2181ba87b192">mpiiofs</a>) // trim(file_loc)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keyword">INQUIRE</span>(file = trim(file_loc),exist = file_exist)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">IF</span> (file_exist .AND. <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="keyword">CALL </span>mpi_file_delete(file_loc,<a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ierr)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keyword">CALL </span>mpi_file_open(mpi_comm_world,file_loc,ior(mpi_mode_wronly,mpi_mode_create),&amp;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ifile,ierr)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="comment">! Size of local arrays</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            data_size = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="comment">! Resize some integers so MPI can write even the biggest files</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            m_mok     = int(<a class="code" href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_glb</a>+1,  mpi_offset_kind)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            n_mok     = int(<a class="code" href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">n_glb</a>+1,  mpi_offset_kind)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            p_mok     = int(<a class="code" href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">p_glb</a>+1,  mpi_offset_kind)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            wp_mok    = int(8d0,      mpi_offset_kind)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            mok       = int(1d0,      mpi_offset_kind)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            str_mok   = int(<a class="code" href="namespacem__global__parameters.html#ac8252b115e717c6f1c8595be6f897df7">name_len</a>, mpi_offset_kind)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            nvars_mok = int(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>, mpi_offset_kind)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            </div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="comment">! Write the data for each variable</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a><span class="comment">! adv_idx%end</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                var_mok = int(i, mpi_offset_kind)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="comment">! Initial displacement to skip at beginning of file</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                disp = m_mok*max(mok,n_mok)*max(mok,p_mok)*wp_mok*(var_mok-1)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keyword">CALL </span>mpi_file_set_view(ifile,disp,mpi_double_precision,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i), &amp;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                            <span class="stringliteral">&#39;native&#39;</span>,<a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ierr)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keyword">CALL </span>mpi_file_write_all(ifile,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(i)%sf,data_size, &amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            mpi_double_precision,status,ierr)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                var_mok = int(i, mpi_offset_kind)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="comment">! Initial displacement to skip at beginning of file</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                disp = m_mok*max(mok,n_mok)*max(mok,p_mok)*wp_mok*(var_mok-1)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keyword">CALL </span>mpi_file_set_view(ifile,disp,mpi_double_precision,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i), &amp;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            <span class="stringliteral">&#39;native&#39;</span>,<a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ierr)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keyword">CALL </span>mpi_file_write_all(ifile,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(i)%sf,data_size, &amp;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            mpi_double_precision,status,ierr)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keyword">CALL </span>mpi_file_close(ifile,ierr)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a12a171700eb3f8a63d17c01a0033cf39">s_write_parallel_data_files</a> <span class="comment">! ---------------------------</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">s_initialize_data_output_module</a>() <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">  432</a></span>&#160;            <span class="comment">! Generic string used to store the address of a particular file</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordtype">CHARACTER(LEN = LEN_TRIM(case_dir) + 2*name_len)</span> :: file_loc</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="comment">! Generic logical used to check the existence of directories</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordtype">LOGICAL</span> :: dir_check</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="comment">! Setting the address of the time-step directory</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keyword">WRITE</span>(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>, <span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&#39;/p_all/p&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;/0&#39;</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a> = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="comment">! Checking the existence of the time-step directory, removing it, if</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="comment">! it exists, and creating a new copy. Note that if preexisting grid</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <span class="comment">! and/or initial condition data are to be read in from the very same</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="comment">! location, then the above described steps are not executed here but</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <span class="comment">! rather in the module m_start_up.f90.</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    file_loc = trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>) // <span class="stringliteral">&#39;/&#39;</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    </div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__compile__specific.html#aa7f14da74305c1d061ce326b16a3263e">my_inquire</a>(file_loc,dir_check)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    <span class="keywordflow">IF</span>(dir_check) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;rm -rf &#39;</span> // trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>))</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(<a class="code" href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">t_step_dir</a>))</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;             </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; <a class="code" href="namespacem__data__output.html#abaf86e34cd05a2227a23bcef0671a391">s_write_serial_data_files</a></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="keyword">WRITE</span>(<a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a>, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;/restart_data&#39;</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a> = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // trim(<a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a>)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) .AND. (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    file_loc = trim(<a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a>) // <span class="stringliteral">&#39;/&#39;</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__compile__specific.html#aa7f14da74305c1d061ce326b16a3263e">my_inquire</a>(file_loc,dir_check)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    <span class="keywordflow">IF</span> (dir_check) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;rm -rf &#39;</span> // trim(<a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a>))</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(<a class="code" href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">restart_dir</a>))</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">s_mpi_barrier</a>()</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; <a class="code" href="namespacem__data__output.html#a12a171700eb3f8a63d17c01a0033cf39">s_write_parallel_data_files</a></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">s_initialize_data_output_module</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        </div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">s_finalize_data_output_module</a>() <span class="comment">! ---------------------------</span></div><div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">  487</a></span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; null()</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">s_finalize_data_output_module</a> <span class="comment">! -------------------------</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        </div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__data__output.html">m_data_output</a></div><div class="ttc" id="namespacem__data__output_html_aba17ac5a2fbc723664abf5c17e07c4e8"><div class="ttname"><a href="namespacem__data__output.html#aba17ac5a2fbc723664abf5c17e07c4e8">m_data_output::t_step_dir</a></div><div class="ttdeci">character(len=path_len+2 *name_len), private t_step_dir</div><div class="ttdoc">Time-step folder into which grid and initial condition data will be placed. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00084">m_data_output.f90:84</a></div></div>
<div class="ttc" id="namespacem__data__output_html"><div class="ttname"><a href="namespacem__data__output.html">m_data_output</a></div><div class="ttdoc">This module takes care of writing the grid and initial condition data files into the &quot;0&quot; time-step di...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00039">m_data_output.f90:39</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_abfbc42cea69273bc9fa4a2d78f636eb1"><div class="ttname"><a href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">m_mpi_proxy::s_mpi_barrier</a></div><div class="ttdeci">subroutine s_mpi_barrier()</div><div class="ttdoc">Halts all processes until all have reached barrier. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00140">m_mpi_proxy.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00180">m_global_parameters.f90:180</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adab11dab474410541d4c37725bea01e1"><div class="ttname"><a href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">m_global_parameters::n_glb</a></div><div class="ttdeci">integer n_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00074">m_global_parameters.f90:74</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2663d07998d11d25e223cd7ad0bbd748"><div class="ttname"><a href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">m_global_parameters::mpi_info_int</a></div><div class="ttdeci">integer mpi_info_int</div><div class="ttdoc">MPI info for parallel IO with Lustre file systems. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00161">m_global_parameters.f90:161</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">This module contains all of the parameters characterizing the computational domain, simulation algorithm, initial condition and the stiffened equation of state. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00037">m_global_parameters.f90:37</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00047">m_derived_types.f90:47</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a971692c50b4725d4724238b8a01a722e"><div class="ttname"><a href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">m_global_parameters::old_grid</a></div><div class="ttdeci">logical old_grid</div><div class="ttdoc">Use existing grid data. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00058">m_global_parameters.f90:58</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a3bd150e984abfe14c8269e759ea4cb60"><div class="ttname"><a href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_xxxxx_to_mixture_variables), pointer s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00090">m_variables_conversion.f90:90</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa436c56a050419e85c8c08611a688e63"><div class="ttname"><a href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">m_global_parameters::y_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable y_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00089">m_global_parameters.f90:89</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abd9ada93ee5222de406111ee9c91ddf0"><div class="ttname"><a href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">m_global_parameters::x_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00089">m_global_parameters.f90:89</a></div></div>
<div class="ttc" id="namespacem__data__output_html_ab65b312ef83adb104cafafada9c998b6"><div class="ttname"><a href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">m_data_output::s_initialize_data_output_module</a></div><div class="ttdeci">subroutine, public s_initialize_data_output_module()</div><div class="ttdoc">Computation of parameters, allocation procedures, and/or any other tasks needed to properly setup the...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00432">m_data_output.f90:432</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5d234ed722013d06fbb2d1ee5f8aab56"><div class="ttname"><a href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(int_bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00125">m_global_parameters.f90:125</a></div></div>
<div class="ttc" id="namespacem__compile__specific_html"><div class="ttname"><a href="namespacem__compile__specific.html">m_compile_specific</a></div><div class="ttdoc">This module contains subroutines that are compiler specific. </div><div class="ttdef"><b>Definition:</b> <a href="m__compile__specific_8f90_source.html#l00035">m_compile_specific.f90:35</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1072f221ca8e41b0ea3240b33374cc1e"><div class="ttname"><a href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">m_global_parameters::p_glb</a></div><div class="ttdeci">integer p_glb</div><div class="ttdoc">Global number of cells in each direction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00074">m_global_parameters.f90:74</a></div></div>
<div class="ttc" id="namespacem__data__output_html_aa2b7bc17089e38b53927e6b77b61b6c7"><div class="ttname"><a href="namespacem__data__output.html#aa2b7bc17089e38b53927e6b77b61b6c7">m_data_output::restart_dir</a></div><div class="ttdeci">character(len=path_len+2 *name_len), public restart_dir</div><div class="ttdoc">Restart data folder. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00087">m_data_output.f90:87</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This file contains the definitions of all of the custom-defined types used in the pre-process code...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab73a1c5c3f6815695771323454db2a81"><div class="ttname"><a href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(int_bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00129">m_global_parameters.f90:129</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1f932e794cad6291b2e6c62b93dcf533"><div class="ttname"><a href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">m_global_parameters::z_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable z_cb</div><div class="ttdoc">Locations of cell-boundaries (cb) in x-, y- and z-directions, respectively. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00089">m_global_parameters.f90:89</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdoc">Number of cells in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00070">m_global_parameters.f90:70</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00128">m_global_parameters.f90:128</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a02f2b04a434c1f0ebf9156147d0f976e"><div class="ttname"><a href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">m_data_output::s_finalize_data_output_module</a></div><div class="ttdeci">subroutine, public s_finalize_data_output_module()</div><div class="ttdoc">Resets s_write_data_files pointer. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00487">m_data_output.f90:487</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in the system of equations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00117">m_global_parameters.f90:117</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00131">m_global_parameters.f90:131</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6ed5e5561c16f30a4010f6612877029d"><div class="ttname"><a href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">m_global_parameters::precision</a></div><div class="ttdeci">integer precision</div><div class="ttdoc">Precision of output files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00141">m_global_parameters.f90:141</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad80f68aac31aa898ab2d7729f60e375f"><div class="ttname"><a href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">m_global_parameters::mpi_io_data</a></div><div class="ttdeci">type(mpi_io_var), public mpi_io_data</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00157">m_global_parameters.f90:157</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0b91e533fe3b3e112c42af4024014544"><div class="ttname"><a href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">m_global_parameters::case_dir</a></div><div class="ttdeci">character(len=path_len) case_dir</div><div class="ttdoc">Case folder location. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00057">m_global_parameters.f90:57</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad4713c1e89eaa8fac3bb2181ba87b192"><div class="ttname"><a href="namespacem__global__parameters.html#ad4713c1e89eaa8fac3bb2181ba87b192">m_global_parameters::mpiiofs</a></div><div class="ttdeci">character(len=name_len) mpiiofs</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00160">m_global_parameters.f90:160</a></div></div>
<div class="ttc" id="interfacem__data__output_1_1s__write__abstract__data__files_html"><div class="ttname"><a href="interfacem__data__output_1_1s__write__abstract__data__files.html">m_data_output::s_write_abstract_data_files</a></div><div class="ttdoc">Interface for the conservative data. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00069">m_data_output.f90:69</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of total energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00127">m_global_parameters.f90:127</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdoc">Reference parameters for Tait EOS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a293bc6a9ccf7a197d8a5f0cfc3988584"><div class="ttname"><a href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(int_bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00069">m_global_parameters.f90:69</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad4e160df8d0de7ea1801a1ca29f8e9b0"><div class="ttname"><a href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_global_parameters::m_glb</a></div><div class="ttdeci">integer m_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00074">m_global_parameters.f90:74</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a12a171700eb3f8a63d17c01a0033cf39"><div class="ttname"><a href="namespacem__data__output.html#a12a171700eb3f8a63d17c01a0033cf39">m_data_output::s_write_parallel_data_files</a></div><div class="ttdeci">subroutine, public s_write_parallel_data_files(q_cons_vf)</div><div class="ttdoc">Writes grid and initial condition data files in parallel to the &quot;0&quot; time-step directory in the local ...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00352">m_data_output.f90:352</a></div></div>
<div class="ttc" id="namespacem__data__output_html_abaf86e34cd05a2227a23bcef0671a391"><div class="ttname"><a href="namespacem__data__output.html#abaf86e34cd05a2227a23bcef0671a391">m_data_output::s_write_serial_data_files</a></div><div class="ttdeci">subroutine, public s_write_serial_data_files(q_cons_vf)</div><div class="ttdoc">Writes grid and initial condition data files to the &quot;0&quot; time-step directory in the local processor ra...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00098">m_data_output.f90:98</a></div></div>
<div class="ttc" id="namespacem__compile__specific_html_aa7f14da74305c1d061ce326b16a3263e"><div class="ttname"><a href="namespacem__compile__specific.html#aa7f14da74305c1d061ce326b16a3263e">m_compile_specific::my_inquire</a></div><div class="ttdeci">subroutine my_inquire(fileloc, dircheck)</div><div class="ttdoc">Inquires on the existence of a directory. </div><div class="ttdef"><b>Definition:</b> <a href="m__compile__specific_8f90_source.html#l00045">m_compile_specific.f90:45</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a2ff35ede51e90c483969e44c31303415"><div class="ttname"><a href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">m_mpi_proxy::s_initialize_mpi_data</a></div><div class="ttdeci">subroutine s_initialize_mpi_data(q_cons_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00101">m_mpi_proxy.f90:101</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac127ac2a9036e1cdb7e6c41159cacdfb"><div class="ttname"><a href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">m_global_parameters::parallel_io</a></div><div class="ttdeci">logical parallel_io</div><div class="ttdoc">Format of the data files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00140">m_global_parameters.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aac1a5a73b1eae759c913983b38047167"><div class="ttname"><a href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">m_global_parameters::s_comp_n_from_cons</a></div><div class="ttdeci">subroutine s_comp_n_from_cons(vftmp, nRtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the conservative variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00781">m_global_parameters.f90:781</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a1ba4e8126b198fb2147d4d9b60f74e44"><div class="ttname"><a href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">m_data_output::s_write_data_files</a></div><div class="ttdeci">procedure(s_write_abstract_data_files), pointer, public s_write_data_files</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00090">m_data_output.f90:90</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac8252b115e717c6f1c8595be6f897df7"><div class="ttname"><a href="namespacem__global__parameters.html#ac8252b115e717c6f1c8595be6f897df7">m_global_parameters::name_len</a></div><div class="ttdeci">integer, parameter name_len</div><div class="ttdoc">Maximum name length. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00054">m_global_parameters.f90:54</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module consists of subroutines used in the conversion of the conservative variables into the pri...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00038">m_variables_conversion.f90:38</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a383c6ff025d4ea09ddd4e2356042d86b"><div class="ttname"><a href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">m_global_parameters::proc_rank</a></div><div class="ttdeci">integer proc_rank</div><div class="ttdoc">Rank of the local processor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00066">m_global_parameters.f90:66</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">This module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00196">m_global_parameters.f90:196</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_218ca2ea05193636ddecee9f98bb8f51.html">pre_process_code</a></li><li class="navelem"><a class="el" href="m__data__output_8f90.html">m_data_output.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
