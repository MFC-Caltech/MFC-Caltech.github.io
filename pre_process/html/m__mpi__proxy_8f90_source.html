<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Pre_process: m_mpi_proxy.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Pre_process
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__mpi__proxy_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_mpi_proxy.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__mpi__proxy_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html">   39</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">USE </span>mpi                     !&lt; message passing interface (mpi) module</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>         !&lt; definitions of the derived types</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>     !&lt; global parameters for the code</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a306ba163b09cfc692125f2c0ba82ef8c">   53</a></span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PRIVATE</span> :: <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  </div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">s_mpi_initialize</a>() <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">   63</a></span>&#160;            </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="comment">! Establishing the MPI environment</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keyword">CALL </span>mpi_init(<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            </div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="comment">! Checking whether the MPI environment has been properly intialized</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> /= mpi_success) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Unable to initialize MPI environment. Exiting ...&#39;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="comment">! Querying number of processors available for the job</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keyword">CALL </span>mpi_comm_size(mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">! Identifying the rank of the local processor</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keyword">CALL </span>mpi_comm_rank(mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> ,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">s_mpi_initialize</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>() <span class="comment">! ---------------------------------------------</span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">   91</a></span>&#160;            </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="comment">! Terminating the MPI environment</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a> <span class="comment">! -------------------------------------------</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">!! @param q_cons_vf Conservative variables </span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">s_initialize_mpi_data</a>(q_cons_vf) <span class="comment">! --------------------------</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">  101</a></span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: sizes_glb, sizes_loc</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordtype">INTEGER</span> :: ierr</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="comment">! Generic loop iterator</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(i)%sf =&gt; q_cons_vf(i)%sf</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="comment">! Define global(g) and local(l) sizes for flow variables</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            sizes_glb(1) = <a class="code" href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_glb</a>+1; sizes_loc(1) = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                sizes_glb(2) = <a class="code" href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">n_glb</a>+1; sizes_loc(2) = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    sizes_glb(3) = <a class="code" href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">p_glb</a>+1; sizes_loc(3) = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">! Define the view for each variable</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="keyword">CALL </span>mpi_type_create_subarray(<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>,sizes_glb,sizes_loc,<a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>,&amp;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    mpi_order_fortran,mpi_double_precision,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i),ierr)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keyword">CALL </span>mpi_type_commit(<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i),ierr)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">s_initialize_mpi_data</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">s_mpi_barrier</a>() <span class="comment">! -------------------------------------------</span></div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">  140</a></span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="comment">! Calling MPI_BARRIER</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keyword">CALL </span>mpi_barrier(mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">s_mpi_barrier</a> <span class="comment">! -----------------------------------------</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">s_mpi_bcast_user_inputs</a>() <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">  154</a></span>&#160;           </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="comment">! Generic loop iterator</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="comment">! Logistics</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>  , len(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>), mpi_character ,      &amp;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                              0      , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a>  ,       1      , mpi_logical   ,      &amp;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                              0      , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ae83688439601a9ff9bad58f09357a721">old_ic</a>    ,       1      , mpi_logical   ,      &amp;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                              0      , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a>,       1      , mpi_integer   ,      &amp;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                              0      , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="comment">! Computational domain parameters</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_glb</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">n_glb</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">p_glb</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%beg, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                          0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%end, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                          0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%beg, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                          0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%end, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                          0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%beg, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                          0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%end, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                          0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a95a3647227ae84b17613caee22408853">stretch_x</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#acd02bb9d62d1e2a5a3185e12b0bdaea9">stretch_y</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aaeee716bda208dc0427196cdb8ad8cdf">stretch_z</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aa0b506b1bb27c795ff1ca2049cd84b95">a_x</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a143fcefbf2bf4d1b296851d664c49b3a">a_y</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a8e0a3ebd94eeb22f50b48dff8a7e0cce">a_z</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a35f17d72a6c9e18aae51a5131d2c9303">loops_x</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#af8c939272b6741337359fd99e419fba1">loops_y</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a5cfb837ca862adc01d2ba0dce83fbd17">loops_z</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a7d6df53840be063479492e0034b34b11">x_a</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ab43cefe0ef4c4b75b1d99842a8626393">x_b</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ab19fa915c817b9b6697827d8ce059797">y_a</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ae6deea785ef4dbdb572a8eb6f30b7c3a">y_b</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a65b092136a85b466956efe77c639dc27">z_a</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#accc52011bfc1383c99125f030792ba6b">z_b</a>, 1,mpi_double_precision, 0,mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">! Simulation algorithm parameters</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">precision</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#add2d4033abdced8536200ef739ab379b">perturb_flow</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a1c242fb70db5a2c91c0997b37bcffd6a">perturb_flow_fluid</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a98ddabe1c45996064589ca24ce5d8fe3">perturb_sph</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a90f36c0b74894ddd901534dd4efccfc8">perturb_sph_fluid</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a3bde8cf1ea00471fcd005219c55e824e">fluid_rho</a>(1)     , <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>, mpi_logical   , &amp;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                                    0       , mpi_comm_world, &amp;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                                              <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;           </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">! Initial condition parameters</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a5e346daa48cf24534ceca2f656a57255">num_patches</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__derived__types.html#a0e61503f10c4338737b8d61e9109e396">num_patches_max</a></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry       , 1, &amp;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                mpi_integer                  , 0, &amp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%x_centroid     , 1, &amp;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%y_centroid     , 1, &amp;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%z_centroid     , 1, &amp;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%length_x       , 1, &amp;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%length_y       , 1, &amp;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%length_z       , 1, &amp;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%radius         , 1, &amp;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%epsilon        , 1, &amp;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%beta           , 1, &amp;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%normal(1)      , 3, &amp;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%radii(1)       , 3, &amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%smoothen       , 1, &amp;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                mpi_logical                  , 0, &amp;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%smooth_patch_id, 1, &amp;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                mpi_integer                  , 0, &amp;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%smooth_coeff   , 1, &amp;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%rho            , 1, &amp;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%vel(1)         , 3, &amp;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%pres           , 1, &amp;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%gamma          , 1, &amp;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%pi_inf         , 1, &amp;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%alter_patch(0)             , &amp;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                <a class="code" href="namespacem__derived__types.html#a0e61503f10c4338737b8d61e9109e396">num_patches_max</a> , mpi_logical         , 0, &amp;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                       )</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%alpha_rho(1)               , &amp;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>  , mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                       )</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%alpha(1)                   , &amp;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>-1, mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                       )</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="comment">! Bubbles</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%r0         , 1, &amp;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%v0         , 1, &amp;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                mpi_double_precision         , 0, &amp;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                 </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            </div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">! Fluids physical parameters</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma   , 1, &amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf  , 1, &amp;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%mul0  , 1, &amp;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%ss  , 1, &amp;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pv  , 1, &amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma_v  , 1, &amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%M_v  , 1, &amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%mu_v  , 1, &amp;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%k_v  , 1, &amp;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">! Tait EOS</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a>,1,             &amp;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>,1,           &amp;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="comment">! Bubble modeling</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>,1,          &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        mpi_logical,0,          &amp;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a>,1,          &amp;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        mpi_logical,0,          &amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a32791d9d5fef0213f01fc31713b17ae8">polydisperse</a>,1,          &amp;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        mpi_logical,0,          &amp;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a29164826db891e5662ce2bccdbc57d3c">poly_sigma</a>,1,            &amp;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a17169a5387f8f1efd5ac34cb4eae7c81">thermal</a>,1,            &amp;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        mpi_integer,0, &amp;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a24492f9b474683476a342e7ee42c1c6d">r0ref</a>,1,            &amp;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>,1,            &amp;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        mpi_integer,0, &amp;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>,1,            &amp;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">ca</a>,1,            &amp;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">re_inv</a>,1,            &amp;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">s_mpi_bcast_user_inputs</a> <span class="comment">! -------------------------------</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        </div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">s_mpi_decompose_computational_domain</a>() <span class="comment">! --------------------</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">  412</a></span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">! # of processors in the x-, y- and z-coordinate directions</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordtype">INTEGER</span> :: num_procs_x, num_procs_y, num_procs_z</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="comment">! Temporary # of processors in x-, y- and z-coordinate directions</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">! used during the processor factorization optimization procedure</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: tmp_num_procs_x, tmp_num_procs_y, tmp_num_procs_z</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            </div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">! Processor factorization (fct) minimization parameter</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: fct_min</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            </div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment">! Cartesian processor topology communicator</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordtype">INTEGER</span> :: MPI_COMM_CART</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">! Number of remaining cells for a particular coordinate direction</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">! after the bulk has evenly been distributed among the available</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="comment">! processors for that coordinate direction</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordtype">INTEGER</span> :: rem_cells</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            </div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> == 1 .AND. <a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(i) = 0</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="comment">! Performing the computational domain decomposition. The procedure</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="comment">! is optimized by ensuring that each processor contains a close to</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="comment">! equivalent piece of the computational domain. Note that explicit</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="comment">! type-casting is omitted here for code legibility purposes.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="comment">! Generating 3D Cartesian Processor Topology =======================</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a> .AND. <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    <span class="comment">! Implement pencil processor blocking if using cylindrical coordinates so</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <span class="comment">! that all cells in azimuthal direction are stored on a single processor.</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    <span class="comment">! This is necessary for efficient application of Fourier filter near axis.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        </div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        <span class="comment">! Initial values of the processor factorization optimization</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        num_procs_x =  1</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        num_procs_z =  1</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = -1</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                        </div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        <span class="comment">! Computing minimization variable for these initial values</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        tmp_num_procs_x = num_procs_x</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        tmp_num_procs_y = num_procs_y</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        tmp_num_procs_z = num_procs_z</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        fct_min         = 10d0*abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                                  -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                        </div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        <span class="comment">! Searching for optimal computational domain distribution</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                            </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                            <span class="keywordflow">IF</span>(        mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>,i) == 0        &amp;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                               .AND.                &amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/i &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                tmp_num_procs_x = i</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                tmp_num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> / i</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                <span class="keywordflow">IF</span>( fct_min &gt;= abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x  &amp;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                                 -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y) &amp;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                                    .AND.                &amp;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y        &amp;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                                     &gt;=                  &amp;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>      ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                    </div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                    num_procs_x = i</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                    num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                    fct_min     = abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                     -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = 0</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                    </div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                            </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                        <span class="comment">! Initial values of the processor factorization optimization</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                        num_procs_x =  1</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        num_procs_y =  1</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        num_procs_z = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = -1</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <span class="comment">! Computing minimization variable for these initial values</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        tmp_num_procs_x = num_procs_x</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        tmp_num_procs_y = num_procs_y</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        tmp_num_procs_z = num_procs_z</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        fct_min         = 10d0*abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x  &amp;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                                  -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y) &amp;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                        + 10d0*abs((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y  &amp;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                                  -(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        </div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        <span class="comment">! Searching for optimal computational domain distribution</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                            </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                            <span class="keywordflow">IF</span>(        mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>,i) == 0        &amp;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                               .AND.                &amp;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/i &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                <span class="keywordflow">DO</span> j = 1, (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                    </div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                    <span class="keywordflow">IF</span>(       mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i,j) == 0       &amp;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                       .AND.                &amp;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/j &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                        </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                        tmp_num_procs_x = i</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                        tmp_num_procs_y = j</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                        tmp_num_procs_z = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> / (i*j)</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                        </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                        <span class="keywordflow">IF</span>( fct_min &gt;= abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x    &amp;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                         -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)   &amp;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                                    + abs((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y    &amp;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                                         -(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z)   &amp;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                                            .AND.                  &amp;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                    (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z          &amp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                             &gt;=                    &amp;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>      ) &amp;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                            <span class="keywordflow">THEN</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                           </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                           num_procs_x = i</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                           num_procs_y = j</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                           num_procs_z = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/(i*j)</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                           fct_min     = abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                                            -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)&amp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                                       + abs((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y &amp;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                            -(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z)</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = 0</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                           </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                        </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                    </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            </div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    </div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    <span class="comment">! Checking whether the decomposition of the computational</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    <span class="comment">! domain was successful</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0 .AND. <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                        print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Unable to decompose computational &#39;</span> // &amp;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                     <span class="stringliteral">&#39;domain for selected number of &#39;</span> // &amp;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                     <span class="stringliteral">&#39;processors. Exiting ...&#39;</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    <span class="comment">! Creating a new communicator using Cartesian topology</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_create( mpi_comm_world, 3, (/ num_procs_x, &amp;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                          num_procs_y, num_procs_z /),       &amp;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                          (/ .true., .true., .true. /),      &amp;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                          .false., mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>       )</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                    </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    <span class="comment">! Finding corresponding Cartesian coordinates of the local</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    <span class="comment">! processor rank in newly declared cartesian communicator</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_coords( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, 3, &amp;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="comment">! END: Generating 3D Cartesian Processor Topology ==================</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                    </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                    </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="comment">! Sub-domain Global Parameters in z-direction ======================</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    <span class="comment">! Number of remaining cells after majority is distributed</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    rem_cells = mod(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1, num_procs_z)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    <span class="comment">! Preliminary uniform cell-width spacing</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#ab930758827576d5cf2518679bf670351">dz</a> = (<a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%beg) / <span class="keywordtype">REAL</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1,kind(0d0))</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    </div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    <span class="comment">! Optimal number of cells per processor</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> = (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) / num_procs_z - 1</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    <span class="comment">! Distributing any remaining cells</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    <span class="keywordflow">DO</span> i = 1, rem_cells</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) == i-1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + 1</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                            <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    <span class="comment">! Beginning and end sub-domain boundary locations</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%beg = <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%beg + <a class="code" href="namespacem__global__parameters.html#ab930758827576d5cf2518679bf670351">dz</a>*<span class="keywordtype">REAL( (p+1) * &amp;
                                                       proc_coords(3)</span> )</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%end = <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#ab930758827576d5cf2518679bf670351">dz</a>*<span class="keywordtype">REAL( (p+1) * &amp;
                                                       (num_procs_z - proc_coords(3) - 1)</span> &amp;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                                     - (num_procs_z - rem_cells) )</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%beg = <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%beg + <a class="code" href="namespacem__global__parameters.html#ab930758827576d5cf2518679bf670351">dz</a>*<span class="keywordtype">REAL( (p+1) * &amp;
                                                       proc_coords(3)</span> + rem_cells )</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%end = <a class="code" href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">z_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#ab930758827576d5cf2518679bf670351">dz</a>*<span class="keywordtype">REAL( (p+1) * &amp;
                                                       (num_procs_z - proc_coords(3) - 1)</span> )</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(3) = (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(3) = (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) + rem_cells</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="comment">! Generating 2D Cartesian Processor Topology =======================</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    <span class="comment">! Initial values of the processor factorization optimization</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    num_procs_x =  1</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = -1</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    </div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="comment">! Computing minimization variable for these initial values</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    tmp_num_procs_x = num_procs_x</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    tmp_num_procs_y = num_procs_y</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    fct_min         = 10d0*abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                              -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    <span class="comment">! Searching for optimal computational domain distribution</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                        </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                        <span class="keywordflow">IF</span>(        mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>,i) == 0        &amp;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                           .AND.                &amp;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                            (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/i &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                            </div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            tmp_num_procs_x = i</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                            tmp_num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> / i</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            </div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                            <span class="keywordflow">IF</span>( fct_min &gt;= abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x  &amp;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                             -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y) &amp;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                                .AND.                &amp;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y        &amp;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                                 &gt;=                  &amp;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                       <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>      ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                </div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                num_procs_x = i</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                fct_min     = abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                                 -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = 0</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <span class="comment">! Checking whether the decomposition of the computational</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="comment">! domain was successful</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0 .AND. <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Unable to decompose computational &#39;</span> // &amp;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                     <span class="stringliteral">&#39;domain for selected number of &#39;</span> // &amp;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                     <span class="stringliteral">&#39;processors. Exiting ...&#39;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <span class="comment">! Creating a new communicator using Cartesian topology</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_create( mpi_comm_world, 2, (/ num_procs_x, &amp;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                          num_procs_y /), (/ .true.,         &amp;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                          .true. /), .false., mpi_comm_cart, &amp;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    <span class="comment">! Finding corresponding Cartesian coordinates of the local</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="comment">! processor rank in newly declared cartesian communicator</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_coords( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, 2, &amp;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">! END: Generating 2D Cartesian Processor Topology ==================</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="comment">! Sub-domain Global Parameters in y-direction ======================</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="comment">! Number of remaining cells after majority has been distributed</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                rem_cells = mod(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1, num_procs_y)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <span class="comment">! Preliminary uniform cell-width spacing</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a5ff5660b10330ad917331259642e8dc4">dy</a> = (<a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%beg) / <span class="keywordtype">REAL</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1, kind(0d0))</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="comment">! Optimal number of cells per processor</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> = (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1) / num_procs_y - 1</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="comment">! Distributing any remaining cells</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">DO</span> i = 1, rem_cells</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) == i-1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + 1</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                        <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="comment">! Beginning and end sub-domain boundary locations</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%beg = <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%beg + <a class="code" href="namespacem__global__parameters.html#a5ff5660b10330ad917331259642e8dc4">dy</a>*<span class="keywordtype">REAL( (n+1) * &amp;
                                                   proc_coords(2)</span> )</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%end = <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#a5ff5660b10330ad917331259642e8dc4">dy</a>*<span class="keywordtype">REAL( (n+1) * &amp;
                                                   (num_procs_y - proc_coords(2) - 1)</span> &amp;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                                 - (num_procs_y - rem_cells) )</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%beg = <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%beg + <a class="code" href="namespacem__global__parameters.html#a5ff5660b10330ad917331259642e8dc4">dy</a>*<span class="keywordtype">REAL( (n+1) * &amp;
                                                   proc_coords(2)</span> + rem_cells )</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%end = <a class="code" href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">y_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#a5ff5660b10330ad917331259642e8dc4">dy</a>*<span class="keywordtype">REAL( (n+1) * &amp;
                                                   (num_procs_y - proc_coords(2) - 1)</span> )</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(2) = (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(2) = (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) + rem_cells</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="comment">! Generating 1D Cartesian Processor Topology =======================</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                </div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="comment">! Number of processors in the coordinate direction is equal to</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="comment">! the total number of processors available</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                num_procs_x = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="comment">! Creating a new communicator using Cartesian topology</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keyword">CALL </span>mpi_cart_create( mpi_comm_world, 1, (/ num_procs_x /), &amp;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                      (/ .true. /), .false., mpi_comm_cart, &amp;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                  )</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="comment">! Finding the corresponding Cartesian coordinates of the local</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <span class="comment">! processor rank in the newly declared cartesian communicator</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="keyword">CALL </span>mpi_cart_coords( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, 1, &amp;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            </div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="comment">! Sub-domain Global Parameters in x-direction ======================</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="comment">! Number of remaining cells after majority has been distributed</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            rem_cells = mod(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, num_procs_x)</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="comment">! Preliminary uniform cell-width spacing</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <a class="code" href="namespacem__global__parameters.html#aaa9a08d5b90f48e0f6bb64c209fd89e4">dx</a> = (<a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%beg) / <span class="keywordtype">REAL</span>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, kind(0d0))</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="comment">! Optimal number of cells per processor</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1) / num_procs_x - 1</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="comment">! Distributing any remaining cells</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">DO</span> i = 1, rem_cells</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) == i-1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + 1</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="comment">! Beginning and end sub-domain boundary locations</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">old_grid</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%beg = <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%beg + <a class="code" href="namespacem__global__parameters.html#aaa9a08d5b90f48e0f6bb64c209fd89e4">dx</a>*<span class="keywordtype">REAL( (m+1) * &amp;
                                           proc_coords(1)</span> )</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%end = <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#aaa9a08d5b90f48e0f6bb64c209fd89e4">dx</a>*<span class="keywordtype">REAL( (m+1) * &amp;
                                           (num_procs_x - proc_coords(1) - 1)</span> &amp;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                         - (num_procs_x - rem_cells) )</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%beg = <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%beg + <a class="code" href="namespacem__global__parameters.html#aaa9a08d5b90f48e0f6bb64c209fd89e4">dx</a>*<span class="keywordtype">REAL( (m+1) * &amp;
                                           proc_coords(1)</span> + rem_cells )</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%end = <a class="code" href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">x_domain</a>%end - <a class="code" href="namespacem__global__parameters.html#aaa9a08d5b90f48e0f6bb64c209fd89e4">dx</a>*<span class="keywordtype">REAL( (m+1) * &amp;
                                           (num_procs_x - proc_coords(1) - 1)</span> )</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(1) = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1)</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(1) = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) + rem_cells</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;           </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            </div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">s_mpi_decompose_computational_domain</a> <span class="comment">! ------------------</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ad02d11c9b94b9354f7d8234937bb27a2">s_mpi_reduce_min</a>(var_loc) <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(INOUT)</span> :: var_loc</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="comment">! Temporary storage variable that holds the reduced minimum value</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: var_glb</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            </div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="comment">! Performing reduction procedure and eventually storing its result</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="comment">! into the variable that was initially inputted into the subroutine</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keyword">CALL </span>mpi_reduce( var_loc, var_glb, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                             mpi_min, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            </div><div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#ad02d11c9b94b9354f7d8234937bb27a2">  834</a></span>&#160;            <span class="keyword">CALL </span>mpi_bcast( var_glb, 1, mpi_double_precision, &amp;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            var_loc = var_glb</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            </div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ad02d11c9b94b9354f7d8234937bb27a2">s_mpi_reduce_min</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        </div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5">s_mpi_finalize</a>() <span class="comment">! ------------------------------</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="comment">! Terminating the MPI environment</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keyword">CALL </span>mpi_finalize(<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5">s_mpi_finalize</a> <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<div class="ttc" id="namespacem__global__parameters_html_a3bde8cf1ea00471fcd005219c55e824e"><div class="ttname"><a href="namespacem__global__parameters.html#a3bde8cf1ea00471fcd005219c55e824e">m_global_parameters::fluid_rho</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids_max) fluid_rho</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="namespacem__derived__types_html_a0e61503f10c4338737b8d61e9109e396"><div class="ttname"><a href="namespacem__derived__types.html#a0e61503f10c4338737b8d61e9109e396">m_derived_types::num_patches_max</a></div><div class="ttdeci">integer, parameter num_patches_max</div><div class="ttdoc">Maximum number of patches allowed. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00040">m_derived_types.f90:40</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4438313a11564fa911c586d2dee15b8d"><div class="ttname"><a href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">m_global_parameters::re_inv</a></div><div class="ttdeci">real(kind(0d0)) re_inv</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00194">m_global_parameters.f90:194</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab43cefe0ef4c4b75b1d99842a8626393"><div class="ttname"><a href="namespacem__global__parameters.html#ab43cefe0ef4c4b75b1d99842a8626393">m_global_parameters::x_b</a></div><div class="ttdeci">real(kind(0d0)) x_b</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00111">m_global_parameters.f90:111</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a48dea2bc17c5e4465a444c926070ae9b"><div class="ttname"><a href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">m_global_parameters::proc_coords</a></div><div class="ttdeci">integer, dimension(:), allocatable proc_coords</div><div class="ttdoc">Processor coordinates in MPI_CART_COMM. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00151">m_global_parameters.f90:151</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a65b092136a85b466956efe77c639dc27"><div class="ttname"><a href="namespacem__global__parameters.html#a65b092136a85b466956efe77c639dc27">m_global_parameters::z_a</a></div><div class="ttdeci">real(kind(0d0)) z_a</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00110">m_global_parameters.f90:110</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5d0554c4fef91acf46f683e8bcd29133"><div class="ttname"><a href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">m_global_parameters::t_step_old</a></div><div class="ttdeci">integer t_step_old</div><div class="ttdoc">Existing IC/grid folder. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00060">m_global_parameters.f90:60</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a35f17d72a6c9e18aae51a5131d2c9303"><div class="ttname"><a href="namespacem__global__parameters.html#a35f17d72a6c9e18aae51a5131d2c9303">m_global_parameters::loops_x</a></div><div class="ttdeci">integer loops_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00109">m_global_parameters.f90:109</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a17169a5387f8f1efd5ac34cb4eae7c81"><div class="ttname"><a href="namespacem__global__parameters.html#a17169a5387f8f1efd5ac34cb4eae7c81">m_global_parameters::thermal</a></div><div class="ttdeci">integer thermal</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00203">m_global_parameters.f90:203</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a46461347b5094736adfa94ef005b49a6"><div class="ttname"><a href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">m_global_parameters::ierr</a></div><div class="ttdeci">integer, private ierr</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00164">m_global_parameters.f90:164</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaa9a08d5b90f48e0f6bb64c209fd89e4"><div class="ttname"><a href="namespacem__global__parameters.html#aaa9a08d5b90f48e0f6bb64c209fd89e4">m_global_parameters::dx</a></div><div class="ttdeci">real(kind(0d0)) dx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00093">m_global_parameters.f90:93</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_abfbc42cea69273bc9fa4a2d78f636eb1"><div class="ttname"><a href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">m_mpi_proxy::s_mpi_barrier</a></div><div class="ttdeci">subroutine s_mpi_barrier()</div><div class="ttdoc">Halts all processes until all have reached barrier. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00140">m_mpi_proxy.f90:140</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a80c5e235786545276fe6ffa06965017f"><div class="ttname"><a href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">m_mpi_proxy::s_mpi_decompose_computational_domain</a></div><div class="ttdeci">subroutine s_mpi_decompose_computational_domain()</div><div class="ttdoc">Description: This subroutine takes care of efficiently distributing the computational domain among th...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00412">m_mpi_proxy.f90:412</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a9bc4c617505152d3cc553e5bc25c1ee1"><div class="ttname"><a href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">m_mpi_proxy::s_mpi_initialize</a></div><div class="ttdeci">subroutine s_mpi_initialize()</div><div class="ttdoc">The subroutine intializes the MPI environment and queries both the number of processors that will be ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00063">m_mpi_proxy.f90:63</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a90f36c0b74894ddd901534dd4efccfc8"><div class="ttname"><a href="namespacem__global__parameters.html#a90f36c0b74894ddd901534dd4efccfc8">m_global_parameters::perturb_sph_fluid</a></div><div class="ttdeci">integer perturb_sph_fluid</div><div class="ttdoc">Fluid to be perturbed with perturb_sph flag. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00147">m_global_parameters.f90:147</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa46a7f3638e49fa9ec33ea859b9e6a5a"><div class="ttname"><a href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">m_global_parameters::bc_x</a></div><div class="ttdeci">type(bounds_info) bc_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00136">m_global_parameters.f90:136</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a32791d9d5fef0213f01fc31713b17ae8"><div class="ttname"><a href="namespacem__global__parameters.html#a32791d9d5fef0213f01fc31713b17ae8">m_global_parameters::polydisperse</a></div><div class="ttdeci">logical polydisperse</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00202">m_global_parameters.f90:202</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00180">m_global_parameters.f90:180</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adab11dab474410541d4c37725bea01e1"><div class="ttname"><a href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">m_global_parameters::n_glb</a></div><div class="ttdeci">integer n_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00074">m_global_parameters.f90:74</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ae5709407e3600d19d79b183e409bb982"><div class="ttname"><a href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">m_mpi_proxy::err_code</a></div><div class="ttdeci">integer, private err_code</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00053">m_mpi_proxy.f90:53</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">This module contains all of the parameters characterizing the computational domain, simulation algorithm, initial condition and the stiffened equation of state. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00037">m_global_parameters.f90:37</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a71f091e6074e6c248fd7e03218b89218"><div class="ttname"><a href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">m_global_parameters::num_stcls_min</a></div><div class="ttdeci">integer, parameter num_stcls_min</div><div class="ttdoc">Mininum # of stencils. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00052">m_global_parameters.f90:52</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a95a3647227ae84b17613caee22408853"><div class="ttname"><a href="namespacem__global__parameters.html#a95a3647227ae84b17613caee22408853">m_global_parameters::stretch_x</a></div><div class="ttdeci">logical stretch_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00101">m_global_parameters.f90:101</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00047">m_derived_types.f90:47</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a971692c50b4725d4724238b8a01a722e"><div class="ttname"><a href="namespacem__global__parameters.html#a971692c50b4725d4724238b8a01a722e">m_global_parameters::old_grid</a></div><div class="ttdeci">logical old_grid</div><div class="ttdoc">Use existing grid data. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00058">m_global_parameters.f90:58</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4b6341f4ce0cc9c395b4791549357efc"><div class="ttname"><a href="namespacem__global__parameters.html#a4b6341f4ce0cc9c395b4791549357efc">m_global_parameters::z_domain</a></div><div class="ttdeci">type(bounds_info) z_domain</div><div class="ttdoc">Locations of the domain bounds in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5ff5660b10330ad917331259642e8dc4"><div class="ttname"><a href="namespacem__global__parameters.html#a5ff5660b10330ad917331259642e8dc4">m_global_parameters::dy</a></div><div class="ttdeci">real(kind(0d0)) dy</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00093">m_global_parameters.f90:93</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a68eaaca2982b39252417b29ef5d0f9c3"><div class="ttname"><a href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">m_global_parameters::bc_y</a></div><div class="ttdeci">type(bounds_info) bc_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00136">m_global_parameters.f90:136</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a58e390acc41a75facd63f1d89a8e60bc"><div class="ttname"><a href="namespacem__global__parameters.html#a58e390acc41a75facd63f1d89a8e60bc">m_global_parameters::x_domain</a></div><div class="ttdeci">type(bounds_info) x_domain</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8e0a3ebd94eeb22f50b48dff8a7e0cce"><div class="ttname"><a href="namespacem__global__parameters.html#a8e0a3ebd94eeb22f50b48dff8a7e0cce">m_global_parameters::a_z</a></div><div class="ttdeci">real(kind(0d0)) a_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00108">m_global_parameters.f90:108</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af8c939272b6741337359fd99e419fba1"><div class="ttname"><a href="namespacem__global__parameters.html#af8c939272b6741337359fd99e419fba1">m_global_parameters::loops_y</a></div><div class="ttdeci">integer loops_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00109">m_global_parameters.f90:109</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a43fbda10c02ec8bc1fc572c83090f2e5"><div class="ttname"><a href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5">m_mpi_proxy::s_mpi_finalize</a></div><div class="ttdeci">subroutine s_mpi_finalize()</div><div class="ttdoc">Finalization of all MPI related processes. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00859">m_mpi_proxy.f90:859</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a24492f9b474683476a342e7ee42c1c6d"><div class="ttname"><a href="namespacem__global__parameters.html#a24492f9b474683476a342e7ee42c1c6d">m_global_parameters::r0ref</a></div><div class="ttdeci">real(kind(0d0)) r0ref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1072f221ca8e41b0ea3240b33374cc1e"><div class="ttname"><a href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">m_global_parameters::p_glb</a></div><div class="ttdeci">integer p_glb</div><div class="ttdoc">Global number of cells in each direction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00074">m_global_parameters.f90:74</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This file contains the definitions of all of the custom-defined types used in the pre-process code...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae6deea785ef4dbdb572a8eb6f30b7c3a"><div class="ttname"><a href="namespacem__global__parameters.html#ae6deea785ef4dbdb572a8eb6f30b7c3a">m_global_parameters::y_b</a></div><div class="ttdeci">real(kind(0d0)) y_b</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00111">m_global_parameters.f90:111</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdoc">Number of cells in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00070">m_global_parameters.f90:70</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7d6df53840be063479492e0034b34b11"><div class="ttname"><a href="namespacem__global__parameters.html#a7d6df53840be063479492e0034b34b11">m_global_parameters::x_a</a></div><div class="ttdeci">real(kind(0d0)) x_a</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00110">m_global_parameters.f90:110</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1fcd6cc13ad7f604ef81708716a1feac"><div class="ttname"><a href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">m_global_parameters::ca</a></div><div class="ttdeci">real(kind(0d0)) ca</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00194">m_global_parameters.f90:194</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acd02bb9d62d1e2a5a3185e12b0bdaea9"><div class="ttname"><a href="namespacem__global__parameters.html#acd02bb9d62d1e2a5a3185e12b0bdaea9">m_global_parameters::stretch_y</a></div><div class="ttdeci">logical stretch_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00101">m_global_parameters.f90:101</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of different fluids present in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_accc52011bfc1383c99125f030792ba6b"><div class="ttname"><a href="namespacem__global__parameters.html#accc52011bfc1383c99125f030792ba6b">m_global_parameters::z_b</a></div><div class="ttdeci">real(kind(0d0)) z_b</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00111">m_global_parameters.f90:111</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a29164826db891e5662ce2bccdbc57d3c"><div class="ttname"><a href="namespacem__global__parameters.html#a29164826db891e5662ce2bccdbc57d3c">m_global_parameters::poly_sigma</a></div><div class="ttdeci">real(kind(0d0)) poly_sigma</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00207">m_global_parameters.f90:207</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae83688439601a9ff9bad58f09357a721"><div class="ttname"><a href="namespacem__global__parameters.html#ae83688439601a9ff9bad58f09357a721">m_global_parameters::old_ic</a></div><div class="ttdeci">logical old_ic</div><div class="ttdoc">Use existing IC data. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4bd117ae744eab60f3d681fd03d6e90d"><div class="ttname"><a href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">m_global_parameters::start_idx</a></div><div class="ttdeci">integer, dimension(:), allocatable start_idx</div><div class="ttdoc">Starting cell-center index of local processor in global grid. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00154">m_global_parameters.f90:154</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in the system of equations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Alpha limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00117">m_global_parameters.f90:117</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a143fcefbf2bf4d1b296851d664c49b3a"><div class="ttname"><a href="namespacem__global__parameters.html#a143fcefbf2bf4d1b296851d664c49b3a">m_global_parameters::a_y</a></div><div class="ttdeci">real(kind(0d0)) a_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00108">m_global_parameters.f90:108</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a98ddabe1c45996064589ca24ce5d8fe3"><div class="ttname"><a href="namespacem__global__parameters.html#a98ddabe1c45996064589ca24ce5d8fe3">m_global_parameters::perturb_sph</a></div><div class="ttdeci">logical perturb_sph</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00146">m_global_parameters.f90:146</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ad02d11c9b94b9354f7d8234937bb27a2"><div class="ttname"><a href="namespacem__mpi__proxy.html#ad02d11c9b94b9354f7d8234937bb27a2">m_mpi_proxy::s_mpi_reduce_min</a></div><div class="ttdeci">subroutine s_mpi_reduce_min(var_loc)</div><div class="ttdoc">The following subroutine takes the inputted variable and determines its minimum value on the entire c...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00834">m_mpi_proxy.f90:834</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6ed5e5561c16f30a4010f6612877029d"><div class="ttname"><a href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">m_global_parameters::precision</a></div><div class="ttdeci">integer precision</div><div class="ttdoc">Precision of output files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00141">m_global_parameters.f90:141</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad80f68aac31aa898ab2d7729f60e375f"><div class="ttname"><a href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">m_global_parameters::mpi_io_data</a></div><div class="ttdeci">type(mpi_io_var), public mpi_io_data</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00157">m_global_parameters.f90:157</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab19fa915c817b9b6697827d8ce059797"><div class="ttname"><a href="namespacem__global__parameters.html#ab19fa915c817b9b6697827d8ce059797">m_global_parameters::y_a</a></div><div class="ttdeci">real(kind(0d0)) y_a</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00110">m_global_parameters.f90:110</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0b91e533fe3b3e112c42af4024014544"><div class="ttname"><a href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">m_global_parameters::case_dir</a></div><div class="ttdeci">character(len=path_len) case_dir</div><div class="ttdoc">Case folder location. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00057">m_global_parameters.f90:57</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdoc">Reference parameters for Tait EOS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__derived__types_html_a3dde07670ef3e164534aa68c1830ff62"><div class="ttname"><a href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">m_derived_types::num_fluids_max</a></div><div class="ttdeci">integer, parameter num_fluids_max</div><div class="ttdoc">Maximum number of fluids allowed. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00043">m_derived_types.f90:43</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a53f0d5eed7783c9760aaeeaa0abbd58c"><div class="ttname"><a href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">m_global_parameters::cyl_coord</a></div><div class="ttdeci">logical cyl_coord</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00080">m_global_parameters.f90:80</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aafb65952c33f1c363d1040bde29734ea"><div class="ttname"><a href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">m_global_parameters::num_procs</a></div><div class="ttdeci">integer num_procs</div><div class="ttdoc">Number of processors. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00051">m_global_parameters.f90:51</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a69660c5fe9302a8c0496b622fa3b5286"><div class="ttname"><a href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">m_mpi_proxy::s_mpi_bcast_user_inputs</a></div><div class="ttdeci">subroutine s_mpi_bcast_user_inputs()</div><div class="ttdoc">Since only processor with rank 0 is in charge of reading and checking the consistency of the user pro...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00154">m_mpi_proxy.f90:154</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5cfb837ca862adc01d2ba0dce83fbd17"><div class="ttname"><a href="namespacem__global__parameters.html#a5cfb837ca862adc01d2ba0dce83fbd17">m_global_parameters::loops_z</a></div><div class="ttdeci">integer loops_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00109">m_global_parameters.f90:109</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af2ed21959a90158c2459574230cdfcff"><div class="ttname"><a href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">m_global_parameters::web</a></div><div class="ttdeci">real(kind(0d0)) web</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00194">m_global_parameters.f90:194</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00069">m_global_parameters.f90:69</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a94bfe5cc861c66dadab450d25a6b5817"><div class="ttname"><a href="namespacem__global__parameters.html#a94bfe5cc861c66dadab450d25a6b5817">m_global_parameters::y_domain</a></div><div class="ttdeci">type(bounds_info) y_domain</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad4e160df8d0de7ea1801a1ca29f8e9b0"><div class="ttname"><a href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_global_parameters::m_glb</a></div><div class="ttdeci">integer m_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00074">m_global_parameters.f90:74</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5e346daa48cf24534ceca2f656a57255"><div class="ttname"><a href="namespacem__global__parameters.html#a5e346daa48cf24534ceca2f656a57255">m_global_parameters::num_patches</a></div><div class="ttdeci">integer num_patches</div><div class="ttdoc">Number of patches composing initial condition. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00169">m_global_parameters.f90:169</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab5fc97fce88eefa124865cab08aa2250"><div class="ttname"><a href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">m_global_parameters::patch_icpp</a></div><div class="ttdeci">type(ic_patch_parameters), dimension(num_patches_max) patch_icpp</div><div class="ttdoc">Database of the initial condition patch parameters (icpp) for each of the patches employed in the con...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00171">m_global_parameters.f90:171</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab8488205257dab4e94258eee55d0d1aa"><div class="ttname"><a href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">m_global_parameters::weno_order</a></div><div class="ttdeci">integer weno_order</div><div class="ttdoc">Order of accuracy for the WENO reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00122">m_global_parameters.f90:122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8d670f2f984167bae71b7b3f12d0908a"><div class="ttname"><a href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">m_global_parameters::polytropic</a></div><div class="ttdeci">logical polytropic</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00201">m_global_parameters.f90:201</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a04ac565bad2b22dc045a5eeb4f516e2e"><div class="ttname"><a href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">m_mpi_proxy::s_mpi_abort</a></div><div class="ttdeci">subroutine s_mpi_abort()</div><div class="ttdoc">The subroutine terminates the MPI execution environment. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00091">m_mpi_proxy.f90:91</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a2ff35ede51e90c483969e44c31303415"><div class="ttname"><a href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">m_mpi_proxy::s_initialize_mpi_data</a></div><div class="ttdeci">subroutine s_initialize_mpi_data(q_cons_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00101">m_mpi_proxy.f90:101</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab930758827576d5cf2518679bf670351"><div class="ttname"><a href="namespacem__global__parameters.html#ab930758827576d5cf2518679bf670351">m_global_parameters::dz</a></div><div class="ttdeci">real(kind(0d0)) dz</div><div class="ttdoc">Minimum cell-widths in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00093">m_global_parameters.f90:93</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac127ac2a9036e1cdb7e6c41159cacdfb"><div class="ttname"><a href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">m_global_parameters::parallel_io</a></div><div class="ttdeci">logical parallel_io</div><div class="ttdoc">Format of the data files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00140">m_global_parameters.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00077">m_global_parameters.f90:77</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_add2d4033abdced8536200ef739ab379b"><div class="ttname"><a href="namespacem__global__parameters.html#add2d4033abdced8536200ef739ab379b">m_global_parameters::perturb_flow</a></div><div class="ttdeci">logical perturb_flow</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00144">m_global_parameters.f90:144</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa0b506b1bb27c795ff1ca2049cd84b95"><div class="ttname"><a href="namespacem__global__parameters.html#aa0b506b1bb27c795ff1ca2049cd84b95">m_global_parameters::a_x</a></div><div class="ttdeci">real(kind(0d0)) a_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00108">m_global_parameters.f90:108</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6769808569174ff0eef096e958889837"><div class="ttname"><a href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">m_global_parameters::bc_z</a></div><div class="ttdeci">type(bounds_info) bc_z</div><div class="ttdoc">Boundary conditions in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00136">m_global_parameters.f90:136</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a383c6ff025d4ea09ddd4e2356042d86b"><div class="ttname"><a href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">m_global_parameters::proc_rank</a></div><div class="ttdeci">integer proc_rank</div><div class="ttdoc">Rank of the local processor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00066">m_global_parameters.f90:66</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">This module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaeee716bda208dc0427196cdb8ad8cdf"><div class="ttname"><a href="namespacem__global__parameters.html#aaeee716bda208dc0427196cdb8ad8cdf">m_global_parameters::stretch_z</a></div><div class="ttdeci">logical stretch_z</div><div class="ttdoc">Grid stretching flags for the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00101">m_global_parameters.f90:101</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1c242fb70db5a2c91c0997b37bcffd6a"><div class="ttname"><a href="namespacem__global__parameters.html#a1c242fb70db5a2c91c0997b37bcffd6a">m_global_parameters::perturb_flow_fluid</a></div><div class="ttdeci">integer perturb_flow_fluid</div><div class="ttdoc">Fluid to be perturbed with perturb_flow flag. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00145">m_global_parameters.f90:145</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00196">m_global_parameters.f90:196</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_218ca2ea05193636ddecee9f98bb8f51.html">pre_process_code</a></li><li class="navelem"><a class="el" href="m__mpi__proxy_8f90.html">m_mpi_proxy.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
