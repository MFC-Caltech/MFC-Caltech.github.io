<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="icon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Pre_process: m_variables_conversion.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Pre_process
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__variables__conversion_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_variables_conversion.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__variables__conversion_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html">   38</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>         !&lt; definitions of the derived types</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>     !&lt; global parameters for the code</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    abstract <span class="keyword">INTERFACE</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      </div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables.html">   64</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables.html">s_convert_xxxxx_to_mixture_variables</a>(   q_vf, i,j,k,   &amp;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                         rho,gamma,pi_inf )</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables.html#a603ed4c3b600fb1f4e9a0c1bc2574573">   66</a></span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="comment">! Importing the derived type scalar_field from m_derived_types.f90</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="comment">! and global variable sys_size, from m_global_variables.f90, as</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="comment">! the abstract interface does not inherently have access to them</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordtype">IMPORT </span>:: <a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            </div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_vf</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: gamma</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: pi_inf</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables.html">s_convert_xxxxx_to_mixture_variables</a></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">    END INTERFACE</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">! NOTE: These abstract interfaces allow for the declaration of a pointer to</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">! a procedure such that the choice of the model equations does not have to</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">! be queried every time the mixture quantities are needed.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">   90</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables.html">s_convert_xxxxx_to_mixture_variables</a>), &amp;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a> =&gt; null() </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ab76f1517a0d2503be8e1bfa7a8825485">s_convert_mixture_to_mixture_variables</a>(     q_vf, i,j,k,    &amp;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                             rho,gamma,pi_inf  )</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ab76f1517a0d2503be8e1bfa7a8825485">  111</a></span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_vf</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: i,j,k</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: gamma</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: pi_inf</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">! Transfering the density, the specific heat ratio function and the</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="comment">! liquid stiffness function, respectively</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            rho    = q_vf(1)%sf(i,j,k)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            gamma  = q_vf(<a class="code" href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">gamma_idx</a>)%sf(i,j,k)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            pi_inf = q_vf(<a class="code" href="namespacem__global__parameters.html#a7db1a23566279bdbc7da68850c596c69">pi_inf_idx</a>)%sf(i,j,k)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ab76f1517a0d2503be8e1bfa7a8825485">s_convert_mixture_to_mixture_variables</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ae67d5c9a515446d7258b13341c1bfb0a">s_convert_species_to_mixture_variables_bubbles</a> ( qK_vf,  &amp;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                            j,k,l,&amp;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                                            rho_K,gamma_K, pi_inf_K &amp;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                             )</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#ae67d5c9a515446d7258b13341c1bfb0a">  146</a></span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: qK_vf</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho_K, gamma_K, pi_inf_K</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span> :: alpha_rho_K, alpha_K</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="comment">! Constraining the partial densities and the volume fractions within</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="comment">! their physical bounds to make sure that any mixture variables that</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="comment">! are derived from them result within the limits that are set by the</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="comment">! fluids physical parameters that make up the mixture</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">! alpha_rho_K(1) = qK_vf(i)%sf(i,j,k)</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">! alpha_K(1)     = qK_vf(E_idx+i)%sf(i,j,k)</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="comment">! Performing the transfer of the density, the specific heat ratio</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">! function as well as the liquid stiffness function, respectively </span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                rho_k    = qk_vf(1)%sf(j,k,l)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                gamma_k  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma    <span class="comment">!qK_vf(gamma_idx)%sf(i,j,k)</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                pi_inf_k = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf   <span class="comment">!qK_vf(pi_inf_idx)%sf(i,j,k)       </span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. <a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                rho_k = 0d0; gamma_k = 0d0; pi_inf_k = 0d0</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 2)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        rho_k    = rho_k    + qk_vf(i)%sf(j,k,l) </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                        gamma_k  = gamma_k  + qk_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                        pi_inf_k = pi_inf_k + qk_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    rho_k    = qk_vf(1)%sf(j,k,l)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    gamma_k  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    pi_inf_k = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf   </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &gt; 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>-1 <span class="comment">!leave out bubble part of mixture</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        rho_k    = rho_k    + qk_vf(i)%sf(j,k,l) </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        gamma_k  = gamma_k  + qk_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        pi_inf_k = pi_inf_k + qk_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    <span class="comment">!rho_K    = qK_vf(1)%sf(j,k,l)</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                    <span class="comment">!gamma_K  = fluid_pp(1)%gamma</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    <span class="comment">!pi_inf_K = fluid_pp(1)%pi_inf   </span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    rho_k    = qk_vf(1)%sf(j,k,l)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    gamma_k  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    pi_inf_k = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf   </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#ae67d5c9a515446d7258b13341c1bfb0a">s_convert_species_to_mixture_variables_bubbles</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(     q_vf, j,k,l,    &amp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                             rho,gamma,pi_inf  )</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">  217</a></span>&#160;           </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_vf</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="comment">! Indices of the cell for which to compute the mixture variables</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: rho</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: gamma</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(OUT)</span> :: pi_inf</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="comment">! Computing the density, the specific heat ratio function and the</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="comment">! liquid stiffness function, respectively</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                rho = 0d0; gamma = 0d0; pi_inf = 0d0</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    rho    = rho    + q_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    gamma  = gamma  + q_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    pi_inf = pi_inf + q_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                </div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                rho    = q_vf(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%sf(j,k,l)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                gamma  = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%gamma</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                pi_inf = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%pi_inf</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>-1</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    rho    = rho    + q_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    gamma  = gamma  + q_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)       &amp;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                    * ( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(     i    )%gamma  &amp;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                      - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%gamma  )</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    pi_inf = pi_inf + q_vf(i+<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)       &amp;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                    * ( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(     i    )%pi_inf &amp;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                      - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%pi_inf )</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a> <span class="comment">! ----------------</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a3645e5a02bfdcb5d3a8f68f9c00cb051">s_initialize_variables_conversion_module</a>() <span class="comment">! -------------------</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a3645e5a02bfdcb5d3a8f68f9c00cb051">  269</a></span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">! Depending on the model selection for the equations of motion, the</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">! appropriate procedure for the conversion to the mixture variables</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">! is targeted by the procedure pointer</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#ab76f1517a0d2503be8e1bfa7a8825485">s_convert_mixture_to_mixture_variables</a></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                 <a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#ae67d5c9a515446d7258b13341c1bfb0a">s_convert_species_to_mixture_variables_bubbles</a></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                            <a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a3645e5a02bfdcb5d3a8f68f9c00cb051">s_initialize_variables_conversion_module</a> <span class="comment">! -----------------</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a589fffc2fe084855ea9e86935f1916b1">s_convert_conservative_to_primitive_variables</a>( q_cons_vf, &amp;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                                  q_prim_vf  )</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a589fffc2fe084855ea9e86935f1916b1">  298</a></span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_prim_vf</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="comment">! Density, specific heat ratio function, liquid stiffness function</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="comment">! and dynamic pressure, as defined in the incompressible flow sense,</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="comment">! respectively</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: dyn_pres</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nbub</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(nb)</span> :: nRtmp</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">! Converting the conservative variables to the primitive variables</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        <span class="comment">! Obtaining the density, specific heat ratio function</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <span class="comment">! and the liquid stiffness function, respectively</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .ne. 4 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a>( q_cons_vf,j,k,l, &amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                                             rho,gamma,pi_inf )</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <span class="comment">! Transferring the continuity equation(s) variable(s)</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                            q_prim_vf(i)%sf(j,k,l) = q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <span class="comment">! Zeroing out the dynamic pressure since it is computed</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <span class="comment">! iteratively by cycling through the momentum equations</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        dyn_pres = 0d0</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        <span class="comment">! Computing velocity and dynamic pressure from momenta</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%end</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .ne. 4 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                q_prim_vf(i)%sf(j,k,l) = q_cons_vf(i)%sf(j,k,l)/rho</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                dyn_pres = dyn_pres + q_cons_vf(i)%sf(j,k,l) * &amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                                  q_prim_vf(i)%sf(j,k,l) / 2d0</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                            <span class="keywordflow">ELSE</span> </div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                q_prim_vf(i)%sf(j,k,l) = q_cons_vf(i)%sf(j,k,l) &amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                       / q_cons_vf(1)%sf(j,k,l)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .ne. 4) .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                            <span class="comment">! Computing the pressure from the energy</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                            q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)-dyn_pres-pi_inf)/gamma</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .ne. 4) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                            print*, <span class="stringliteral">&#39;getting model_eqns 2 with bubbles. cons to prim&#39;</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                            <span class="comment">! p = ( E/(1-alf) - 0.5 rho u u/(1-alf) - pi_inf_k )/gamma_k</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                            q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                               ((q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)-dyn_pres)/(1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)) &amp;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                                - pi_inf )/gamma                     </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                            <span class="comment">! Tait EOS</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                            <span class="comment">! p = (pl0 + pi_infty)(rho/(rho_l0(1-alf)))^gamma - pi_infty</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                            q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) =                       &amp; </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                   (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf) *                  &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                   (                                            &amp; </div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                   q_prim_vf(1)%sf(j,k,l)/                     &amp;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                   (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1-q_prim_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)))   &amp; </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                   ) ** (1/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1) - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        <span class="comment">! Set partial pressures to mixture pressure</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">internalenergies_idx</a>%end</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                q_prim_vf(i)%sf(j,k,l) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <span class="comment">! Transfer the advection equation(s) variable(s)</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                            q_prim_vf(i)%sf(j,k,l) = q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                            <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                nrtmp(i) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l), nrtmp, nbub)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                q_prim_vf(i)%sf(j,k,l) = q_cons_vf(i)%sf(j,k,l)/nbub</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            </div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a589fffc2fe084855ea9e86935f1916b1">s_convert_conservative_to_primitive_variables</a> <span class="comment">! ---------</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        </div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a63d50d6771031b79117f2aba60e0cca3">s_convert_primitive_to_conservative_variables</a>( q_prim_vf, &amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                                                  q_cons_vf  )</div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a63d50d6771031b79117f2aba60e0cca3">  409</a></span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="comment">! Density, specific heat ratio function, liquid stiffness function</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">! and dynamic pressure, as defined in the incompressible flow sense,</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">! respectively</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: dyn_pres</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nbub</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(nb)</span> :: Rtmp</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            </div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment">! Converting the primitive variables to the conservative variables</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        <span class="comment">! Obtaining the density, specific heat ratio function</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                        <span class="comment">! and the liquid stiffness function, respectively</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a>( q_prim_vf,j,k,l, &amp;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                                             rho,gamma,pi_inf )</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <span class="comment">! Transferring the continuity equation(s) variable(s)</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                            q_cons_vf(i)%sf(j,k,l) = q_prim_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <span class="comment">! Zeroing out the dynamic pressure since it is computed</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                        <span class="comment">! iteratively by cycling through the velocity equations</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        dyn_pres = 0d0</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                        </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        <span class="comment">! Computing momenta and dynamic pressure from velocity</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%end</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                            q_cons_vf(i)%sf(j,k,l) = rho*q_prim_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                            dyn_pres = dyn_pres + q_cons_vf(i)%sf(j,k,l) * &amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                  q_prim_vf(i)%sf(j,k,l) / 2d0</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        <span class="comment">! Computing the energy from the pressure</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .ne. 4) .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                            <span class="comment">! E = Gamma*P + \rho u u /2 + \pi_inf</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                            q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                gamma*q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)+dyn_pres+pi_inf</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .ne. 4) .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                            <span class="comment">! \tilde{E} = dyn_pres + (1-\alf)(\Gamma p_l + \Pi_inf)</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                            q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = dyn_pres +         &amp;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                (1.d0 - q_prim_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)) *     &amp;    </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                (gamma*q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) + pi_inf)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                            <span class="comment">!Tait EOS, no conserved energy variable</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                            q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = 0.</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        <span class="comment">! Computing the internal energies from the pressure and continuities</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">internalenergies_idx</a>%end</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                q_cons_vf(i)%sf(j,k,l) = q_cons_vf(i-<a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end)%sf(j,k,l) * &amp; </div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i-<a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end)%gamma*q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i-<a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end)%pi_inf</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        <span class="comment">! Transferring the advection equation(s) variable(s)</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                            q_cons_vf(i)%sf(j,k,l) = q_prim_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                            <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                rtmp(i) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">s_comp_n_from_prim</a>( q_prim_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l), rtmp, nbub)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                q_cons_vf(i)%sf(j,k,l) = q_prim_vf(i)%sf(j,k,l)*nbub</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            </div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a63d50d6771031b79117f2aba60e0cca3">s_convert_primitive_to_conservative_variables</a> <span class="comment">! ---------</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a16536fea4442b05b3d639881992b9058">s_finalize_variables_conversion_module</a>() <span class="comment">! ----------------</span></div><div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="namespacem__variables__conversion.html#a16536fea4442b05b3d639881992b9058">  504</a></span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="comment">! Nullifying the procedure pointer to the subroutine transfering/</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="comment">! computing the mixture/species variables to the mixture variables</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">s_convert_to_mixture_variables</a> =&gt; null()</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            </div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__variables__conversion.html#a16536fea4442b05b3d639881992b9058">s_finalize_variables_conversion_module</a> <span class="comment">! --------------</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttc" id="namespacem__variables__conversion_html_a3645e5a02bfdcb5d3a8f68f9c00cb051"><div class="ttname"><a href="namespacem__variables__conversion.html#a3645e5a02bfdcb5d3a8f68f9c00cb051">m_variables_conversion::s_initialize_variables_conversion_module</a></div><div class="ttdeci">subroutine s_initialize_variables_conversion_module()</div><div class="ttdoc">Computation of parameters, allocation procedures, and/or any other tasks needed to properly setup the...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00269">m_variables_conversion.f90:269</a></div></div>
<div class="ttc" id="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables_html"><div class="ttname"><a href="interfacem__variables__conversion_1_1s__convert__xxxxx__to__mixture__variables.html">m_variables_conversion::s_convert_xxxxx_to_mixture_variables</a></div><div class="ttdoc">Abstract interface to two subroutines designed for the transfer/conversion of the mixture/species var...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00064">m_variables_conversion.f90:64</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00180">m_global_parameters.f90:180</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7db1a23566279bdbc7da68850c596c69"><div class="ttname"><a href="namespacem__global__parameters.html#a7db1a23566279bdbc7da68850c596c69">m_global_parameters::pi_inf_idx</a></div><div class="ttdeci">integer pi_inf_idx</div><div class="ttdoc">Index of liquid stiffness func. eqn. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">This module contains all of the parameters characterizing the computational domain, simulation algorithm, initial condition and the stiffened equation of state. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00037">m_global_parameters.f90:37</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00047">m_derived_types.f90:47</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_add70754fa3c57535e4bc79c012962dc6"><div class="ttname"><a href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine s_convert_species_to_mixture_variables(q_vf, j, k, l, rho, gamma, pi_inf)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00217">m_variables_conversion.f90:217</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a3bd150e984abfe14c8269e759ea4cb60"><div class="ttname"><a href="namespacem__variables__conversion.html#a3bd150e984abfe14c8269e759ea4cb60">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_xxxxx_to_mixture_variables), pointer s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00090">m_variables_conversion.f90:90</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5d234ed722013d06fbb2d1ee5f8aab56"><div class="ttname"><a href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(int_bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00125">m_global_parameters.f90:125</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This file contains the definitions of all of the custom-defined types used in the pre-process code...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a63d50d6771031b79117f2aba60e0cca3"><div class="ttname"><a href="namespacem__variables__conversion.html#a63d50d6771031b79117f2aba60e0cca3">m_variables_conversion::s_convert_primitive_to_conservative_variables</a></div><div class="ttdeci">subroutine s_convert_primitive_to_conservative_variables(q_prim_vf, q_cons_vf)</div><div class="ttdoc">Converts the primitive variables to the conservative ones. Used when initializing patches...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00409">m_variables_conversion.f90:409</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab73a1c5c3f6815695771323454db2a81"><div class="ttname"><a href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(int_bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00129">m_global_parameters.f90:129</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdoc">Number of cells in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00070">m_global_parameters.f90:70</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00128">m_global_parameters.f90:128</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of different fluids present in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a16536fea4442b05b3d639881992b9058"><div class="ttname"><a href="namespacem__variables__conversion.html#a16536fea4442b05b3d639881992b9058">m_variables_conversion::s_finalize_variables_conversion_module</a></div><div class="ttdeci">subroutine s_finalize_variables_conversion_module()</div><div class="ttdoc">Deallocation procedures for the module. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00504">m_variables_conversion.f90:504</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in the system of equations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Alpha limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00117">m_global_parameters.f90:117</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acdaa3827df6fee38a3e55e8b13130c27"><div class="ttname"><a href="namespacem__global__parameters.html#acdaa3827df6fee38a3e55e8b13130c27">m_global_parameters::s_comp_n_from_prim</a></div><div class="ttdeci">subroutine s_comp_n_from_prim(vftmp, Rtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the primitive variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00796">m_global_parameters.f90:796</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00131">m_global_parameters.f90:131</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4ecdedaf3db880f8d71dbefc816322f8"><div class="ttname"><a href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">m_global_parameters::gamma_idx</a></div><div class="ttdeci">integer gamma_idx</div><div class="ttdoc">Index of specific heat ratio func. eqn. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00132">m_global_parameters.f90:132</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ab76f1517a0d2503be8e1bfa7a8825485"><div class="ttname"><a href="namespacem__variables__conversion.html#ab76f1517a0d2503be8e1bfa7a8825485">m_variables_conversion::s_convert_mixture_to_mixture_variables</a></div><div class="ttdeci">subroutine s_convert_mixture_to_mixture_variables(q_vf, i, j, k, rho, gamma, pi_inf)</div><div class="ttdoc">This subroutine is designed for the gamma/pi_inf model and provided a set of either conservative or p...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00111">m_variables_conversion.f90:111</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of total energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00127">m_global_parameters.f90:127</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdoc">Reference parameters for Tait EOS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a293bc6a9ccf7a197d8a5f0cfc3988584"><div class="ttname"><a href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(int_bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a589fffc2fe084855ea9e86935f1916b1"><div class="ttname"><a href="namespacem__variables__conversion.html#a589fffc2fe084855ea9e86935f1916b1">m_variables_conversion::s_convert_conservative_to_primitive_variables</a></div><div class="ttdeci">subroutine s_convert_conservative_to_primitive_variables(q_cons_vf, q_prim_vf)</div><div class="ttdoc">Converts the conservative variables to the primitive ones. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00298">m_variables_conversion.f90:298</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00069">m_global_parameters.f90:69</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aac1a5a73b1eae759c913983b38047167"><div class="ttname"><a href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">m_global_parameters::s_comp_n_from_cons</a></div><div class="ttdeci">subroutine s_comp_n_from_cons(vftmp, nRtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the conservative variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00781">m_global_parameters.f90:781</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9eb3789b90381530338a223c99cf1090"><div class="ttname"><a href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">m_global_parameters::internalenergies_idx</a></div><div class="ttdeci">type(int_bounds_info) internalenergies_idx</div><div class="ttdoc">Indexes of first &amp; last internal energy eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00130">m_global_parameters.f90:130</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_ae67d5c9a515446d7258b13341c1bfb0a"><div class="ttname"><a href="namespacem__variables__conversion.html#ae67d5c9a515446d7258b13341c1bfb0a">m_variables_conversion::s_convert_species_to_mixture_variables_bubbles</a></div><div class="ttdeci">subroutine s_convert_species_to_mixture_variables_bubbles(qK_vf, j, k, l, rho_K, gamma_K, pi_inf_K)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. Specifially designed for when subgrid bubbles must be included. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00146">m_variables_conversion.f90:146</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module consists of subroutines used in the conversion of the conservative variables into the pri...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00038">m_variables_conversion.f90:38</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00196">m_global_parameters.f90:196</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_218ca2ea05193636ddecee9f98bb8f51.html">pre_process_code</a></li><li class="navelem"><a class="el" href="m__variables__conversion_8f90.html">m_variables_conversion.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
